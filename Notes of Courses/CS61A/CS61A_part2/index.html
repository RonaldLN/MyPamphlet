
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ronaldln.github.io/MyPamphlet/Notes%20of%20Courses/CS61A/CS61A_part2/">
      
      
        <link rel="prev" href="../CS61A_part1/">
      
      
        <link rel="next" href="../CS61A_part3/">
      
      
      <link rel="icon" href="../../../icons/favicon.jpg">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.6">
    
    
      
        <title>CS61A Part 2 - My Pamphlet</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.35e1ed30.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/timeago.css">
    
      <link rel="stylesheet" href="../../../css/timeago.css">
    
      <link rel="stylesheet" href="../../../css/timeago.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-screen-web/style.css">
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC&display=swap">
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=JetBrains+Mono&display=swap">
    
      <link rel="stylesheet" href="../../../stylesheets/my_scheme.css">
    
      <link rel="stylesheet" href="../../../stylesheets/custom.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-H7SV12D750"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-H7SV12D750",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-H7SV12D750",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?7a9cfe470ed52fa0c0940a58fede385c";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

   <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="sunset-glow" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cs61a-part-2" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="My Pamphlet" class="md-header__button md-logo" aria-label="My Pamphlet" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M96 0C43 0 0 43 0 96v320c0 53 43 96 96 96h320c17.7 0 32-14.3 32-32s-14.3-32-32-32v-64c17.7 0 32-14.3 32-32V32c0-17.7-14.3-32-32-32H96zm0 384h256v64H96c-17.7 0-32-14.3-32-32s14.3-32 32-32zm32-240c0-8.8 7.2-16 16-16h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16zm16 48h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16s7.2-16 16-16z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            My Pamphlet
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              CS61A Part 2
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="sunset-glow" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="sunset-glow-dark" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24Z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../../../zh/Notes%20of%20Courses/CS61A/CS61A_part2/" hreflang="zh" class="md-select__link">
              简体中文
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="./" hreflang="en" class="md-select__link">
              English labels (英文标签)
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/RonaldLN/MyPamphlet" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    RonaldLN/MyPamphlet
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="My Pamphlet" class="md-nav__button md-logo" aria-label="My Pamphlet" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M96 0C43 0 0 43 0 96v320c0 53 43 96 96 96h320c17.7 0 32-14.3 32-32s-14.3-32-32-32v-64c17.7 0 32-14.3 32-32V32c0-17.7-14.3-32-32-32H96zm0 384h256v64H96c-17.7 0-32-14.3-32-32s14.3-32 32-32zm32-240c0-8.8 7.2-16 16-16h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16zm16 48h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16s7.2-16 16-16z"/></svg>

    </a>
    My Pamphlet
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/RonaldLN/MyPamphlet" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    RonaldLN/MyPamphlet
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to My Pamphlet
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blog
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Notes of Courses
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Notes of Courses
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CS61A
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            CS61A
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../CS61A_part1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CS61A Part 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    CS61A Part 2
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    CS61A Part 2
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lecture-18-objects" class="md-nav__link">
    Lecture 18 Objects
  </a>
  
    <nav class="md-nav" aria-label="Lecture 18 Objects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    5
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-18-qa" class="md-nav__link">
    Lecture 18 Q&amp;A
  </a>
  
    <nav class="md-nav" aria-label="Lecture 18 Q&A">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hw-04" class="md-nav__link">
    HW 04
  </a>
  
    <nav class="md-nav" aria-label="HW 04">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_2" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_2" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_1" class="md-nav__link">
    3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-19-inheritance" class="md-nav__link">
    Lecture 19 Inheritance
  </a>
  
    <nav class="md-nav" aria-label="Lecture 19 Inheritance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_3" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_3" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_2" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_1" class="md-nav__link">
    4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_1" class="md-nav__link">
    5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    6
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    7
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8" class="md-nav__link">
    8
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9" class="md-nav__link">
    9
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10" class="md-nav__link">
    10
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    11
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-19-qa" class="md-nav__link">
    Lecture 19 Q&amp;A
  </a>
  
    <nav class="md-nav" aria-label="Lecture 19 Q&A">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_4" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_4" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_3" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_2" class="md-nav__link">
    4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_2" class="md-nav__link">
    5
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-07" class="md-nav__link">
    Lab 07
  </a>
  
    <nav class="md-nav" aria-label="Lab 07">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_5" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_5" class="md-nav__link">
    2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#project-ants" class="md-nav__link">
    Project Ants
  </a>
  
    <nav class="md-nav" aria-label="Project Ants">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_6" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_6" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_4" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_3" class="md-nav__link">
    4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_3" class="md-nav__link">
    5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6_1" class="md-nav__link">
    6
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7_1" class="md-nav__link">
    7
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-20-representation" class="md-nav__link">
    Lecture 20 Representation
  </a>
  
    <nav class="md-nav" aria-label="Lecture 20 Representation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_7" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_7" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_5" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_4" class="md-nav__link">
    4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_4" class="md-nav__link">
    5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6_2" class="md-nav__link">
    6
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-20-qa" class="md-nav__link">
    Lecture 20 Q&amp;A
  </a>
  
    <nav class="md-nav" aria-label="Lecture 20 Q&A">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_8" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_8" class="md-nav__link">
    2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-21-composition" class="md-nav__link">
    Lecture 21 Composition
  </a>
  
    <nav class="md-nav" aria-label="Lecture 21 Composition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_9" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_9" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_6" class="md-nav__link">
    3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hw-05" class="md-nav__link">
    HW 05
  </a>
  
    <nav class="md-nav" aria-label="HW 05">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_10" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_10" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_7" class="md-nav__link">
    3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-22-efficiency" class="md-nav__link">
    Lecture 22 Efficiency
  </a>
  
    <nav class="md-nav" aria-label="Lecture 22 Efficiency">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_11" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_11" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_8" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_5" class="md-nav__link">
    4
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-08" class="md-nav__link">
    Lab 08
  </a>
  
    <nav class="md-nav" aria-label="Lab 08">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_12" class="md-nav__link">
    1
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-23-decomposition" class="md-nav__link">
    Lecture 23 Decomposition
  </a>
  
    <nav class="md-nav" aria-label="Lecture 23 Decomposition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_13" class="md-nav__link">
    1
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-23-qa" class="md-nav__link">
    Lecture 23 Q&amp;A
  </a>
  
    <nav class="md-nav" aria-label="Lecture 23 Q&A">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_14" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_12" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_9" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_6" class="md-nav__link">
    4
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-24-data-example" class="md-nav__link">
    Lecture 24 Data Example
  </a>
  
    <nav class="md-nav" aria-label="Lecture 24 Data Example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_15" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_13" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_10" class="md-nav__link">
    3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-24-qa" class="md-nav__link">
    Lecture 24 Q&amp;A
  </a>
  
    <nav class="md-nav" aria-label="Lecture 24 Q&A">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_16" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_14" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_11" class="md-nav__link">
    3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-09" class="md-nav__link">
    Lab 09
  </a>
  
    <nav class="md-nav" aria-label="Lab 09">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_17" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_15" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_12" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_7" class="md-nav__link">
    4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_5" class="md-nav__link">
    5
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-25-users" class="md-nav__link">
    Lecture 25 Users
  </a>
  
    <nav class="md-nav" aria-label="Lecture 25 Users">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_18" class="md-nav__link">
    1
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-25-qa" class="md-nav__link">
    Lecture 25 Q&amp;A
  </a>
  
    <nav class="md-nav" aria-label="Lecture 25 Q&A">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_19" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_16" class="md-nav__link">
    2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-26-ethical-ai-data" class="md-nav__link">
    Lecture 26 Ethical AI &amp; Data
  </a>
  
    <nav class="md-nav" aria-label="Lecture 26 Ethical AI & Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_20" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_17" class="md-nav__link">
    2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-27-scheme" class="md-nav__link">
    Lecture 27 Scheme
  </a>
  
    <nav class="md-nav" aria-label="Lecture 27 Scheme">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_21" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_18" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_13" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_8" class="md-nav__link">
    4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_6" class="md-nav__link">
    5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6_3" class="md-nav__link">
    6
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7_2" class="md-nav__link">
    7
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8_1" class="md-nav__link">
    8
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9_1" class="md-nav__link">
    9
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10_1" class="md-nav__link">
    10
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11_1" class="md-nav__link">
    11
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-27-qa" class="md-nav__link">
    Lecture 27 Q&amp;A
  </a>
  
    <nav class="md-nav" aria-label="Lecture 27 Q&A">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_22" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_19" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_14" class="md-nav__link">
    3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-10" class="md-nav__link">
    Lab 10
  </a>
  
    <nav class="md-nav" aria-label="Lab 10">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_23" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_20" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_15" class="md-nav__link">
    3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hw-06" class="md-nav__link">
    HW 06
  </a>
  
    <nav class="md-nav" aria-label="HW 06">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_24" class="md-nav__link">
    1
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-28-exception" class="md-nav__link">
    Lecture 28 Exception
  </a>
  
    <nav class="md-nav" aria-label="Lecture 28 Exception">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_25" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_21" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_16" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_9" class="md-nav__link">
    4
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-28-qa" class="md-nav__link">
    Lecture 28 Q&amp;A
  </a>
  
    <nav class="md-nav" aria-label="Lecture 28 Q&A">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_26" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_22" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_17" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_10" class="md-nav__link">
    4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_7" class="md-nav__link">
    5
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-29-calculater" class="md-nav__link">
    Lecture 29 Calculater
  </a>
  
    <nav class="md-nav" aria-label="Lecture 29 Calculater">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_27" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_23" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_18" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_11" class="md-nav__link">
    4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_8" class="md-nav__link">
    5
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-29-qa" class="md-nav__link">
    Lecture 29 Q&amp;A
  </a>
  
    <nav class="md-nav" aria-label="Lecture 29 Q&A">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_28" class="md-nav__link">
    1
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hw-07" class="md-nav__link">
    HW 07
  </a>
  
    <nav class="md-nav" aria-label="HW 07">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_29" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_24" class="md-nav__link">
    2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-11" class="md-nav__link">
    Lab 11
  </a>
  
    <nav class="md-nav" aria-label="Lab 11">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_30" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_25" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_19" class="md-nav__link">
    3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#project-scheme" class="md-nav__link">
    Project Scheme
  </a>
  
    <nav class="md-nav" aria-label="Project Scheme">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_31" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_26" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_20" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_12" class="md-nav__link">
    4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_9" class="md-nav__link">
    5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6_4" class="md-nav__link">
    6
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7_3" class="md-nav__link">
    7
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8_2" class="md-nav__link">
    8
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9_2" class="md-nav__link">
    9
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10_2" class="md-nav__link">
    10
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11_2" class="md-nav__link">
    11
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12" class="md-nav__link">
    12
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13" class="md-nav__link">
    13
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../CS61A_part3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CS61A Part 3
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CS61B
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            CS61B
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../CS61B/CS61B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CS61B
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Git相关
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Git相关
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../git%E7%9B%B8%E5%85%B3/fastgithub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FastGithub
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../git%E7%9B%B8%E5%85%B3/github%20copilot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Github Copilot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../git%E7%9B%B8%E5%85%B3/github%26gitee/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Github & Gitee
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Markdown相关
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Markdown相关
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../markdown%E7%9B%B8%E5%85%B3/hexo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hexo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../markdown%E7%9B%B8%E5%85%B3/mermaid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mermaid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../markdown%E7%9B%B8%E5%85%B3/mkdocs%28material%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mkdocs (Material)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Python相关
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Python相关
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../python%E7%9B%B8%E5%85%B3/matplotlib/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Matplotlib
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../python%E7%9B%B8%E5%85%B3/mediapipe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MediaPipe
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../python%E7%9B%B8%E5%85%B3/numpy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NumPy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../python%E7%9B%B8%E5%85%B3/openpyxl%28%E7%94%A8%E4%BA%8Eexcel%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenPyXL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../python%E7%9B%B8%E5%85%B3/python%E8%AF%AD%E8%A8%80/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python 语言
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../python%E7%9B%B8%E5%85%B3/scipy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SciPy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../python%E7%9B%B8%E5%85%B3/sympy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SymPy
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Yolo
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Yolo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../yolo/yolov5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YOLOv5
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../yolo/yolov7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YOLOv7
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../yolo/yolov8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YOLOv8
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    系统&环境
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            系统&环境
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%B3%BB%E7%BB%9F%26%E7%8E%AF%E5%A2%83/anaconda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Anaconda
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%B3%BB%E7%BB%9F%26%E7%8E%AF%E5%A2%83/cuda%20cudnn%E5%AE%89%E8%A3%85/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CUDA cuDNN 安装
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%B3%BB%E7%BB%9F%26%E7%8E%AF%E5%A2%83/jupyter%20notebook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jupyter Notebook
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%B3%BB%E7%BB%9F%26%E7%8E%AF%E5%A2%83/nodejs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Node.js
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%B3%BB%E7%BB%9F%26%E7%8E%AF%E5%A2%83/pip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pip
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%B3%BB%E7%BB%9F%26%E7%8E%AF%E5%A2%83/powershell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PowerShell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%B3%BB%E7%BB%9F%26%E7%8E%AF%E5%A2%83/ros/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ROS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%B3%BB%E7%BB%9F%26%E7%8E%AF%E5%A2%83/ubuntu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ubuntu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%B3%BB%E7%BB%9F%26%E7%8E%AF%E5%A2%83/vim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vim
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lecture-18-objects" class="md-nav__link">
    Lecture 18 Objects
  </a>
  
    <nav class="md-nav" aria-label="Lecture 18 Objects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    5
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-18-qa" class="md-nav__link">
    Lecture 18 Q&amp;A
  </a>
  
    <nav class="md-nav" aria-label="Lecture 18 Q&A">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hw-04" class="md-nav__link">
    HW 04
  </a>
  
    <nav class="md-nav" aria-label="HW 04">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_2" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_2" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_1" class="md-nav__link">
    3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-19-inheritance" class="md-nav__link">
    Lecture 19 Inheritance
  </a>
  
    <nav class="md-nav" aria-label="Lecture 19 Inheritance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_3" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_3" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_2" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_1" class="md-nav__link">
    4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_1" class="md-nav__link">
    5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    6
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    7
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8" class="md-nav__link">
    8
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9" class="md-nav__link">
    9
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10" class="md-nav__link">
    10
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    11
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-19-qa" class="md-nav__link">
    Lecture 19 Q&amp;A
  </a>
  
    <nav class="md-nav" aria-label="Lecture 19 Q&A">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_4" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_4" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_3" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_2" class="md-nav__link">
    4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_2" class="md-nav__link">
    5
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-07" class="md-nav__link">
    Lab 07
  </a>
  
    <nav class="md-nav" aria-label="Lab 07">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_5" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_5" class="md-nav__link">
    2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#project-ants" class="md-nav__link">
    Project Ants
  </a>
  
    <nav class="md-nav" aria-label="Project Ants">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_6" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_6" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_4" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_3" class="md-nav__link">
    4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_3" class="md-nav__link">
    5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6_1" class="md-nav__link">
    6
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7_1" class="md-nav__link">
    7
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-20-representation" class="md-nav__link">
    Lecture 20 Representation
  </a>
  
    <nav class="md-nav" aria-label="Lecture 20 Representation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_7" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_7" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_5" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_4" class="md-nav__link">
    4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_4" class="md-nav__link">
    5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6_2" class="md-nav__link">
    6
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-20-qa" class="md-nav__link">
    Lecture 20 Q&amp;A
  </a>
  
    <nav class="md-nav" aria-label="Lecture 20 Q&A">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_8" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_8" class="md-nav__link">
    2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-21-composition" class="md-nav__link">
    Lecture 21 Composition
  </a>
  
    <nav class="md-nav" aria-label="Lecture 21 Composition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_9" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_9" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_6" class="md-nav__link">
    3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hw-05" class="md-nav__link">
    HW 05
  </a>
  
    <nav class="md-nav" aria-label="HW 05">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_10" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_10" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_7" class="md-nav__link">
    3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-22-efficiency" class="md-nav__link">
    Lecture 22 Efficiency
  </a>
  
    <nav class="md-nav" aria-label="Lecture 22 Efficiency">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_11" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_11" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_8" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_5" class="md-nav__link">
    4
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-08" class="md-nav__link">
    Lab 08
  </a>
  
    <nav class="md-nav" aria-label="Lab 08">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_12" class="md-nav__link">
    1
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-23-decomposition" class="md-nav__link">
    Lecture 23 Decomposition
  </a>
  
    <nav class="md-nav" aria-label="Lecture 23 Decomposition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_13" class="md-nav__link">
    1
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-23-qa" class="md-nav__link">
    Lecture 23 Q&amp;A
  </a>
  
    <nav class="md-nav" aria-label="Lecture 23 Q&A">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_14" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_12" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_9" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_6" class="md-nav__link">
    4
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-24-data-example" class="md-nav__link">
    Lecture 24 Data Example
  </a>
  
    <nav class="md-nav" aria-label="Lecture 24 Data Example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_15" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_13" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_10" class="md-nav__link">
    3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-24-qa" class="md-nav__link">
    Lecture 24 Q&amp;A
  </a>
  
    <nav class="md-nav" aria-label="Lecture 24 Q&A">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_16" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_14" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_11" class="md-nav__link">
    3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-09" class="md-nav__link">
    Lab 09
  </a>
  
    <nav class="md-nav" aria-label="Lab 09">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_17" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_15" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_12" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_7" class="md-nav__link">
    4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_5" class="md-nav__link">
    5
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-25-users" class="md-nav__link">
    Lecture 25 Users
  </a>
  
    <nav class="md-nav" aria-label="Lecture 25 Users">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_18" class="md-nav__link">
    1
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-25-qa" class="md-nav__link">
    Lecture 25 Q&amp;A
  </a>
  
    <nav class="md-nav" aria-label="Lecture 25 Q&A">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_19" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_16" class="md-nav__link">
    2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-26-ethical-ai-data" class="md-nav__link">
    Lecture 26 Ethical AI &amp; Data
  </a>
  
    <nav class="md-nav" aria-label="Lecture 26 Ethical AI & Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_20" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_17" class="md-nav__link">
    2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-27-scheme" class="md-nav__link">
    Lecture 27 Scheme
  </a>
  
    <nav class="md-nav" aria-label="Lecture 27 Scheme">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_21" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_18" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_13" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_8" class="md-nav__link">
    4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_6" class="md-nav__link">
    5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6_3" class="md-nav__link">
    6
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7_2" class="md-nav__link">
    7
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8_1" class="md-nav__link">
    8
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9_1" class="md-nav__link">
    9
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10_1" class="md-nav__link">
    10
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11_1" class="md-nav__link">
    11
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-27-qa" class="md-nav__link">
    Lecture 27 Q&amp;A
  </a>
  
    <nav class="md-nav" aria-label="Lecture 27 Q&A">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_22" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_19" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_14" class="md-nav__link">
    3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-10" class="md-nav__link">
    Lab 10
  </a>
  
    <nav class="md-nav" aria-label="Lab 10">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_23" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_20" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_15" class="md-nav__link">
    3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hw-06" class="md-nav__link">
    HW 06
  </a>
  
    <nav class="md-nav" aria-label="HW 06">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_24" class="md-nav__link">
    1
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-28-exception" class="md-nav__link">
    Lecture 28 Exception
  </a>
  
    <nav class="md-nav" aria-label="Lecture 28 Exception">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_25" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_21" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_16" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_9" class="md-nav__link">
    4
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-28-qa" class="md-nav__link">
    Lecture 28 Q&amp;A
  </a>
  
    <nav class="md-nav" aria-label="Lecture 28 Q&A">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_26" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_22" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_17" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_10" class="md-nav__link">
    4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_7" class="md-nav__link">
    5
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-29-calculater" class="md-nav__link">
    Lecture 29 Calculater
  </a>
  
    <nav class="md-nav" aria-label="Lecture 29 Calculater">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_27" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_23" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_18" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_11" class="md-nav__link">
    4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_8" class="md-nav__link">
    5
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecture-29-qa" class="md-nav__link">
    Lecture 29 Q&amp;A
  </a>
  
    <nav class="md-nav" aria-label="Lecture 29 Q&A">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_28" class="md-nav__link">
    1
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hw-07" class="md-nav__link">
    HW 07
  </a>
  
    <nav class="md-nav" aria-label="HW 07">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_29" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_24" class="md-nav__link">
    2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-11" class="md-nav__link">
    Lab 11
  </a>
  
    <nav class="md-nav" aria-label="Lab 11">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_30" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_25" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_19" class="md-nav__link">
    3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#project-scheme" class="md-nav__link">
    Project Scheme
  </a>
  
    <nav class="md-nav" aria-label="Project Scheme">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_31" class="md-nav__link">
    1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_26" class="md-nav__link">
    2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_20" class="md-nav__link">
    3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_12" class="md-nav__link">
    4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_9" class="md-nav__link">
    5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6_4" class="md-nav__link">
    6
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7_3" class="md-nav__link">
    7
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8_2" class="md-nav__link">
    8
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9_2" class="md-nav__link">
    9
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10_2" class="md-nav__link">
    10
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11_2" class="md-nav__link">
    11
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12" class="md-nav__link">
    12
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13" class="md-nav__link">
    13
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="cs61a-part-2">CS61A Part 2<a class="headerlink" href="#cs61a-part-2" title="Permanent link">&para;</a></h1>
<div style="margin-top: -30px; font-size: 0.75em; opacity: 0.7;">
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10h-2a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8V2m6.78 1a.69.69 0 0 0-.48.2l-1.22 1.21 2.5 2.5L20.8 5.7c.26-.26.26-.7 0-.95L19.25 3.2c-.13-.13-.3-.2-.47-.2m-2.41 2.12L9 12.5V15h2.5l7.37-7.38-2.5-2.5Z"/></svg></span> 约 22492 个字 <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6zm80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3z"/></svg></span> 3213 行代码 <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20c4.42 0 8-3.58 8-8s-3.58-8-8-8-8 3.58-8 8 3.58 8 8 8m0-18c5.5 0 10 4.5 10 10s-4.5 10-10 10C6.47 22 2 17.5 2 12S6.5 2 12 2m.5 11H11V7h1.5v4.26l3.7-2.13.75 1.3L12.5 13Z"/></svg></span> 预计阅读时间 115 分钟</p>
</div>
<details class="info">
<summary>目录</summary>
<ul>
<li><a href="#lecture-18-objects">Lecture 18 Objects</a></li>
<li><a href="#lecture-18-qa">Lecture 18 Q&amp;A</a></li>
<li><a href="#hw-04">HW 04</a></li>
<li><a href="#lecture-19-inheritance">Lecture 19 Inheritance</a></li>
<li><a href="#lecture-19-qa">Lecture 19 Q&amp;A</a></li>
<li><a href="#lab-07">Lab 07</a></li>
<li><a href="#project-ants">Project Ants</a></li>
<li><a href="#lecture-20-representation">Lecture 20 Representation</a></li>
<li><a href="#lecture-20-qa">Lecture 20 Q&amp;A</a></li>
<li><a href="#lecture-21-composition">Lecture 21 Composition</a></li>
<li><a href="#hw-05">HW 05</a></li>
<li><a href="#lecture-22-efficiency">Lecture 22 Efficiency</a></li>
<li><a href="#lab-08">Lab 08</a></li>
<li><a href="#lecture-23-decomposition">Lecture 23 Decomposition</a></li>
<li><a href="#lecture-23-qa">Lecture 23 Q&amp;A</a></li>
<li><a href="#lecture-24-data-example">Lecture 24 Data Example</a></li>
<li><a href="#lecture-24-qa">Lecture 24 Q&amp;A</a></li>
<li><a href="#lab-09">Lab 09</a></li>
<li><a href="#lecture-25-users">Lecture 25 Users</a></li>
<li><a href="#lecture-25-qa">Lecture 25 Q&amp;A</a></li>
<li><a href="#lecture-26-ethical-ai-data">Lecture 26 Ethical AI &amp; Data</a></li>
<li><a href="#lecture-27-scheme">Lecture 27 Scheme</a></li>
<li><a href="#lecture-27--qa">Lecture 27  Q&amp;A</a></li>
<li><a href="#lab-10">Lab 10</a></li>
<li><a href="#hw-06">HW 06</a></li>
<li><a href="#lecture-28-exception">Lecture 28 Exception</a></li>
<li><a href="#lecture-28-qa">Lecture 28 Q&amp;A</a></li>
<li><a href="#lecture-29-calculater">Lecture 29 Calculater</a></li>
<li><a href="#lecture-29-qa">Lecture 29 Q&amp;A</a></li>
<li><a href="#hw-07">HW 07</a></li>
<li><a href="#lab-11">Lab 11</a></li>
<li><a href="#project-scheme">Project Scheme</a></li>
</ul>
</details>
<h2 id="lecture-18-objects">Lecture 18 Objects<a class="headerlink" href="#lecture-18-objects" title="Permanent link">&para;</a></h2>
<h3 id="1">1<a class="headerlink" href="#1" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_80.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_80" loading="lazy" src="../images/cs61a_80.png" /></a></p>
<p>关于 class 和 object 之间的关系的形容</p>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p>关于 class 和 object 的解释：</p>
<ul>
<li><strong>class</strong>: A class combines (and abstracts) data and functions</li>
<li><strong>object</strong>: An object is an instantiation of a class</li>
</ul>
</div>
<h3 id="2">2<a class="headerlink" href="#2" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_81.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_81" loading="lazy" src="../images/cs61a_81.png" /></a></p>
<p>类内的方法在编写是，第一个参数须是 <code>self</code> ，</p>
<p>但类内方法在被调用的时候，不需要传入 <code>self</code> 的值，或者说 <code>self</code> 就是调用方法的实例，所以只需要传入之后的参数</p>
<h3 id="3">3<a class="headerlink" href="#3" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_82.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_82" loading="lazy" src="../images/cs61a_82.png" /></a></p>
<p>python有内置函数可以查询/访问类的实例的<em>属性(attribute)</em>，或者是类的属性 (<strong><mark>类内的方法算作是类本身的属性，而不是具体实例的属性</mark></strong>)</p>
<p><code>getattr()</code> 可以访问属性，获取对应的值</p>
<p><code>hasatrr()</code> 可以看是否有某个属性</p>
<p><strong>函数的第一个参数需要传入实例，第二个参数需要传入要查询的属性的属性名(以字符串传入)</strong></p>
<h3 id="4">4<a class="headerlink" href="#4" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_83.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_83" loading="lazy" src="../images/cs61a_83.png" /></a></p>
<p>如上图，<code>类名.方法名</code> 是一个函数，并且 <code>self</code> 参数需要传入东西，而 <code>对象.方法名</code> 是一个方法，<code>self</code> 不用传</p>
<h3 id="5">5<a class="headerlink" href="#5" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_84.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_84" loading="lazy" src="../images/cs61a_84.png" /></a></p>
<p><strong>类属性</strong></p>
<p>如上图，在类中赋值的变量，(应该)就是类的属性(类内的方法也算是类的属性，第3点有提到过)，</p>
<p><strong><mark>类属性不是对象/实例的一部分，而是类的一部分</mark>。每次通过对象来访问类属性，访问的是类中的属性，而通过 <code>对象.属性名</code> 赋值/更改属性，其实是在对象中创建/更改对应的属性(所以通过对象修改“类属性”不会更改实际的类属性)</strong></p>
<h2 id="lecture-18-qa">Lecture 18 Q&amp;A<a class="headerlink" href="#lecture-18-qa" title="Permanent link">&para;</a></h2>
<h3 id="1_1">1<a class="headerlink" href="#1_1" title="Permanent link">&para;</a></h3>
<p>类属性除了可以在类内定义，也可以在类以外，通过 <code>类名.属性名</code> 的形式赋值去定义，如</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Account</span><span class="p">:</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="o">...</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">Account</span><span class="o">.</span><span class="n">interest</span> <span class="o">=</span> <span class="mf">0.03</span>
</span></code></pre></div>
<blockquote>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">Account</span><span class="o">.</span><span class="n">interest</span>  <span class="mf">0.03</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">Account</span><span class="p">(</span><span class="s1">&#39;John&#39;</span><span class="p">)</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">interest</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="mf">0.03</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">interest</span> <span class="o">=</span> <span class="mf">0.05</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">interest</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="mf">0.05</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Account</span><span class="p">(</span><span class="s1">&#39;Hany&#39;</span><span class="p">)</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">b</span><span class="o">.</span><span class="n">interest</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="mf">0.03</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">interest</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="mf">0.05</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">interest</span> <span class="o">=</span> <span class="n">Account</span><span class="o">.</span><span class="n">interest</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">interest</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="mf">0.03</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">Account</span><span class="o">.</span><span class="n">interest</span> <span class="o">=</span> <span class="mf">0.04</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">interest</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="mf">0.03</span>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="o">&gt;&gt;&gt;</span>
</span></code></pre></div>
</blockquote>
<p>John的这段代码演示，显示了通过对象来修改“类属性”(指相同的名字)时，其实是修改的是具体对象中的属性</p>
<p>类和对象<strong>两者各自的修改都不会影响到对方的属性</strong></p>
<p><strong><code>del</code> 语句</strong>，经过测试，是可以将对象中已有的属性清除掉，从而再次访问相同的属性名时，获取到的是类属性的值</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span><span class="w"> </span><span class="nc">Account</span><span class="p">:</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="o">...</span>     <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="o">...</span>         <span class="k">return</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="o">...</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">Account</span><span class="o">.</span><span class="n">interest</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">p1</span> <span class="o">=</span> <span class="n">Account</span><span class="p">()</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">p1</span><span class="o">.</span><span class="n">interest</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="mi">5</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">del</span> <span class="n">p1</span><span class="o">.</span><span class="n">interest</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>  <span class="n">File</span> <span class="s2">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="ne">AttributeError</span><span class="p">:</span> <span class="n">interest</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">p1</span><span class="o">.</span><span class="n">interest</span> <span class="o">+=</span> <span class="mi">2</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">p1</span><span class="o">.</span><span class="n">interest</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="mi">7</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">Account</span><span class="o">.</span><span class="n">interest</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="mi">5</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">del</span> <span class="n">p1</span><span class="o">.</span><span class="n">interest</span>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">p1</span><span class="o">.</span><span class="n">interest</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a><span class="mi">5</span>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">del</span> <span class="n">p1</span><span class="o">.</span><span class="n">interest</span>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>  <span class="n">File</span> <span class="s2">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a><span class="ne">AttributeError</span><span class="p">:</span> <span class="n">interest</span>
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a><span class="o">&gt;&gt;&gt;</span>
</span></code></pre></div>
<h3 id="2_1">2<a class="headerlink" href="#2_1" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_85.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_85" loading="lazy" src="../images/cs61a_85.png" /></a></p>
<p><code>del</code> 也可以删除列表中的元素，</p>
<p>但是John说 <code>del</code> 不常用</p>
<h2 id="hw-04">HW 04<a class="headerlink" href="#hw-04" title="Permanent link">&para;</a></h2>
<h3 id="1_2">1<a class="headerlink" href="#1_2" title="Permanent link">&para;</a></h3>
<p>Q4</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p><em>Hint:</em> If you had the permutations of all the elements in <code>seq</code> not including the first element, how could you use that to generate the permutations of the full <code>seq</code>?</p>
</div>
<p>这个提示很有用：考虑每次抽去其中一个元素的情况，然后依次递归...</p>
<p>一开始感觉能用推导式写成一行</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">permutations</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>    <span class="k">yield from</span> <span class="p">[[</span><span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">+</span> <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">permutations</span><span class="p">(</span><span class="n">seq</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">seq</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">))]</span>
</span></code></pre></div>
<p>然后发现，<code>i</code> 只对 <code>permutations(seq[:i] + seq[i + 1:])</code> 生效，<code>[seq[i]]</code> 中 <code>i</code> 显示未定义</p>
<p>然后改成</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">permutations</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">))</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>        <span class="k">yield from</span> <span class="p">[[</span><span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">+</span> <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">permutations</span><span class="p">(</span><span class="n">seq</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">seq</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:])]</span>
</span></code></pre></div>
<p>然后在测试文档的一个测试用例中，用 <code>next()</code> 使用函数返回的生成器，显示 <code>StopIteration</code> ，</p>
<p>思考了很久，发现是因为，递归到了最后， <code>permutations(seq[:i] + seq[i + 1:])</code> 传入的是空列表，那么就不能<em>解压</em>出 <code>p</code> ，那么推导式的结果就会是空的列表，再一层层返回，所以最后整体的函数返回的生成器中没有可以迭代的元素</p>
<p>所以需要设置 base case ，(一开始以为不需要设置，或者说以为空列表就可以作为 base case)</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">permutations</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>        <span class="k">yield</span> <span class="n">seq</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>        <span class="k">yield from</span> <span class="p">[[</span><span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">+</span> <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">permutations</span><span class="p">(</span><span class="n">seq</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">seq</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:])]</span>
</span></code></pre></div>
<p>然后发现，测试文档中，有一个传入了元组，所以我稍加了修改</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">permutations</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>    <span class="n">seq</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>        <span class="k">yield</span> <span class="n">seq</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>        <span class="k">yield from</span> <span class="p">[[</span><span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">+</span> <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">permutations</span><span class="p">(</span><span class="n">seq</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">seq</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:])]</span>
</span></code></pre></div>
<blockquote>
<p>后面发现，其实这样改也可以：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">permutations</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>        <span class="k">yield</span> <span class="p">[</span><span class="n">seq</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>        <span class="k">yield from</span> <span class="p">[[</span><span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">+</span> <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">permutations</span><span class="p">(</span><span class="n">seq</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">seq</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:])]</span>
</span></code></pre></div>
</blockquote>
<p>在思索到底一行语句实现功能是否可行时，想到了 <code>sum()</code> 函数，想到可以用它来把结果合并在一个列表中</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">permutations</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>    <span class="k">yield from</span> <span class="nb">sum</span><span class="p">([[</span><span class="o">...</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">permutations</span><span class="p">(</span><span class="n">seq</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">seq</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:])]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">))],</span> <span class="n">start</span><span class="o">=</span><span class="p">[])</span>
</span></code></pre></div>
<p>然后想到可以把 base case 放在 <code>sum</code> 函数外面</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">permutations</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>    <span class="k">yield from</span> <span class="p">[[</span><span class="n">seq</span><span class="p">[</span><span class="mi">0</span><span class="p">]]]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="nb">sum</span><span class="p">([[[</span><span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">+</span> <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">permutations</span><span class="p">(</span><span class="n">seq</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">seq</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:])]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">))],</span> <span class="n">start</span><span class="o">=</span><span class="p">[])</span>    
</span></code></pre></div>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">permutations</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates all permutations of the given sequence. Each permutation is a</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="sd">    list of the elements in SEQ in a different order. The permutations may be</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="sd">    yielded in any order.</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="sd">    &gt;&gt;&gt; perms = permutations([100])</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="sd">    &gt;&gt;&gt; type(perms)</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="sd">    &lt;class &#39;generator&#39;&gt;</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="sd">    &gt;&gt;&gt; next(perms)</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="sd">    [100]</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="sd">    &gt;&gt;&gt; try: #this piece of code prints &quot;No more permutations!&quot; if calling next would cause an error</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="sd">    ...     next(perms)</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="sd">    ... except StopIteration:</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="sd">    ...     print(&#39;No more permutations!&#39;)</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="sd">    No more permutations!</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="sd">    &gt;&gt;&gt; sorted(permutations([1, 2, 3])) # Returns a sorted list containing elements of the generator</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="sd">    [[1, 2, 3], [1, 3, 2], [2, 1, 3], [2, 3, 1], [3, 1, 2], [3, 2, 1]]</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="sd">    &gt;&gt;&gt; sorted(permutations((10, 20, 30)))</span>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="sd">    [[10, 20, 30], [10, 30, 20], [20, 10, 30], [20, 30, 10], [30, 10, 20], [30, 20, 10]]</span>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="sd">    &gt;&gt;&gt; sorted(permutations(&quot;ab&quot;))</span>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="sd">    [[&#39;a&#39;, &#39;b&#39;], [&#39;b&#39;, &#39;a&#39;]]</span>
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a>    <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a>    <span class="c1"># seq = list(seq)</span>
</span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a>    <span class="c1"># if len(seq) == 1:</span>
</span><span id="__span-10-26"><a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a>    <span class="c1">#     yield seq</span>
</span><span id="__span-10-27"><a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a>    <span class="c1"># else:</span>
</span><span id="__span-10-28"><a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a>    <span class="c1">#     for i in range(len(seq)):</span>
</span><span id="__span-10-29"><a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a>    <span class="c1">#         yield from [[seq[i]] + p for p in permutations(seq[:i] + seq[i + 1:])]</span>
</span><span id="__span-10-30"><a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a>    <span class="k">yield from</span> <span class="p">[[</span><span class="n">seq</span><span class="p">[</span><span class="mi">0</span><span class="p">]]]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="nb">sum</span><span class="p">([[[</span><span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">+</span> <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">permutations</span><span class="p">(</span><span class="n">seq</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">seq</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:])]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">))],</span> <span class="n">start</span><span class="o">=</span><span class="p">[])</span>
</span></code></pre></div>
</details>
<h3 id="2_2">2<a class="headerlink" href="#2_2" title="Permanent link">&para;</a></h3>
<p>Q5</p>
<blockquote>
<p>Use <code>type(value) == str</code> to test if some <code>value</code> is a string</p>
</blockquote>
<p>可以使用 <code>type(value) == str</code> 来判断一个东西是否是字符串</p>
<p>感觉我最后答案中的这一行是关键的地方：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_joint</span><span class="p">(</span><span class="n">with_draw</span><span class="p">,</span> <span class="n">old_pass</span><span class="p">,</span> <span class="n">new_pass</span><span class="p">):</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">joint</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">pw_input</span><span class="p">):</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>        <span class="o">...</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>        <span class="k">return</span> <span class="n">withdraw</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">pw_input</span><span class="p">)</span>  <span class="c1"># key point</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>    <span class="o">...</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>    <span class="k">return</span> <span class="n">joint</span>
</span></code></pre></div>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_joint</span><span class="p">(</span><span class="n">withdraw</span><span class="p">,</span> <span class="n">old_pass</span><span class="p">,</span> <span class="n">new_pass</span><span class="p">):</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a password-protected withdraw function that has joint access to</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="sd">    the balance of withdraw.</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="sd">    &gt;&gt;&gt; w = make_withdraw(100, &#39;hax0r&#39;)</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="sd">    &gt;&gt;&gt; w(25, &#39;hax0r&#39;)</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="sd">    75</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="sd">    &gt;&gt;&gt; make_joint(w, &#39;my&#39;, &#39;secret&#39;)</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="sd">    &#39;Incorrect password&#39;</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="sd">    &gt;&gt;&gt; j = make_joint(w, &#39;hax0r&#39;, &#39;secret&#39;)</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="sd">    &gt;&gt;&gt; w(25, &#39;secret&#39;)</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="sd">    &#39;Incorrect password&#39;</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="sd">    &gt;&gt;&gt; j(25, &#39;secret&#39;)</span>
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="sd">    50</span>
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="sd">    &gt;&gt;&gt; j(25, &#39;hax0r&#39;)</span>
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="sd">    25</span>
</span><span id="__span-12-17"><a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a><span class="sd">    &gt;&gt;&gt; j(100, &#39;secret&#39;)</span>
</span><span id="__span-12-18"><a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a><span class="sd">    &#39;Insufficient funds&#39;</span>
</span><span id="__span-12-19"><a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a>
</span><span id="__span-12-20"><a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a><span class="sd">    &gt;&gt;&gt; j2 = make_joint(j, &#39;secret&#39;, &#39;code&#39;)</span>
</span><span id="__span-12-21"><a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a><span class="sd">    &gt;&gt;&gt; j2(5, &#39;code&#39;)</span>
</span><span id="__span-12-22"><a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a><span class="sd">    20</span>
</span><span id="__span-12-23"><a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a><span class="sd">    &gt;&gt;&gt; j2(5, &#39;secret&#39;)</span>
</span><span id="__span-12-24"><a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a><span class="sd">    15</span>
</span><span id="__span-12-25"><a id="__codelineno-12-25" name="__codelineno-12-25" href="#__codelineno-12-25"></a><span class="sd">    &gt;&gt;&gt; j2(5, &#39;hax0r&#39;)</span>
</span><span id="__span-12-26"><a id="__codelineno-12-26" name="__codelineno-12-26" href="#__codelineno-12-26"></a><span class="sd">    10</span>
</span><span id="__span-12-27"><a id="__codelineno-12-27" name="__codelineno-12-27" href="#__codelineno-12-27"></a>
</span><span id="__span-12-28"><a id="__codelineno-12-28" name="__codelineno-12-28" href="#__codelineno-12-28"></a><span class="sd">    &gt;&gt;&gt; j2(25, &#39;password&#39;)</span>
</span><span id="__span-12-29"><a id="__codelineno-12-29" name="__codelineno-12-29" href="#__codelineno-12-29"></a><span class="sd">    &#39;Incorrect password&#39;</span>
</span><span id="__span-12-30"><a id="__codelineno-12-30" name="__codelineno-12-30" href="#__codelineno-12-30"></a><span class="sd">    &gt;&gt;&gt; j2(5, &#39;secret&#39;)</span>
</span><span id="__span-12-31"><a id="__codelineno-12-31" name="__codelineno-12-31" href="#__codelineno-12-31"></a><span class="sd">    &quot;Frozen account. Attempts: [&#39;my&#39;, &#39;secret&#39;, &#39;password&#39;]&quot;</span>
</span><span id="__span-12-32"><a id="__codelineno-12-32" name="__codelineno-12-32" href="#__codelineno-12-32"></a><span class="sd">    &gt;&gt;&gt; j(5, &#39;secret&#39;)</span>
</span><span id="__span-12-33"><a id="__codelineno-12-33" name="__codelineno-12-33" href="#__codelineno-12-33"></a><span class="sd">    &quot;Frozen account. Attempts: [&#39;my&#39;, &#39;secret&#39;, &#39;password&#39;]&quot;</span>
</span><span id="__span-12-34"><a id="__codelineno-12-34" name="__codelineno-12-34" href="#__codelineno-12-34"></a><span class="sd">    &gt;&gt;&gt; w(5, &#39;hax0r&#39;)</span>
</span><span id="__span-12-35"><a id="__codelineno-12-35" name="__codelineno-12-35" href="#__codelineno-12-35"></a><span class="sd">    &quot;Frozen account. Attempts: [&#39;my&#39;, &#39;secret&#39;, &#39;password&#39;]&quot;</span>
</span><span id="__span-12-36"><a id="__codelineno-12-36" name="__codelineno-12-36" href="#__codelineno-12-36"></a><span class="sd">    &gt;&gt;&gt; make_joint(w, &#39;hax0r&#39;, &#39;hello&#39;)</span>
</span><span id="__span-12-37"><a id="__codelineno-12-37" name="__codelineno-12-37" href="#__codelineno-12-37"></a><span class="sd">    &quot;Frozen account. Attempts: [&#39;my&#39;, &#39;secret&#39;, &#39;password&#39;]&quot;</span>
</span><span id="__span-12-38"><a id="__codelineno-12-38" name="__codelineno-12-38" href="#__codelineno-12-38"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-12-39"><a id="__codelineno-12-39" name="__codelineno-12-39" href="#__codelineno-12-39"></a>    <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-12-40"><a id="__codelineno-12-40" name="__codelineno-12-40" href="#__codelineno-12-40"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">joint</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">pw_input</span><span class="p">):</span>
</span><span id="__span-12-41"><a id="__codelineno-12-41" name="__codelineno-12-41" href="#__codelineno-12-41"></a>        <span class="k">if</span> <span class="n">pw_input</span> <span class="o">==</span> <span class="n">new_pass</span><span class="p">:</span>
</span><span id="__span-12-42"><a id="__codelineno-12-42" name="__codelineno-12-42" href="#__codelineno-12-42"></a>            <span class="k">return</span> <span class="n">withdraw</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">old_pass</span><span class="p">)</span>
</span><span id="__span-12-43"><a id="__codelineno-12-43" name="__codelineno-12-43" href="#__codelineno-12-43"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-12-44"><a id="__codelineno-12-44" name="__codelineno-12-44" href="#__codelineno-12-44"></a>            <span class="k">return</span> <span class="n">withdraw</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">pw_input</span><span class="p">)</span>
</span><span id="__span-12-45"><a id="__codelineno-12-45" name="__codelineno-12-45" href="#__codelineno-12-45"></a>    <span class="n">old_result</span> <span class="o">=</span> <span class="n">withdraw</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">old_pass</span><span class="p">)</span>
</span><span id="__span-12-46"><a id="__codelineno-12-46" name="__codelineno-12-46" href="#__codelineno-12-46"></a>    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">old_result</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-12-47"><a id="__codelineno-12-47" name="__codelineno-12-47" href="#__codelineno-12-47"></a>        <span class="k">return</span> <span class="n">old_result</span>
</span><span id="__span-12-48"><a id="__codelineno-12-48" name="__codelineno-12-48" href="#__codelineno-12-48"></a>    <span class="k">return</span> <span class="n">joint</span>
</span></code></pre></div>
</details>
<h3 id="3_1">3<a class="headerlink" href="#3_1" title="Permanent link">&para;</a></h3>
<p>Q6</p>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">remainders_generator</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="sd">    Yields m generators. The ith yielded generator yields natural numbers whose</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="sd">    remainder is i when divided by m.</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="sd">    &gt;&gt;&gt; import types</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="sd">    &gt;&gt;&gt; [isinstance(gen, types.GeneratorType) for gen in remainders_generator(5)]</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="sd">    [True, True, True, True, True]</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="sd">    &gt;&gt;&gt; remainders_four = remainders_generator(4)</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="sd">    &gt;&gt;&gt; for i in range(4):</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="sd">    ...     print(&quot;First 3 natural numbers with remainder {0} when divided by 4:&quot;.format(i))</span>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="sd">    ...     gen = next(remainders_four)</span>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="sd">    ...     for _ in range(3):</span>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a><span class="sd">    ...         print(next(gen))</span>
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="sd">    First 3 natural numbers with remainder 0 when divided by 4:</span>
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="sd">    4</span>
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span class="sd">    8</span>
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a><span class="sd">    12</span>
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span class="sd">    First 3 natural numbers with remainder 1 when divided by 4:</span>
</span><span id="__span-13-20"><a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a><span class="sd">    1</span>
</span><span id="__span-13-21"><a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a><span class="sd">    5</span>
</span><span id="__span-13-22"><a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a><span class="sd">    9</span>
</span><span id="__span-13-23"><a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a><span class="sd">    First 3 natural numbers with remainder 2 when divided by 4:</span>
</span><span id="__span-13-24"><a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a><span class="sd">    2</span>
</span><span id="__span-13-25"><a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a><span class="sd">    6</span>
</span><span id="__span-13-26"><a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a><span class="sd">    10</span>
</span><span id="__span-13-27"><a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a><span class="sd">    First 3 natural numbers with remainder 3 when divided by 4:</span>
</span><span id="__span-13-28"><a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a><span class="sd">    3</span>
</span><span id="__span-13-29"><a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a><span class="sd">    7</span>
</span><span id="__span-13-30"><a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a><span class="sd">    11</span>
</span><span id="__span-13-31"><a id="__codelineno-13-31" name="__codelineno-13-31" href="#__codelineno-13-31"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-13-32"><a id="__codelineno-13-32" name="__codelineno-13-32" href="#__codelineno-13-32"></a>    <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-13-33"><a id="__codelineno-13-33" name="__codelineno-13-33" href="#__codelineno-13-33"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">helper</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
</span><span id="__span-13-34"><a id="__codelineno-13-34" name="__codelineno-13-34" href="#__codelineno-13-34"></a>        <span class="c1"># yield from [n * m + i for n in naturals()]</span>
</span><span id="__span-13-35"><a id="__codelineno-13-35" name="__codelineno-13-35" href="#__codelineno-13-35"></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-13-36"><a id="__codelineno-13-36" name="__codelineno-13-36" href="#__codelineno-13-36"></a>            <span class="k">yield</span> <span class="n">i</span>
</span><span id="__span-13-37"><a id="__codelineno-13-37" name="__codelineno-13-37" href="#__codelineno-13-37"></a>        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">naturals</span><span class="p">():</span>
</span><span id="__span-13-38"><a id="__codelineno-13-38" name="__codelineno-13-38" href="#__codelineno-13-38"></a>            <span class="k">yield</span> <span class="n">n</span> <span class="o">*</span> <span class="n">m</span> <span class="o">+</span> <span class="n">i</span>
</span><span id="__span-13-39"><a id="__codelineno-13-39" name="__codelineno-13-39" href="#__codelineno-13-39"></a>    <span class="k">yield from</span> <span class="p">[</span><span class="n">helper</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>
</span></code></pre></div>
</details>
<h2 id="lecture-19-inheritance">Lecture 19 Inheritance<a class="headerlink" href="#lecture-19-inheritance" title="Permanent link">&para;</a></h2>
<h3 id="1_3">1<a class="headerlink" href="#1_3" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_86.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_86" loading="lazy" src="../images/cs61a_86.png" /></a></p>
<p>用 <em>点表达式 dot expression</em> 给属性赋值</p>
<p><mark>如果<em>点 <code>.</code></em> 左边的对象是实例，那么赋值的就是实例的属性，</mark></p>
<p><mark>而如果<em>点 <code>.</code></em> 左边的对象是类，那么赋值的就是类的属性</mark></p>
<blockquote>
<p>这就解释了上节课 Q&amp;A 中的第一点</p>
</blockquote>
<p>并且，由于</p>
<blockquote>
<p>Attribute assignment statement adds or modifies the attribute named ...</p>
</blockquote>
<p>所以，属性赋值就是，如果实例/类<strong>还没有</strong>对应名字的属性，那么赋值就会添加一个相对应的属性，而如果已经存在对应名字的属性，那么就会修改这个属性的值</p>
<h3 id="2_3">2<a class="headerlink" href="#2_3" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_87.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_87" loading="lazy" src="../images/cs61a_87.png" /></a></p>
<p>通过 <code>实例.属性</code> ，实际上是先在实例中先查看是否有对应的属性，如果有就返回，如果没有就到类中去查看是否有对应的属性</p>
<p><a class="glightbox" href="../images/cs61a_88.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_88" loading="lazy" src="../images/cs61a_88.png" /></a></p>
<h3 id="3_2">3<a class="headerlink" href="#3_2" title="Permanent link">&para;</a></h3>
<p>继承的语法：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="k">class</span><span class="w"> </span><span class="err">&lt;</span><span class="nc">name</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&lt;</span><span class="n">base</span> <span class="n">class</span><span class="o">&gt;</span><span class="p">):</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>    <span class="o">&lt;</span><span class="n">suite</span><span class="o">&gt;</span>
</span></code></pre></div>
<h3 id="4_1">4<a class="headerlink" href="#4_1" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_89.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_89" loading="lazy" src="../images/cs61a_89.png" /></a></p>
<p>一个使用继承的例子，没想到居然可以这样使用父类的方法 来修改成为自己的方法(惊奇地发现 <code>self</code> 参数原来是这么用的)</p>
<h3 id="5_1">5<a class="headerlink" href="#5_1" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_90.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_90" loading="lazy" src="../images/cs61a_90.png" /></a></p>
<p>子类与父类的属性的使用关系感觉也是和实例与类的属性使用关系很像，即<strong>父类的属性并没有复制并绑定到子类中，而是在使用属性时，现在子类中查看，如果没有就到父类中查看</strong>(如果父类中没有就继续到父类的父类...)</p>
<h3 id="6">6<a class="headerlink" href="#6" title="Permanent link">&para;</a></h3>
<p>John在demo中展示了 <code>CheckingAccount</code> 的 <code>withdraw</code> 方法的两种写法：</p>
<ul>
<li>
<p>1</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">CheckingAccount</span><span class="p">(</span><span class="n">Account</span><span class="p">):</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>    <span class="o">...</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">withdraw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>        <span class="n">amount</span> <span class="o">=</span> <span class="n">amount</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>        <span class="k">if</span> <span class="n">amount</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span><span class="p">:</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>            <span class="k">return</span> <span class="s1">&#39;Insufficient funds&#39;</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">-</span> <span class="n">amount</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span>
</span></code></pre></div>
</li>
<li>
<p>2</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">CheckingAccount</span><span class="p">(</span><span class="n">Account</span><span class="p">):</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>    <span class="o">...</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>    <span class="n">withdraw_fee</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">withdraw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>        <span class="k">return</span> <span class="n">Account</span><span class="o">.</span><span class="n">withdraw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">withdraw_fee</span><span class="p">)</span>
</span></code></pre></div>
</li>
</ul>
<p>前者相比于后者有个类似于(之前数据抽象相关的课程中提到的)打破抽象的界限的问题，会存在一个隐患，即如果对父类的方法进行修改，那么子类的方法还会是原来的样子，而后者如果父类被修改了，子类也会跟着一起修改</p>
<h3 id="7">7<a class="headerlink" href="#7" title="Permanent link">&para;</a></h3>
<p>关于设计继承的时候John的几个<strong><mark>建议</mark></strong>：</p>
<ul>
<li>
<p><strong>Don't repeat yourself; use existing implementations.</strong></p>
<blockquote>
<p><strong>try to avoid copying and pasting code</strong></p>
</blockquote>
<p>要避免直接复制代码，而是使用已经实现了的(父类的)方法或函数</p>
</li>
<li>
<p><strong>Attributes that have been overridden are still accessible via class objects.</strong></p>
<p>意思就是，父类中被子类<em>覆写</em>了的属性，可以通过类名去访问</p>
</li>
<li>
<p><strong>Look up attributes on instances whenever possible.</strong></p>
<p>意思是，尽可能使用实例的属性(值或者方法)，(而不是类的)</p>
</li>
</ul>
<h3 id="8">8<a class="headerlink" href="#8" title="Permanent link">&para;</a></h3>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p><strong>Inheritance and Composition</strong></p>
<p>Object-oriented programming shines when we adopt the metaphor</p>
<ul>
<li>
<p>Inheritance is best for representing <em>is-a</em> relationships.</p>
<p>E.g., a checking account <strong>is a</strong> specific type of account.</p>
<p>So, CheckingAccount inherits from Account.</p>
</li>
<li>
<p>Composition is best for representing <em>has-a</em> relationships.</p>
<p>E.g., a bank <strong>has a</strong> collection of bank accounts it manages.</p>
<p>So, A bank has a list of accounts as an attribute.</p>
</li>
</ul>
</div>
<p><em>继承</em>和<em>构成</em> (<em>Inheritance and Composition</em>)</p>
<p><mark>面向对象编程(的思想/概念)很适合类比现实中的事物</mark></p>
<ul>
<li>
<p><strong>继承</strong>适合表示 <strong>是/属于</strong> 的关系，比如：支票账户<strong>是</strong>银行账户的一种</p>
<p>所以 支票账户 从 银行账户 继承</p>
</li>
<li>
<p><strong>构成</strong>适合表示 <strong>有</strong> 的关系，比如：银行<strong>有</strong>很多银行账户</p>
<p>所以，银行 有 一系列 银行账户 作为它的属性</p>
</li>
</ul>
<h3 id="9">9<a class="headerlink" href="#9" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_91.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_91" loading="lazy" src="../images/cs61a_91.png" /></a></p>
<p>关于第一个语句 <code>&gt;&gt;&gt; C(2).n</code> 创建出的右下角的 <code>C</code> 类的实例中会存在 <code>z</code> 的疑惑和理解</p>
<p>由于<strong>在创建 <code>C</code> 类的时候，会调用<em>初始化函数</em> <code>__init__()</code> ，而 <code>C</code> 类本身类中又没有<em>初始化函数</em>，所以==会调用父类中的<em>初始化函数</em><mark><strong>，故会调用 <code>B</code> 中的 <code>__init__()</code> ，</strong>而值得注意的一点，由于是 <code>C</code> 的实例调用<em>初始化函数</em>，所以 ==<code>self</code> 被传入的是 <code>C</code> 的实例本身，因此 <code>self.z = self.f(y)</code> 这一行语句中，执行的 <code>f()</code> 函数是 <code>C</code> 类中的 <code>f()</code> 方法</mark>，所以最后的结果是，那个实例中会存在一个 值为2的 <code>z</code></strong> </p>
<p>所以对于python中的 <code>self</code> 参数有了新的认知，即<strong>可以使用父类的方法，而 <code>self</code> 参数传入的却是子类的实例(所以要注意由于是子类的实例，有可能 <code>self.xxx</code> 之类的self的<em>点表达式</em>代码，得到的效果会和一般的父类实例不一样，比如上图中 <code>B</code> 的<em>初始化函数</em>如果传入的是 <code>B</code> 类的实例，那么很可能 <code>self.f(y)</code> 调用的是 <code>A</code> 类中的方法)</strong></p>
<blockquote>
<p>在第三个语句中也出现了类似的情况(但是这第三个语句极其地绕)</p>
<p><code>b = B(1)</code> 中，实例中的 <code>z</code> 由于调用了 <code>A</code> 中的 <code>f</code> 方法，所以指向了另一个 <code>B</code> 类实例，而新的实例<em>初始化函数</em>中 <code>z</code> 又指向的是一个 <code>C</code> 类的实例，而 <code>C</code> 类实例在初始化时，又需要调用 <code>B</code> 的 <code>__init__()</code> ，然后就调用了 <code>C</code> 类的 <code>f</code> 方法(我本来以为会一直 <code>B</code> 类 <code>C</code> 类来回一直指下去)</p>
</blockquote>
<h3 id="10">10<a class="headerlink" href="#10" title="Permanent link">&para;</a></h3>
<p>一个类可以继承多个父类，如</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">AsSeenOnTVAccount</span><span class="p">(</span><span class="n">CheckingAccount</span><span class="p">,</span> <span class="n">SavingsAccount</span><span class="p">):</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_holder</span><span class="p">):</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">holder</span> <span class="o">=</span> <span class="n">account_holder</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="mi">1</span>
</span></code></pre></div>
<h3 id="11">11<a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<blockquote>
<p>now it's hard for me to show you why this (multiple inheritance tends to make programs complicated) is the case, so instead I'll just show you an analogy about human inheritance.</p>
</blockquote>
<p><a class="glightbox" href="../images/cs61a_93.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_93" loading="lazy" src="../images/cs61a_93.png" /></a></p>
<p>在使用多重继承的时候，除非是真的很重要的关系，或者十分必须，在使用时要很注意，因为多重继承会使程序变得复杂，虽然很难举出例子，但是可以参考现实中(生物上)的继承</p>
<h2 id="lecture-19-qa">Lecture 19 Q&amp;A<a class="headerlink" href="#lecture-19-qa" title="Permanent link">&para;</a></h2>
<h3 id="1_4">1<a class="headerlink" href="#1_4" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_94.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_94" loading="lazy" src="../images/cs61a_94.png" /></a></p>
<p><code>type()</code> 函数如果返回类，可以通过它的返回值来访问类内的属性，如</p>
<blockquote>
<div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Account</span><span class="p">:</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_holder</span><span class="p">):</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">holderr</span> <span class="o">=</span> <span class="n">account_holder</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>        
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">deposit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="n">amount</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span>
</span></code></pre></div>
</blockquote>
<div class="language-python highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">Account</span><span class="p">(</span><span class="s1">&#39;John&#39;</span><span class="p">)</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="mi">100</span>
</span></code></pre></div>
<p>但是 Hany 说应该避免使用这种写法，因为大多数人不会怎么写</p>
<h3 id="2_4">2<a class="headerlink" href="#2_4" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_95.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_95" loading="lazy" src="../images/cs61a_95.png" /></a></p>
<p>根据 John 的解释，<code>super()</code> 的作用是，不在本类中寻找 <code>.</code> 之后的东西，而是在上一级父类中寻找</p>
<p>并且在使用父类的<em>方法</em>时，会将实例自动传入 <code>self</code> 参数，和直接 <code>父类名.方法</code> 的使用形式略有不同</p>
<h3 id="3_3">3<a class="headerlink" href="#3_3" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_96.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_96" loading="lazy" src="../images/cs61a_96.png" /></a></p>
<p>有多继承的类在使用本类中没有的方法时，是先在<strong>上一级父类</strong>中<strong>按顺序</strong>寻找，比如上图，如果在 <code>CheckingAccount</code> 中没找到对应的方法，那么不会在 <code>CheckingAccount</code> 的父类( <code>Acount</code> 类)中寻找，而是在 <code>SavingAccount</code> 类中寻找，<strong>如果所有的上一级父类中都没找到对应的方法，那么才会在上两级父类中寻找(即父类的父类)</strong></p>
<h3 id="4_2">4<a class="headerlink" href="#4_2" title="Permanent link">&para;</a></h3>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p><strong>John</strong>:</p>
<p>well i'd say at the outset that it's often the case that tracing through, uh, tree recursion is not something that humans can tolerate, like it's, it's just really messy sometimes, um, so the right answer is to shift the way in which you approach understanding, uh, implementation to get away from tracing, and instead just treat the recursive calls as abstractions, they do the thing that they're supposed to do, but how they do them is not your problem, and then like you can put it together. but this is not, not like obvious or easy so, um, so maybe we can talk about that with a particular example. so maybe while i read this maybe hany can, uh, say whether that makes sense to him.</p>
<p>&nbsp;</p>
<p><strong>Hany</strong>:</p>
<p>i i'll add one more thing to it, so john's absolutely right that tracing tree recursion is very hard, you have to hold a lot in your memory. um, so one way to fix it is as he just said, is to just think differently about it. it's not about tracing, it's about thinking about the fundamental nature of, um, the, the functions and they just do what you want them to do, and the other is to just use toy examples.</p>
<hr />
<p><strong>John</strong>：</p>
<p>嗯，我首先要说的是，往往情况是，追踪树形递归对人类来说是无法忍受的，就像有时候非常混乱一样。所以正确的答案是改变你理解实现的方式，摆脱追踪，而是将递归调用视为抽象，它们执行它们应该执行的任务，但它们如何执行不是你的问题，然后你可以将它们组合起来。但这并不明显或容易，所以也许我们可以用一个具体的例子来讨论一下。所以也许在我阅读这个的时候，Hany可以说一下这是否有意义。</p>
<p>&nbsp;</p>
<p><strong>Hany</strong>：</p>
<p>我要补充一点，John说得对，追踪树形递归非常困难，你必须记住很多东西。所以解决的一种方法就像他刚才说的那样，只是以不同的方式思考。这不是关于追踪，而是思考函数的基本性质，它们只是执行你想要它们执行的任务，另一种方法是使用简单的示例。</p>
</div>
<p>John 和 Hany 说到<strong>对树形递归追踪很难，所以不应该去追踪递归(我认为这里可以理解为，弄清楚递归的每一步的具体效果)，而是换一种想法去思考(即之前总结的假定函数能返回正确/所需的值)</strong></p>
<h3 id="5_2">5<a class="headerlink" href="#5_2" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_97.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_97" loading="lazy" src="../images/cs61a_97.png" /></a></p>
<p>John 解答 Lab04 中的 Q5 ，</p>
<p>提到，在解答/构建递归时，可以先拿简单的例子来进行思考，比如 <code>n = 123 ; t = 2</code> (而不要上来就尝试弄清楚 5 位数)，然后通过分析简单的例子，思路就会很清晰</p>
<h2 id="lab-07">Lab 07<a class="headerlink" href="#lab-07" title="Permanent link">&para;</a></h2>
<h3 id="1_5">1<a class="headerlink" href="#1_5" title="Permanent link">&para;</a></h3>
<p>在做Q1时，本来使用</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="k">yield from</span> <span class="p">[</span><span class="n">x</span> <span class="o">*</span> <span class="n">multiplier</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>
</span></code></pre></div>
<p>但是当 <code>it</code> 是能无穷迭代的生成器时(如要测试的 <code>naturals()</code> )，就会超时，</p>
<p>但我询问 chatgpt ，它提供的代码与我上面的代码很像，只是把列表换成了元组，然后测试竟然不会超时，</p>
<p><strong>所以使用 <code>yield from</code> 时可以使用元组来避免可以无穷迭代的迭代器造成的超时</strong></p>
<p>下面是询问 chatgpt 为什么会这样的原因的记录</p>
<details class="example" open="open">
<summary>chat log</summary>
<p><strong>You</strong>:</p>
<p>Generators also allow us to represent infinite sequences, such as the sequence of natural numbers (1, 2, ...) shown in the function below!</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">naturals</span><span class="p">():</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A generator function that yields the infinite sequence of natural</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="sd">    numbers, starting at 1.</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="sd">    &gt;&gt;&gt; m = naturals()</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="sd">    &gt;&gt;&gt; type(m)</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="sd">    &lt;class &#39;generator&#39;&gt;</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="sd">    &gt;&gt;&gt; [next(m) for _ in range(10)]</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="sd">    [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a>    <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>        <span class="k">yield</span> <span class="n">i</span>
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a>        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span></code></pre></div>
<p><strong>Q1: Scale</strong></p>
<p>Implement the generator function <code>scale(it, multiplier)</code>, which yields elements of the given iterable <code>it</code>, scaled by <code>multiplier</code>. As an extra challenge, try writing this function using a <code>yield from</code> statement!</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">scale</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">):</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Yield elements of the iterable it scaled by a number multiplier.</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="sd">    &gt;&gt;&gt; m = scale([1, 5, 2], 5)</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="sd">    &gt;&gt;&gt; type(m)</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="sd">    &lt;class &#39;generator&#39;&gt;</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="sd">    &gt;&gt;&gt; list(m)</span>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="sd">    [5, 25, 10]</span>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a>
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="sd">    &gt;&gt;&gt; m = scale(naturals(), 2)</span>
</span><span id="__span-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="sd">    &gt;&gt;&gt; [next(m) for _ in range(5)]</span>
</span><span id="__span-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="sd">    [2, 4, 6, 8, 10]</span>
</span><span id="__span-22-13"><a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-22-14"><a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a>    <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span></code></pre></div>
<p>&nbsp;</p>
<p><strong>ChatGPT</strong>:</p>
<p>Certainly! You can implement the <code>scale</code> generator function using a <code>yield from</code> statement. Here's one way to do it:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">scale</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">):</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Yield elements of the iterable it scaled by a number multiplier.&quot;&quot;&quot;</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>    <span class="k">yield from</span> <span class="p">(</span><span class="n">element</span> <span class="o">*</span> <span class="n">multiplier</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">it</span><span class="p">)</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="c1"># Test cases</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="n">m</span> <span class="o">=</span> <span class="n">scale</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>  <span class="c1"># &lt;class &#39;generator&#39;&gt;</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>  <span class="c1"># [5, 25, 10]</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="n">m</span> <span class="o">=</span> <span class="n">scale</span><span class="p">(</span><span class="n">naturals</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="nb">print</span><span class="p">([</span><span class="nb">next</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>  <span class="c1"># [2, 4, 6, 8, 10]</span>
</span></code></pre></div>
<p>In this implementation, the <code>scale</code> function uses a generator expression with <code>yield from</code> to yield elements of the iterable <code>it</code> scaled by the given <code>multiplier</code>. The generator expression <code>(element * multiplier for element in it)</code> generates scaled elements one by one, and <code>yield from</code> is used to yield each element from this expression.</p>
<p>&nbsp;</p>
<p><strong>You</strong>:</p>
<p>why timeout by using list type while not by using tuple type?</p>
<p>&nbsp;</p>
<p><strong>ChatGPT</strong>:</p>
<p>If you are experiencing a timeout when using a list type but not when using a tuple type, it might be due to the differences in how lists and tuples are handled in Python. Lists are mutable, meaning their elements can be changed after the list is created, while tuples are immutable, and their elements cannot be changed.</p>
<p>When you use a list comprehension with a generator expression and <code>yield from</code>, the entire list needs to be generated in memory before any elements can be yielded. This might be problematic for an infinite generator, as attempting to generate an infinite list in memory can lead to a timeout.</p>
<p>On the other hand, when using a tuple, it is immutable. Python can optimize and generate each element of the tuple on-the-fly without needing to create an entire list in memory. This can be more efficient, especially when dealing with infinite sequences.</p>
<p>Here's an example to illustrate the difference:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="c1"># Using a list</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">scale_list</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">):</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>    <span class="k">yield from</span> <span class="p">[</span><span class="n">x</span> <span class="o">*</span> <span class="n">multiplier</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="c1"># Using a tuple</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">scale_tuple</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">):</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>    <span class="k">yield from</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">multiplier</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">it</span><span class="p">)</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="c1"># Test cases</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="n">m_list</span> <span class="o">=</span> <span class="n">scale_list</span><span class="p">(</span><span class="n">naturals</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="c1"># This may lead to a timeout because it attempts to generate an infinite list in memory.</span>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a><span class="c1"># print(list(m_list))</span>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a>
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a><span class="n">m_tuple</span> <span class="o">=</span> <span class="n">scale_tuple</span><span class="p">(</span><span class="n">naturals</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a><span class="c1"># This is more efficient because it generates each element on-the-fly without creating an entire list.</span>
</span><span id="__span-24-16"><a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a><span class="nb">print</span><span class="p">([</span><span class="nb">next</span><span class="p">(</span><span class="n">m_tuple</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>
</span></code></pre></div>
<p>In the commented-out line for <code>scale_list</code>, attempting to convert an infinite list to a list object might cause the program to run out of memory or take a very long time, leading to a timeout. Using a tuple can avoid this issue because it doesn't try to create an entire list in memory.</p>
<p>&nbsp;</p>
<p><strong>You</strong>:</p>
<p>translate to chinese</p>
<p>&nbsp;</p>
<p><strong>ChatGPT</strong>:</p>
<p>如果你在使用列表类型时遇到超时问题，但在使用元组类型时却没有，这可能是由于 Python 处理列表和元组的方式不同。列表是可变的，意味着它们的元素在列表创建后可以被修改，而元组是不可变的，它们的元素不能被修改。</p>
<p>当你使用列表解析与生成器表达式以及 <code>yield from</code> 时，在产生任何元素之前需要在内存中生成整个列表。对于无限生成器，尝试在内存中生成无限列表可能导致超时。</p>
<p>另一方面，使用元组是不可变的。Python 可以优化并在需要时即时生成元组的每个元素，而无需创建整个列表在内存中。这可能更有效率，尤其是在处理无限序列时。</p>
<p>以下是一个示例，用以说明这种差异：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="c1"># 使用列表</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">scale_list</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">):</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>    <span class="k">yield from</span> <span class="p">[</span><span class="n">x</span> <span class="o">*</span> <span class="n">multiplier</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="c1"># 使用元组</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">scale_tuple</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">):</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a>    <span class="k">yield from</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">multiplier</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">it</span><span class="p">)</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a><span class="c1"># 测试案例</span>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="n">m_list</span> <span class="o">=</span> <span class="n">scale_list</span><span class="p">(</span><span class="n">naturals</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="c1"># 这可能导致超时，因为它试图在内存中生成一个无限列表。</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a><span class="c1"># print(list(m_list))</span>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a>
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a><span class="n">m_tuple</span> <span class="o">=</span> <span class="n">scale_tuple</span><span class="p">(</span><span class="n">naturals</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="__span-25-15"><a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a><span class="c1"># 这更加有效，因为它在不创建整个列表的情况下即时生成每个元素。</span>
</span><span id="__span-25-16"><a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a><span class="nb">print</span><span class="p">([</span><span class="nb">next</span><span class="p">(</span><span class="n">m_tuple</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>
</span></code></pre></div>
<p>在注释掉的 <code>scale_list</code> 的行中，试图将无限列表转换为列表对象可能导致程序耗尽内存或花费很长时间，从而导致超时。使用元组可以避免这个问题，因为它不会尝试在内存中创建整个列表。</p>
</details>
<h3 id="2_5">2<a class="headerlink" href="#2_5" title="Permanent link">&para;</a></h3>
<p>Q5中，我利用列表的 <code>.pop()</code> 方法来实现 <code>Player.play()</code> 方法，</p>
<p>在之前课程视频里介绍列表的 <code>.pop()</code> 方法是只能移除并返回列表的最后一个元素，但上网查询发现 <code>.pop()</code> 方法只是默认最后一个，还可以传入下标指定要移除并返回的元素，例如</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="mi">5</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="mi">2</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</span></code></pre></div>
<h2 id="project-ants">Project Ants<a class="headerlink" href="#project-ants" title="Permanent link">&para;</a></h2>
<h3 id="1_6">1<a class="headerlink" href="#1_6" title="Permanent link">&para;</a></h3>
<p>Problem 4 中，有一点值得注意</p>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p>A good way to approach the implementation to <code>ShortThrower</code> and <code>LongThrower</code> is to have it inherit the <code>nearest_bee</code> method from the base <code>ThrowerAnt</code> class. The logic of choosing which bee a thrower ant will attack is essentially the same, except the <code>ShortThrower</code> and <code>LongThrower</code> ants have maximum and minimum ranges, respectively.</p>
<p>To implement these behaviors, you will need to modify the <code>nearest_bee</code> method to reference <code>min_range</code> and <code>max_range</code> attributes, and only return a bee that is in range.</p>
</div>
<p>这题中要求实现两个 <em>蚂蚁射手</em> 的子类的寻找射击目标的方法，我本来差点就是想的在原有的代码上进行修改，看到上面这段话，我才想到有更好的方法--去<strong>使用父类的方法</strong>，</p>
<p><strong>教程中建议的方法是</strong>，在父类中添加属性，再在子类中(有需要的话)进行覆写</p>
<blockquote>
<p>最后发现采用教程中的思路，居然可以在子类中不用重新实现方法，直接使用父类中的方法即可</p>
<p>所以说，<strong><mark>能用父类的属性(值或者方法)，就用父类的，尽可能的不要去重新实现</mark></strong>
</p>
</blockquote>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">ThrowerAnt</span><span class="p">(</span><span class="n">Ant</span><span class="p">):</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>    <span class="o">...</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>    <span class="c1"># ADD/OVERRIDE CLASS ATTRIBUTES HERE</span>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>    <span class="n">food_cost</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>    <span class="n">min_range</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>    <span class="n">max_range</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">nearest_bee</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">beehive</span><span class="p">):</span>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the nearest Bee in a Place that is not the HIVE (beehive), connected to</span>
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="sd">        the ThrowerAnt&#39;s Place by following entrances.</span>
</span><span id="__span-27-11"><a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a>
</span><span id="__span-27-12"><a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a><span class="sd">        This method returns None if there is no such Bee (or none in range).</span>
</span><span id="__span-27-13"><a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-27-14"><a id="__codelineno-27-14" name="__codelineno-27-14" href="#__codelineno-27-14"></a>        <span class="c1"># BEGIN Problem 3 and 4</span>
</span><span id="__span-27-15"><a id="__codelineno-27-15" name="__codelineno-27-15" href="#__codelineno-27-15"></a>        <span class="c1"># return rANTdom_else_none(self.place.bees) # REPLACE THIS LINE</span>
</span><span id="__span-27-16"><a id="__codelineno-27-16" name="__codelineno-27-16" href="#__codelineno-27-16"></a>        <span class="n">place</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">place</span>
</span><span id="__span-27-17"><a id="__codelineno-27-17" name="__codelineno-27-17" href="#__codelineno-27-17"></a>        <span class="n">dist</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-27-18"><a id="__codelineno-27-18" name="__codelineno-27-18" href="#__codelineno-27-18"></a>        <span class="k">while</span> <span class="n">place</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">beehive</span><span class="p">:</span>
</span><span id="__span-27-19"><a id="__codelineno-27-19" name="__codelineno-27-19" href="#__codelineno-27-19"></a>            <span class="k">if</span> <span class="n">place</span><span class="o">.</span><span class="n">bees</span> <span class="ow">and</span> <span class="n">dist</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_range</span> <span class="ow">and</span> <span class="n">dist</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_range</span><span class="p">:</span>
</span><span id="__span-27-20"><a id="__codelineno-27-20" name="__codelineno-27-20" href="#__codelineno-27-20"></a>                <span class="k">return</span> <span class="n">rANTdom_else_none</span><span class="p">(</span><span class="n">place</span><span class="o">.</span><span class="n">bees</span><span class="p">)</span>
</span><span id="__span-27-21"><a id="__codelineno-27-21" name="__codelineno-27-21" href="#__codelineno-27-21"></a>            <span class="n">place</span> <span class="o">=</span> <span class="n">place</span><span class="o">.</span><span class="n">entrance</span>
</span><span id="__span-27-22"><a id="__codelineno-27-22" name="__codelineno-27-22" href="#__codelineno-27-22"></a>            <span class="n">dist</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-27-23"><a id="__codelineno-27-23" name="__codelineno-27-23" href="#__codelineno-27-23"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-27-24"><a id="__codelineno-27-24" name="__codelineno-27-24" href="#__codelineno-27-24"></a>        <span class="c1"># END Problem 3 and 4</span>
</span><span id="__span-27-25"><a id="__codelineno-27-25" name="__codelineno-27-25" href="#__codelineno-27-25"></a>
</span><span id="__span-27-26"><a id="__codelineno-27-26" name="__codelineno-27-26" href="#__codelineno-27-26"></a>    <span class="o">...</span>
</span><span id="__span-27-27"><a id="__codelineno-27-27" name="__codelineno-27-27" href="#__codelineno-27-27"></a>
</span><span id="__span-27-28"><a id="__codelineno-27-28" name="__codelineno-27-28" href="#__codelineno-27-28"></a><span class="k">class</span><span class="w"> </span><span class="nc">ShortThrower</span><span class="p">(</span><span class="n">ThrowerAnt</span><span class="p">):</span>
</span><span id="__span-27-29"><a id="__codelineno-27-29" name="__codelineno-27-29" href="#__codelineno-27-29"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A ThrowerAnt that only throws leaves at Bees at most 3 places away.&quot;&quot;&quot;</span>
</span><span id="__span-27-30"><a id="__codelineno-27-30" name="__codelineno-27-30" href="#__codelineno-27-30"></a>
</span><span id="__span-27-31"><a id="__codelineno-27-31" name="__codelineno-27-31" href="#__codelineno-27-31"></a>    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Short&#39;</span>
</span><span id="__span-27-32"><a id="__codelineno-27-32" name="__codelineno-27-32" href="#__codelineno-27-32"></a>    <span class="n">food_cost</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="__span-27-33"><a id="__codelineno-27-33" name="__codelineno-27-33" href="#__codelineno-27-33"></a>    <span class="c1"># OVERRIDE CLASS ATTRIBUTES HERE</span>
</span><span id="__span-27-34"><a id="__codelineno-27-34" name="__codelineno-27-34" href="#__codelineno-27-34"></a>    <span class="c1"># BEGIN Problem 4</span>
</span><span id="__span-27-35"><a id="__codelineno-27-35" name="__codelineno-27-35" href="#__codelineno-27-35"></a>    <span class="n">max_range</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="__span-27-36"><a id="__codelineno-27-36" name="__codelineno-27-36" href="#__codelineno-27-36"></a>    <span class="c1"># implemented = False   # Change to True to view in the GUI</span>
</span><span id="__span-27-37"><a id="__codelineno-27-37" name="__codelineno-27-37" href="#__codelineno-27-37"></a>    <span class="n">implemented</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-27-38"><a id="__codelineno-27-38" name="__codelineno-27-38" href="#__codelineno-27-38"></a>    <span class="c1"># END Problem 4</span>
</span><span id="__span-27-39"><a id="__codelineno-27-39" name="__codelineno-27-39" href="#__codelineno-27-39"></a>
</span><span id="__span-27-40"><a id="__codelineno-27-40" name="__codelineno-27-40" href="#__codelineno-27-40"></a><span class="k">class</span><span class="w"> </span><span class="nc">LongThrower</span><span class="p">(</span><span class="n">ThrowerAnt</span><span class="p">):</span>
</span><span id="__span-27-41"><a id="__codelineno-27-41" name="__codelineno-27-41" href="#__codelineno-27-41"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A ThrowerAnt that only throws leaves at Bees at least 5 places away.&quot;&quot;&quot;</span>
</span><span id="__span-27-42"><a id="__codelineno-27-42" name="__codelineno-27-42" href="#__codelineno-27-42"></a>
</span><span id="__span-27-43"><a id="__codelineno-27-43" name="__codelineno-27-43" href="#__codelineno-27-43"></a>    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Long&#39;</span>
</span><span id="__span-27-44"><a id="__codelineno-27-44" name="__codelineno-27-44" href="#__codelineno-27-44"></a>    <span class="n">food_cost</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="__span-27-45"><a id="__codelineno-27-45" name="__codelineno-27-45" href="#__codelineno-27-45"></a>    <span class="c1"># OVERRIDE CLASS ATTRIBUTES HERE</span>
</span><span id="__span-27-46"><a id="__codelineno-27-46" name="__codelineno-27-46" href="#__codelineno-27-46"></a>    <span class="c1"># BEGIN Problem 4</span>
</span><span id="__span-27-47"><a id="__codelineno-27-47" name="__codelineno-27-47" href="#__codelineno-27-47"></a>    <span class="n">min_range</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="__span-27-48"><a id="__codelineno-27-48" name="__codelineno-27-48" href="#__codelineno-27-48"></a>    <span class="c1"># implemented = False   # Change to True to view in the GUI</span>
</span><span id="__span-27-49"><a id="__codelineno-27-49" name="__codelineno-27-49" href="#__codelineno-27-49"></a>    <span class="n">implemented</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-27-50"><a id="__codelineno-27-50" name="__codelineno-27-50" href="#__codelineno-27-50"></a>    <span class="c1"># END Problem 4</span>
</span></code></pre></div>
</details>
<h3 id="2_6">2<a class="headerlink" href="#2_6" title="Permanent link">&para;</a></h3>
<p>Problem 4 中有一点提示，</p>
<p>可以使用 <code>float('inf')</code> 来获得一个<em>无穷大</em>的值</p>
<h3 id="3_4">3<a class="headerlink" href="#3_4" title="Permanent link">&para;</a></h3>
<p>在 Extra Credit 中，</p>
<blockquote>
<p>Some hints:</p>
<p>All instances of the same class share the same class attributes. How can you use this information to tell whether a QueenAnt instance is the true QueenAnt?</p>
<p>...</p>
</blockquote>
<p>基于这一点提示，所以我采取的方法是，在 <code>Ant</code> 类中设置一个类属性 <code>true_queen = None</code> 默认值是 <code>None</code> ，当第一个/真蚁后被创建时(通过判断 <code>true_queen</code> 是否为 <code>None</code> 来确定是否是真蚁后)， <code>true_queen</code> 就会指向它，而之后的蚁后就可以依据这个属性来判断出是<em>假蚁后</em>(impostor)</p>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Ant</span><span class="p">(</span><span class="n">Insect</span><span class="p">):</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>    <span class="o">...</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>    <span class="c1"># ADD CLASS ATTRIBUTES HERE</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>    <span class="n">true_queen</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a>    <span class="o">...</span>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">remove_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">place</span><span class="p">):</span>
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a>        <span class="k">if</span> <span class="bp">self</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">true_queen</span><span class="p">:</span>
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a>            <span class="k">return</span>
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a>                <span class="k">if</span> <span class="n">place</span><span class="o">.</span><span class="n">ant</span> <span class="ow">is</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="__span-28-11"><a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a>            <span class="n">place</span><span class="o">.</span><span class="n">ant</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-28-12"><a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a>        <span class="k">elif</span> <span class="n">place</span><span class="o">.</span><span class="n">ant</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-28-13"><a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a>            <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> is not in </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">place</span><span class="p">)</span>
</span><span id="__span-28-14"><a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-28-15"><a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a>            <span class="c1"># queen or container (optional) or other situation</span>
</span><span id="__span-28-16"><a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a>            <span class="n">place</span><span class="o">.</span><span class="n">ant</span><span class="o">.</span><span class="n">remove_ant</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-28-17"><a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a>        <span class="n">Insect</span><span class="o">.</span><span class="n">remove_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">place</span><span class="p">)</span>
</span><span id="__span-28-18"><a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a>
</span><span id="__span-28-19"><a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a><span class="o">...</span>
</span><span id="__span-28-20"><a id="__codelineno-28-20" name="__codelineno-28-20" href="#__codelineno-28-20"></a>
</span><span id="__span-28-21"><a id="__codelineno-28-21" name="__codelineno-28-21" href="#__codelineno-28-21"></a><span class="c1"># BEGIN Problem EC</span>
</span><span id="__span-28-22"><a id="__codelineno-28-22" name="__codelineno-28-22" href="#__codelineno-28-22"></a><span class="c1"># class QueenAnt(Ant):  # You should change this line</span>
</span><span id="__span-28-23"><a id="__codelineno-28-23" name="__codelineno-28-23" href="#__codelineno-28-23"></a><span class="k">class</span><span class="w"> </span><span class="nc">QueenAnt</span><span class="p">(</span><span class="n">ScubaThrower</span><span class="p">):</span>
</span><span id="__span-28-24"><a id="__codelineno-28-24" name="__codelineno-28-24" href="#__codelineno-28-24"></a><span class="c1"># END Problem EC</span>
</span><span id="__span-28-25"><a id="__codelineno-28-25" name="__codelineno-28-25" href="#__codelineno-28-25"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The Queen of the colony. The game is over if a bee enters her place.&quot;&quot;&quot;</span>
</span><span id="__span-28-26"><a id="__codelineno-28-26" name="__codelineno-28-26" href="#__codelineno-28-26"></a>
</span><span id="__span-28-27"><a id="__codelineno-28-27" name="__codelineno-28-27" href="#__codelineno-28-27"></a>    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Queen&#39;</span>
</span><span id="__span-28-28"><a id="__codelineno-28-28" name="__codelineno-28-28" href="#__codelineno-28-28"></a>    <span class="n">food_cost</span> <span class="o">=</span> <span class="mi">7</span>
</span><span id="__span-28-29"><a id="__codelineno-28-29" name="__codelineno-28-29" href="#__codelineno-28-29"></a>    <span class="c1"># OVERRIDE CLASS ATTRIBUTES HERE</span>
</span><span id="__span-28-30"><a id="__codelineno-28-30" name="__codelineno-28-30" href="#__codelineno-28-30"></a>    <span class="c1"># BEGIN Problem EC</span>
</span><span id="__span-28-31"><a id="__codelineno-28-31" name="__codelineno-28-31" href="#__codelineno-28-31"></a>    <span class="c1"># implemented = False   # Change to True to view in the GUI</span>
</span><span id="__span-28-32"><a id="__codelineno-28-32" name="__codelineno-28-32" href="#__codelineno-28-32"></a>    <span class="n">implemented</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-28-33"><a id="__codelineno-28-33" name="__codelineno-28-33" href="#__codelineno-28-33"></a>    <span class="c1"># END Problem EC</span>
</span><span id="__span-28-34"><a id="__codelineno-28-34" name="__codelineno-28-34" href="#__codelineno-28-34"></a>
</span><span id="__span-28-35"><a id="__codelineno-28-35" name="__codelineno-28-35" href="#__codelineno-28-35"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">armor</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="__span-28-36"><a id="__codelineno-28-36" name="__codelineno-28-36" href="#__codelineno-28-36"></a>        <span class="c1"># BEGIN Problem EC</span>
</span><span id="__span-28-37"><a id="__codelineno-28-37" name="__codelineno-28-37" href="#__codelineno-28-37"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-28-38"><a id="__codelineno-28-38" name="__codelineno-28-38" href="#__codelineno-28-38"></a>        <span class="n">ScubaThrower</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">armor</span><span class="p">)</span>
</span><span id="__span-28-39"><a id="__codelineno-28-39" name="__codelineno-28-39" href="#__codelineno-28-39"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">buffed_ants</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-28-40"><a id="__codelineno-28-40" name="__codelineno-28-40" href="#__codelineno-28-40"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">Ant</span><span class="o">.</span><span class="n">true_queen</span><span class="p">:</span>
</span><span id="__span-28-41"><a id="__codelineno-28-41" name="__codelineno-28-41" href="#__codelineno-28-41"></a>            <span class="n">Ant</span><span class="o">.</span><span class="n">true_queen</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="__span-28-42"><a id="__codelineno-28-42" name="__codelineno-28-42" href="#__codelineno-28-42"></a>        <span class="c1"># END Problem EC</span>
</span><span id="__span-28-43"><a id="__codelineno-28-43" name="__codelineno-28-43" href="#__codelineno-28-43"></a>
</span><span id="__span-28-44"><a id="__codelineno-28-44" name="__codelineno-28-44" href="#__codelineno-28-44"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gamestate</span><span class="p">):</span>
</span><span id="__span-28-45"><a id="__codelineno-28-45" name="__codelineno-28-45" href="#__codelineno-28-45"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;A queen ant throws a leaf, but also doubles the damage of ants</span>
</span><span id="__span-28-46"><a id="__codelineno-28-46" name="__codelineno-28-46" href="#__codelineno-28-46"></a><span class="sd">        in her tunnel.</span>
</span><span id="__span-28-47"><a id="__codelineno-28-47" name="__codelineno-28-47" href="#__codelineno-28-47"></a>
</span><span id="__span-28-48"><a id="__codelineno-28-48" name="__codelineno-28-48" href="#__codelineno-28-48"></a><span class="sd">        Impostor queens do only one thing: reduce their own armor to 0.</span>
</span><span id="__span-28-49"><a id="__codelineno-28-49" name="__codelineno-28-49" href="#__codelineno-28-49"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-28-50"><a id="__codelineno-28-50" name="__codelineno-28-50" href="#__codelineno-28-50"></a>        <span class="c1"># BEGIN Problem EC</span>
</span><span id="__span-28-51"><a id="__codelineno-28-51" name="__codelineno-28-51" href="#__codelineno-28-51"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-28-52"><a id="__codelineno-28-52" name="__codelineno-28-52" href="#__codelineno-28-52"></a>        <span class="k">if</span> <span class="bp">self</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">true_queen</span><span class="p">:</span>
</span><span id="__span-28-53"><a id="__codelineno-28-53" name="__codelineno-28-53" href="#__codelineno-28-53"></a>            <span class="n">Ant</span><span class="o">.</span><span class="n">reduce_armor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">armor</span><span class="p">)</span>
</span><span id="__span-28-54"><a id="__codelineno-28-54" name="__codelineno-28-54" href="#__codelineno-28-54"></a>            <span class="k">return</span>
</span><span id="__span-28-55"><a id="__codelineno-28-55" name="__codelineno-28-55" href="#__codelineno-28-55"></a>        <span class="n">ScubaThrower</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-28-56"><a id="__codelineno-28-56" name="__codelineno-28-56" href="#__codelineno-28-56"></a>        <span class="n">place</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">place</span><span class="o">.</span><span class="n">exit</span>
</span><span id="__span-28-57"><a id="__codelineno-28-57" name="__codelineno-28-57" href="#__codelineno-28-57"></a>        <span class="k">while</span> <span class="n">place</span><span class="p">:</span>
</span><span id="__span-28-58"><a id="__codelineno-28-58" name="__codelineno-28-58" href="#__codelineno-28-58"></a>            <span class="k">if</span> <span class="n">place</span><span class="o">.</span><span class="n">ant</span> <span class="ow">and</span> <span class="n">place</span><span class="o">.</span><span class="n">ant</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffed_ants</span><span class="p">:</span>
</span><span id="__span-28-59"><a id="__codelineno-28-59" name="__codelineno-28-59" href="#__codelineno-28-59"></a>                <span class="n">place</span><span class="o">.</span><span class="n">ant</span><span class="o">.</span><span class="n">damage</span> <span class="o">*=</span> <span class="mi">2</span>
</span><span id="__span-28-60"><a id="__codelineno-28-60" name="__codelineno-28-60" href="#__codelineno-28-60"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">buffed_ants</span> <span class="o">+=</span> <span class="p">[</span><span class="n">place</span><span class="o">.</span><span class="n">ant</span><span class="p">]</span>
</span><span id="__span-28-61"><a id="__codelineno-28-61" name="__codelineno-28-61" href="#__codelineno-28-61"></a>            <span class="n">place</span> <span class="o">=</span> <span class="n">place</span><span class="o">.</span><span class="n">exit</span>
</span><span id="__span-28-62"><a id="__codelineno-28-62" name="__codelineno-28-62" href="#__codelineno-28-62"></a>        <span class="c1"># END Problem EC</span>
</span><span id="__span-28-63"><a id="__codelineno-28-63" name="__codelineno-28-63" href="#__codelineno-28-63"></a>
</span><span id="__span-28-64"><a id="__codelineno-28-64" name="__codelineno-28-64" href="#__codelineno-28-64"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">reduce_armor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
</span><span id="__span-28-65"><a id="__codelineno-28-65" name="__codelineno-28-65" href="#__codelineno-28-65"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Reduce armor by AMOUNT, and if the True QueenAnt has no armor</span>
</span><span id="__span-28-66"><a id="__codelineno-28-66" name="__codelineno-28-66" href="#__codelineno-28-66"></a><span class="sd">        remaining, signal the end of the game.</span>
</span><span id="__span-28-67"><a id="__codelineno-28-67" name="__codelineno-28-67" href="#__codelineno-28-67"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-28-68"><a id="__codelineno-28-68" name="__codelineno-28-68" href="#__codelineno-28-68"></a>        <span class="c1"># BEGIN Problem EC</span>
</span><span id="__span-28-69"><a id="__codelineno-28-69" name="__codelineno-28-69" href="#__codelineno-28-69"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-28-70"><a id="__codelineno-28-70" name="__codelineno-28-70" href="#__codelineno-28-70"></a>        <span class="n">ScubaThrower</span><span class="o">.</span><span class="n">reduce_armor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">)</span>
</span><span id="__span-28-71"><a id="__codelineno-28-71" name="__codelineno-28-71" href="#__codelineno-28-71"></a>        <span class="k">if</span> <span class="bp">self</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">true_queen</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">armor</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-28-72"><a id="__codelineno-28-72" name="__codelineno-28-72" href="#__codelineno-28-72"></a>            <span class="n">bees_win</span><span class="p">()</span>
</span><span id="__span-28-73"><a id="__codelineno-28-73" name="__codelineno-28-73" href="#__codelineno-28-73"></a>        <span class="c1"># END Problem EC</span>
</span></code></pre></div>
</details>
<h3 id="4_3">4<a class="headerlink" href="#4_3" title="Permanent link">&para;</a></h3>
<p>Optional Problem 2 中</p>
<blockquote>
<p>Hint: You may find the <code>isinstance</code> function useful for checking if an object is an instance of a given class. For example:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>    <span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">Foo</span><span class="p">()</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>    <span class="o">&gt;&gt;&gt;</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Foo</span><span class="p">)</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>    <span class="kc">True</span>
</span></code></pre></div>
</blockquote>
<p>可以用 <code>isinstance()</code> 的函数来判断某个实例是否是某个类</p>
<h3 id="5_3">5<a class="headerlink" href="#5_3" title="Permanent link">&para;</a></h3>
<p>Optional Problem 2 中</p>
<blockquote>
<p>Note: the constructor of <code>ContainerAnt.__init__</code> is implemented as such</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>        <span class="n">Ant</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">contained_ant</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div>
<p>As we saw in Hog, we have that <code>args</code> is bound to all positional arguments (that is all arguments not passed not with keywords, and <code>kwargs</code> is bound to all the keyword arguments. This ensures that both sets of arguments are passed to the Ant constructor).</p>
</blockquote>
<p><code>args</code> 是所有没有 <em>关键字</em> (比如 <code>key=</code> 、 <code>base=</code> 就是关键字) 的参数，而 <code>kwargs</code> 是所有有 <em>关键字</em> 的参数</p>
<h3 id="6_1">6<a class="headerlink" href="#6_1" title="Permanent link">&para;</a></h3>
<p>Optional Problem 2 有点难，debug都debug了10多次，成功实现的代码在下面</p>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Ant</span><span class="p">(</span><span class="n">Insect</span><span class="p">):</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>    <span class="o">...</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">place</span><span class="p">):</span>
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a>        <span class="k">if</span> <span class="n">place</span><span class="o">.</span><span class="n">ant</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a>            <span class="n">place</span><span class="o">.</span><span class="n">ant</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="__span-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-31-8"><a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a>            <span class="c1"># BEGIN Problem Optional 2</span>
</span><span id="__span-31-9"><a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a>            <span class="c1"># if not (isinstance(self, ContainerAnt) and self.can_contain(place.ant)) and not (isinstance(place.ant, ContainerAnt) and place.ant.can_contain(self)):</span>
</span><span id="__span-31-10"><a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ContainerAnt</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">can_contain</span><span class="p">(</span><span class="n">place</span><span class="o">.</span><span class="n">ant</span><span class="p">):</span>
</span><span id="__span-31-11"><a id="__codelineno-31-11" name="__codelineno-31-11" href="#__codelineno-31-11"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">contain_ant</span><span class="p">(</span><span class="n">place</span><span class="o">.</span><span class="n">ant</span><span class="p">)</span>
</span><span id="__span-31-12"><a id="__codelineno-31-12" name="__codelineno-31-12" href="#__codelineno-31-12"></a>                <span class="n">place</span><span class="o">.</span><span class="n">ant</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="__span-31-13"><a id="__codelineno-31-13" name="__codelineno-31-13" href="#__codelineno-31-13"></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">place</span><span class="o">.</span><span class="n">ant</span><span class="p">,</span> <span class="n">ContainerAnt</span><span class="p">)</span> <span class="ow">and</span> <span class="n">place</span><span class="o">.</span><span class="n">ant</span><span class="o">.</span><span class="n">can_contain</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-31-14"><a id="__codelineno-31-14" name="__codelineno-31-14" href="#__codelineno-31-14"></a>                <span class="n">place</span><span class="o">.</span><span class="n">ant</span><span class="o">.</span><span class="n">contain_ant</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-31-15"><a id="__codelineno-31-15" name="__codelineno-31-15" href="#__codelineno-31-15"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-31-16"><a id="__codelineno-31-16" name="__codelineno-31-16" href="#__codelineno-31-16"></a>                <span class="k">assert</span> <span class="n">place</span><span class="o">.</span><span class="n">ant</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Two ants in </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">place</span><span class="p">)</span>
</span><span id="__span-31-17"><a id="__codelineno-31-17" name="__codelineno-31-17" href="#__codelineno-31-17"></a>            <span class="c1"># END Problem Optional 2</span>
</span><span id="__span-31-18"><a id="__codelineno-31-18" name="__codelineno-31-18" href="#__codelineno-31-18"></a>        <span class="n">Insect</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">place</span><span class="p">)</span>
</span><span id="__span-31-19"><a id="__codelineno-31-19" name="__codelineno-31-19" href="#__codelineno-31-19"></a>
</span><span id="__span-31-20"><a id="__codelineno-31-20" name="__codelineno-31-20" href="#__codelineno-31-20"></a>    <span class="o">...</span>
</span><span id="__span-31-21"><a id="__codelineno-31-21" name="__codelineno-31-21" href="#__codelineno-31-21"></a>
</span><span id="__span-31-22"><a id="__codelineno-31-22" name="__codelineno-31-22" href="#__codelineno-31-22"></a><span class="o">...</span>
</span><span id="__span-31-23"><a id="__codelineno-31-23" name="__codelineno-31-23" href="#__codelineno-31-23"></a>
</span><span id="__span-31-24"><a id="__codelineno-31-24" name="__codelineno-31-24" href="#__codelineno-31-24"></a><span class="k">class</span><span class="w"> </span><span class="nc">ContainerAnt</span><span class="p">(</span><span class="n">Ant</span><span class="p">):</span>
</span><span id="__span-31-25"><a id="__codelineno-31-25" name="__codelineno-31-25" href="#__codelineno-31-25"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="__span-31-26"><a id="__codelineno-31-26" name="__codelineno-31-26" href="#__codelineno-31-26"></a>        <span class="n">Ant</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="__span-31-27"><a id="__codelineno-31-27" name="__codelineno-31-27" href="#__codelineno-31-27"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">contained_ant</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-31-28"><a id="__codelineno-31-28" name="__codelineno-31-28" href="#__codelineno-31-28"></a>
</span><span id="__span-31-29"><a id="__codelineno-31-29" name="__codelineno-31-29" href="#__codelineno-31-29"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">can_contain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="__span-31-30"><a id="__codelineno-31-30" name="__codelineno-31-30" href="#__codelineno-31-30"></a>        <span class="c1"># BEGIN Problem Optional 2</span>
</span><span id="__span-31-31"><a id="__codelineno-31-31" name="__codelineno-31-31" href="#__codelineno-31-31"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-31-32"><a id="__codelineno-31-32" name="__codelineno-31-32" href="#__codelineno-31-32"></a>        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">contained_ant</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ContainerAnt</span><span class="p">)</span>
</span><span id="__span-31-33"><a id="__codelineno-31-33" name="__codelineno-31-33" href="#__codelineno-31-33"></a>        <span class="c1"># END Problem Optional 2</span>
</span><span id="__span-31-34"><a id="__codelineno-31-34" name="__codelineno-31-34" href="#__codelineno-31-34"></a>
</span><span id="__span-31-35"><a id="__codelineno-31-35" name="__codelineno-31-35" href="#__codelineno-31-35"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">contain_ant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ant</span><span class="p">):</span>
</span><span id="__span-31-36"><a id="__codelineno-31-36" name="__codelineno-31-36" href="#__codelineno-31-36"></a>        <span class="c1"># BEGIN Problem Optional 2</span>
</span><span id="__span-31-37"><a id="__codelineno-31-37" name="__codelineno-31-37" href="#__codelineno-31-37"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-31-38"><a id="__codelineno-31-38" name="__codelineno-31-38" href="#__codelineno-31-38"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">can_contain</span><span class="p">(</span><span class="n">ant</span><span class="p">):</span>
</span><span id="__span-31-39"><a id="__codelineno-31-39" name="__codelineno-31-39" href="#__codelineno-31-39"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">contained_ant</span> <span class="o">=</span> <span class="n">ant</span>
</span><span id="__span-31-40"><a id="__codelineno-31-40" name="__codelineno-31-40" href="#__codelineno-31-40"></a>            <span class="c1"># self.place.ant = self</span>
</span><span id="__span-31-41"><a id="__codelineno-31-41" name="__codelineno-31-41" href="#__codelineno-31-41"></a>        <span class="c1"># END Problem Optional 2</span>
</span><span id="__span-31-42"><a id="__codelineno-31-42" name="__codelineno-31-42" href="#__codelineno-31-42"></a>
</span><span id="__span-31-43"><a id="__codelineno-31-43" name="__codelineno-31-43" href="#__codelineno-31-43"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">remove_ant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ant</span><span class="p">):</span>
</span><span id="__span-31-44"><a id="__codelineno-31-44" name="__codelineno-31-44" href="#__codelineno-31-44"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">contained_ant</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">ant</span><span class="p">:</span>
</span><span id="__span-31-45"><a id="__codelineno-31-45" name="__codelineno-31-45" href="#__codelineno-31-45"></a>            <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> does not contain </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ant</span><span class="p">)</span>
</span><span id="__span-31-46"><a id="__codelineno-31-46" name="__codelineno-31-46" href="#__codelineno-31-46"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">contained_ant</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-31-47"><a id="__codelineno-31-47" name="__codelineno-31-47" href="#__codelineno-31-47"></a>
</span><span id="__span-31-48"><a id="__codelineno-31-48" name="__codelineno-31-48" href="#__codelineno-31-48"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">remove_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">place</span><span class="p">):</span>
</span><span id="__span-31-49"><a id="__codelineno-31-49" name="__codelineno-31-49" href="#__codelineno-31-49"></a>        <span class="c1"># Special handling for container ants (this is optional)</span>
</span><span id="__span-31-50"><a id="__codelineno-31-50" name="__codelineno-31-50" href="#__codelineno-31-50"></a>        <span class="k">if</span> <span class="n">place</span><span class="o">.</span><span class="n">ant</span> <span class="ow">is</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="__span-31-51"><a id="__codelineno-31-51" name="__codelineno-31-51" href="#__codelineno-31-51"></a>            <span class="c1"># Container was removed. Contained ant should remain in the game</span>
</span><span id="__span-31-52"><a id="__codelineno-31-52" name="__codelineno-31-52" href="#__codelineno-31-52"></a>            <span class="n">place</span><span class="o">.</span><span class="n">ant</span> <span class="o">=</span> <span class="n">place</span><span class="o">.</span><span class="n">ant</span><span class="o">.</span><span class="n">contained_ant</span>
</span><span id="__span-31-53"><a id="__codelineno-31-53" name="__codelineno-31-53" href="#__codelineno-31-53"></a>            <span class="n">Insect</span><span class="o">.</span><span class="n">remove_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">place</span><span class="p">)</span>
</span><span id="__span-31-54"><a id="__codelineno-31-54" name="__codelineno-31-54" href="#__codelineno-31-54"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-31-55"><a id="__codelineno-31-55" name="__codelineno-31-55" href="#__codelineno-31-55"></a>            <span class="c1"># default to normal behavior</span>
</span><span id="__span-31-56"><a id="__codelineno-31-56" name="__codelineno-31-56" href="#__codelineno-31-56"></a>            <span class="n">Ant</span><span class="o">.</span><span class="n">remove_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">place</span><span class="p">)</span>
</span><span id="__span-31-57"><a id="__codelineno-31-57" name="__codelineno-31-57" href="#__codelineno-31-57"></a>
</span><span id="__span-31-58"><a id="__codelineno-31-58" name="__codelineno-31-58" href="#__codelineno-31-58"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gamestate</span><span class="p">):</span>
</span><span id="__span-31-59"><a id="__codelineno-31-59" name="__codelineno-31-59" href="#__codelineno-31-59"></a>        <span class="c1"># BEGIN Optional 2</span>
</span><span id="__span-31-60"><a id="__codelineno-31-60" name="__codelineno-31-60" href="#__codelineno-31-60"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-31-61"><a id="__codelineno-31-61" name="__codelineno-31-61" href="#__codelineno-31-61"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">contained_ant</span><span class="p">:</span>
</span><span id="__span-31-62"><a id="__codelineno-31-62" name="__codelineno-31-62" href="#__codelineno-31-62"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">contained_ant</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-31-63"><a id="__codelineno-31-63" name="__codelineno-31-63" href="#__codelineno-31-63"></a>        <span class="c1"># END Optional 2</span>
</span><span id="__span-31-64"><a id="__codelineno-31-64" name="__codelineno-31-64" href="#__codelineno-31-64"></a>
</span><span id="__span-31-65"><a id="__codelineno-31-65" name="__codelineno-31-65" href="#__codelineno-31-65"></a><span class="k">class</span><span class="w"> </span><span class="nc">BodyguardAnt</span><span class="p">(</span><span class="n">ContainerAnt</span><span class="p">):</span>
</span><span id="__span-31-66"><a id="__codelineno-31-66" name="__codelineno-31-66" href="#__codelineno-31-66"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;BodyguardAnt provides protection to other Ants.&quot;&quot;&quot;</span>
</span><span id="__span-31-67"><a id="__codelineno-31-67" name="__codelineno-31-67" href="#__codelineno-31-67"></a>
</span><span id="__span-31-68"><a id="__codelineno-31-68" name="__codelineno-31-68" href="#__codelineno-31-68"></a>    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Bodyguard&#39;</span>
</span><span id="__span-31-69"><a id="__codelineno-31-69" name="__codelineno-31-69" href="#__codelineno-31-69"></a>    <span class="n">food_cost</span> <span class="o">=</span> <span class="mi">4</span>
</span><span id="__span-31-70"><a id="__codelineno-31-70" name="__codelineno-31-70" href="#__codelineno-31-70"></a>    <span class="c1"># OVERRIDE CLASS ATTRIBUTES HERE</span>
</span><span id="__span-31-71"><a id="__codelineno-31-71" name="__codelineno-31-71" href="#__codelineno-31-71"></a>    <span class="c1"># BEGIN Optional 2</span>
</span><span id="__span-31-72"><a id="__codelineno-31-72" name="__codelineno-31-72" href="#__codelineno-31-72"></a>    <span class="c1"># implemented = False   # Change to True to view in the GUI</span>
</span><span id="__span-31-73"><a id="__codelineno-31-73" name="__codelineno-31-73" href="#__codelineno-31-73"></a>    <span class="n">implemented</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-31-74"><a id="__codelineno-31-74" name="__codelineno-31-74" href="#__codelineno-31-74"></a>
</span><span id="__span-31-75"><a id="__codelineno-31-75" name="__codelineno-31-75" href="#__codelineno-31-75"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">armor</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="__span-31-76"><a id="__codelineno-31-76" name="__codelineno-31-76" href="#__codelineno-31-76"></a>        <span class="n">ContainerAnt</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">armor</span><span class="p">)</span>
</span><span id="__span-31-77"><a id="__codelineno-31-77" name="__codelineno-31-77" href="#__codelineno-31-77"></a>    <span class="c1"># END Optional 2</span>
</span></code></pre></div>
</details>
<h3 id="7_1">7<a class="headerlink" href="#7_1" title="Permanent link">&para;</a></h3>
<p>Optional Problem 4</p>
<p>这题我认为很难(看完题目要求时就已经头大了)，应该算是所有题目里面最难的一题，修修改改了很久才初步写完，然后还debug了很多次</p>
<hr />
<p>刚开始时没什么头绪，所以打算 在教程的要求(主要要实现三个函数)中 <strong>先从最简单的问题开始解决(最后发现这很有用，因为把简单的问题解决了，最后难的问题就变得清晰明了了)</strong>，</p>
<p><code>make_slow</code> 和 <code>make_scare</code> ，这两个基本上差不多，他们都是要返回一个新的方法</p>
<blockquote>
<div class="language-python highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_slow</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">bee</span><span class="p">):</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a new action method that calls ACTION every other turn.</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="sd">    action -- An action method of some Bee</span>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>    <span class="c1"># BEGIN Problem Optional 4</span>
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a>    <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a>    <span class="c1"># END Problem Optional 4</span>
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a>
</span><span id="__span-32-10"><a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_scare</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">bee</span><span class="p">):</span>
</span><span id="__span-32-11"><a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a new action method that makes the bee go backwards.</span>
</span><span id="__span-32-12"><a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a>
</span><span id="__span-32-13"><a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a><span class="sd">    action -- An action method of some Bee</span>
</span><span id="__span-32-14"><a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-32-15"><a id="__codelineno-32-15" name="__codelineno-32-15" href="#__codelineno-32-15"></a>    <span class="c1"># BEGIN Problem Optional 4</span>
</span><span id="__span-32-16"><a id="__codelineno-32-16" name="__codelineno-32-16" href="#__codelineno-32-16"></a>    <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-32-17"><a id="__codelineno-32-17" name="__codelineno-32-17" href="#__codelineno-32-17"></a>    <span class="c1"># END Problem Optional 4</span>
</span></code></pre></div>
</blockquote>
<p>但我一开始没有理解 <em>返回方法</em> 应该意味着什么，然后注意到了 <strong>教程中的提示</strong> ，即<strong><mark>实例的方法是可以通过赋值去覆盖掉的</mark></strong></p>
<blockquote>
<p><em>Hint:</em> You will need to rebind a method in one of the functions. Note that when assigning to an instance, the self parameter isn't bound.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>  <span class="k">class</span><span class="w"> </span><span class="nc">X</span><span class="p">:</span> <span class="k">pass</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">3</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>  <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="p">()</span>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>  <span class="n">x</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">f</span>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>  <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="c1"># prints 8</span>
</span></code></pre></div>
</blockquote>
<p>所以我这时的想法是，在 <code>make_slow</code> 函数里面创建一个 用来当作方法 的函数，然后绑定到 <code>bee</code> 中，所以</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_slow</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">bee</span><span class="p">):</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">new_action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">):</span>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>        <span class="k">if</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">time</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>            <span class="n">action</span><span class="p">(</span><span class="n">bee</span><span class="p">,</span> <span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a>    <span class="n">bee</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">new_action</span>
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a>
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="o">...</span>
</span></code></pre></div>
<p>但是突然感觉，方法应该是有 <code>self</code> 参数的，</p>
<p>以及 好像要求说的是要返回，所以我这时认为，应该要在函数中将这个 用作方法的函数 返回，然后在 <code>apply_status</code> 中再将它绑定到对象中，所以</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_slow</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">bee</span><span class="p">):</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">new_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gamestate</span><span class="p">):</span>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>        <span class="k">if</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">time</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a>            <span class="n">action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>    <span class="k">return</span> <span class="n">new_action</span>
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a>
</span><span id="__span-35-7"><a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_scare</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">bee</span><span class="p">):</span>
</span><span id="__span-35-8"><a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">new_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gamestate</span><span class="p">):</span>
</span><span id="__span-35-9"><a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a>        <span class="n">bee</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">place</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">place</span><span class="o">.</span><span class="n">entrance</span> <span class="ow">is</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">beehive</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">place</span><span class="o">.</span><span class="n">entrance</span>
</span><span id="__span-35-10"><a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a>        <span class="n">action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-35-11"><a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a>    <span class="k">return</span> <span class="n">new_action</span>
</span></code></pre></div>
<p><code>.direction</code> 属性是由于，教程中提示到</p>
<blockquote>
<p><em>Hint:</em> to make a bee go backwards, consider adding an instance variable indicating its current direction. Where should you change the bee's direction? Once the direction is known, how can you modify the <code>action</code> method of <code>Bee</code> to move appropriately?</p>
</blockquote>
<p>所以我对 <code>Bee.action</code> 进行了修改</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Bee</span><span class="p">(</span><span class="n">Insect</span><span class="p">):</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>    <span class="o">...</span>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gamestate</span><span class="p">):</span>
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;A Bee&#39;s action stings the Ant that blocks its exit if it is blocked,</span>
</span><span id="__span-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a><span class="sd">        or moves to the exit of its current place otherwise.</span>
</span><span id="__span-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a>
</span><span id="__span-36-8"><a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a><span class="sd">        gamestate -- The GameState, used to access game state information.</span>
</span><span id="__span-36-9"><a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-36-10"><a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a>        <span class="n">destination</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">place</span><span class="o">.</span><span class="n">exit</span>
</span><span id="__span-36-11"><a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a>        <span class="c1"># Extra credit: Special handling for bee direction</span>
</span><span id="__span-36-12"><a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a>        <span class="c1"># BEGIN EC</span>
</span><span id="__span-36-13"><a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-36-14"><a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a>        <span class="n">destination</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span>
</span><span id="__span-36-15"><a id="__codelineno-36-15" name="__codelineno-36-15" href="#__codelineno-36-15"></a>        <span class="c1"># END EC</span>
</span><span id="__span-36-16"><a id="__codelineno-36-16" name="__codelineno-36-16" href="#__codelineno-36-16"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocked</span><span class="p">():</span>
</span><span id="__span-36-17"><a id="__codelineno-36-17" name="__codelineno-36-17" href="#__codelineno-36-17"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">place</span><span class="o">.</span><span class="n">ant</span><span class="p">)</span>
</span><span id="__span-36-18"><a id="__codelineno-36-18" name="__codelineno-36-18" href="#__codelineno-36-18"></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">armor</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">destination</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-36-19"><a id="__codelineno-36-19" name="__codelineno-36-19" href="#__codelineno-36-19"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">move_to</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>
</span></code></pre></div>
<hr />
<p>然后就开始写 <code>apply_status</code> 函数</p>
<p>一开始我没想好怎么设置 持续时间，所以就只是这样</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">apply_status</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">bee</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply a status to a BEE that lasts for LENGTH turns.&quot;&quot;&quot;</span>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a>    <span class="c1"># BEGIN Problem Optional 4</span>
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a>    <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a>    <span class="n">bee</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">status</span><span class="p">(</span><span class="n">bee</span><span class="o">.</span><span class="n">action</span><span class="p">,</span> <span class="n">bee</span><span class="p">)</span>
</span><span id="__span-37-6"><a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a>    <span class="c1"># END Problem Optional 4</span>
</span></code></pre></div>
<p>然后由于 剩余时间 需要被记录下来，而且我想到调用一次 action 函数就减少一次剩余时间，所以想到了在函数中再构建一个嵌套函数，然后使用 <code>nonlocal</code> 语句来减少 <code>length</code> 的值，并且在剩余时间为0的时候把方法换回原本的方法，所以</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">apply_status</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">bee</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>    <span class="n">old_action</span> <span class="o">=</span> <span class="n">bee</span><span class="o">.</span><span class="n">action</span>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">new_action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">):</span>
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a>        <span class="k">nonlocal</span> <span class="n">length</span>
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a>        <span class="n">length</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a>        <span class="n">status</span><span class="p">(</span><span class="n">old_action</span><span class="p">,</span> <span class="n">bee</span><span class="p">)(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-38-7"><a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a>        <span class="k">if</span> <span class="n">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-38-8"><a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a>            <span class="n">bee</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">old_action</span>
</span><span id="__span-38-9"><a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a>            <span class="n">bee</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-38-10"><a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a>    <span class="n">bee</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">new_action</span>
</span></code></pre></div>
<p>最后教程中还有一点，就是 <strong>多状态</strong> 的问题，</p>
<blockquote>
<p><code>apply_status</code> takes a <code>status</code> (either <code>make_slow</code> or <code>make_scare</code>), a <code>Bee</code>, and a <code>length</code>. The way it works is as so: imagine that a <code>Bee</code> has a bunch of statuses, each of which modifies <code>action</code> in sequence. When a status's length is up, it removes itself from the list. <code>apply_status</code> adds the given status to the end of the list, so that it is applied latest. Note that you don't necessarily need to make a literal list of statuses - it is just helpful to think of statuses in this way.</p>
<hr />
<p>As an example of what "previous behavior" means, take the example of a bee that has been slowed twice (say by two separate <code>SlowThrower</code>s). It will have the following behavior:</p>
<ul>
<li>on time 1, it will do nothing. The outer slow has 2 turns to go, the inner one still has 3 turns</li>
<li>on time 2, it moves forward. The outer slow has 1 turn to go, the inner one has 2 turns</li>
<li>on time 3, it will do nothing. The outer slow has no turns left, the inner one has 2 turns</li>
<li>on time 4, it moves forward. The inner slow has 1 turn left</li>
<li>on time 5, it does nothing. The inner slow has no turns left</li>
</ul>
</blockquote>
<p>意思是要求，存在多个状态时，剩余时间会一起减少，但是应用的效果是按从早(最先生效)到晚(后产生)的顺序应用的，具体可以看教程中的解释</p>
<p>由于这个点我没有弄清楚应该如何实现，于是没有办法，我只能尝试先进行测试</p>
<hr />
<p>测试出现的第一个问题</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">ants</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">beehive</span><span class="p">,</span> <span class="n">layout</span> <span class="o">=</span> <span class="n">Hive</span><span class="p">(</span><span class="n">AssaultPlan</span><span class="p">()),</span> <span class="n">dry_layout</span>
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">dimensions</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">gamestate</span> <span class="o">=</span> <span class="n">GameState</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">beehive</span><span class="p">,</span> <span class="n">ant_types</span><span class="p">(),</span> <span class="n">layout</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">)</span>
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Testing Slow</span>
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">slow</span> <span class="o">=</span> <span class="n">SlowThrower</span><span class="p">()</span>
</span><span id="__span-39-7"><a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">bee</span> <span class="o">=</span> <span class="n">Bee</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="__span-39-8"><a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">places</span><span class="p">[</span><span class="s2">&quot;tunnel_0_0&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_insect</span><span class="p">(</span><span class="n">slow</span><span class="p">)</span>
</span><span id="__span-39-9"><a id="__codelineno-39-9" name="__codelineno-39-9" href="#__codelineno-39-9"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">places</span><span class="p">[</span><span class="s2">&quot;tunnel_0_4&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_insect</span><span class="p">(</span><span class="n">bee</span><span class="p">)</span>
</span><span id="__span-39-10"><a id="__codelineno-39-10" name="__codelineno-39-10" href="#__codelineno-39-10"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">slow</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-39-11"><a id="__codelineno-39-11" name="__codelineno-39-11" href="#__codelineno-39-11"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-39-12"><a id="__codelineno-39-12" name="__codelineno-39-12" href="#__codelineno-39-12"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">bee</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-39-13"><a id="__codelineno-39-13" name="__codelineno-39-13" href="#__codelineno-39-13"></a><span class="ne">TypeError</span><span class="p">:</span> <span class="n">apply_status</span><span class="o">.&lt;</span><span class="nb">locals</span><span class="o">&gt;.</span><span class="n">new_action</span><span class="p">()</span> <span class="n">missing</span> <span class="mi">1</span> <span class="n">required</span> <span class="n">positional</span> <span class="n">argument</span><span class="p">:</span> <span class="s1">&#39;gamestate&#39;</span>
</span><span id="__span-39-14"><a id="__codelineno-39-14" name="__codelineno-39-14" href="#__codelineno-39-14"></a>
</span><span id="__span-39-15"><a id="__codelineno-39-15" name="__codelineno-39-15" href="#__codelineno-39-15"></a><span class="c1"># Error: expected</span>
</span><span id="__span-39-16"><a id="__codelineno-39-16" name="__codelineno-39-16" href="#__codelineno-39-16"></a>
</span><span id="__span-39-17"><a id="__codelineno-39-17" name="__codelineno-39-17" href="#__codelineno-39-17"></a><span class="c1"># but got</span>
</span><span id="__span-39-18"><a id="__codelineno-39-18" name="__codelineno-39-18" href="#__codelineno-39-18"></a><span class="c1">#     Traceback (most recent call last):</span>
</span><span id="__span-39-19"><a id="__codelineno-39-19" name="__codelineno-39-19" href="#__codelineno-39-19"></a><span class="c1">#       ...</span>
</span><span id="__span-39-20"><a id="__codelineno-39-20" name="__codelineno-39-20" href="#__codelineno-39-20"></a><span class="c1">#     TypeError: apply_status.&lt;locals&gt;.new_action() missing 1 required positional argument: &#39;gamestate&#39;</span>
</span></code></pre></div>
<p>是指 <code>apply_status</code> 函数中的嵌套函数 <code>new_action</code> 在被使用时，第二个 <code>gamestate</code> 参数没有被传入值(一开始我的理解还有些偏差，经过了一些测试和试错才最终确定是这个原因)</p>
<p>这就意味着， <code>bee.action(gamestate)</code> 处，在调用新的方法时，只传入了一个参数(所以第二个参数没有被传入)，所以这似乎告诉我，在编写新的方法时，并不需要使用 <code>self</code> 参数</p>
<p>为了求证，我重新去查看和理解教程中给出的示例</p>
<blockquote>
<p><em>Hint:</em> You will need to rebind a method in one of the functions. Note that when assigning to an instance, the self parameter isn't bound.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>  <span class="k">class</span><span class="w"> </span><span class="nc">X</span><span class="p">:</span> <span class="k">pass</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">3</span>
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a>  <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="p">()</span>
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a>  <span class="n">x</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">f</span>
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a>  <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="c1"># prints 8</span>
</span></code></pre></div>
</blockquote>
<p>如何发现，这里面的 新方法 就是没有 <code>self</code> 参数，并且在调用时，这个实例也没有将自身作为参数传入其中(调用自身或父类的方法时，会把自身 <strong>隐式地</strong> 传入 <code>self</code> 参数)，所以得到结论，<strong><mark>如果一个在类外定义的函数，被绑定成为了某个实例的属性，或者某种程度上可以说时成为了这个实例的一个方法，在通过 <code>实例.属性名</code> 的方式使用这个函数/方法时，是不会将实例传入函数/方法的</mark></strong></p>
<p>所以对原有代码进行了修改</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_slow</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">bee</span><span class="p">):</span>
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">new_action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">):</span>
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a>        <span class="k">if</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">time</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a>            <span class="n">action</span><span class="p">(</span><span class="n">bee</span> <span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-41-5"><a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a>    <span class="k">return</span> <span class="n">new_action</span>
</span><span id="__span-41-6"><a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a>
</span><span id="__span-41-7"><a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_scare</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">bee</span><span class="p">):</span>
</span><span id="__span-41-8"><a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">new_action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">):</span>
</span><span id="__span-41-9"><a id="__codelineno-41-9" name="__codelineno-41-9" href="#__codelineno-41-9"></a>        <span class="n">bee</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">bee</span><span class="o">.</span><span class="n">place</span> <span class="k">if</span> <span class="n">bee</span><span class="o">.</span><span class="n">place</span><span class="o">.</span><span class="n">entrance</span> <span class="ow">is</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">beehive</span> <span class="k">else</span> <span class="n">bee</span><span class="o">.</span><span class="n">place</span><span class="o">.</span><span class="n">entrance</span>
</span><span id="__span-41-10"><a id="__codelineno-41-10" name="__codelineno-41-10" href="#__codelineno-41-10"></a>        <span class="n">action</span><span class="p">(</span><span class="n">bee</span><span class="p">,</span> <span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-41-11"><a id="__codelineno-41-11" name="__codelineno-41-11" href="#__codelineno-41-11"></a>    <span class="k">return</span> <span class="n">new_action</span>
</span><span id="__span-41-12"><a id="__codelineno-41-12" name="__codelineno-41-12" href="#__codelineno-41-12"></a>
</span><span id="__span-41-13"><a id="__codelineno-41-13" name="__codelineno-41-13" href="#__codelineno-41-13"></a><span class="k">def</span><span class="w"> </span><span class="nf">apply_status</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">bee</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
</span><span id="__span-41-14"><a id="__codelineno-41-14" name="__codelineno-41-14" href="#__codelineno-41-14"></a>    <span class="n">old_action</span> <span class="o">=</span> <span class="n">bee</span><span class="o">.</span><span class="n">action</span>
</span><span id="__span-41-15"><a id="__codelineno-41-15" name="__codelineno-41-15" href="#__codelineno-41-15"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">new_action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">):</span>
</span><span id="__span-41-16"><a id="__codelineno-41-16" name="__codelineno-41-16" href="#__codelineno-41-16"></a>        <span class="k">nonlocal</span> <span class="n">length</span>
</span><span id="__span-41-17"><a id="__codelineno-41-17" name="__codelineno-41-17" href="#__codelineno-41-17"></a>        <span class="n">length</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="__span-41-18"><a id="__codelineno-41-18" name="__codelineno-41-18" href="#__codelineno-41-18"></a>        <span class="n">status</span><span class="p">(</span><span class="n">old_action</span><span class="p">,</span> <span class="n">bee</span><span class="p">)(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-41-19"><a id="__codelineno-41-19" name="__codelineno-41-19" href="#__codelineno-41-19"></a>        <span class="k">if</span> <span class="n">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-41-20"><a id="__codelineno-41-20" name="__codelineno-41-20" href="#__codelineno-41-20"></a>            <span class="n">bee</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">old_action</span>
</span><span id="__span-41-21"><a id="__codelineno-41-21" name="__codelineno-41-21" href="#__codelineno-41-21"></a>            <span class="n">bee</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-41-22"><a id="__codelineno-41-22" name="__codelineno-41-22" href="#__codelineno-41-22"></a>    <span class="n">bee</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">new_action</span>
</span></code></pre></div>
<p>然后在测试修改好的代码时，发现</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">ants</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">beehive</span><span class="p">,</span> <span class="n">layout</span> <span class="o">=</span> <span class="n">Hive</span><span class="p">(</span><span class="n">AssaultPlan</span><span class="p">()),</span> <span class="n">dry_layout</span>
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">dimensions</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">gamestate</span> <span class="o">=</span> <span class="n">GameState</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">beehive</span><span class="p">,</span> <span class="n">ant_types</span><span class="p">(),</span> <span class="n">layout</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">)</span>
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Testing Slow</span>
</span><span id="__span-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">slow</span> <span class="o">=</span> <span class="n">SlowThrower</span><span class="p">()</span>
</span><span id="__span-42-7"><a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">bee</span> <span class="o">=</span> <span class="n">Bee</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="__span-42-8"><a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">places</span><span class="p">[</span><span class="s2">&quot;tunnel_0_0&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_insect</span><span class="p">(</span><span class="n">slow</span><span class="p">)</span>
</span><span id="__span-42-9"><a id="__codelineno-42-9" name="__codelineno-42-9" href="#__codelineno-42-9"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">places</span><span class="p">[</span><span class="s2">&quot;tunnel_0_4&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_insect</span><span class="p">(</span><span class="n">bee</span><span class="p">)</span>
</span><span id="__span-42-10"><a id="__codelineno-42-10" name="__codelineno-42-10" href="#__codelineno-42-10"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">slow</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-42-11"><a id="__codelineno-42-11" name="__codelineno-42-11" href="#__codelineno-42-11"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-42-12"><a id="__codelineno-42-12" name="__codelineno-42-12" href="#__codelineno-42-12"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">bee</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-42-13"><a id="__codelineno-42-13" name="__codelineno-42-13" href="#__codelineno-42-13"></a><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
</span><span id="__span-42-14"><a id="__codelineno-42-14" name="__codelineno-42-14" href="#__codelineno-42-14"></a>  <span class="n">File</span> <span class="s2">&quot;E:\Courses\cs61a\projects</span><span class="se">\a</span><span class="s2">nts</span><span class="se">\a</span><span class="s2">nts.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">606</span><span class="p">,</span> <span class="ow">in</span> <span class="n">new_action</span>
</span><span id="__span-42-15"><a id="__codelineno-42-15" name="__codelineno-42-15" href="#__codelineno-42-15"></a>    <span class="n">action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-42-16"><a id="__codelineno-42-16" name="__codelineno-42-16" href="#__codelineno-42-16"></a>  <span class="n">File</span> <span class="s2">&quot;E:\Courses\cs61a\projects</span><span class="se">\a</span><span class="s2">nts</span><span class="se">\a</span><span class="s2">nts.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">470</span><span class="p">,</span> <span class="ow">in</span> <span class="n">action</span>
</span><span id="__span-42-17"><a id="__codelineno-42-17" name="__codelineno-42-17" href="#__codelineno-42-17"></a>    <span class="n">destination</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span>
</span><span id="__span-42-18"><a id="__codelineno-42-18" name="__codelineno-42-18" href="#__codelineno-42-18"></a><span class="ne">AttributeError</span><span class="p">:</span> <span class="s1">&#39;Bee&#39;</span> <span class="nb">object</span> <span class="n">has</span> <span class="n">no</span> <span class="n">attribute</span> <span class="s1">&#39;direction&#39;</span>
</span><span id="__span-42-19"><a id="__codelineno-42-19" name="__codelineno-42-19" href="#__codelineno-42-19"></a>
</span><span id="__span-42-20"><a id="__codelineno-42-20" name="__codelineno-42-20" href="#__codelineno-42-20"></a><span class="c1"># Error: expected</span>
</span><span id="__span-42-21"><a id="__codelineno-42-21" name="__codelineno-42-21" href="#__codelineno-42-21"></a>
</span><span id="__span-42-22"><a id="__codelineno-42-22" name="__codelineno-42-22" href="#__codelineno-42-22"></a><span class="c1"># but got</span>
</span><span id="__span-42-23"><a id="__codelineno-42-23" name="__codelineno-42-23" href="#__codelineno-42-23"></a><span class="c1">#     Traceback (most recent call last):</span>
</span><span id="__span-42-24"><a id="__codelineno-42-24" name="__codelineno-42-24" href="#__codelineno-42-24"></a><span class="c1">#       ...</span>
</span><span id="__span-42-25"><a id="__codelineno-42-25" name="__codelineno-42-25" href="#__codelineno-42-25"></a><span class="c1">#     AttributeError: &#39;Bee&#39; object has no attribute &#39;direction&#39;</span>
</span></code></pre></div>
<p>由于 <code>bee.direction</code> 没有初始值/默认值，所以有可能出现属性不存在的情况，所以进行修改</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Bee</span><span class="p">(</span><span class="n">Insect</span><span class="p">):</span>
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a>    <span class="o">...</span>
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a>    <span class="n">direction</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a>    <span class="o">...</span>
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a>
</span><span id="__span-43-6"><a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gamestate</span><span class="p">):</span>
</span><span id="__span-43-7"><a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a>        <span class="n">destination</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">place</span><span class="o">.</span><span class="n">exit</span>
</span><span id="__span-43-8"><a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a>        <span class="c1"># Extra credit: Special handling for bee direction</span>
</span><span id="__span-43-9"><a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a>        <span class="c1"># BEGIN EC</span>
</span><span id="__span-43-10"><a id="__codelineno-43-10" name="__codelineno-43-10" href="#__codelineno-43-10"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-43-11"><a id="__codelineno-43-11" name="__codelineno-43-11" href="#__codelineno-43-11"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span><span class="p">:</span>
</span><span id="__span-43-12"><a id="__codelineno-43-12" name="__codelineno-43-12" href="#__codelineno-43-12"></a>            <span class="n">destination</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span>
</span><span id="__span-43-13"><a id="__codelineno-43-13" name="__codelineno-43-13" href="#__codelineno-43-13"></a>        <span class="c1"># END EC</span>
</span><span id="__span-43-14"><a id="__codelineno-43-14" name="__codelineno-43-14" href="#__codelineno-43-14"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocked</span><span class="p">():</span>
</span><span id="__span-43-15"><a id="__codelineno-43-15" name="__codelineno-43-15" href="#__codelineno-43-15"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">place</span><span class="o">.</span><span class="n">ant</span><span class="p">)</span>
</span><span id="__span-43-16"><a id="__codelineno-43-16" name="__codelineno-43-16" href="#__codelineno-43-16"></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">armor</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">destination</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-43-17"><a id="__codelineno-43-17" name="__codelineno-43-17" href="#__codelineno-43-17"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">move_to</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>
</span></code></pre></div>
<p>然后又出现了一个问题，</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">ants</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">beehive</span><span class="p">,</span> <span class="n">layout</span> <span class="o">=</span> <span class="n">Hive</span><span class="p">(</span><span class="n">AssaultPlan</span><span class="p">()),</span> <span class="n">dry_layout</span>
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">dimensions</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">gamestate</span> <span class="o">=</span> <span class="n">GameState</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">beehive</span><span class="p">,</span> <span class="n">ant_types</span><span class="p">(),</span> <span class="n">layout</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">)</span>
</span><span id="__span-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Testing Slow</span>
</span><span id="__span-44-6"><a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">slow</span> <span class="o">=</span> <span class="n">SlowThrower</span><span class="p">()</span>
</span><span id="__span-44-7"><a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">bee</span> <span class="o">=</span> <span class="n">Bee</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="__span-44-8"><a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">places</span><span class="p">[</span><span class="s2">&quot;tunnel_0_0&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_insect</span><span class="p">(</span><span class="n">slow</span><span class="p">)</span>
</span><span id="__span-44-9"><a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">places</span><span class="p">[</span><span class="s2">&quot;tunnel_0_4&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_insect</span><span class="p">(</span><span class="n">bee</span><span class="p">)</span>
</span><span id="__span-44-10"><a id="__codelineno-44-10" name="__codelineno-44-10" href="#__codelineno-44-10"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">slow</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-44-11"><a id="__codelineno-44-11" name="__codelineno-44-11" href="#__codelineno-44-11"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-44-12"><a id="__codelineno-44-12" name="__codelineno-44-12" href="#__codelineno-44-12"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">bee</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-44-13"><a id="__codelineno-44-13" name="__codelineno-44-13" href="#__codelineno-44-13"></a><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
</span><span id="__span-44-14"><a id="__codelineno-44-14" name="__codelineno-44-14" href="#__codelineno-44-14"></a>  <span class="n">File</span> <span class="s2">&quot;E:\Courses\cs61a\projects</span><span class="se">\a</span><span class="s2">nts</span><span class="se">\a</span><span class="s2">nts.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">606</span><span class="p">,</span> <span class="ow">in</span> <span class="n">new_action</span>
</span><span id="__span-44-15"><a id="__codelineno-44-15" name="__codelineno-44-15" href="#__codelineno-44-15"></a>    <span class="n">action</span><span class="p">(</span><span class="n">bee</span><span class="p">,</span> <span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-44-16"><a id="__codelineno-44-16" name="__codelineno-44-16" href="#__codelineno-44-16"></a><span class="ne">TypeError</span><span class="p">:</span> <span class="n">Bee</span><span class="o">.</span><span class="n">action</span><span class="p">()</span> <span class="n">takes</span> <span class="mi">2</span> <span class="n">positional</span> <span class="n">arguments</span> <span class="n">but</span> <span class="mi">3</span> <span class="n">were</span> <span class="n">given</span>
</span><span id="__span-44-17"><a id="__codelineno-44-17" name="__codelineno-44-17" href="#__codelineno-44-17"></a>
</span><span id="__span-44-18"><a id="__codelineno-44-18" name="__codelineno-44-18" href="#__codelineno-44-18"></a><span class="c1"># Error: expected</span>
</span><span id="__span-44-19"><a id="__codelineno-44-19" name="__codelineno-44-19" href="#__codelineno-44-19"></a>
</span><span id="__span-44-20"><a id="__codelineno-44-20" name="__codelineno-44-20" href="#__codelineno-44-20"></a><span class="c1"># but got</span>
</span><span id="__span-44-21"><a id="__codelineno-44-21" name="__codelineno-44-21" href="#__codelineno-44-21"></a><span class="c1">#     Traceback (most recent call last):</span>
</span><span id="__span-44-22"><a id="__codelineno-44-22" name="__codelineno-44-22" href="#__codelineno-44-22"></a><span class="c1">#       ...</span>
</span><span id="__span-44-23"><a id="__codelineno-44-23" name="__codelineno-44-23" href="#__codelineno-44-23"></a><span class="c1">#     TypeError: Bee.action() takes 2 positional arguments but 3 were given</span>
</span></code></pre></div>
<p><code>bee</code> 原本的方法传入了一个参数，所以可以发现，<strong><mark>实例的方法本身已经将实例本身传入了 <code>self</code> 参数</mark></strong>，比如 <code>old_action = bee.action</code> ，<code>bee.action</code> 已经给 <code>Bee.action</code> 中的 <code>self</code> 参数传入了自身(即 <code>bee</code> 实例)，而如果使用 <code>old_action</code> ，比如 <code>old_action(gs)</code> ，那么 <code>gs</code> 会被传入 <code>Bee.action</code> 的 <code>gamestate</code> (第二个参数)而不是 <code>self</code> </p>
<p>所以进行修改</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_slow</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">bee</span><span class="p">):</span>
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">new_action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">):</span>
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a>        <span class="k">if</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">time</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a>            <span class="n">action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a>    <span class="k">return</span> <span class="n">new_action</span>
</span><span id="__span-45-6"><a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a>
</span><span id="__span-45-7"><a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_scare</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">bee</span><span class="p">):</span>
</span><span id="__span-45-8"><a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">new_action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">):</span>
</span><span id="__span-45-9"><a id="__codelineno-45-9" name="__codelineno-45-9" href="#__codelineno-45-9"></a>        <span class="n">bee</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">bee</span><span class="o">.</span><span class="n">place</span> <span class="k">if</span> <span class="n">bee</span><span class="o">.</span><span class="n">place</span><span class="o">.</span><span class="n">entrance</span> <span class="ow">is</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">beehive</span> <span class="k">else</span> <span class="n">bee</span><span class="o">.</span><span class="n">place</span><span class="o">.</span><span class="n">entrance</span>
</span><span id="__span-45-10"><a id="__codelineno-45-10" name="__codelineno-45-10" href="#__codelineno-45-10"></a>        <span class="n">action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-45-11"><a id="__codelineno-45-11" name="__codelineno-45-11" href="#__codelineno-45-11"></a>    <span class="k">return</span> <span class="n">new_action</span>
</span><span id="__span-45-12"><a id="__codelineno-45-12" name="__codelineno-45-12" href="#__codelineno-45-12"></a>
</span><span id="__span-45-13"><a id="__codelineno-45-13" name="__codelineno-45-13" href="#__codelineno-45-13"></a><span class="k">def</span><span class="w"> </span><span class="nf">apply_status</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">bee</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
</span><span id="__span-45-14"><a id="__codelineno-45-14" name="__codelineno-45-14" href="#__codelineno-45-14"></a>    <span class="n">old_action</span> <span class="o">=</span> <span class="n">bee</span><span class="o">.</span><span class="n">action</span>
</span><span id="__span-45-15"><a id="__codelineno-45-15" name="__codelineno-45-15" href="#__codelineno-45-15"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">new_action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">):</span>
</span><span id="__span-45-16"><a id="__codelineno-45-16" name="__codelineno-45-16" href="#__codelineno-45-16"></a>        <span class="k">nonlocal</span> <span class="n">length</span>
</span><span id="__span-45-17"><a id="__codelineno-45-17" name="__codelineno-45-17" href="#__codelineno-45-17"></a>        <span class="n">length</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="__span-45-18"><a id="__codelineno-45-18" name="__codelineno-45-18" href="#__codelineno-45-18"></a>        <span class="n">status</span><span class="p">(</span><span class="n">old_action</span><span class="p">,</span> <span class="n">bee</span><span class="p">)(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-45-19"><a id="__codelineno-45-19" name="__codelineno-45-19" href="#__codelineno-45-19"></a>        <span class="k">if</span> <span class="n">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-45-20"><a id="__codelineno-45-20" name="__codelineno-45-20" href="#__codelineno-45-20"></a>            <span class="n">bee</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">old_action</span>
</span><span id="__span-45-21"><a id="__codelineno-45-21" name="__codelineno-45-21" href="#__codelineno-45-21"></a>            <span class="n">bee</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-45-22"><a id="__codelineno-45-22" name="__codelineno-45-22" href="#__codelineno-45-22"></a>    <span class="n">bee</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">new_action</span>
</span></code></pre></div>
<hr />
<p>测试出现的第二个问题</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">ants</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">beehive</span><span class="p">,</span> <span class="n">layout</span> <span class="o">=</span> <span class="n">Hive</span><span class="p">(</span><span class="n">AssaultPlan</span><span class="p">()),</span> <span class="n">dry_layout</span>
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">dimensions</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">gamestate</span> <span class="o">=</span> <span class="n">GameState</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">beehive</span><span class="p">,</span> <span class="n">ant_types</span><span class="p">(),</span> <span class="n">layout</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">)</span>
</span><span id="__span-46-5"><a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">scare</span> <span class="o">=</span> <span class="n">ScaryThrower</span><span class="p">()</span>
</span><span id="__span-46-6"><a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">bee</span> <span class="o">=</span> <span class="n">Bee</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="__span-46-7"><a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">places</span><span class="p">[</span><span class="s2">&quot;tunnel_0_0&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_insect</span><span class="p">(</span><span class="n">scare</span><span class="p">)</span>
</span><span id="__span-46-8"><a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">places</span><span class="p">[</span><span class="s2">&quot;tunnel_0_1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_insect</span><span class="p">(</span><span class="n">bee</span><span class="p">)</span>
</span><span id="__span-46-9"><a id="__codelineno-46-9" name="__codelineno-46-9" href="#__codelineno-46-9"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">scare</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-46-10"><a id="__codelineno-46-10" name="__codelineno-46-10" href="#__codelineno-46-10"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">bee</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-46-11"><a id="__codelineno-46-11" name="__codelineno-46-11" href="#__codelineno-46-11"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">bee</span><span class="o">.</span><span class="n">place</span><span class="o">.</span><span class="n">name</span>
</span><span id="__span-46-12"><a id="__codelineno-46-12" name="__codelineno-46-12" href="#__codelineno-46-12"></a><span class="s1">&#39;tunnel_0_2&#39;</span>
</span><span id="__span-46-13"><a id="__codelineno-46-13" name="__codelineno-46-13" href="#__codelineno-46-13"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">bee</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-46-14"><a id="__codelineno-46-14" name="__codelineno-46-14" href="#__codelineno-46-14"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">bee</span><span class="o">.</span><span class="n">place</span><span class="o">.</span><span class="n">name</span>
</span><span id="__span-46-15"><a id="__codelineno-46-15" name="__codelineno-46-15" href="#__codelineno-46-15"></a><span class="s1">&#39;tunnel_0_3&#39;</span>
</span><span id="__span-46-16"><a id="__codelineno-46-16" name="__codelineno-46-16" href="#__codelineno-46-16"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1">#</span>
</span><span id="__span-46-17"><a id="__codelineno-46-17" name="__codelineno-46-17" href="#__codelineno-46-17"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Same bee should not be scared more than once</span>
</span><span id="__span-46-18"><a id="__codelineno-46-18" name="__codelineno-46-18" href="#__codelineno-46-18"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">scare</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-46-19"><a id="__codelineno-46-19" name="__codelineno-46-19" href="#__codelineno-46-19"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">bee</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-46-20"><a id="__codelineno-46-20" name="__codelineno-46-20" href="#__codelineno-46-20"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">bee</span><span class="o">.</span><span class="n">place</span><span class="o">.</span><span class="n">name</span>
</span><span id="__span-46-21"><a id="__codelineno-46-21" name="__codelineno-46-21" href="#__codelineno-46-21"></a><span class="s1">&#39;tunnel_0_4&#39;</span>
</span><span id="__span-46-22"><a id="__codelineno-46-22" name="__codelineno-46-22" href="#__codelineno-46-22"></a>
</span><span id="__span-46-23"><a id="__codelineno-46-23" name="__codelineno-46-23" href="#__codelineno-46-23"></a><span class="c1"># Error: expected</span>
</span><span id="__span-46-24"><a id="__codelineno-46-24" name="__codelineno-46-24" href="#__codelineno-46-24"></a><span class="c1">#     &#39;tunnel_0_2&#39;</span>
</span><span id="__span-46-25"><a id="__codelineno-46-25" name="__codelineno-46-25" href="#__codelineno-46-25"></a><span class="c1"># but got</span>
</span><span id="__span-46-26"><a id="__codelineno-46-26" name="__codelineno-46-26" href="#__codelineno-46-26"></a><span class="c1">#     &#39;tunnel_0_4&#39;</span>
</span></code></pre></div>
<p>同一个蜜蜂只能被<em>恐吓</em>一次，所以对原有代码进行修改</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Bee</span><span class="p">(</span><span class="n">Insect</span><span class="p">):</span>
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a>    <span class="o">...</span>
</span><span id="__span-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a>    <span class="n">direction</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-47-4"><a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a>    <span class="n">has_been_scared</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-47-5"><a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a>    <span class="o">...</span>
</span><span id="__span-47-6"><a id="__codelineno-47-6" name="__codelineno-47-6" href="#__codelineno-47-6"></a>
</span><span id="__span-47-7"><a id="__codelineno-47-7" name="__codelineno-47-7" href="#__codelineno-47-7"></a><span class="o">...</span>
</span><span id="__span-47-8"><a id="__codelineno-47-8" name="__codelineno-47-8" href="#__codelineno-47-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_scare</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">bee</span><span class="p">):</span>
</span><span id="__span-47-9"><a id="__codelineno-47-9" name="__codelineno-47-9" href="#__codelineno-47-9"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">new_action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">):</span>
</span><span id="__span-47-10"><a id="__codelineno-47-10" name="__codelineno-47-10" href="#__codelineno-47-10"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">bee</span><span class="o">.</span><span class="n">has_been_scared</span><span class="p">:</span>
</span><span id="__span-47-11"><a id="__codelineno-47-11" name="__codelineno-47-11" href="#__codelineno-47-11"></a>            <span class="n">bee</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">bee</span><span class="o">.</span><span class="n">place</span> <span class="k">if</span> <span class="n">bee</span><span class="o">.</span><span class="n">place</span><span class="o">.</span><span class="n">entrance</span> <span class="ow">is</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">beehive</span> <span class="k">else</span> <span class="n">bee</span><span class="o">.</span><span class="n">place</span><span class="o">.</span><span class="n">entrance</span>
</span><span id="__span-47-12"><a id="__codelineno-47-12" name="__codelineno-47-12" href="#__codelineno-47-12"></a>        <span class="n">action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-47-13"><a id="__codelineno-47-13" name="__codelineno-47-13" href="#__codelineno-47-13"></a>    <span class="k">return</span> <span class="n">new_action</span>
</span><span id="__span-47-14"><a id="__codelineno-47-14" name="__codelineno-47-14" href="#__codelineno-47-14"></a>
</span><span id="__span-47-15"><a id="__codelineno-47-15" name="__codelineno-47-15" href="#__codelineno-47-15"></a><span class="k">def</span><span class="w"> </span><span class="nf">apply_status</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">bee</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
</span><span id="__span-47-16"><a id="__codelineno-47-16" name="__codelineno-47-16" href="#__codelineno-47-16"></a>    <span class="n">old_action</span> <span class="o">=</span> <span class="n">bee</span><span class="o">.</span><span class="n">action</span>
</span><span id="__span-47-17"><a id="__codelineno-47-17" name="__codelineno-47-17" href="#__codelineno-47-17"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">new_action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">):</span>
</span><span id="__span-47-18"><a id="__codelineno-47-18" name="__codelineno-47-18" href="#__codelineno-47-18"></a>        <span class="k">nonlocal</span> <span class="n">length</span>
</span><span id="__span-47-19"><a id="__codelineno-47-19" name="__codelineno-47-19" href="#__codelineno-47-19"></a>        <span class="n">length</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="__span-47-20"><a id="__codelineno-47-20" name="__codelineno-47-20" href="#__codelineno-47-20"></a>        <span class="n">status</span><span class="p">(</span><span class="n">old_action</span><span class="p">,</span> <span class="n">bee</span><span class="p">)(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-47-21"><a id="__codelineno-47-21" name="__codelineno-47-21" href="#__codelineno-47-21"></a>        <span class="k">if</span> <span class="n">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-47-22"><a id="__codelineno-47-22" name="__codelineno-47-22" href="#__codelineno-47-22"></a>            <span class="n">bee</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">old_action</span>
</span><span id="__span-47-23"><a id="__codelineno-47-23" name="__codelineno-47-23" href="#__codelineno-47-23"></a>            <span class="n">bee</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-47-24"><a id="__codelineno-47-24" name="__codelineno-47-24" href="#__codelineno-47-24"></a>            <span class="k">if</span> <span class="n">status</span> <span class="ow">is</span> <span class="n">make_scare</span><span class="p">:</span>
</span><span id="__span-47-25"><a id="__codelineno-47-25" name="__codelineno-47-25" href="#__codelineno-47-25"></a>                <span class="n">bee</span><span class="o">.</span><span class="n">has_been_scared</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-47-26"><a id="__codelineno-47-26" name="__codelineno-47-26" href="#__codelineno-47-26"></a>    <span class="n">bee</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">new_action</span>
</span></code></pre></div>
<hr />
<p>测试出现的第三个问题</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">ants</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">beehive</span><span class="p">,</span> <span class="n">layout</span> <span class="o">=</span> <span class="n">Hive</span><span class="p">(</span><span class="n">AssaultPlan</span><span class="p">()),</span> <span class="n">dry_layout</span>
</span><span id="__span-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">dimensions</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
</span><span id="__span-48-4"><a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">gamestate</span> <span class="o">=</span> <span class="n">GameState</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">beehive</span><span class="p">,</span> <span class="n">ant_types</span><span class="p">(),</span> <span class="n">layout</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">)</span>
</span><span id="__span-48-5"><a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Testing long status stack</span>
</span><span id="__span-48-6"><a id="__codelineno-48-6" name="__codelineno-48-6" href="#__codelineno-48-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">scary</span> <span class="o">=</span> <span class="n">ScaryThrower</span><span class="p">()</span>
</span><span id="__span-48-7"><a id="__codelineno-48-7" name="__codelineno-48-7" href="#__codelineno-48-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">slow</span> <span class="o">=</span> <span class="n">SlowThrower</span><span class="p">()</span>
</span><span id="__span-48-8"><a id="__codelineno-48-8" name="__codelineno-48-8" href="#__codelineno-48-8"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">bee</span> <span class="o">=</span> <span class="n">Bee</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="__span-48-9"><a id="__codelineno-48-9" name="__codelineno-48-9" href="#__codelineno-48-9"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">places</span><span class="p">[</span><span class="s2">&quot;tunnel_0_0&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_insect</span><span class="p">(</span><span class="n">scary</span><span class="p">)</span>
</span><span id="__span-48-10"><a id="__codelineno-48-10" name="__codelineno-48-10" href="#__codelineno-48-10"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">places</span><span class="p">[</span><span class="s2">&quot;tunnel_0_1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_insect</span><span class="p">(</span><span class="n">slow</span><span class="p">)</span>
</span><span id="__span-48-11"><a id="__codelineno-48-11" name="__codelineno-48-11" href="#__codelineno-48-11"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">places</span><span class="p">[</span><span class="s2">&quot;tunnel_0_3&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_insect</span><span class="p">(</span><span class="n">bee</span><span class="p">)</span>
</span><span id="__span-48-12"><a id="__codelineno-48-12" name="__codelineno-48-12" href="#__codelineno-48-12"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">scary</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span> <span class="c1"># scare bee once</span>
</span><span id="__span-48-13"><a id="__codelineno-48-13" name="__codelineno-48-13" href="#__codelineno-48-13"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-48-14"><a id="__codelineno-48-14" name="__codelineno-48-14" href="#__codelineno-48-14"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">bee</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span> <span class="c1"># scared</span>
</span><span id="__span-48-15"><a id="__codelineno-48-15" name="__codelineno-48-15" href="#__codelineno-48-15"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">bee</span><span class="o">.</span><span class="n">place</span><span class="o">.</span><span class="n">name</span>
</span><span id="__span-48-16"><a id="__codelineno-48-16" name="__codelineno-48-16" href="#__codelineno-48-16"></a><span class="s1">&#39;tunnel_0_4&#39;</span>
</span><span id="__span-48-17"><a id="__codelineno-48-17" name="__codelineno-48-17" href="#__codelineno-48-17"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span> <span class="c1"># slow bee three times</span>
</span><span id="__span-48-18"><a id="__codelineno-48-18" name="__codelineno-48-18" href="#__codelineno-48-18"></a><span class="o">...</span>    <span class="n">slow</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-48-19"><a id="__codelineno-48-19" name="__codelineno-48-19" href="#__codelineno-48-19"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-48-20"><a id="__codelineno-48-20" name="__codelineno-48-20" href="#__codelineno-48-20"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">bee</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span> <span class="c1"># scared, but also slowed thrice</span>
</span><span id="__span-48-21"><a id="__codelineno-48-21" name="__codelineno-48-21" href="#__codelineno-48-21"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">bee</span><span class="o">.</span><span class="n">place</span><span class="o">.</span><span class="n">name</span>
</span><span id="__span-48-22"><a id="__codelineno-48-22" name="__codelineno-48-22" href="#__codelineno-48-22"></a><span class="s1">&#39;tunnel_0_4&#39;</span>
</span><span id="__span-48-23"><a id="__codelineno-48-23" name="__codelineno-48-23" href="#__codelineno-48-23"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="__span-48-24"><a id="__codelineno-48-24" name="__codelineno-48-24" href="#__codelineno-48-24"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">bee</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span> <span class="c1"># scared and slowed thrice</span>
</span><span id="__span-48-25"><a id="__codelineno-48-25" name="__codelineno-48-25" href="#__codelineno-48-25"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">bee</span><span class="o">.</span><span class="n">place</span><span class="o">.</span><span class="n">name</span>
</span><span id="__span-48-26"><a id="__codelineno-48-26" name="__codelineno-48-26" href="#__codelineno-48-26"></a><span class="s1">&#39;tunnel_0_5&#39;</span>
</span><span id="__span-48-27"><a id="__codelineno-48-27" name="__codelineno-48-27" href="#__codelineno-48-27"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="__span-48-28"><a id="__codelineno-48-28" name="__codelineno-48-28" href="#__codelineno-48-28"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">bee</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span> <span class="c1"># slowed thrice</span>
</span><span id="__span-48-29"><a id="__codelineno-48-29" name="__codelineno-48-29" href="#__codelineno-48-29"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">bee</span><span class="o">.</span><span class="n">place</span><span class="o">.</span><span class="n">name</span>
</span><span id="__span-48-30"><a id="__codelineno-48-30" name="__codelineno-48-30" href="#__codelineno-48-30"></a><span class="s1">&#39;tunnel_0_4&#39;</span>
</span><span id="__span-48-31"><a id="__codelineno-48-31" name="__codelineno-48-31" href="#__codelineno-48-31"></a>
</span><span id="__span-48-32"><a id="__codelineno-48-32" name="__codelineno-48-32" href="#__codelineno-48-32"></a><span class="c1"># Error: expected</span>
</span><span id="__span-48-33"><a id="__codelineno-48-33" name="__codelineno-48-33" href="#__codelineno-48-33"></a><span class="c1">#     &#39;tunnel_0_5&#39;</span>
</span><span id="__span-48-34"><a id="__codelineno-48-34" name="__codelineno-48-34" href="#__codelineno-48-34"></a><span class="c1"># but got</span>
</span><span id="__span-48-35"><a id="__codelineno-48-35" name="__codelineno-48-35" href="#__codelineno-48-35"></a><span class="c1">#     &#39;tunnel_0_4&#39;</span>
</span></code></pre></div>
<p>我判断这个就是由于没有处理多状态的情况而产生的问题</p>
<p>然后开始观察测试的代码(因为前几个输出都没有报错)，经过思考以及梳理代码的具体流程，我大概明白了出现这种情况的原因(前面计中情况没错而后面错了)，问题可能是出在，多状态下，<em>恐吓</em>状态结束时，(我写的原本的代码中)会把实例的 <code>.action</code> 方法赋值成原来的 <code>action</code> 方法，就应该会导致某种矛盾</p>
<p>而前面没有出错的 是因为 <strong><em><mark>恐吓</mark></em><mark>之后的<em>减速</em>状态，是将<em>恐吓</em>后的新 <code>action</code> 方法设置成了旧 <code>action</code> 方法，所以会有种类似于 hw04 的 Q5 Joint Account 一样的感觉(即联合账户在取钱时，会调用原账户的方法，然后如果原账户也是一个联合账户，那么就会继续调用原账户的原账户的方法...)</mark></strong>，所以我的理解是这样</p>
<pre class="mermaid"><code>flowchart TD
subgraph g1[" "]
a1["bee"] ==&gt; b1["original action method"]
end
subgraph g2[" "]
a2["bee"] -.- b2["original action method"]
a2 ==&gt; c2["action method \n created by 1st status"]
c2 --&gt; b2
end
subgraph g3[" "]
a3["bee"] -.- b3["original action method"]
a3 -.- c3["action method \n created by 1st status"]
a3 ==&gt; d3["action method \n created by 2nd status"]
d3 --&gt; c3
c3 --&gt; b3
end
subgraph g4[" "]
a4["bee"] -.- b4["original action method"]
a4 -.- c4["action method \n created by 1st status"]
a4 -.- d4["action method \n created by 2nd status"]
a4 ==&gt; e4["action method \n created by 3rd status"]
e4 --&gt; d4
d4 --&gt; c4
c4 --&gt; b4
end
g1 --&gt; g2 --&gt; g3 --&gt; g4 --&gt; ...</code></pre>
<p>由于在状态剩余时间减为0之后，想不到如何把 <code>old_action</code> 给后面的 新action方法</p>
<p>所以将思路改变成，在剩余时间减为0之后，不结束函数，而是继续保留函数，并且剩余时间减为0之后就直接执行原本的 <code>old_action</code> 方法即可，所以</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">apply_status</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">bee</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a>    <span class="n">old_action</span> <span class="o">=</span> <span class="n">bee</span><span class="o">.</span><span class="n">action</span>
</span><span id="__span-49-3"><a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">new_action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">):</span>
</span><span id="__span-49-4"><a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a>        <span class="k">nonlocal</span> <span class="n">length</span>
</span><span id="__span-49-5"><a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a>        <span class="k">if</span> <span class="n">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-49-6"><a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a>            <span class="n">length</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="__span-49-7"><a id="__codelineno-49-7" name="__codelineno-49-7" href="#__codelineno-49-7"></a>            <span class="n">status</span><span class="p">(</span><span class="n">old_action</span><span class="p">,</span> <span class="n">bee</span><span class="p">)(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-49-8"><a id="__codelineno-49-8" name="__codelineno-49-8" href="#__codelineno-49-8"></a>            <span class="k">if</span> <span class="n">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-49-9"><a id="__codelineno-49-9" name="__codelineno-49-9" href="#__codelineno-49-9"></a>                <span class="n">bee</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-49-10"><a id="__codelineno-49-10" name="__codelineno-49-10" href="#__codelineno-49-10"></a>                <span class="k">if</span> <span class="n">status</span> <span class="ow">is</span> <span class="n">make_scare</span><span class="p">:</span>
</span><span id="__span-49-11"><a id="__codelineno-49-11" name="__codelineno-49-11" href="#__codelineno-49-11"></a>                    <span class="n">bee</span><span class="o">.</span><span class="n">has_been_scared</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-49-12"><a id="__codelineno-49-12" name="__codelineno-49-12" href="#__codelineno-49-12"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-49-13"><a id="__codelineno-49-13" name="__codelineno-49-13" href="#__codelineno-49-13"></a>            <span class="n">old_action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-49-14"><a id="__codelineno-49-14" name="__codelineno-49-14" href="#__codelineno-49-14"></a>    <span class="n">bee</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">new_action</span>
</span></code></pre></div>
<p>最终终于成功解决这个问题</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a>$<span class="w"> </span>python<span class="w"> </span>ok<span class="w"> </span>-q<span class="w"> </span>optional4<span class="w"> </span>--local
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a><span class="o">=====================================================================</span>
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a>Assignment:<span class="w"> </span>Project<span class="w"> </span><span class="m">3</span>:<span class="w"> </span>Ants<span class="w"> </span>Vs.<span class="w"> </span>SomeBees
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a>OK,<span class="w"> </span>version<span class="w"> </span>v1.18.1
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a><span class="o">=====================================================================</span>
</span><span id="__span-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a>
</span><span id="__span-50-7"><a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</span><span id="__span-50-8"><a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a>Running<span class="w"> </span>tests
</span><span id="__span-50-9"><a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a>
</span><span id="__span-50-10"><a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a>---------------------------------------------------------------------
</span><span id="__span-50-11"><a id="__codelineno-50-11" name="__codelineno-50-11" href="#__codelineno-50-11"></a>Test<span class="w"> </span>summary
</span><span id="__span-50-12"><a id="__codelineno-50-12" name="__codelineno-50-12" href="#__codelineno-50-12"></a><span class="w">    </span><span class="m">10</span><span class="w"> </span><span class="nb">test</span><span class="w"> </span>cases<span class="w"> </span>passed!<span class="w"> </span>No<span class="w"> </span>cases<span class="w"> </span>failed.
</span></code></pre></div>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Bee</span><span class="p">(</span><span class="n">Insect</span><span class="p">):</span>
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a>    <span class="o">...</span>
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a>    <span class="c1"># OVERRIDE CLASS ATTRIBUTES HERE</span>
</span><span id="__span-51-4"><a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a>    <span class="o">...</span>
</span><span id="__span-51-5"><a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a>    <span class="n">direction</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-51-6"><a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a>    <span class="n">has_been_scared</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-51-7"><a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a>
</span><span id="__span-51-8"><a id="__codelineno-51-8" name="__codelineno-51-8" href="#__codelineno-51-8"></a>
</span><span id="__span-51-9"><a id="__codelineno-51-9" name="__codelineno-51-9" href="#__codelineno-51-9"></a>    <span class="o">...</span>
</span><span id="__span-51-10"><a id="__codelineno-51-10" name="__codelineno-51-10" href="#__codelineno-51-10"></a>
</span><span id="__span-51-11"><a id="__codelineno-51-11" name="__codelineno-51-11" href="#__codelineno-51-11"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gamestate</span><span class="p">):</span>
</span><span id="__span-51-12"><a id="__codelineno-51-12" name="__codelineno-51-12" href="#__codelineno-51-12"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;A Bee&#39;s action stings the Ant that blocks its exit if it is blocked,</span>
</span><span id="__span-51-13"><a id="__codelineno-51-13" name="__codelineno-51-13" href="#__codelineno-51-13"></a><span class="sd">        or moves to the exit of its current place otherwise.</span>
</span><span id="__span-51-14"><a id="__codelineno-51-14" name="__codelineno-51-14" href="#__codelineno-51-14"></a>
</span><span id="__span-51-15"><a id="__codelineno-51-15" name="__codelineno-51-15" href="#__codelineno-51-15"></a><span class="sd">        gamestate -- The GameState, used to access game state information.</span>
</span><span id="__span-51-16"><a id="__codelineno-51-16" name="__codelineno-51-16" href="#__codelineno-51-16"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-51-17"><a id="__codelineno-51-17" name="__codelineno-51-17" href="#__codelineno-51-17"></a>        <span class="n">destination</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">place</span><span class="o">.</span><span class="n">exit</span>
</span><span id="__span-51-18"><a id="__codelineno-51-18" name="__codelineno-51-18" href="#__codelineno-51-18"></a>        <span class="c1"># Extra credit: Special handling for bee direction</span>
</span><span id="__span-51-19"><a id="__codelineno-51-19" name="__codelineno-51-19" href="#__codelineno-51-19"></a>        <span class="c1"># BEGIN EC</span>
</span><span id="__span-51-20"><a id="__codelineno-51-20" name="__codelineno-51-20" href="#__codelineno-51-20"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-51-21"><a id="__codelineno-51-21" name="__codelineno-51-21" href="#__codelineno-51-21"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span><span class="p">:</span>
</span><span id="__span-51-22"><a id="__codelineno-51-22" name="__codelineno-51-22" href="#__codelineno-51-22"></a>            <span class="n">destination</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span>
</span><span id="__span-51-23"><a id="__codelineno-51-23" name="__codelineno-51-23" href="#__codelineno-51-23"></a>        <span class="c1"># END EC</span>
</span><span id="__span-51-24"><a id="__codelineno-51-24" name="__codelineno-51-24" href="#__codelineno-51-24"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocked</span><span class="p">():</span>
</span><span id="__span-51-25"><a id="__codelineno-51-25" name="__codelineno-51-25" href="#__codelineno-51-25"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">place</span><span class="o">.</span><span class="n">ant</span><span class="p">)</span>
</span><span id="__span-51-26"><a id="__codelineno-51-26" name="__codelineno-51-26" href="#__codelineno-51-26"></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">armor</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">destination</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-51-27"><a id="__codelineno-51-27" name="__codelineno-51-27" href="#__codelineno-51-27"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">move_to</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>
</span><span id="__span-51-28"><a id="__codelineno-51-28" name="__codelineno-51-28" href="#__codelineno-51-28"></a>
</span><span id="__span-51-29"><a id="__codelineno-51-29" name="__codelineno-51-29" href="#__codelineno-51-29"></a>    <span class="o">...</span>
</span><span id="__span-51-30"><a id="__codelineno-51-30" name="__codelineno-51-30" href="#__codelineno-51-30"></a>
</span><span id="__span-51-31"><a id="__codelineno-51-31" name="__codelineno-51-31" href="#__codelineno-51-31"></a><span class="o">...</span>
</span><span id="__span-51-32"><a id="__codelineno-51-32" name="__codelineno-51-32" href="#__codelineno-51-32"></a>
</span><span id="__span-51-33"><a id="__codelineno-51-33" name="__codelineno-51-33" href="#__codelineno-51-33"></a><span class="c1">############</span>
</span><span id="__span-51-34"><a id="__codelineno-51-34" name="__codelineno-51-34" href="#__codelineno-51-34"></a><span class="c1"># Statuses #</span>
</span><span id="__span-51-35"><a id="__codelineno-51-35" name="__codelineno-51-35" href="#__codelineno-51-35"></a><span class="c1">############</span>
</span><span id="__span-51-36"><a id="__codelineno-51-36" name="__codelineno-51-36" href="#__codelineno-51-36"></a>
</span><span id="__span-51-37"><a id="__codelineno-51-37" name="__codelineno-51-37" href="#__codelineno-51-37"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_slow</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">bee</span><span class="p">):</span>
</span><span id="__span-51-38"><a id="__codelineno-51-38" name="__codelineno-51-38" href="#__codelineno-51-38"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a new action method that calls ACTION every other turn.</span>
</span><span id="__span-51-39"><a id="__codelineno-51-39" name="__codelineno-51-39" href="#__codelineno-51-39"></a>
</span><span id="__span-51-40"><a id="__codelineno-51-40" name="__codelineno-51-40" href="#__codelineno-51-40"></a><span class="sd">    action -- An action method of some Bee</span>
</span><span id="__span-51-41"><a id="__codelineno-51-41" name="__codelineno-51-41" href="#__codelineno-51-41"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-51-42"><a id="__codelineno-51-42" name="__codelineno-51-42" href="#__codelineno-51-42"></a>    <span class="c1"># BEGIN Problem Optional 4</span>
</span><span id="__span-51-43"><a id="__codelineno-51-43" name="__codelineno-51-43" href="#__codelineno-51-43"></a>    <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-51-44"><a id="__codelineno-51-44" name="__codelineno-51-44" href="#__codelineno-51-44"></a>    <span class="c1"># def new_action(gamestate):</span>
</span><span id="__span-51-45"><a id="__codelineno-51-45" name="__codelineno-51-45" href="#__codelineno-51-45"></a>    <span class="c1">#     if gamestate.time % 2 == 1:</span>
</span><span id="__span-51-46"><a id="__codelineno-51-46" name="__codelineno-51-46" href="#__codelineno-51-46"></a>    <span class="c1">#         action(bee, gamestate)</span>
</span><span id="__span-51-47"><a id="__codelineno-51-47" name="__codelineno-51-47" href="#__codelineno-51-47"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">new_action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">):</span>
</span><span id="__span-51-48"><a id="__codelineno-51-48" name="__codelineno-51-48" href="#__codelineno-51-48"></a>        <span class="k">if</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">time</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-51-49"><a id="__codelineno-51-49" name="__codelineno-51-49" href="#__codelineno-51-49"></a>            <span class="n">action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-51-50"><a id="__codelineno-51-50" name="__codelineno-51-50" href="#__codelineno-51-50"></a>    <span class="c1"># bee.action = new_action</span>
</span><span id="__span-51-51"><a id="__codelineno-51-51" name="__codelineno-51-51" href="#__codelineno-51-51"></a>    <span class="k">return</span> <span class="n">new_action</span>
</span><span id="__span-51-52"><a id="__codelineno-51-52" name="__codelineno-51-52" href="#__codelineno-51-52"></a>    <span class="c1"># END Problem Optional 4</span>
</span><span id="__span-51-53"><a id="__codelineno-51-53" name="__codelineno-51-53" href="#__codelineno-51-53"></a>
</span><span id="__span-51-54"><a id="__codelineno-51-54" name="__codelineno-51-54" href="#__codelineno-51-54"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_scare</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">bee</span><span class="p">):</span>
</span><span id="__span-51-55"><a id="__codelineno-51-55" name="__codelineno-51-55" href="#__codelineno-51-55"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a new action method that makes the bee go backwards.</span>
</span><span id="__span-51-56"><a id="__codelineno-51-56" name="__codelineno-51-56" href="#__codelineno-51-56"></a>
</span><span id="__span-51-57"><a id="__codelineno-51-57" name="__codelineno-51-57" href="#__codelineno-51-57"></a><span class="sd">    action -- An action method of some Bee</span>
</span><span id="__span-51-58"><a id="__codelineno-51-58" name="__codelineno-51-58" href="#__codelineno-51-58"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-51-59"><a id="__codelineno-51-59" name="__codelineno-51-59" href="#__codelineno-51-59"></a>    <span class="c1"># BEGIN Problem Optional 4</span>
</span><span id="__span-51-60"><a id="__codelineno-51-60" name="__codelineno-51-60" href="#__codelineno-51-60"></a>    <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-51-61"><a id="__codelineno-51-61" name="__codelineno-51-61" href="#__codelineno-51-61"></a>    <span class="c1"># bee.direction = bee.place.exit</span>
</span><span id="__span-51-62"><a id="__codelineno-51-62" name="__codelineno-51-62" href="#__codelineno-51-62"></a>    <span class="c1"># def new_action(gamestate):</span>
</span><span id="__span-51-63"><a id="__codelineno-51-63" name="__codelineno-51-63" href="#__codelineno-51-63"></a>    <span class="c1">#     bee.direction = bee.place if bee.place.entrance is gamestate.beehive else bee.place.entrance</span>
</span><span id="__span-51-64"><a id="__codelineno-51-64" name="__codelineno-51-64" href="#__codelineno-51-64"></a>    <span class="c1">#     action(bee, gamestate)</span>
</span><span id="__span-51-65"><a id="__codelineno-51-65" name="__codelineno-51-65" href="#__codelineno-51-65"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">new_action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">):</span>
</span><span id="__span-51-66"><a id="__codelineno-51-66" name="__codelineno-51-66" href="#__codelineno-51-66"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">bee</span><span class="o">.</span><span class="n">has_been_scared</span><span class="p">:</span>
</span><span id="__span-51-67"><a id="__codelineno-51-67" name="__codelineno-51-67" href="#__codelineno-51-67"></a>            <span class="n">bee</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">bee</span><span class="o">.</span><span class="n">place</span> <span class="k">if</span> <span class="n">bee</span><span class="o">.</span><span class="n">place</span><span class="o">.</span><span class="n">entrance</span> <span class="ow">is</span> <span class="n">gamestate</span><span class="o">.</span><span class="n">beehive</span> <span class="k">else</span> <span class="n">bee</span><span class="o">.</span><span class="n">place</span><span class="o">.</span><span class="n">entrance</span>
</span><span id="__span-51-68"><a id="__codelineno-51-68" name="__codelineno-51-68" href="#__codelineno-51-68"></a>        <span class="n">action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-51-69"><a id="__codelineno-51-69" name="__codelineno-51-69" href="#__codelineno-51-69"></a>    <span class="c1"># bee.action = new_action</span>
</span><span id="__span-51-70"><a id="__codelineno-51-70" name="__codelineno-51-70" href="#__codelineno-51-70"></a>    <span class="k">return</span> <span class="n">new_action</span>
</span><span id="__span-51-71"><a id="__codelineno-51-71" name="__codelineno-51-71" href="#__codelineno-51-71"></a>    <span class="c1"># END Problem Optional 4</span>
</span><span id="__span-51-72"><a id="__codelineno-51-72" name="__codelineno-51-72" href="#__codelineno-51-72"></a>
</span><span id="__span-51-73"><a id="__codelineno-51-73" name="__codelineno-51-73" href="#__codelineno-51-73"></a><span class="k">def</span><span class="w"> </span><span class="nf">apply_status</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">bee</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
</span><span id="__span-51-74"><a id="__codelineno-51-74" name="__codelineno-51-74" href="#__codelineno-51-74"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply a status to a BEE that lasts for LENGTH turns.&quot;&quot;&quot;</span>
</span><span id="__span-51-75"><a id="__codelineno-51-75" name="__codelineno-51-75" href="#__codelineno-51-75"></a>    <span class="c1"># BEGIN Problem Optional 4</span>
</span><span id="__span-51-76"><a id="__codelineno-51-76" name="__codelineno-51-76" href="#__codelineno-51-76"></a>    <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-51-77"><a id="__codelineno-51-77" name="__codelineno-51-77" href="#__codelineno-51-77"></a>    <span class="n">old_action</span> <span class="o">=</span> <span class="n">bee</span><span class="o">.</span><span class="n">action</span>
</span><span id="__span-51-78"><a id="__codelineno-51-78" name="__codelineno-51-78" href="#__codelineno-51-78"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">new_action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">):</span>
</span><span id="__span-51-79"><a id="__codelineno-51-79" name="__codelineno-51-79" href="#__codelineno-51-79"></a>        <span class="k">nonlocal</span> <span class="n">length</span>
</span><span id="__span-51-80"><a id="__codelineno-51-80" name="__codelineno-51-80" href="#__codelineno-51-80"></a>        <span class="k">if</span> <span class="n">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-51-81"><a id="__codelineno-51-81" name="__codelineno-51-81" href="#__codelineno-51-81"></a>            <span class="n">length</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="__span-51-82"><a id="__codelineno-51-82" name="__codelineno-51-82" href="#__codelineno-51-82"></a>            <span class="n">status</span><span class="p">(</span><span class="n">old_action</span><span class="p">,</span> <span class="n">bee</span><span class="p">)(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-51-83"><a id="__codelineno-51-83" name="__codelineno-51-83" href="#__codelineno-51-83"></a>            <span class="k">if</span> <span class="n">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-51-84"><a id="__codelineno-51-84" name="__codelineno-51-84" href="#__codelineno-51-84"></a>                <span class="c1"># bee.action = old_action</span>
</span><span id="__span-51-85"><a id="__codelineno-51-85" name="__codelineno-51-85" href="#__codelineno-51-85"></a>                <span class="n">bee</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-51-86"><a id="__codelineno-51-86" name="__codelineno-51-86" href="#__codelineno-51-86"></a>                <span class="k">if</span> <span class="n">status</span> <span class="ow">is</span> <span class="n">make_scare</span><span class="p">:</span>
</span><span id="__span-51-87"><a id="__codelineno-51-87" name="__codelineno-51-87" href="#__codelineno-51-87"></a>                    <span class="n">bee</span><span class="o">.</span><span class="n">has_been_scared</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-51-88"><a id="__codelineno-51-88" name="__codelineno-51-88" href="#__codelineno-51-88"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-51-89"><a id="__codelineno-51-89" name="__codelineno-51-89" href="#__codelineno-51-89"></a>            <span class="n">old_action</span><span class="p">(</span><span class="n">gamestate</span><span class="p">)</span>
</span><span id="__span-51-90"><a id="__codelineno-51-90" name="__codelineno-51-90" href="#__codelineno-51-90"></a>    <span class="c1"># bee.action = status(bee.action, bee)</span>
</span><span id="__span-51-91"><a id="__codelineno-51-91" name="__codelineno-51-91" href="#__codelineno-51-91"></a>    <span class="n">bee</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">new_action</span>
</span><span id="__span-51-92"><a id="__codelineno-51-92" name="__codelineno-51-92" href="#__codelineno-51-92"></a>    <span class="c1"># END Problem Optional 4</span>
</span><span id="__span-51-93"><a id="__codelineno-51-93" name="__codelineno-51-93" href="#__codelineno-51-93"></a>
</span><span id="__span-51-94"><a id="__codelineno-51-94" name="__codelineno-51-94" href="#__codelineno-51-94"></a>
</span><span id="__span-51-95"><a id="__codelineno-51-95" name="__codelineno-51-95" href="#__codelineno-51-95"></a><span class="k">class</span><span class="w"> </span><span class="nc">SlowThrower</span><span class="p">(</span><span class="n">ThrowerAnt</span><span class="p">):</span>
</span><span id="__span-51-96"><a id="__codelineno-51-96" name="__codelineno-51-96" href="#__codelineno-51-96"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;ThrowerAnt that causes Slow on Bees.&quot;&quot;&quot;</span>
</span><span id="__span-51-97"><a id="__codelineno-51-97" name="__codelineno-51-97" href="#__codelineno-51-97"></a>
</span><span id="__span-51-98"><a id="__codelineno-51-98" name="__codelineno-51-98" href="#__codelineno-51-98"></a>    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Slow&#39;</span>
</span><span id="__span-51-99"><a id="__codelineno-51-99" name="__codelineno-51-99" href="#__codelineno-51-99"></a>    <span class="n">food_cost</span> <span class="o">=</span> <span class="mi">4</span>
</span><span id="__span-51-100"><a id="__codelineno-51-100" name="__codelineno-51-100" href="#__codelineno-51-100"></a>    <span class="c1"># BEGIN Problem Optional 4</span>
</span><span id="__span-51-101"><a id="__codelineno-51-101" name="__codelineno-51-101" href="#__codelineno-51-101"></a>    <span class="c1"># implemented = False   # Change to True to view in the GUI</span>
</span><span id="__span-51-102"><a id="__codelineno-51-102" name="__codelineno-51-102" href="#__codelineno-51-102"></a>    <span class="n">implemented</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-51-103"><a id="__codelineno-51-103" name="__codelineno-51-103" href="#__codelineno-51-103"></a>    <span class="c1"># END Problem Optional 4</span>
</span><span id="__span-51-104"><a id="__codelineno-51-104" name="__codelineno-51-104" href="#__codelineno-51-104"></a>
</span><span id="__span-51-105"><a id="__codelineno-51-105" name="__codelineno-51-105" href="#__codelineno-51-105"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">throw_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
</span><span id="__span-51-106"><a id="__codelineno-51-106" name="__codelineno-51-106" href="#__codelineno-51-106"></a>        <span class="k">if</span> <span class="n">target</span><span class="p">:</span>
</span><span id="__span-51-107"><a id="__codelineno-51-107" name="__codelineno-51-107" href="#__codelineno-51-107"></a>            <span class="n">apply_status</span><span class="p">(</span><span class="n">make_slow</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="__span-51-108"><a id="__codelineno-51-108" name="__codelineno-51-108" href="#__codelineno-51-108"></a>
</span><span id="__span-51-109"><a id="__codelineno-51-109" name="__codelineno-51-109" href="#__codelineno-51-109"></a>
</span><span id="__span-51-110"><a id="__codelineno-51-110" name="__codelineno-51-110" href="#__codelineno-51-110"></a><span class="k">class</span><span class="w"> </span><span class="nc">ScaryThrower</span><span class="p">(</span><span class="n">ThrowerAnt</span><span class="p">):</span>
</span><span id="__span-51-111"><a id="__codelineno-51-111" name="__codelineno-51-111" href="#__codelineno-51-111"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;ThrowerAnt that intimidates Bees, making them back away instead of advancing.&quot;&quot;&quot;</span>
</span><span id="__span-51-112"><a id="__codelineno-51-112" name="__codelineno-51-112" href="#__codelineno-51-112"></a>
</span><span id="__span-51-113"><a id="__codelineno-51-113" name="__codelineno-51-113" href="#__codelineno-51-113"></a>    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Scary&#39;</span>
</span><span id="__span-51-114"><a id="__codelineno-51-114" name="__codelineno-51-114" href="#__codelineno-51-114"></a>    <span class="n">food_cost</span> <span class="o">=</span> <span class="mi">6</span>
</span><span id="__span-51-115"><a id="__codelineno-51-115" name="__codelineno-51-115" href="#__codelineno-51-115"></a>    <span class="c1"># BEGIN Problem Optional 4</span>
</span><span id="__span-51-116"><a id="__codelineno-51-116" name="__codelineno-51-116" href="#__codelineno-51-116"></a>    <span class="c1"># implemented = False   # Change to True to view in the GUI</span>
</span><span id="__span-51-117"><a id="__codelineno-51-117" name="__codelineno-51-117" href="#__codelineno-51-117"></a>    <span class="n">implemented</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-51-118"><a id="__codelineno-51-118" name="__codelineno-51-118" href="#__codelineno-51-118"></a>    <span class="c1"># END Problem Optional 4</span>
</span><span id="__span-51-119"><a id="__codelineno-51-119" name="__codelineno-51-119" href="#__codelineno-51-119"></a>
</span><span id="__span-51-120"><a id="__codelineno-51-120" name="__codelineno-51-120" href="#__codelineno-51-120"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">throw_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
</span><span id="__span-51-121"><a id="__codelineno-51-121" name="__codelineno-51-121" href="#__codelineno-51-121"></a>        <span class="c1"># BEGIN Problem Optional 4</span>
</span><span id="__span-51-122"><a id="__codelineno-51-122" name="__codelineno-51-122" href="#__codelineno-51-122"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-51-123"><a id="__codelineno-51-123" name="__codelineno-51-123" href="#__codelineno-51-123"></a>        <span class="k">if</span> <span class="n">target</span><span class="p">:</span>
</span><span id="__span-51-124"><a id="__codelineno-51-124" name="__codelineno-51-124" href="#__codelineno-51-124"></a>            <span class="n">apply_status</span><span class="p">(</span><span class="n">make_scare</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="__span-51-125"><a id="__codelineno-51-125" name="__codelineno-51-125" href="#__codelineno-51-125"></a>        <span class="c1"># END Problem Optional 4</span>
</span></code></pre></div>
</details>
<h2 id="lecture-20-representation">Lecture 20 Representation<a class="headerlink" href="#lecture-20-representation" title="Permanent link">&para;</a></h2>
<h3 id="1_7">1<a class="headerlink" href="#1_7" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_98.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_98" loading="lazy" src="../images/cs61a_98.png" /></a></p>
<p><code>repr()</code> 函数能把python表达式转换成在自然语言中<em>规范</em>的字符串，</p>
<p>返回的字符串和在终端中使用交互式的python，输入表达式时显示的结果一样(即如上图，<code>12e12</code> 和 <code>print(repr(12e12))</code> 显示的一样)</p>
<p><a class="glightbox" href="../images/cs61a_99.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_99" loading="lazy" src="../images/cs61a_99.png" /></a></p>
<p><code>str()</code> (类)可以将对象转换成(其对应的)字符串(感觉有点类似于 c++ 中 左移运算符 <code>&lt;&lt;</code> 的重载)，这个字符串和 使用 <code>print</code> 函数 显示的结果是相应的(或者说使用 <code>print</code> 函数会隐式地调用 <code>__str__</code> 方法)</p>
<p>上图中可以看到 <code>repr()</code> 和 <code>str()</code> 的不同之处</p>
<h3 id="2_7">2<a class="headerlink" href="#2_7" title="Permanent link">&para;</a></h3>
<p><code>repr()</code> 和 <code>str()</code> 都是通过调用传入参数的方法来实现功能</p>
<p><code>repr()</code> 会调用 <code>__repr__</code> 方法，</p>
<blockquote>
<div class="language-python highlight"><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">repr</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a>    <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></code></pre></div>
<p>使用类内方法可以避免在实例中修改了方法</p>
</blockquote>
<p><code>str()</code> 会调用 <code>__str__</code> 方法</p>
<blockquote>
<p>如果没有 <code>__str__</code> 方法，则调用 <code>__repr__</code> 方法</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">str</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-53-2"><a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a>    <span class="n">t</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-53-3"><a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a>    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="s1">&#39;__str__&#39;</span><span class="p">):</span>
</span><span id="__span-53-4"><a id="__codelineno-53-4" name="__codelineno-53-4" href="#__codelineno-53-4"></a>        <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="fm">__str__</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-53-5"><a id="__codelineno-53-5" name="__codelineno-53-5" href="#__codelineno-53-5"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-53-6"><a id="__codelineno-53-6" name="__codelineno-53-6" href="#__codelineno-53-6"></a>        <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></code></pre></div>
</blockquote>
<h3 id="3_5">3<a class="headerlink" href="#3_5" title="Permanent link">&para;</a></h3>
<p>如果一个类没有 <code>__str__</code> 方法，在直接调用 <code>__str__</code> 方法时，会改为调用 <code>__repr__</code> 方法</p>
<blockquote>
<div class="language-python highlight"><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Bear</span><span class="p">:</span>
</span><span id="__span-54-2"><a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A Bear.&quot;&quot;&quot;</span>
</span><span id="__span-54-3"><a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a>    
</span><span id="__span-54-4"><a id="__codelineno-54-4" name="__codelineno-54-4" href="#__codelineno-54-4"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-54-5"><a id="__codelineno-54-5" name="__codelineno-54-5" href="#__codelineno-54-5"></a>        <span class="k">return</span> <span class="s1">&#39;Bear()&#39;</span>
</span><span id="__span-54-6"><a id="__codelineno-54-6" name="__codelineno-54-6" href="#__codelineno-54-6"></a>    
</span><span id="__span-54-7"><a id="__codelineno-54-7" name="__codelineno-54-7" href="#__codelineno-54-7"></a><span class="n">oski</span> <span class="o">=</span> <span class="n">Bear</span><span class="p">()</span>
</span><span id="__span-54-8"><a id="__codelineno-54-8" name="__codelineno-54-8" href="#__codelineno-54-8"></a><span class="nb">print</span><span class="p">(</span><span class="n">oski</span><span class="p">)</span>
</span><span id="__span-54-9"><a id="__codelineno-54-9" name="__codelineno-54-9" href="#__codelineno-54-9"></a><span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">oski</span><span class="p">))</span>
</span><span id="__span-54-10"><a id="__codelineno-54-10" name="__codelineno-54-10" href="#__codelineno-54-10"></a><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">oski</span><span class="p">))</span>
</span><span id="__span-54-11"><a id="__codelineno-54-11" name="__codelineno-54-11" href="#__codelineno-54-11"></a><span class="nb">print</span><span class="p">(</span><span class="n">oski</span><span class="o">.</span><span class="fm">__str__</span><span class="p">())</span>
</span><span id="__span-54-12"><a id="__codelineno-54-12" name="__codelineno-54-12" href="#__codelineno-54-12"></a><span class="nb">print</span><span class="p">(</span><span class="n">oski</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">())</span>
</span></code></pre></div>
<p>运行以上代码，会显示</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a>Bear<span class="o">()</span>
</span><span id="__span-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a>Bear<span class="o">()</span>
</span><span id="__span-55-3"><a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a>Bear<span class="o">()</span>
</span><span id="__span-55-4"><a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a>Bear<span class="o">()</span>
</span><span id="__span-55-5"><a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a>Bear<span class="o">()</span>
</span></code></pre></div>
</blockquote>
<h3 id="4_4">4<a class="headerlink" href="#4_4" title="Permanent link">&para;</a></h3>
<p>字符串可以使用 <code>.format()</code> 来填入参数(需要注意序号/下标与传入顺序对应)</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="__span-56-2"><a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">6</span>
</span><span id="__span-56-3"><a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="s2">&quot;x + y = </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
</span><span id="__span-56-4"><a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a><span class="s1">&#39;x + y = 11&#39;</span>
</span><span id="__span-56-5"><a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="s2">&quot;x + y = </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="__span-56-6"><a id="__codelineno-56-6" name="__codelineno-56-6" href="#__codelineno-56-6"></a><span class="s1">&#39;x + y = 6&#39;</span>
</span></code></pre></div>
<p>或者也可以使用</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="sa">f</span><span class="s2">&quot;x + y = </span><span class="si">{</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-57-2"><a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a><span class="s1">&#39;x + y = 11&#39;</span>
</span></code></pre></div>
<h3 id="5_4">5<a class="headerlink" href="#5_4" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_100.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_100" loading="lazy" src="../images/cs61a_100.png" /></a></p>
<p>python的一些特殊方法名(前后都有两个下划线的方法)</p>
<h3 id="6_2">6<a class="headerlink" href="#6_2" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_101.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_101" loading="lazy" src="../images/cs61a_101.png" /></a></p>
<p><code>__add__</code> 方法是实例在加号左边时使用， <code>__radd__</code> 方法是实例在加号右边时使用，</p>
<blockquote>
<p>John 直接添加了一行代码</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="fm">__radd__</span> <span class="o">=</span> <span class="fm">__add__</span>
</span></code></pre></div>
</blockquote>
<h2 id="lecture-20-qa">Lecture 20 Q&amp;A<a class="headerlink" href="#lecture-20-qa" title="Permanent link">&para;</a></h2>
<h3 id="1_8">1<a class="headerlink" href="#1_8" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_102.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_102" loading="lazy" src="../images/cs61a_102.png" /></a></p>
<p><code>type</code> 和 <code>isinstance</code> 的区别</p>
<ul>
<li><code>isinstance</code> 会判断一个实例是否是某个类或它的子类们</li>
<li><code>type</code> 只会返回实例具体的类</li>
</ul>
<h3 id="2_8">2<a class="headerlink" href="#2_8" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_103.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_103" loading="lazy" src="../images/cs61a_103.png" /></a></p>
<p>John 使用递归和 <code>yield</code> 语句来实现输出树的所有根到叶子的路径的方法</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">print_all_paths</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
</span><span id="__span-59-2"><a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Print all the paths from the root to a leaf.</span>
</span><span id="__span-59-3"><a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a>
</span><span id="__span-59-4"><a id="__codelineno-59-4" name="__codelineno-59-4" href="#__codelineno-59-4"></a><span class="sd">    &gt;&gt;&gt; t = tree(1, [tree(2, [tree(3), tree(5)]), tree(4)])</span>
</span><span id="__span-59-5"><a id="__codelineno-59-5" name="__codelineno-59-5" href="#__codelineno-59-5"></a><span class="sd">    &gt;&gt;&gt; print_all_paths(t)</span>
</span><span id="__span-59-6"><a id="__codelineno-59-6" name="__codelineno-59-6" href="#__codelineno-59-6"></a><span class="sd">    [1, 2, 3]</span>
</span><span id="__span-59-7"><a id="__codelineno-59-7" name="__codelineno-59-7" href="#__codelineno-59-7"></a><span class="sd">    [1, 2, 5]</span>
</span><span id="__span-59-8"><a id="__codelineno-59-8" name="__codelineno-59-8" href="#__codelineno-59-8"></a><span class="sd">    [1, 4]</span>
</span><span id="__span-59-9"><a id="__codelineno-59-9" name="__codelineno-59-9" href="#__codelineno-59-9"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-59-10"><a id="__codelineno-59-10" name="__codelineno-59-10" href="#__codelineno-59-10"></a>    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">all_paths</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
</span><span id="__span-59-11"><a id="__codelineno-59-11" name="__codelineno-59-11" href="#__codelineno-59-11"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="__span-59-12"><a id="__codelineno-59-12" name="__codelineno-59-12" href="#__codelineno-59-12"></a>
</span><span id="__span-59-13"><a id="__codelineno-59-13" name="__codelineno-59-13" href="#__codelineno-59-13"></a><span class="k">def</span><span class="w"> </span><span class="nf">all_paths</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
</span><span id="__span-59-14"><a id="__codelineno-59-14" name="__codelineno-59-14" href="#__codelineno-59-14"></a>    <span class="k">if</span> <span class="n">is_leaf</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
</span><span id="__span-59-15"><a id="__codelineno-59-15" name="__codelineno-59-15" href="#__codelineno-59-15"></a>        <span class="k">yield</span> <span class="p">[</span><span class="n">label</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span>
</span><span id="__span-59-16"><a id="__codelineno-59-16" name="__codelineno-59-16" href="#__codelineno-59-16"></a>    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">branches</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
</span><span id="__span-59-17"><a id="__codelineno-59-17" name="__codelineno-59-17" href="#__codelineno-59-17"></a>        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">all_paths</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>   <span class="c1"># path might be [2, 3]</span>
</span><span id="__span-59-18"><a id="__codelineno-59-18" name="__codelineno-59-18" href="#__codelineno-59-18"></a>            <span class="k">yield</span> <span class="p">[</span><span class="n">label</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span> <span class="o">+</span> <span class="n">path</span> <span class="c1"># yielding [1, 2, 3]</span>
</span></code></pre></div>
<h2 id="lecture-21-composition">Lecture 21 Composition<a class="headerlink" href="#lecture-21-composition" title="Permanent link">&para;</a></h2>
<h3 id="1_9">1<a class="headerlink" href="#1_9" title="Permanent link">&para;</a></h3>
<p>John 为自定义的 <em>链表 Linked List</em> 类 用递归的方式编写了类似于python内置的 <code>range</code> <code>map</code> <code>filter</code> 函数</p>
<p><a class="glightbox" href="../images/cs61a_104.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_104" loading="lazy" src="../images/cs61a_104.png" /></a></p>
<blockquote>
<div class="language-python highlight"><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Link</span><span class="p">:</span>
</span><span id="__span-60-2"><a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a>    <span class="n">empty</span> <span class="o">=</span> <span class="p">()</span>
</span><span id="__span-60-3"><a id="__codelineno-60-3" name="__codelineno-60-3" href="#__codelineno-60-3"></a>    
</span><span id="__span-60-4"><a id="__codelineno-60-4" name="__codelineno-60-4" href="#__codelineno-60-4"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">rest</span><span class="o">=</span><span class="n">empty</span><span class="p">):</span>
</span><span id="__span-60-5"><a id="__codelineno-60-5" name="__codelineno-60-5" href="#__codelineno-60-5"></a>        <span class="k">assert</span> <span class="n">rest</span> <span class="ow">is</span> <span class="n">Link</span><span class="o">.</span><span class="n">empty</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rest</span><span class="p">,</span> <span class="n">Link</span><span class="p">)</span>
</span><span id="__span-60-6"><a id="__codelineno-60-6" name="__codelineno-60-6" href="#__codelineno-60-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">first</span> <span class="o">=</span> <span class="n">first</span>
</span><span id="__span-60-7"><a id="__codelineno-60-7" name="__codelineno-60-7" href="#__codelineno-60-7"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rest</span> <span class="o">=</span> <span class="n">rest</span>
</span><span id="__span-60-8"><a id="__codelineno-60-8" name="__codelineno-60-8" href="#__codelineno-60-8"></a>        
</span><span id="__span-60-9"><a id="__codelineno-60-9" name="__codelineno-60-9" href="#__codelineno-60-9"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-60-10"><a id="__codelineno-60-10" name="__codelineno-60-10" href="#__codelineno-60-10"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rest</span><span class="p">:</span>
</span><span id="__span-60-11"><a id="__codelineno-60-11" name="__codelineno-60-11" href="#__codelineno-60-11"></a>            <span class="n">rest_repr</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rest</span><span class="p">)</span>
</span><span id="__span-60-12"><a id="__codelineno-60-12" name="__codelineno-60-12" href="#__codelineno-60-12"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-60-13"><a id="__codelineno-60-13" name="__codelineno-60-13" href="#__codelineno-60-13"></a>            <span class="n">rest_repr</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="__span-60-14"><a id="__codelineno-60-14" name="__codelineno-60-14" href="#__codelineno-60-14"></a>        <span class="k">return</span> <span class="s1">&#39;Link()&#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">)</span> <span class="o">+</span> <span class="n">rest_repr</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
</span><span id="__span-60-15"><a id="__codelineno-60-15" name="__codelineno-60-15" href="#__codelineno-60-15"></a>    
</span><span id="__span-60-16"><a id="__codelineno-60-16" name="__codelineno-60-16" href="#__codelineno-60-16"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-60-17"><a id="__codelineno-60-17" name="__codelineno-60-17" href="#__codelineno-60-17"></a>        <span class="n">string</span> <span class="o">=</span> <span class="s1">&#39;&lt;&#39;</span>
</span><span id="__span-60-18"><a id="__codelineno-60-18" name="__codelineno-60-18" href="#__codelineno-60-18"></a>        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">rest</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">Link</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-60-19"><a id="__codelineno-60-19" name="__codelineno-60-19" href="#__codelineno-60-19"></a>            <span class="n">string</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>
</span><span id="__span-60-20"><a id="__codelineno-60-20" name="__codelineno-60-20" href="#__codelineno-60-20"></a>            <span class="n">slef</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rest</span>
</span><span id="__span-60-21"><a id="__codelineno-60-21" name="__codelineno-60-21" href="#__codelineno-60-21"></a>        <span class="k">return</span> <span class="n">string</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&gt;&#39;</span>
</span></code></pre></div>
</blockquote>
<div class="language-python highlight"><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">range_link</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
</span><span id="__span-61-2"><a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a Link containing consecutive integers from start to end.</span>
</span><span id="__span-61-3"><a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a>
</span><span id="__span-61-4"><a id="__codelineno-61-4" name="__codelineno-61-4" href="#__codelineno-61-4"></a><span class="sd">    &gt;&gt;&gt; range_link(3, 6)</span>
</span><span id="__span-61-5"><a id="__codelineno-61-5" name="__codelineno-61-5" href="#__codelineno-61-5"></a><span class="sd">    Link(e, Link(4, Link(5)))</span>
</span><span id="__span-61-6"><a id="__codelineno-61-6" name="__codelineno-61-6" href="#__codelineno-61-6"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-61-7"><a id="__codelineno-61-7" name="__codelineno-61-7" href="#__codelineno-61-7"></a>    <span class="k">if</span> <span class="n">start</span> <span class="o">&gt;=</span> <span class="n">end</span><span class="p">:</span>
</span><span id="__span-61-8"><a id="__codelineno-61-8" name="__codelineno-61-8" href="#__codelineno-61-8"></a>        <span class="k">return</span> <span class="n">Link</span><span class="o">.</span><span class="n">empty</span>
</span><span id="__span-61-9"><a id="__codelineno-61-9" name="__codelineno-61-9" href="#__codelineno-61-9"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-61-10"><a id="__codelineno-61-10" name="__codelineno-61-10" href="#__codelineno-61-10"></a>        <span class="k">return</span> <span class="n">Link</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">range_link</span><span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="p">))</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">map_link</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
</span><span id="__span-62-2"><a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a link that contains f(x) for each x in Link s.</span>
</span><span id="__span-62-3"><a id="__codelineno-62-3" name="__codelineno-62-3" href="#__codelineno-62-3"></a>
</span><span id="__span-62-4"><a id="__codelineno-62-4" name="__codelineno-62-4" href="#__codelineno-62-4"></a><span class="sd">    &gt;&gt;&gt; map_link(square, range_link(3, 6))</span>
</span><span id="__span-62-5"><a id="__codelineno-62-5" name="__codelineno-62-5" href="#__codelineno-62-5"></a><span class="sd">    Link(9, Link(16, Link(25)))</span>
</span><span id="__span-62-6"><a id="__codelineno-62-6" name="__codelineno-62-6" href="#__codelineno-62-6"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-62-7"><a id="__codelineno-62-7" name="__codelineno-62-7" href="#__codelineno-62-7"></a>    <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="n">Link</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-62-8"><a id="__codelineno-62-8" name="__codelineno-62-8" href="#__codelineno-62-8"></a>        <span class="k">return</span> <span class="n">s</span>
</span><span id="__span-62-9"><a id="__codelineno-62-9" name="__codelineno-62-9" href="#__codelineno-62-9"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-62-10"><a id="__codelineno-62-10" name="__codelineno-62-10" href="#__codelineno-62-10"></a>        <span class="k">return</span> <span class="n">Link</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">first</span><span class="p">),</span> <span class="n">map_link</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">rest</span><span class="p">))</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">filter_link</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
</span><span id="__span-63-2"><a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a Link that contains only the elements x of Link s for which f(x) is a true value.</span>
</span><span id="__span-63-3"><a id="__codelineno-63-3" name="__codelineno-63-3" href="#__codelineno-63-3"></a>
</span><span id="__span-63-4"><a id="__codelineno-63-4" name="__codelineno-63-4" href="#__codelineno-63-4"></a><span class="sd">    &gt;&gt;&gt; filter_link(odd, range_link(3, 6))</span>
</span><span id="__span-63-5"><a id="__codelineno-63-5" name="__codelineno-63-5" href="#__codelineno-63-5"></a><span class="sd">    Link(3, Link(5))</span>
</span><span id="__span-63-6"><a id="__codelineno-63-6" name="__codelineno-63-6" href="#__codelineno-63-6"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-63-7"><a id="__codelineno-63-7" name="__codelineno-63-7" href="#__codelineno-63-7"></a>    <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="n">Link</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-63-8"><a id="__codelineno-63-8" name="__codelineno-63-8" href="#__codelineno-63-8"></a>        <span class="k">return</span> <span class="n">s</span>
</span><span id="__span-63-9"><a id="__codelineno-63-9" name="__codelineno-63-9" href="#__codelineno-63-9"></a>    <span class="n">filtered_rest</span> <span class="o">=</span> <span class="n">filter_link</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">rest</span><span class="p">)</span>
</span><span id="__span-63-10"><a id="__codelineno-63-10" name="__codelineno-63-10" href="#__codelineno-63-10"></a>    <span class="k">if</span> <span class="n">f</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">first</span><span class="p">):</span>
</span><span id="__span-63-11"><a id="__codelineno-63-11" name="__codelineno-63-11" href="#__codelineno-63-11"></a>        <span class="k">return</span> <span class="n">Link</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">filtered_rest</span><span class="p">)</span>
</span><span id="__span-63-12"><a id="__codelineno-63-12" name="__codelineno-63-12" href="#__codelineno-63-12"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-63-13"><a id="__codelineno-63-13" name="__codelineno-63-13" href="#__codelineno-63-13"></a>        <span class="k">return</span> <span class="n">filtered_rest</span>
</span></code></pre></div>
<h3 id="2_9">2<a class="headerlink" href="#2_9" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_105.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_105" loading="lazy" src="../images/cs61a_105.png" /></a></p>
<p>John 用递归的方式写的 自定义链表结构 的 <code>add</code> 函数(让我觉得看起来很简洁)</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
</span><span id="__span-64-2"><a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add v to s, returning modified s.</span>
</span><span id="__span-64-3"><a id="__codelineno-64-3" name="__codelineno-64-3" href="#__codelineno-64-3"></a>
</span><span id="__span-64-4"><a id="__codelineno-64-4" name="__codelineno-64-4" href="#__codelineno-64-4"></a><span class="sd">    &gt;&gt;&gt; s = Link(1, Link(3, Link(5)))</span>
</span><span id="__span-64-5"><a id="__codelineno-64-5" name="__codelineno-64-5" href="#__codelineno-64-5"></a><span class="sd">    &gt;&gt;&gt; add(s, 0)</span>
</span><span id="__span-64-6"><a id="__codelineno-64-6" name="__codelineno-64-6" href="#__codelineno-64-6"></a><span class="sd">    Link(0, Link(1, Link(3, Link(5))))</span>
</span><span id="__span-64-7"><a id="__codelineno-64-7" name="__codelineno-64-7" href="#__codelineno-64-7"></a><span class="sd">    &gt;&gt;&gt; add(s, 3)</span>
</span><span id="__span-64-8"><a id="__codelineno-64-8" name="__codelineno-64-8" href="#__codelineno-64-8"></a><span class="sd">    Link(0, Link(1, Link(3, Link(5))))</span>
</span><span id="__span-64-9"><a id="__codelineno-64-9" name="__codelineno-64-9" href="#__codelineno-64-9"></a><span class="sd">    &gt;&gt;&gt; add(s, 4)</span>
</span><span id="__span-64-10"><a id="__codelineno-64-10" name="__codelineno-64-10" href="#__codelineno-64-10"></a><span class="sd">    Link(0, Link(1, Link(3, Link(4, Link(5)))))</span>
</span><span id="__span-64-11"><a id="__codelineno-64-11" name="__codelineno-64-11" href="#__codelineno-64-11"></a><span class="sd">    &gt;&gt;&gt; add(s, 6)</span>
</span><span id="__span-64-12"><a id="__codelineno-64-12" name="__codelineno-64-12" href="#__codelineno-64-12"></a><span class="sd">    Link(0, Link(1, Link(3, Link(4, Link(5, Link(6))))))</span>
</span><span id="__span-64-13"><a id="__codelineno-64-13" name="__codelineno-64-13" href="#__codelineno-64-13"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-64-14"><a id="__codelineno-64-14" name="__codelineno-64-14" href="#__codelineno-64-14"></a>    <span class="k">assert</span> <span class="n">s</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">Link</span><span class="o">.</span><span class="n">empty</span>
</span><span id="__span-64-15"><a id="__codelineno-64-15" name="__codelineno-64-15" href="#__codelineno-64-15"></a>    <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">first</span> <span class="o">&gt;</span> <span class="n">v</span><span class="p">:</span>
</span><span id="__span-64-16"><a id="__codelineno-64-16" name="__codelineno-64-16" href="#__codelineno-64-16"></a>        <span class="n">s</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">rest</span> <span class="o">=</span> <span class="n">v</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">rest</span><span class="p">)</span>
</span><span id="__span-64-17"><a id="__codelineno-64-17" name="__codelineno-64-17" href="#__codelineno-64-17"></a>    <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">first</span> <span class="o">&lt;</span> <span class="n">v</span> <span class="ow">and</span> <span class="n">empty</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">rest</span><span class="p">):</span>
</span><span id="__span-64-18"><a id="__codelineno-64-18" name="__codelineno-64-18" href="#__codelineno-64-18"></a>        <span class="n">s</span><span class="o">.</span><span class="n">rest</span> <span class="o">=</span> <span class="n">Link</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="__span-64-19"><a id="__codelineno-64-19" name="__codelineno-64-19" href="#__codelineno-64-19"></a>    <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">first</span> <span class="o">&lt;</span> <span class="n">v</span><span class="p">:</span>
</span><span id="__span-64-20"><a id="__codelineno-64-20" name="__codelineno-64-20" href="#__codelineno-64-20"></a>        <span class="n">add</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</span><span id="__span-64-21"><a id="__codelineno-64-21" name="__codelineno-64-21" href="#__codelineno-64-21"></a>    <span class="k">return</span> <span class="n">s</span>
</span></code></pre></div>
<h3 id="3_6">3<a class="headerlink" href="#3_6" title="Permanent link">&para;</a></h3>
<p>John 展示的 <code>Tree</code> 类的实现代码</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Tree</span><span class="p">:</span>
</span><span id="__span-65-2"><a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A tree is a label and a list of branches.&quot;&quot;&quot;</span>
</span><span id="__span-65-3"><a id="__codelineno-65-3" name="__codelineno-65-3" href="#__codelineno-65-3"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">branches</span><span class="o">=</span><span class="p">[]):</span>
</span><span id="__span-65-4"><a id="__codelineno-65-4" name="__codelineno-65-4" href="#__codelineno-65-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
</span><span id="__span-65-5"><a id="__codelineno-65-5" name="__codelineno-65-5" href="#__codelineno-65-5"></a>        <span class="k">for</span> <span class="n">branch</span> <span class="ow">in</span> <span class="n">branches</span><span class="p">:</span>
</span><span id="__span-65-6"><a id="__codelineno-65-6" name="__codelineno-65-6" href="#__codelineno-65-6"></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">branch</span><span class="p">,</span> <span class="n">Tree</span><span class="p">)</span>
</span><span id="__span-65-7"><a id="__codelineno-65-7" name="__codelineno-65-7" href="#__codelineno-65-7"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">branches</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">branches</span><span class="p">)</span>
</span><span id="__span-65-8"><a id="__codelineno-65-8" name="__codelineno-65-8" href="#__codelineno-65-8"></a>
</span><span id="__span-65-9"><a id="__codelineno-65-9" name="__codelineno-65-9" href="#__codelineno-65-9"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-65-10"><a id="__codelineno-65-10" name="__codelineno-65-10" href="#__codelineno-65-10"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">branches</span><span class="p">:</span>
</span><span id="__span-65-11"><a id="__codelineno-65-11" name="__codelineno-65-11" href="#__codelineno-65-11"></a>            <span class="n">branch_str</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">branches</span><span class="p">)</span>
</span><span id="__span-65-12"><a id="__codelineno-65-12" name="__codelineno-65-12" href="#__codelineno-65-12"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-65-13"><a id="__codelineno-65-13" name="__codelineno-65-13" href="#__codelineno-65-13"></a>            <span class="n">branch_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="__span-65-14"><a id="__codelineno-65-14" name="__codelineno-65-14" href="#__codelineno-65-14"></a>        <span class="k">return</span> <span class="s1">&#39;Tree(</span><span class="si">{0}{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">),</span> <span class="n">branch_str</span><span class="p">)</span>
</span><span id="__span-65-15"><a id="__codelineno-65-15" name="__codelineno-65-15" href="#__codelineno-65-15"></a>
</span><span id="__span-65-16"><a id="__codelineno-65-16" name="__codelineno-65-16" href="#__codelineno-65-16"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-65-17"><a id="__codelineno-65-17" name="__codelineno-65-17" href="#__codelineno-65-17"></a>        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indented</span><span class="p">())</span>
</span><span id="__span-65-18"><a id="__codelineno-65-18" name="__codelineno-65-18" href="#__codelineno-65-18"></a>
</span><span id="__span-65-19"><a id="__codelineno-65-19" name="__codelineno-65-19" href="#__codelineno-65-19"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">indented</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-65-20"><a id="__codelineno-65-20" name="__codelineno-65-20" href="#__codelineno-65-20"></a>        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-65-21"><a id="__codelineno-65-21" name="__codelineno-65-21" href="#__codelineno-65-21"></a>        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">branches</span><span class="p">:</span>
</span><span id="__span-65-22"><a id="__codelineno-65-22" name="__codelineno-65-22" href="#__codelineno-65-22"></a>            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">b</span><span class="o">.</span><span class="n">indented</span><span class="p">():</span>
</span><span id="__span-65-23"><a id="__codelineno-65-23" name="__codelineno-65-23" href="#__codelineno-65-23"></a>                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;  &#39;</span> <span class="o">+</span> <span class="n">line</span><span class="p">)</span>
</span><span id="__span-65-24"><a id="__codelineno-65-24" name="__codelineno-65-24" href="#__codelineno-65-24"></a>        <span class="k">return</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">)]</span> <span class="o">+</span> <span class="n">lines</span>
</span><span id="__span-65-25"><a id="__codelineno-65-25" name="__codelineno-65-25" href="#__codelineno-65-25"></a>
</span><span id="__span-65-26"><a id="__codelineno-65-26" name="__codelineno-65-26" href="#__codelineno-65-26"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_leaf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-65-27"><a id="__codelineno-65-27" name="__codelineno-65-27" href="#__codelineno-65-27"></a>        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">branches</span>
</span></code></pre></div>
<h2 id="hw-05">HW 05<a class="headerlink" href="#hw-05" title="Permanent link">&para;</a></h2>
<h3 id="1_10">1<a class="headerlink" href="#1_10" title="Permanent link">&para;</a></h3>
<p>Q5 中，本来我以为</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a><span class="k">return</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">preorder</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">branches</span><span class="p">])</span>
</span></code></pre></div>
<p>能实现，但是显示没有返回的值，然后进行测试发现，<strong>列表的 <code>.append()</code> 和 <code>.extend()</code> 方法没有返回值</strong></p>
<h3 id="2_10">2<a class="headerlink" href="#2_10" title="Permanent link">&para;</a></h3>
<p>Q6，我的两种实现方式</p>
<ul>
<li>
<p>按照原本提供的框架</p>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-67-1"><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">path_yielder</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="__span-67-2"><a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a>    <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-67-3"><a id="__codelineno-67-3" name="__codelineno-67-3" href="#__codelineno-67-3"></a>
</span><span id="__span-67-4"><a id="__codelineno-67-4" name="__codelineno-67-4" href="#__codelineno-67-4"></a>    <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">value</span><span class="p">:</span>
</span><span id="__span-67-5"><a id="__codelineno-67-5" name="__codelineno-67-5" href="#__codelineno-67-5"></a>        <span class="k">yield</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">label</span><span class="p">]</span>
</span><span id="__span-67-6"><a id="__codelineno-67-6" name="__codelineno-67-6" href="#__codelineno-67-6"></a>    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">branches</span><span class="p">:</span>
</span><span id="__span-67-7"><a id="__codelineno-67-7" name="__codelineno-67-7" href="#__codelineno-67-7"></a>        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">path_yielder</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="__span-67-8"><a id="__codelineno-67-8" name="__codelineno-67-8" href="#__codelineno-67-8"></a>
</span><span id="__span-67-9"><a id="__codelineno-67-9" name="__codelineno-67-9" href="#__codelineno-67-9"></a>            <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-67-10"><a id="__codelineno-67-10" name="__codelineno-67-10" href="#__codelineno-67-10"></a>            <span class="k">yield</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">label</span><span class="p">]</span> <span class="o">+</span> <span class="n">path</span>
</span></code></pre></div>
</details>
</li>
<li>
<p>我整合成一行代码</p>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-68-1"><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">path_yielder</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="__span-68-2"><a id="__codelineno-68-2" name="__codelineno-68-2" href="#__codelineno-68-2"></a>    <span class="k">yield from</span> <span class="p">(([[</span><span class="n">t</span><span class="o">.</span><span class="n">label</span><span class="p">]]</span> <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">value</span> <span class="k">else</span> <span class="p">[])</span> <span class="o">+</span>
</span><span id="__span-68-3"><a id="__codelineno-68-3" name="__codelineno-68-3" href="#__codelineno-68-3"></a>                <span class="nb">sum</span><span class="p">([[[</span><span class="n">t</span><span class="o">.</span><span class="n">label</span><span class="p">]</span> <span class="o">+</span> <span class="n">path</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">path_yielder</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">value</span><span class="p">)]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">branches</span><span class="p">],</span> <span class="n">start</span><span class="o">=</span><span class="p">[]))</span>
</span></code></pre></div>
</details>
</li>
</ul>
<h3 id="3_7">3<a class="headerlink" href="#3_7" title="Permanent link">&para;</a></h3>
<p>Q3中，原本我是用递归的方式来实现，但是会稍微麻烦一些，</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-69-1"><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">store_digits</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="__span-69-2"><a id="__codelineno-69-2" name="__codelineno-69-2" href="#__codelineno-69-2"></a>    <span class="k">if</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-69-3"><a id="__codelineno-69-3" name="__codelineno-69-3" href="#__codelineno-69-3"></a>        <span class="k">return</span> <span class="n">Link</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span><span id="__span-69-4"><a id="__codelineno-69-4" name="__codelineno-69-4" href="#__codelineno-69-4"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-69-5"><a id="__codelineno-69-5" name="__codelineno-69-5" href="#__codelineno-69-5"></a>        <span class="n">pre_digits</span> <span class="o">=</span> <span class="n">store_digits</span><span class="p">(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">10</span><span class="p">)</span>
</span><span id="__span-69-6"><a id="__codelineno-69-6" name="__codelineno-69-6" href="#__codelineno-69-6"></a>        <span class="n">last_digits</span> <span class="o">=</span> <span class="n">pre_digits</span>
</span><span id="__span-69-7"><a id="__codelineno-69-7" name="__codelineno-69-7" href="#__codelineno-69-7"></a>        <span class="k">while</span> <span class="n">last_digits</span><span class="o">.</span><span class="n">rest</span> <span class="o">!=</span> <span class="n">Link</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-69-8"><a id="__codelineno-69-8" name="__codelineno-69-8" href="#__codelineno-69-8"></a>            <span class="n">last_digits</span> <span class="o">=</span> <span class="n">last_digits</span><span class="o">.</span><span class="n">rest</span>
</span><span id="__span-69-9"><a id="__codelineno-69-9" name="__codelineno-69-9" href="#__codelineno-69-9"></a>        <span class="n">last_digits</span><span class="o">.</span><span class="n">rest</span> <span class="o">=</span> <span class="n">Link</span><span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">10</span><span class="p">)</span>
</span><span id="__span-69-10"><a id="__codelineno-69-10" name="__codelineno-69-10" href="#__codelineno-69-10"></a>        <span class="k">return</span> <span class="n">pre_digits</span>
</span></code></pre></div>
<p>然后在提示视频中看到助教老师说<strong>一般链表会使用递归和迭代的方式来实现功能</strong>，这题使用迭代比较方便，然后我将我的代码改成了用迭代来实现</p>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-70-1"><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">store_digits</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="__span-70-2"><a id="__codelineno-70-2" name="__codelineno-70-2" href="#__codelineno-70-2"></a>    <span class="n">link</span> <span class="o">=</span> <span class="n">Link</span><span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">10</span><span class="p">)</span>
</span><span id="__span-70-3"><a id="__codelineno-70-3" name="__codelineno-70-3" href="#__codelineno-70-3"></a>    <span class="k">while</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">10</span><span class="p">:</span>
</span><span id="__span-70-4"><a id="__codelineno-70-4" name="__codelineno-70-4" href="#__codelineno-70-4"></a>        <span class="n">n</span> <span class="o">//=</span> <span class="mi">10</span>
</span><span id="__span-70-5"><a id="__codelineno-70-5" name="__codelineno-70-5" href="#__codelineno-70-5"></a>        <span class="n">link</span> <span class="o">=</span> <span class="n">Link</span><span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">10</span><span class="p">,</span> <span class="n">link</span><span class="p">)</span>
</span><span id="__span-70-6"><a id="__codelineno-70-6" name="__codelineno-70-6" href="#__codelineno-70-6"></a>    <span class="k">return</span> <span class="n">link</span>
</span></code></pre></div>
</details>
<h2 id="lecture-22-efficiency">Lecture 22 Efficiency<a class="headerlink" href="#lecture-22-efficiency" title="Permanent link">&para;</a></h2>
<h3 id="1_11">1<a class="headerlink" href="#1_11" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_106.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_106" loading="lazy" src="../images/cs61a_106.png" /></a></p>
<p>从John的demo演示中可以看到， <code>def</code> 定义出的函数似乎也可以像类一样拥有<em>属性 Attribute</em> (可以使用 <code>.</code> 来访问)</p>
<h3 id="2_11">2<a class="headerlink" href="#2_11" title="Permanent link">&para;</a></h3>
<p><strong>函数内部的变量具体指向的对象 取决于 <mark>调用时</mark> 的情况</strong>，</p>
<p>例如</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-71-1"><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="__span-71-2"><a id="__codelineno-71-2" name="__codelineno-71-2" href="#__codelineno-71-2"></a><span class="o">...</span>     <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">n</span> <span class="k">else</span> <span class="n">n</span>
</span><span id="__span-71-3"><a id="__codelineno-71-3" name="__codelineno-71-3" href="#__codelineno-71-3"></a><span class="o">...</span>
</span><span id="__span-71-4"><a id="__codelineno-71-4" name="__codelineno-71-4" href="#__codelineno-71-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">ori_f</span> <span class="o">=</span> <span class="n">f</span>
</span><span id="__span-71-5"><a id="__codelineno-71-5" name="__codelineno-71-5" href="#__codelineno-71-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="mi">6</span>
</span><span id="__span-71-6"><a id="__codelineno-71-6" name="__codelineno-71-6" href="#__codelineno-71-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">ori_f</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="__span-71-7"><a id="__codelineno-71-7" name="__codelineno-71-7" href="#__codelineno-71-7"></a><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
</span><span id="__span-71-8"><a id="__codelineno-71-8" name="__codelineno-71-8" href="#__codelineno-71-8"></a>  <span class="n">File</span> <span class="s2">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
</span><span id="__span-71-9"><a id="__codelineno-71-9" name="__codelineno-71-9" href="#__codelineno-71-9"></a>  <span class="n">File</span> <span class="s2">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">2</span><span class="p">,</span> <span class="ow">in</span> <span class="n">f</span>
</span><span id="__span-71-10"><a id="__codelineno-71-10" name="__codelineno-71-10" href="#__codelineno-71-10"></a><span class="ne">TypeError</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="nb">object</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">callable</span>
</span><span id="__span-71-11"><a id="__codelineno-71-11" name="__codelineno-71-11" href="#__codelineno-71-11"></a><span class="o">&gt;&gt;&gt;</span>
</span></code></pre></div>
<p>在定义好 <code>f</code> 函数之后，将 <code>f</code> 修改为 <code>6</code> ，那么之后调用<strong>原本的函数 <code>f</code></strong> 时，在进行递归调用(访问 <code>f</code> 变量)时，获取到的是整型 <code>6</code> ，所以会显示</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-72-1"><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a><span class="ne">TypeError</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="nb">object</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">callable</span>
</span></code></pre></div>
<p>所以，下面图中 John 演示的 demo 我觉得应该这样理解</p>
<p><a class="glightbox" href="../images/cs61a_107.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_107" loading="lazy" src="../images/cs61a_107.png" /></a></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-73-1"><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">fib</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="__span-73-2"><a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-73-3"><a id="__codelineno-73-3" name="__codelineno-73-3" href="#__codelineno-73-3"></a>        <span class="k">return</span> <span class="n">n</span>
</span><span id="__span-73-4"><a id="__codelineno-73-4" name="__codelineno-73-4" href="#__codelineno-73-4"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-73-5"><a id="__codelineno-73-5" name="__codelineno-73-5" href="#__codelineno-73-5"></a>        <span class="k">return</span> <span class="n">fib</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">fib</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-73-6"><a id="__codelineno-73-6" name="__codelineno-73-6" href="#__codelineno-73-6"></a>
</span><span id="__span-73-7"><a id="__codelineno-73-7" name="__codelineno-73-7" href="#__codelineno-73-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">count</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
</span><span id="__span-73-8"><a id="__codelineno-73-8" name="__codelineno-73-8" href="#__codelineno-73-8"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">counted</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="__span-73-9"><a id="__codelineno-73-9" name="__codelineno-73-9" href="#__codelineno-73-9"></a>        <span class="n">counted</span><span class="o">.</span><span class="n">call_count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-73-10"><a id="__codelineno-73-10" name="__codelineno-73-10" href="#__codelineno-73-10"></a>        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span><span id="__span-73-11"><a id="__codelineno-73-11" name="__codelineno-73-11" href="#__codelineno-73-11"></a>    <span class="n">counted</span><span class="o">.</span><span class="n">call_count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-73-12"><a id="__codelineno-73-12" name="__codelineno-73-12" href="#__codelineno-73-12"></a>    <span class="k">return</span> <span class="n">counted</span>
</span><span id="__span-73-13"><a id="__codelineno-73-13" name="__codelineno-73-13" href="#__codelineno-73-13"></a>
</span><span id="__span-73-14"><a id="__codelineno-73-14" name="__codelineno-73-14" href="#__codelineno-73-14"></a><span class="k">def</span><span class="w"> </span><span class="nf">memo</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
</span><span id="__span-73-15"><a id="__codelineno-73-15" name="__codelineno-73-15" href="#__codelineno-73-15"></a>    <span class="n">cache</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-73-16"><a id="__codelineno-73-16" name="__codelineno-73-16" href="#__codelineno-73-16"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">memoized</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="__span-73-17"><a id="__codelineno-73-17" name="__codelineno-73-17" href="#__codelineno-73-17"></a>        <span class="k">if</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cache</span><span class="p">:</span>
</span><span id="__span-73-18"><a id="__codelineno-73-18" name="__codelineno-73-18" href="#__codelineno-73-18"></a>            <span class="n">cache</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span><span id="__span-73-19"><a id="__codelineno-73-19" name="__codelineno-73-19" href="#__codelineno-73-19"></a>        <span class="k">return</span> <span class="n">cache</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
</span><span id="__span-73-20"><a id="__codelineno-73-20" name="__codelineno-73-20" href="#__codelineno-73-20"></a>    <span class="k">return</span> <span class="n">memoized</span>
</span></code></pre></div>
<ul>
<li>
<p>第一步</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-74-1"><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fib</span> <span class="o">=</span> <span class="n">count</span><span class="p">(</span><span class="n">fib</span><span class="p">)</span>
</span><span id="__span-74-2"><a id="__codelineno-74-2" name="__codelineno-74-2" href="#__codelineno-74-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">counted_fib</span> <span class="o">=</span> <span class="n">fib</span>
</span></code></pre></div>
<p>将 <code>fib</code> 函数传入 <code>count</code> 函数中，获得 第一个 <code>counted</code> (与之后第二个 <code>counted</code> 作区分)</p>
<pre class="mermaid"><code>flowchart LR
变量名fib --&gt; 第一个counted函数 --"f"--&gt; fib函数
counted_fib --&gt; 第一个counted函数</code></pre>
</li>
<li>
<p>第二步</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-75-1"><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fib</span> <span class="o">=</span> <span class="n">memo</span><span class="p">(</span><span class="n">fib</span><span class="p">)</span>
</span></code></pre></div>
<p>这里 <code>fib</code> 指向的是 第一个 <code>counted</code> ，所以传入 <code>memo</code> 的是 第一个 <code>counted</code> ，</p>
<p>然后获得 <code>memoized</code> 函数</p>
<pre class="mermaid"><code>flowchart LR
counted_fib --&gt; 第一个counted函数 --"f"--&gt; fib函数
变量名fib --&gt; memoized函数 --"f"--&gt; 第一个counted函数</code></pre>
</li>
<li>
<p>第三步</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-76-1"><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fib</span> <span class="o">=</span> <span class="n">count</span><span class="p">(</span><span class="n">fib</span><span class="p">)</span>
</span></code></pre></div>
<p>和刚才类似，这里是将 <code>memoized</code> 函数传入 <code>count</code> ，然后获得 第二个 <code>counted</code> 函数</p>
<pre class="mermaid"><code>flowchart LR
counted_fib --&gt; 第一个counted函数 --"f"--&gt; fib函数
memoized函数 --"f"--&gt; 第一个counted函数
变量名fib --&gt; 第二个counted函数 --"f"--&gt; memoized函数</code></pre>
</li>
<li>
<p>而 <code>fib</code> 函数内部在递归时，会访问 变量名 <code>fib</code> ，所以关系可以进一步理解为</p>
<pre class="mermaid"><code>flowchart LR
变量名fib --&gt; 第二个counted函数 --"f"--&gt; memoized函数
counted_fib --&gt; 第一个counted函数 --"f"--&gt; fib函数
memoized函数 --"f"--&gt; 第一个counted函数
fib函数 -.-&gt; 变量名fib</code></pre>
<p>所以，每次调用(原本的) <code>fib</code> 函数时，递归调用的是 第二个 <code>counted</code> 函数，并且由于是 <em>树形递归</em>，所以 第二个 <code>counted</code> 函数的 <code>call_count</code> 大约为 <code>n</code> (30)的两倍，</p>
<p>而 第一个 <code>counted</code> 函数，只有 <code>memoized</code> 函数中传入未被记录结果的 <code>n</code> 时，才会被调用，因此 第一个 <code>counted</code> 函数 的 <code>call_count</code> 为 <code>31</code> ，刚好对应 0 到 30</p>
</li>
</ul>
<h3 id="3_8">3<a class="headerlink" href="#3_8" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_108.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_108" loading="lazy" src="../images/cs61a_108.png" /></a></p>
<p>John 给出了一种利用平方来加速 幂运算 的方法：</p>
<div class="arithmatex">\[
b^n = \begin{cases}
1 &amp; \mathrm{if} \ n = 0 \\
(b^{\frac{1}{2}n})^2 &amp; \mathrm{if} \ n \ \mathrm{is \ even} \\
b \cdot b^{n-1} &amp; \mathrm{if} \ n \ \mathrm{is \ odd} \\
\end{cases}
\]</div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-77-1"><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span><span id="__span-77-2"><a id="__codelineno-77-2" name="__codelineno-77-2" href="#__codelineno-77-2"></a>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-77-3"><a id="__codelineno-77-3" name="__codelineno-77-3" href="#__codelineno-77-3"></a>        <span class="k">return</span> <span class="mi">1</span>
</span><span id="__span-77-4"><a id="__codelineno-77-4" name="__codelineno-77-4" href="#__codelineno-77-4"></a>    <span class="k">elif</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-77-5"><a id="__codelineno-77-5" name="__codelineno-77-5" href="#__codelineno-77-5"></a>        <span class="k">return</span> <span class="n">square</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">))</span>
</span><span id="__span-77-6"><a id="__codelineno-77-6" name="__codelineno-77-6" href="#__codelineno-77-6"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-77-7"><a id="__codelineno-77-7" name="__codelineno-77-7" href="#__codelineno-77-7"></a>        <span class="k">return</span> <span class="n">b</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-77-8"><a id="__codelineno-77-8" name="__codelineno-77-8" href="#__codelineno-77-8"></a>
</span><span id="__span-77-9"><a id="__codelineno-77-9" name="__codelineno-77-9" href="#__codelineno-77-9"></a><span class="k">def</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-77-10"><a id="__codelineno-77-10" name="__codelineno-77-10" href="#__codelineno-77-10"></a>    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>
</span></code></pre></div>
<h3 id="4_5">4<a class="headerlink" href="#4_5" title="Permanent link">&para;</a></h3>
<p>John 展示了一下 Jupyter Notebook 的使用</p>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p>John:</p>
<p>...this environment is called a jupiter notebook, you can read about them online. it's a common way that people use in order to execute python code when the output is a graph or a chart.</p>
<hr />
<p>John:</p>
<p>...这个环境被称为Jupyter笔记本，你可以在网上了解更多相关信息。这是人们在执行输出为图表或图表的Python代码时常用的一种方式。</p>
</div>
<p><a class="glightbox" href="../images/cs61a_109.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_109" loading="lazy" src="../images/cs61a_109.png" /></a></p>
<p><a class="glightbox" href="../images/cs61a_110.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_110" loading="lazy" src="../images/cs61a_110.png" /></a></p>
<p>感觉用来画图会很方便</p>
<h2 id="lab-08">Lab 08<a class="headerlink" href="#lab-08" title="Permanent link">&para;</a></h2>
<h3 id="1_12">1<a class="headerlink" href="#1_12" title="Permanent link">&para;</a></h3>
<p>Q5 的额外挑战 extra challenge，实现检测链表是否带有循环，但是只能使用固定大小的/恒定的空间</p>
<p>我一开始没想出来，第二天重新思考的时候，想到有循环就意味着会来到曾经来过的节点，那么就意味着 这个节点可以用比当前更少的步数从链表头到达，所以，我打算使用恒定空间来记录当前走过的步数，</p>
<p>最后成功实现了功能</p>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-78-1"><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">has_cycle_constant</span><span class="p">(</span><span class="n">link</span><span class="p">):</span>
</span><span id="__span-78-2"><a id="__codelineno-78-2" name="__codelineno-78-2" href="#__codelineno-78-2"></a>    <span class="n">head</span> <span class="o">=</span> <span class="n">link</span>
</span><span id="__span-78-3"><a id="__codelineno-78-3" name="__codelineno-78-3" href="#__codelineno-78-3"></a>    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-78-4"><a id="__codelineno-78-4" name="__codelineno-78-4" href="#__codelineno-78-4"></a>    <span class="k">while</span> <span class="n">link</span><span class="o">.</span><span class="n">rest</span><span class="p">:</span>
</span><span id="__span-78-5"><a id="__codelineno-78-5" name="__codelineno-78-5" href="#__codelineno-78-5"></a>        <span class="n">link</span> <span class="o">=</span> <span class="n">link</span><span class="o">.</span><span class="n">rest</span>
</span><span id="__span-78-6"><a id="__codelineno-78-6" name="__codelineno-78-6" href="#__codelineno-78-6"></a>        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-78-7"><a id="__codelineno-78-7" name="__codelineno-78-7" href="#__codelineno-78-7"></a>        <span class="n">sublist</span> <span class="o">=</span> <span class="n">head</span>
</span><span id="__span-78-8"><a id="__codelineno-78-8" name="__codelineno-78-8" href="#__codelineno-78-8"></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
</span><span id="__span-78-9"><a id="__codelineno-78-9" name="__codelineno-78-9" href="#__codelineno-78-9"></a>            <span class="k">if</span> <span class="n">sublist</span> <span class="ow">is</span> <span class="n">link</span><span class="p">:</span>
</span><span id="__span-78-10"><a id="__codelineno-78-10" name="__codelineno-78-10" href="#__codelineno-78-10"></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-78-11"><a id="__codelineno-78-11" name="__codelineno-78-11" href="#__codelineno-78-11"></a>            <span class="n">sublist</span> <span class="o">=</span> <span class="n">sublist</span><span class="o">.</span><span class="n">rest</span>
</span><span id="__span-78-12"><a id="__codelineno-78-12" name="__codelineno-78-12" href="#__codelineno-78-12"></a>    <span class="k">return</span> <span class="kc">False</span>
</span></code></pre></div>
</details>
<h2 id="lecture-23-decomposition">Lecture 23 Decomposition<a class="headerlink" href="#lecture-23-decomposition" title="Permanent link">&para;</a></h2>
<h3 id="1_13">1<a class="headerlink" href="#1_13" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_111.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_111" loading="lazy" src="../images/cs61a_111.png" /></a></p>
<p>一个之前没怎么使用过的python的数据类型 <strong>set</strong> ，它的特性</p>
<ul>
<li>只能包含不同的元素，如果创建时有多个相同的元素，则只会保留一个</li>
<li>元素的顺序是无序的</li>
<li>John介绍说，使用 <code>in</code> 语句查询某个元素是否在一个 set 中，所需的时间是常数级的，不会随着 set 的长度增长(像列表就会随着长度增长，是线性级的)</li>
<li><code>.union()</code> 和 <code>.intersection()</code> 分别是 set 取<strong>并集</strong>和<strong>交集</strong>的方法，并且 John 说道，这两个方法并不会对原本的 set 进行修改，而是会创建出一个新的 set</li>
</ul>
<h2 id="lecture-23-qa">Lecture 23 Q&amp;A<a class="headerlink" href="#lecture-23-qa" title="Permanent link">&para;</a></h2>
<h3 id="1_14">1<a class="headerlink" href="#1_14" title="Permanent link">&para;</a></h3>
<p>有人提问的一道考试题目</p>
<p><a class="glightbox" href="../images/cs61a_112.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_112" loading="lazy" src="../images/cs61a_112.png" /></a></p>
<p>我感觉还蛮有意思，于是我就暂停尝试了一下</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-79-1"><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">stable</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span><span id="__span-79-2"><a id="__codelineno-79-2" name="__codelineno-79-2" href="#__codelineno-79-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return whether all pairs of elements of S within distance K differ by at most N.</span>
</span><span id="__span-79-3"><a id="__codelineno-79-3" name="__codelineno-79-3" href="#__codelineno-79-3"></a>
</span><span id="__span-79-4"><a id="__codelineno-79-4" name="__codelineno-79-4" href="#__codelineno-79-4"></a><span class="sd">    &gt;&gt;&gt; stable([1, 2, 3, 5, 6], 1, 2)  # All adjacent values differ by at most 2.</span>
</span><span id="__span-79-5"><a id="__codelineno-79-5" name="__codelineno-79-5" href="#__codelineno-79-5"></a><span class="sd">    True</span>
</span><span id="__span-79-6"><a id="__codelineno-79-6" name="__codelineno-79-6" href="#__codelineno-79-6"></a><span class="sd">    &gt;&gt;&gt; stable([1, 2, 3, 5, 6], 2, 2)  # abs(5-2) is a difference of 3.</span>
</span><span id="__span-79-7"><a id="__codelineno-79-7" name="__codelineno-79-7" href="#__codelineno-79-7"></a><span class="sd">    False</span>
</span><span id="__span-79-8"><a id="__codelineno-79-8" name="__codelineno-79-8" href="#__codelineno-79-8"></a><span class="sd">    &gt;&gt;&gt; stable([1, 5, 1, 5, 1], 2, 2)  # abs(5-1) is a difference of 4.</span>
</span><span id="__span-79-9"><a id="__codelineno-79-9" name="__codelineno-79-9" href="#__codelineno-79-9"></a><span class="sd">    False</span>
</span><span id="__span-79-10"><a id="__codelineno-79-10" name="__codelineno-79-10" href="#__codelineno-79-10"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-79-11"><a id="__codelineno-79-11" name="__codelineno-79-11" href="#__codelineno-79-11"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>
</span><span id="__span-79-12"><a id="__codelineno-79-12" name="__codelineno-79-12" href="#__codelineno-79-12"></a>        <span class="n">near</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">i</span><span class="p">)</span>
</span><span id="__span-79-13"><a id="__codelineno-79-13" name="__codelineno-79-13" href="#__codelineno-79-13"></a>        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="nb">abs</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">n</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">near</span><span class="p">]):</span>
</span><span id="__span-79-14"><a id="__codelineno-79-14" name="__codelineno-79-14" href="#__codelineno-79-14"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-79-15"><a id="__codelineno-79-15" name="__codelineno-79-15" href="#__codelineno-79-15"></a>    <span class="k">return</span> <span class="kc">True</span>
</span></code></pre></div>
<p>运行进行测试，成功通过</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-80-1"><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a>&gt;<span class="w"> </span>python<span class="w"> </span>-m<span class="w"> </span>doctest<span class="w"> </span>-v<span class="w"> </span>.<span class="se">\t</span>est.py
</span><span id="__span-80-2"><a id="__codelineno-80-2" name="__codelineno-80-2" href="#__codelineno-80-2"></a>Trying:
</span><span id="__span-80-3"><a id="__codelineno-80-3" name="__codelineno-80-3" href="#__codelineno-80-3"></a><span class="w">    </span>stable<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">2</span>,<span class="w"> </span><span class="m">3</span>,<span class="w"> </span><span class="m">5</span>,<span class="w"> </span><span class="m">6</span><span class="o">]</span>,<span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="m">2</span><span class="o">)</span><span class="w">  </span><span class="c1"># All adjacent values differ by at most 2.</span>
</span><span id="__span-80-4"><a id="__codelineno-80-4" name="__codelineno-80-4" href="#__codelineno-80-4"></a>Expecting:
</span><span id="__span-80-5"><a id="__codelineno-80-5" name="__codelineno-80-5" href="#__codelineno-80-5"></a><span class="w">    </span>True
</span><span id="__span-80-6"><a id="__codelineno-80-6" name="__codelineno-80-6" href="#__codelineno-80-6"></a>ok
</span><span id="__span-80-7"><a id="__codelineno-80-7" name="__codelineno-80-7" href="#__codelineno-80-7"></a>Trying:
</span><span id="__span-80-8"><a id="__codelineno-80-8" name="__codelineno-80-8" href="#__codelineno-80-8"></a><span class="w">    </span>stable<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">2</span>,<span class="w"> </span><span class="m">3</span>,<span class="w"> </span><span class="m">5</span>,<span class="w"> </span><span class="m">6</span><span class="o">]</span>,<span class="w"> </span><span class="m">2</span>,<span class="w"> </span><span class="m">2</span><span class="o">)</span><span class="w">  </span><span class="c1"># abs(5-2) is a difference of 3.</span>
</span><span id="__span-80-9"><a id="__codelineno-80-9" name="__codelineno-80-9" href="#__codelineno-80-9"></a>Expecting:
</span><span id="__span-80-10"><a id="__codelineno-80-10" name="__codelineno-80-10" href="#__codelineno-80-10"></a><span class="w">    </span>False
</span><span id="__span-80-11"><a id="__codelineno-80-11" name="__codelineno-80-11" href="#__codelineno-80-11"></a>ok
</span><span id="__span-80-12"><a id="__codelineno-80-12" name="__codelineno-80-12" href="#__codelineno-80-12"></a>Trying:
</span><span id="__span-80-13"><a id="__codelineno-80-13" name="__codelineno-80-13" href="#__codelineno-80-13"></a><span class="w">    </span>stable<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">5</span>,<span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="m">5</span>,<span class="w"> </span><span class="m">1</span><span class="o">]</span>,<span class="w"> </span><span class="m">2</span>,<span class="w"> </span><span class="m">2</span><span class="o">)</span><span class="w">  </span><span class="c1"># abs(5-1) is a difference of 4.</span>
</span><span id="__span-80-14"><a id="__codelineno-80-14" name="__codelineno-80-14" href="#__codelineno-80-14"></a>Expecting:
</span><span id="__span-80-15"><a id="__codelineno-80-15" name="__codelineno-80-15" href="#__codelineno-80-15"></a><span class="w">    </span>False
</span><span id="__span-80-16"><a id="__codelineno-80-16" name="__codelineno-80-16" href="#__codelineno-80-16"></a>ok
</span><span id="__span-80-17"><a id="__codelineno-80-17" name="__codelineno-80-17" href="#__codelineno-80-17"></a><span class="m">1</span><span class="w"> </span>items<span class="w"> </span>had<span class="w"> </span>no<span class="w"> </span>tests:
</span><span id="__span-80-18"><a id="__codelineno-80-18" name="__codelineno-80-18" href="#__codelineno-80-18"></a><span class="w">    </span><span class="nb">test</span>
</span><span id="__span-80-19"><a id="__codelineno-80-19" name="__codelineno-80-19" href="#__codelineno-80-19"></a><span class="m">1</span><span class="w"> </span>items<span class="w"> </span>passed<span class="w"> </span>all<span class="w"> </span>tests:
</span><span id="__span-80-20"><a id="__codelineno-80-20" name="__codelineno-80-20" href="#__codelineno-80-20"></a><span class="w">   </span><span class="m">3</span><span class="w"> </span>tests<span class="w"> </span><span class="k">in</span><span class="w"> </span>test.stable
</span><span id="__span-80-21"><a id="__codelineno-80-21" name="__codelineno-80-21" href="#__codelineno-80-21"></a><span class="m">3</span><span class="w"> </span>tests<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>items.
</span><span id="__span-80-22"><a id="__codelineno-80-22" name="__codelineno-80-22" href="#__codelineno-80-22"></a><span class="m">3</span><span class="w"> </span>passed<span class="w"> </span>and<span class="w"> </span><span class="m">0</span><span class="w"> </span>failed.
</span><span id="__span-80-23"><a id="__codelineno-80-23" name="__codelineno-80-23" href="#__codelineno-80-23"></a>Test<span class="w"> </span>passed.
</span></code></pre></div>
<h3 id="2_12">2<a class="headerlink" href="#2_12" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_113.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_113" loading="lazy" src="../images/cs61a_113.png" /></a></p>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-81-1"><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a><span class="sd">&quot;&quot;&quot;A: (3 pts) Implement is_power, which takes a positive integer base and a</span>
</span><span id="__span-81-2"><a id="__codelineno-81-2" name="__codelineno-81-2" href="#__codelineno-81-2"></a><span class="sd">non-negative integer s. It returns whether s is power of base, meaning that there</span>
</span><span id="__span-81-3"><a id="__codelineno-81-3" name="__codelineno-81-3" href="#__codelineno-81-3"></a><span class="sd">is some non-negative integer n such that pow(base, n) equals s.</span>
</span><span id="__span-81-4"><a id="__codelineno-81-4" name="__codelineno-81-4" href="#__codelineno-81-4"></a>
</span><span id="__span-81-5"><a id="__codelineno-81-5" name="__codelineno-81-5" href="#__codelineno-81-5"></a><span class="sd">IMPORTANT: You may not call pow, use the ** operator, or import any function</span>
</span><span id="__span-81-6"><a id="__codelineno-81-6" name="__codelineno-81-6" href="#__codelineno-81-6"></a><span class="sd">(such as math.log). Your solution must be recursive.</span>
</span><span id="__span-81-7"><a id="__codelineno-81-7" name="__codelineno-81-7" href="#__codelineno-81-7"></a>
</span><span id="__span-81-8"><a id="__codelineno-81-8" name="__codelineno-81-8" href="#__codelineno-81-8"></a><span class="sd">Check the doctests with: python3 -q a</span>
</span><span id="__span-81-9"><a id="__codelineno-81-9" name="__codelineno-81-9" href="#__codelineno-81-9"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-81-10"><a id="__codelineno-81-10" name="__codelineno-81-10" href="#__codelineno-81-10"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_power</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
</span><span id="__span-81-11"><a id="__codelineno-81-11" name="__codelineno-81-11" href="#__codelineno-81-11"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return whether s is a power of base.</span>
</span><span id="__span-81-12"><a id="__codelineno-81-12" name="__codelineno-81-12" href="#__codelineno-81-12"></a>
</span><span id="__span-81-13"><a id="__codelineno-81-13" name="__codelineno-81-13" href="#__codelineno-81-13"></a><span class="sd">    &gt;&gt;&gt; is_power(5, 625)  # pow(5, 4) = 5 * 5 * 5 * 5 = 625</span>
</span><span id="__span-81-14"><a id="__codelineno-81-14" name="__codelineno-81-14" href="#__codelineno-81-14"></a><span class="sd">    True</span>
</span><span id="__span-81-15"><a id="__codelineno-81-15" name="__codelineno-81-15" href="#__codelineno-81-15"></a><span class="sd">    &gt;&gt;&gt; is_power(5, 1)    # pow(5, 0) = 1</span>
</span><span id="__span-81-16"><a id="__codelineno-81-16" name="__codelineno-81-16" href="#__codelineno-81-16"></a><span class="sd">    True</span>
</span><span id="__span-81-17"><a id="__codelineno-81-17" name="__codelineno-81-17" href="#__codelineno-81-17"></a><span class="sd">    &gt;&gt;&gt; is_power(5, 5)    # pow(5, 1) = 5</span>
</span><span id="__span-81-18"><a id="__codelineno-81-18" name="__codelineno-81-18" href="#__codelineno-81-18"></a><span class="sd">    True</span>
</span><span id="__span-81-19"><a id="__codelineno-81-19" name="__codelineno-81-19" href="#__codelineno-81-19"></a><span class="sd">    &gt;&gt;&gt; is_power(5, 15)   # 15 is not a power of 5 (it&#39;s multiple)</span>
</span><span id="__span-81-20"><a id="__codelineno-81-20" name="__codelineno-81-20" href="#__codelineno-81-20"></a><span class="sd">    False</span>
</span><span id="__span-81-21"><a id="__codelineno-81-21" name="__codelineno-81-21" href="#__codelineno-81-21"></a><span class="sd">    &gt;&gt;&gt; is_power(3, 9)</span>
</span><span id="__span-81-22"><a id="__codelineno-81-22" name="__codelineno-81-22" href="#__codelineno-81-22"></a><span class="sd">    True</span>
</span><span id="__span-81-23"><a id="__codelineno-81-23" name="__codelineno-81-23" href="#__codelineno-81-23"></a><span class="sd">    &gt;&gt;&gt; is_power(3, 8)</span>
</span><span id="__span-81-24"><a id="__codelineno-81-24" name="__codelineno-81-24" href="#__codelineno-81-24"></a><span class="sd">    False</span>
</span><span id="__span-81-25"><a id="__codelineno-81-25" name="__codelineno-81-25" href="#__codelineno-81-25"></a><span class="sd">    &gt;&gt;&gt; is_power(3, 10)</span>
</span><span id="__span-81-26"><a id="__codelineno-81-26" name="__codelineno-81-26" href="#__codelineno-81-26"></a><span class="sd">    False</span>
</span><span id="__span-81-27"><a id="__codelineno-81-27" name="__codelineno-81-27" href="#__codelineno-81-27"></a><span class="sd">    &gt;&gt;&gt; is_power(1, 8)</span>
</span><span id="__span-81-28"><a id="__codelineno-81-28" name="__codelineno-81-28" href="#__codelineno-81-28"></a><span class="sd">    False</span>
</span><span id="__span-81-29"><a id="__codelineno-81-29" name="__codelineno-81-29" href="#__codelineno-81-29"></a><span class="sd">    &gt;&gt;&gt; is_power(2, 0)    # 0 is not a power of any positive base.</span>
</span><span id="__span-81-30"><a id="__codelineno-81-30" name="__codelineno-81-30" href="#__codelineno-81-30"></a><span class="sd">    False</span>
</span><span id="__span-81-31"><a id="__codelineno-81-31" name="__codelineno-81-31" href="#__codelineno-81-31"></a>
</span><span id="__span-81-32"><a id="__codelineno-81-32" name="__codelineno-81-32" href="#__codelineno-81-32"></a><span class="sd">    &gt;&gt;&gt; is_power(4, 16)</span>
</span><span id="__span-81-33"><a id="__codelineno-81-33" name="__codelineno-81-33" href="#__codelineno-81-33"></a><span class="sd">    True</span>
</span><span id="__span-81-34"><a id="__codelineno-81-34" name="__codelineno-81-34" href="#__codelineno-81-34"></a><span class="sd">    &gt;&gt;&gt; is_power(4, 64)</span>
</span><span id="__span-81-35"><a id="__codelineno-81-35" name="__codelineno-81-35" href="#__codelineno-81-35"></a><span class="sd">    True</span>
</span><span id="__span-81-36"><a id="__codelineno-81-36" name="__codelineno-81-36" href="#__codelineno-81-36"></a><span class="sd">    &gt;&gt;&gt; is_power(4, 63)</span>
</span><span id="__span-81-37"><a id="__codelineno-81-37" name="__codelineno-81-37" href="#__codelineno-81-37"></a><span class="sd">    False</span>
</span><span id="__span-81-38"><a id="__codelineno-81-38" name="__codelineno-81-38" href="#__codelineno-81-38"></a><span class="sd">    &gt;&gt;&gt; is_power(4, 65)</span>
</span><span id="__span-81-39"><a id="__codelineno-81-39" name="__codelineno-81-39" href="#__codelineno-81-39"></a><span class="sd">    False</span>
</span><span id="__span-81-40"><a id="__codelineno-81-40" name="__codelineno-81-40" href="#__codelineno-81-40"></a><span class="sd">    &gt;&gt;&gt; is_power(4, 32)</span>
</span><span id="__span-81-41"><a id="__codelineno-81-41" name="__codelineno-81-41" href="#__codelineno-81-41"></a><span class="sd">    False</span>
</span><span id="__span-81-42"><a id="__codelineno-81-42" name="__codelineno-81-42" href="#__codelineno-81-42"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-81-43"><a id="__codelineno-81-43" name="__codelineno-81-43" href="#__codelineno-81-43"></a>    <span class="k">assert</span> <span class="n">base</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">s</span> <span class="o">&gt;=</span> <span class="mi">0</span>
</span><span id="__span-81-44"><a id="__codelineno-81-44" name="__codelineno-81-44" href="#__codelineno-81-44"></a>    <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">base</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span>
</span><span id="__span-81-45"><a id="__codelineno-81-45" name="__codelineno-81-45" href="#__codelineno-81-45"></a>    <span class="k">if</span> <span class="n">______</span><span class="p">:</span>
</span><span id="__span-81-46"><a id="__codelineno-81-46" name="__codelineno-81-46" href="#__codelineno-81-46"></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-81-47"><a id="__codelineno-81-47" name="__codelineno-81-47" href="#__codelineno-81-47"></a>    <span class="k">elif</span> <span class="n">______</span><span class="p">:</span>
</span><span id="__span-81-48"><a id="__codelineno-81-48" name="__codelineno-81-48" href="#__codelineno-81-48"></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-81-49"><a id="__codelineno-81-49" name="__codelineno-81-49" href="#__codelineno-81-49"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-81-50"><a id="__codelineno-81-50" name="__codelineno-81-50" href="#__codelineno-81-50"></a>        <span class="k">return</span> <span class="n">______</span>
</span><span id="__span-81-51"><a id="__codelineno-81-51" name="__codelineno-81-51" href="#__codelineno-81-51"></a>
</span><span id="__span-81-52"><a id="__codelineno-81-52" name="__codelineno-81-52" href="#__codelineno-81-52"></a>
</span><span id="__span-81-53"><a id="__codelineno-81-53" name="__codelineno-81-53" href="#__codelineno-81-53"></a><span class="n">curry2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">f</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="__span-81-54"><a id="__codelineno-81-54" name="__codelineno-81-54" href="#__codelineno-81-54"></a>
</span><span id="__span-81-55"><a id="__codelineno-81-55" name="__codelineno-81-55" href="#__codelineno-81-55"></a><span class="sd">&quot;&quot;&quot;B: (5 pts) Implement powers, a generator function which takes positive</span>
</span><span id="__span-81-56"><a id="__codelineno-81-56" name="__codelineno-81-56" href="#__codelineno-81-56"></a><span class="sd">integers n and k. It yields all integers m that are both powers of k and whose</span>
</span><span id="__span-81-57"><a id="__codelineno-81-57" name="__codelineno-81-57" href="#__codelineno-81-57"></a><span class="sd">digits appear in order in n.</span>
</span><span id="__span-81-58"><a id="__codelineno-81-58" name="__codelineno-81-58" href="#__codelineno-81-58"></a>
</span><span id="__span-81-59"><a id="__codelineno-81-59" name="__codelineno-81-59" href="#__codelineno-81-59"></a><span class="sd">Assume thar is_power is implemented correctly.</span>
</span><span id="__span-81-60"><a id="__codelineno-81-60" name="__codelineno-81-60" href="#__codelineno-81-60"></a>
</span><span id="__span-81-61"><a id="__codelineno-81-61" name="__codelineno-81-61" href="#__codelineno-81-61"></a><span class="sd">Note: powers may yield its results in any order. The doctests below check what</span>
</span><span id="__span-81-62"><a id="__codelineno-81-62" name="__codelineno-81-62" href="#__codelineno-81-62"></a><span class="sd">is yielded, but not the order. The built-in sorted funcion used in the doctests</span>
</span><span id="__span-81-63"><a id="__codelineno-81-63" name="__codelineno-81-63" href="#__codelineno-81-63"></a><span class="sd">takes in an iterable object and returns a list containing the elements of the</span>
</span><span id="__span-81-64"><a id="__codelineno-81-64" name="__codelineno-81-64" href="#__codelineno-81-64"></a><span class="sd">iterable in non-decreasing order.</span>
</span><span id="__span-81-65"><a id="__codelineno-81-65" name="__codelineno-81-65" href="#__codelineno-81-65"></a>
</span><span id="__span-81-66"><a id="__codelineno-81-66" name="__codelineno-81-66" href="#__codelineno-81-66"></a><span class="sd">Check the doctests with: python3 ok -q b&quot;&quot;&quot;</span>
</span><span id="__span-81-67"><a id="__codelineno-81-67" name="__codelineno-81-67" href="#__codelineno-81-67"></a><span class="k">def</span><span class="w"> </span><span class="nf">powers</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span><span id="__span-81-68"><a id="__codelineno-81-68" name="__codelineno-81-68" href="#__codelineno-81-68"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Yield all powers of k whose digits appear in order in n.</span>
</span><span id="__span-81-69"><a id="__codelineno-81-69" name="__codelineno-81-69" href="#__codelineno-81-69"></a>
</span><span id="__span-81-70"><a id="__codelineno-81-70" name="__codelineno-81-70" href="#__codelineno-81-70"></a><span class="sd">    &gt;&gt;&gt; sorted(powers(12345, 5))</span>
</span><span id="__span-81-71"><a id="__codelineno-81-71" name="__codelineno-81-71" href="#__codelineno-81-71"></a><span class="sd">    [1, 5, 25, 125]</span>
</span><span id="__span-81-72"><a id="__codelineno-81-72" name="__codelineno-81-72" href="#__codelineno-81-72"></a><span class="sd">    &gt;&gt;&gt; sorted(powers(54321, 5))  # 25 and 125 are not in order</span>
</span><span id="__span-81-73"><a id="__codelineno-81-73" name="__codelineno-81-73" href="#__codelineno-81-73"></a><span class="sd">    [1, 5]</span>
</span><span id="__span-81-74"><a id="__codelineno-81-74" name="__codelineno-81-74" href="#__codelineno-81-74"></a><span class="sd">    &gt;&gt;&gt; sorted(powers(2493, 3))</span>
</span><span id="__span-81-75"><a id="__codelineno-81-75" name="__codelineno-81-75" href="#__codelineno-81-75"></a><span class="sd">    [3, 9, 243]</span>
</span><span id="__span-81-76"><a id="__codelineno-81-76" name="__codelineno-81-76" href="#__codelineno-81-76"></a>
</span><span id="__span-81-77"><a id="__codelineno-81-77" name="__codelineno-81-77" href="#__codelineno-81-77"></a><span class="sd">    &gt;&gt;&gt; sorted(powers(2493, 2))</span>
</span><span id="__span-81-78"><a id="__codelineno-81-78" name="__codelineno-81-78" href="#__codelineno-81-78"></a><span class="sd">    [2, 4]</span>
</span><span id="__span-81-79"><a id="__codelineno-81-79" name="__codelineno-81-79" href="#__codelineno-81-79"></a><span class="sd">    &gt;&gt;&gt; sorted(powers(164352, 2))</span>
</span><span id="__span-81-80"><a id="__codelineno-81-80" name="__codelineno-81-80" href="#__codelineno-81-80"></a><span class="sd">    [1, 2, 4, 16, 32, 64]</span>
</span><span id="__span-81-81"><a id="__codelineno-81-81" name="__codelineno-81-81" href="#__codelineno-81-81"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-81-82"><a id="__codelineno-81-82" name="__codelineno-81-82" href="#__codelineno-81-82"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="n">seed</span><span class="p">):</span>
</span><span id="__span-81-83"><a id="__codelineno-81-83" name="__codelineno-81-83" href="#__codelineno-81-83"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Yield all non-negetive integers whose digits appear in order in seed.</span>
</span><span id="__span-81-84"><a id="__codelineno-81-84" name="__codelineno-81-84" href="#__codelineno-81-84"></a><span class="sd">        0 is yielded because 0 has no digits, so all its digits are in seed.</span>
</span><span id="__span-81-85"><a id="__codelineno-81-85" name="__codelineno-81-85" href="#__codelineno-81-85"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-81-86"><a id="__codelineno-81-86" name="__codelineno-81-86" href="#__codelineno-81-86"></a>        <span class="k">if</span> <span class="n">seed</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-81-87"><a id="__codelineno-81-87" name="__codelineno-81-87" href="#__codelineno-81-87"></a>            <span class="k">yield</span> <span class="mi">0</span>
</span><span id="__span-81-88"><a id="__codelineno-81-88" name="__codelineno-81-88" href="#__codelineno-81-88"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-81-89"><a id="__codelineno-81-89" name="__codelineno-81-89" href="#__codelineno-81-89"></a>            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">______</span><span class="p">:</span>
</span><span id="__span-81-90"><a id="__codelineno-81-90" name="__codelineno-81-90" href="#__codelineno-81-90"></a>                <span class="n">______</span>
</span><span id="__span-81-91"><a id="__codelineno-81-91" name="__codelineno-81-91" href="#__codelineno-81-91"></a>                <span class="n">______</span>
</span><span id="__span-81-92"><a id="__codelineno-81-92" name="__codelineno-81-92" href="#__codelineno-81-92"></a>    <span class="k">yield from</span> <span class="nb">filter</span><span class="p">(</span><span class="n">curry2</span><span class="p">(</span><span class="n">______</span><span class="p">)(</span><span class="n">______</span><span class="p">),</span> <span class="n">build</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span></code></pre></div>
</div>
<p>有人提问的一道题目，我有点想尝试一下，</p>
<p>本来只是想做一下第二题/第二部分，但是看题目要求好像第二题需要用到第一题的函数，于是就连第一题一起做完了😂</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-82-1"><a id="__codelineno-82-1" name="__codelineno-82-1" href="#__codelineno-82-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_power</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
</span><span id="__span-82-2"><a id="__codelineno-82-2" name="__codelineno-82-2" href="#__codelineno-82-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return whether s is a power of base.</span>
</span><span id="__span-82-3"><a id="__codelineno-82-3" name="__codelineno-82-3" href="#__codelineno-82-3"></a>
</span><span id="__span-82-4"><a id="__codelineno-82-4" name="__codelineno-82-4" href="#__codelineno-82-4"></a><span class="sd">    &gt;&gt;&gt; is_power(5, 625)  # pow(5, 4) = 5 * 5 * 5 * 5 = 625</span>
</span><span id="__span-82-5"><a id="__codelineno-82-5" name="__codelineno-82-5" href="#__codelineno-82-5"></a><span class="sd">    True</span>
</span><span id="__span-82-6"><a id="__codelineno-82-6" name="__codelineno-82-6" href="#__codelineno-82-6"></a><span class="sd">    &gt;&gt;&gt; is_power(5, 1)    # pow(5, 0) = 1</span>
</span><span id="__span-82-7"><a id="__codelineno-82-7" name="__codelineno-82-7" href="#__codelineno-82-7"></a><span class="sd">    True</span>
</span><span id="__span-82-8"><a id="__codelineno-82-8" name="__codelineno-82-8" href="#__codelineno-82-8"></a><span class="sd">    &gt;&gt;&gt; is_power(5, 5)    # pow(5, 1) = 5</span>
</span><span id="__span-82-9"><a id="__codelineno-82-9" name="__codelineno-82-9" href="#__codelineno-82-9"></a><span class="sd">    True</span>
</span><span id="__span-82-10"><a id="__codelineno-82-10" name="__codelineno-82-10" href="#__codelineno-82-10"></a><span class="sd">    &gt;&gt;&gt; is_power(5, 15)   # 15 is not a power of 5 (it&#39;s multiple)</span>
</span><span id="__span-82-11"><a id="__codelineno-82-11" name="__codelineno-82-11" href="#__codelineno-82-11"></a><span class="sd">    False</span>
</span><span id="__span-82-12"><a id="__codelineno-82-12" name="__codelineno-82-12" href="#__codelineno-82-12"></a><span class="sd">    &gt;&gt;&gt; is_power(3, 9)</span>
</span><span id="__span-82-13"><a id="__codelineno-82-13" name="__codelineno-82-13" href="#__codelineno-82-13"></a><span class="sd">    True</span>
</span><span id="__span-82-14"><a id="__codelineno-82-14" name="__codelineno-82-14" href="#__codelineno-82-14"></a><span class="sd">    &gt;&gt;&gt; is_power(3, 8)</span>
</span><span id="__span-82-15"><a id="__codelineno-82-15" name="__codelineno-82-15" href="#__codelineno-82-15"></a><span class="sd">    False</span>
</span><span id="__span-82-16"><a id="__codelineno-82-16" name="__codelineno-82-16" href="#__codelineno-82-16"></a><span class="sd">    &gt;&gt;&gt; is_power(3, 10)</span>
</span><span id="__span-82-17"><a id="__codelineno-82-17" name="__codelineno-82-17" href="#__codelineno-82-17"></a><span class="sd">    False</span>
</span><span id="__span-82-18"><a id="__codelineno-82-18" name="__codelineno-82-18" href="#__codelineno-82-18"></a><span class="sd">    &gt;&gt;&gt; is_power(1, 8)</span>
</span><span id="__span-82-19"><a id="__codelineno-82-19" name="__codelineno-82-19" href="#__codelineno-82-19"></a><span class="sd">    False</span>
</span><span id="__span-82-20"><a id="__codelineno-82-20" name="__codelineno-82-20" href="#__codelineno-82-20"></a><span class="sd">    &gt;&gt;&gt; is_power(2, 0)    # 0 is not a power of any positive base.</span>
</span><span id="__span-82-21"><a id="__codelineno-82-21" name="__codelineno-82-21" href="#__codelineno-82-21"></a><span class="sd">    False</span>
</span><span id="__span-82-22"><a id="__codelineno-82-22" name="__codelineno-82-22" href="#__codelineno-82-22"></a>
</span><span id="__span-82-23"><a id="__codelineno-82-23" name="__codelineno-82-23" href="#__codelineno-82-23"></a><span class="sd">    &gt;&gt;&gt; is_power(4, 16)</span>
</span><span id="__span-82-24"><a id="__codelineno-82-24" name="__codelineno-82-24" href="#__codelineno-82-24"></a><span class="sd">    True</span>
</span><span id="__span-82-25"><a id="__codelineno-82-25" name="__codelineno-82-25" href="#__codelineno-82-25"></a><span class="sd">    &gt;&gt;&gt; is_power(4, 64)</span>
</span><span id="__span-82-26"><a id="__codelineno-82-26" name="__codelineno-82-26" href="#__codelineno-82-26"></a><span class="sd">    True</span>
</span><span id="__span-82-27"><a id="__codelineno-82-27" name="__codelineno-82-27" href="#__codelineno-82-27"></a><span class="sd">    &gt;&gt;&gt; is_power(4, 63)</span>
</span><span id="__span-82-28"><a id="__codelineno-82-28" name="__codelineno-82-28" href="#__codelineno-82-28"></a><span class="sd">    False</span>
</span><span id="__span-82-29"><a id="__codelineno-82-29" name="__codelineno-82-29" href="#__codelineno-82-29"></a><span class="sd">    &gt;&gt;&gt; is_power(4, 65)</span>
</span><span id="__span-82-30"><a id="__codelineno-82-30" name="__codelineno-82-30" href="#__codelineno-82-30"></a><span class="sd">    False</span>
</span><span id="__span-82-31"><a id="__codelineno-82-31" name="__codelineno-82-31" href="#__codelineno-82-31"></a><span class="sd">    &gt;&gt;&gt; is_power(4, 32)</span>
</span><span id="__span-82-32"><a id="__codelineno-82-32" name="__codelineno-82-32" href="#__codelineno-82-32"></a><span class="sd">    False</span>
</span><span id="__span-82-33"><a id="__codelineno-82-33" name="__codelineno-82-33" href="#__codelineno-82-33"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-82-34"><a id="__codelineno-82-34" name="__codelineno-82-34" href="#__codelineno-82-34"></a>    <span class="k">assert</span> <span class="n">base</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">s</span> <span class="o">&gt;=</span> <span class="mi">0</span>
</span><span id="__span-82-35"><a id="__codelineno-82-35" name="__codelineno-82-35" href="#__codelineno-82-35"></a>    <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">base</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span>
</span><span id="__span-82-36"><a id="__codelineno-82-36" name="__codelineno-82-36" href="#__codelineno-82-36"></a>    <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-82-37"><a id="__codelineno-82-37" name="__codelineno-82-37" href="#__codelineno-82-37"></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-82-38"><a id="__codelineno-82-38" name="__codelineno-82-38" href="#__codelineno-82-38"></a>    <span class="k">elif</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">s</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">s</span> <span class="o">%</span> <span class="n">base</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-82-39"><a id="__codelineno-82-39" name="__codelineno-82-39" href="#__codelineno-82-39"></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-82-40"><a id="__codelineno-82-40" name="__codelineno-82-40" href="#__codelineno-82-40"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-82-41"><a id="__codelineno-82-41" name="__codelineno-82-41" href="#__codelineno-82-41"></a>        <span class="k">return</span> <span class="n">is_power</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">s</span> <span class="o">//</span> <span class="n">base</span><span class="p">)</span>
</span><span id="__span-82-42"><a id="__codelineno-82-42" name="__codelineno-82-42" href="#__codelineno-82-42"></a>
</span><span id="__span-82-43"><a id="__codelineno-82-43" name="__codelineno-82-43" href="#__codelineno-82-43"></a>
</span><span id="__span-82-44"><a id="__codelineno-82-44" name="__codelineno-82-44" href="#__codelineno-82-44"></a><span class="n">curry2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">f</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="__span-82-45"><a id="__codelineno-82-45" name="__codelineno-82-45" href="#__codelineno-82-45"></a>
</span><span id="__span-82-46"><a id="__codelineno-82-46" name="__codelineno-82-46" href="#__codelineno-82-46"></a><span class="k">def</span><span class="w"> </span><span class="nf">powers</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span><span id="__span-82-47"><a id="__codelineno-82-47" name="__codelineno-82-47" href="#__codelineno-82-47"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Yield all powers of k whose digits appear in order in n.</span>
</span><span id="__span-82-48"><a id="__codelineno-82-48" name="__codelineno-82-48" href="#__codelineno-82-48"></a>
</span><span id="__span-82-49"><a id="__codelineno-82-49" name="__codelineno-82-49" href="#__codelineno-82-49"></a><span class="sd">    &gt;&gt;&gt; sorted(powers(12345, 5))</span>
</span><span id="__span-82-50"><a id="__codelineno-82-50" name="__codelineno-82-50" href="#__codelineno-82-50"></a><span class="sd">    [1, 5, 25, 125]</span>
</span><span id="__span-82-51"><a id="__codelineno-82-51" name="__codelineno-82-51" href="#__codelineno-82-51"></a><span class="sd">    &gt;&gt;&gt; sorted(powers(54321, 5))  # 25 and 125 are not in order</span>
</span><span id="__span-82-52"><a id="__codelineno-82-52" name="__codelineno-82-52" href="#__codelineno-82-52"></a><span class="sd">    [1, 5]</span>
</span><span id="__span-82-53"><a id="__codelineno-82-53" name="__codelineno-82-53" href="#__codelineno-82-53"></a><span class="sd">    &gt;&gt;&gt; sorted(powers(2493, 3))</span>
</span><span id="__span-82-54"><a id="__codelineno-82-54" name="__codelineno-82-54" href="#__codelineno-82-54"></a><span class="sd">    [3, 9, 243]</span>
</span><span id="__span-82-55"><a id="__codelineno-82-55" name="__codelineno-82-55" href="#__codelineno-82-55"></a>
</span><span id="__span-82-56"><a id="__codelineno-82-56" name="__codelineno-82-56" href="#__codelineno-82-56"></a><span class="sd">    &gt;&gt;&gt; sorted(powers(2493, 2))</span>
</span><span id="__span-82-57"><a id="__codelineno-82-57" name="__codelineno-82-57" href="#__codelineno-82-57"></a><span class="sd">    [2, 4]</span>
</span><span id="__span-82-58"><a id="__codelineno-82-58" name="__codelineno-82-58" href="#__codelineno-82-58"></a><span class="sd">    &gt;&gt;&gt; sorted(powers(164352, 2))</span>
</span><span id="__span-82-59"><a id="__codelineno-82-59" name="__codelineno-82-59" href="#__codelineno-82-59"></a><span class="sd">    [1, 2, 4, 16, 32, 64]</span>
</span><span id="__span-82-60"><a id="__codelineno-82-60" name="__codelineno-82-60" href="#__codelineno-82-60"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-82-61"><a id="__codelineno-82-61" name="__codelineno-82-61" href="#__codelineno-82-61"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="n">seed</span><span class="p">):</span>
</span><span id="__span-82-62"><a id="__codelineno-82-62" name="__codelineno-82-62" href="#__codelineno-82-62"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Yield all non-negetive integers whose digits appear in order in seed.</span>
</span><span id="__span-82-63"><a id="__codelineno-82-63" name="__codelineno-82-63" href="#__codelineno-82-63"></a><span class="sd">        0 is yielded because 0 has no digits, so all its digits are in seed.</span>
</span><span id="__span-82-64"><a id="__codelineno-82-64" name="__codelineno-82-64" href="#__codelineno-82-64"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-82-65"><a id="__codelineno-82-65" name="__codelineno-82-65" href="#__codelineno-82-65"></a>        <span class="k">if</span> <span class="n">seed</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-82-66"><a id="__codelineno-82-66" name="__codelineno-82-66" href="#__codelineno-82-66"></a>            <span class="k">yield</span> <span class="mi">0</span>
</span><span id="__span-82-67"><a id="__codelineno-82-67" name="__codelineno-82-67" href="#__codelineno-82-67"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-82-68"><a id="__codelineno-82-68" name="__codelineno-82-68" href="#__codelineno-82-68"></a>            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">build</span><span class="p">(</span><span class="n">seed</span> <span class="o">//</span> <span class="mi">10</span><span class="p">):</span>
</span><span id="__span-82-69"><a id="__codelineno-82-69" name="__codelineno-82-69" href="#__codelineno-82-69"></a>                <span class="k">yield</span> <span class="n">x</span>
</span><span id="__span-82-70"><a id="__codelineno-82-70" name="__codelineno-82-70" href="#__codelineno-82-70"></a>                <span class="k">yield</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="n">seed</span> <span class="o">%</span> <span class="mi">10</span>
</span><span id="__span-82-71"><a id="__codelineno-82-71" name="__codelineno-82-71" href="#__codelineno-82-71"></a>    <span class="k">yield from</span> <span class="nb">filter</span><span class="p">(</span><span class="n">curry2</span><span class="p">(</span><span class="n">is_power</span><span class="p">)(</span><span class="n">k</span><span class="p">),</span> <span class="n">build</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span></code></pre></div>
<h3 id="3_9">3<a class="headerlink" href="#3_9" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_114.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_114" loading="lazy" src="../images/cs61a_114.png" /></a></p>
<p>John 提到了 lab 08 的 Q6 <code>reverse_other</code> 这题，基本的思路和之前我做的时候的思路感觉差不多，但是在具体处理上，我觉得老师的一些处理值得学习，</p>
<p>首先就是，用到了之前的练习中也有提到的 <code>zip</code> 函数，利用了 <code>zip</code> 感觉就比我之前的写法更加简洁，</p>
<p>然后是处理 <strong>隔一层反转</strong> 的操作上，是直接在子节点的循环中再次循环，就刚好能拿到 孙子节点，我之前的做法就稍微麻烦，还需要一个 <code>helper</code> 函数来辅助计数</p>
<p><a class="glightbox" href="../images/cs61a_115.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_115" loading="lazy" src="../images/cs61a_115.png" /></a></p>
<p>John又展示了不使用 <code>zip</code> 的实现方法，而他这次利用了<strong>负的下标</strong>来实现翻转</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-83-1"><a id="__codelineno-83-1" name="__codelineno-83-1" href="#__codelineno-83-1"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">branches</span><span class="p">)):</span>
</span><span id="__span-83-2"><a id="__codelineno-83-2" name="__codelineno-83-2" href="#__codelineno-83-2"></a>    <span class="n">t</span><span class="o">.</span><span class="n">branches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">labels_of_branches</span><span class="p">[</span><span class="o">-</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="__span-83-3"><a id="__codelineno-83-3" name="__codelineno-83-3" href="#__codelineno-83-3"></a>    <span class="o">...</span>
</span></code></pre></div>
<h3 id="4_6">4<a class="headerlink" href="#4_6" title="Permanent link">&para;</a></h3>
<p>有人提问，如果一个类继承自两个不同的类，那么它使用 <code>super</code> 时会怎样</p>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p>John:</p>
<p>so if you use super on a class that inherits from two different classes, what have you built, you built something very strange, but basically whay you've built is the same object except for, it's gonna not look up things is its class, it's gonna look at them up in one of the base classes, and which one, well, it looks at them in the order that you inherit, so if have a class that inherits from both b and c, it's gonna look in b first and then it's gonna look at c, to find the corresponding attribute that you're looking at.</p>
<hr />
<p>John:</p>
<p>当你在一个从两个不同类继承的类上使用 super 时，你构建了一些非常奇怪的东西，但基本上你构建的是相同的对象，只是它不会在其类中查找属性，而是会在其中一个基类中查找。而具体是哪一个基类呢？它会按照你继承的顺序查找，所以如果有一个类同时继承自类B和类C，它会首先在B中查找，然后再在C中查找相应的属性。</p>
</div>
<h2 id="lecture-24-data-example">Lecture 24 Data Example<a class="headerlink" href="#lecture-24-data-example" title="Permanent link">&para;</a></h2>
<h3 id="1_15">1<a class="headerlink" href="#1_15" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_116.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_116" loading="lazy" src="../images/cs61a_116.png" /></a></p>
<p>尝试自己做了一下这四题，下面是我写的</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-84-1"><a id="__codelineno-84-1" name="__codelineno-84-1" href="#__codelineno-84-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">indices_of_min_abs</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span><span id="__span-84-2"><a id="__codelineno-84-2" name="__codelineno-84-2" href="#__codelineno-84-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-84-3"><a id="__codelineno-84-3" name="__codelineno-84-3" href="#__codelineno-84-3"></a><span class="sd">    &gt;&gt;&gt; indices_of_min_abs([-4, -3, -2, 3, 2, 4])</span>
</span><span id="__span-84-4"><a id="__codelineno-84-4" name="__codelineno-84-4" href="#__codelineno-84-4"></a><span class="sd">    [2, 4]</span>
</span><span id="__span-84-5"><a id="__codelineno-84-5" name="__codelineno-84-5" href="#__codelineno-84-5"></a><span class="sd">    &gt;&gt;&gt; indices_of_min_abs([1, 2, 3, 4, 5])</span>
</span><span id="__span-84-6"><a id="__codelineno-84-6" name="__codelineno-84-6" href="#__codelineno-84-6"></a><span class="sd">    [0]</span>
</span><span id="__span-84-7"><a id="__codelineno-84-7" name="__codelineno-84-7" href="#__codelineno-84-7"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-84-8"><a id="__codelineno-84-8" name="__codelineno-84-8" href="#__codelineno-84-8"></a>    <span class="n">min_abs</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">s</span><span class="p">])</span>
</span><span id="__span-84-9"><a id="__codelineno-84-9" name="__codelineno-84-9" href="#__codelineno-84-9"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="n">min_abs</span><span class="p">]</span>
</span><span id="__span-84-10"><a id="__codelineno-84-10" name="__codelineno-84-10" href="#__codelineno-84-10"></a>
</span><span id="__span-84-11"><a id="__codelineno-84-11" name="__codelineno-84-11" href="#__codelineno-84-11"></a><span class="k">def</span><span class="w"> </span><span class="nf">largest_sum_of_adjacency</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span><span id="__span-84-12"><a id="__codelineno-84-12" name="__codelineno-84-12" href="#__codelineno-84-12"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-84-13"><a id="__codelineno-84-13" name="__codelineno-84-13" href="#__codelineno-84-13"></a><span class="sd">    &gt;&gt;&gt; largest_sum_of_adjacency([-4, -3, -2, 3, 2, 4])</span>
</span><span id="__span-84-14"><a id="__codelineno-84-14" name="__codelineno-84-14" href="#__codelineno-84-14"></a><span class="sd">    6</span>
</span><span id="__span-84-15"><a id="__codelineno-84-15" name="__codelineno-84-15" href="#__codelineno-84-15"></a><span class="sd">    &gt;&gt;&gt; largest_sum_of_adjacency([-4, 3, -2, -3, 2, -4])</span>
</span><span id="__span-84-16"><a id="__codelineno-84-16" name="__codelineno-84-16" href="#__codelineno-84-16"></a><span class="sd">    1</span>
</span><span id="__span-84-17"><a id="__codelineno-84-17" name="__codelineno-84-17" href="#__codelineno-84-17"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-84-18"><a id="__codelineno-84-18" name="__codelineno-84-18" href="#__codelineno-84-18"></a>    <span class="k">return</span> <span class="nb">max</span><span class="p">([</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)])</span>
</span><span id="__span-84-19"><a id="__codelineno-84-19" name="__codelineno-84-19" href="#__codelineno-84-19"></a>
</span><span id="__span-84-20"><a id="__codelineno-84-20" name="__codelineno-84-20" href="#__codelineno-84-20"></a><span class="k">def</span><span class="w"> </span><span class="nf">map_digit_to_element</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span><span id="__span-84-21"><a id="__codelineno-84-21" name="__codelineno-84-21" href="#__codelineno-84-21"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-84-22"><a id="__codelineno-84-22" name="__codelineno-84-22" href="#__codelineno-84-22"></a><span class="sd">    &gt;&gt;&gt; map_digit_to_element([5, 8, 13, 21, 34, 55, 89])</span>
</span><span id="__span-84-23"><a id="__codelineno-84-23" name="__codelineno-84-23" href="#__codelineno-84-23"></a><span class="sd">    {1: [21], 3: [13], 4: [34], 5: [5, 55], 8: [8], 9: [89]}</span>
</span><span id="__span-84-24"><a id="__codelineno-84-24" name="__codelineno-84-24" href="#__codelineno-84-24"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-84-25"><a id="__codelineno-84-25" name="__codelineno-84-25" href="#__codelineno-84-25"></a>    <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-84-26"><a id="__codelineno-84-26" name="__codelineno-84-26" href="#__codelineno-84-26"></a>    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
</span><span id="__span-84-27"><a id="__codelineno-84-27" name="__codelineno-84-27" href="#__codelineno-84-27"></a>        <span class="n">d</span> <span class="o">=</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">10</span>
</span><span id="__span-84-28"><a id="__codelineno-84-28" name="__codelineno-84-28" href="#__codelineno-84-28"></a>        <span class="k">if</span> <span class="n">d</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
</span><span id="__span-84-29"><a id="__codelineno-84-29" name="__codelineno-84-29" href="#__codelineno-84-29"></a>            <span class="n">result</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span>
</span><span id="__span-84-30"><a id="__codelineno-84-30" name="__codelineno-84-30" href="#__codelineno-84-30"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-84-31"><a id="__codelineno-84-31" name="__codelineno-84-31" href="#__codelineno-84-31"></a>            <span class="n">result</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span>
</span><span id="__span-84-32"><a id="__codelineno-84-32" name="__codelineno-84-32" href="#__codelineno-84-32"></a>    <span class="k">return</span> <span class="p">{</span><span class="n">d</span><span class="p">:</span> <span class="n">result</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">result</span><span class="p">)}</span>
</span><span id="__span-84-33"><a id="__codelineno-84-33" name="__codelineno-84-33" href="#__codelineno-84-33"></a>
</span><span id="__span-84-34"><a id="__codelineno-84-34" name="__codelineno-84-34" href="#__codelineno-84-34"></a><span class="k">def</span><span class="w"> </span><span class="nf">every_element_has_equal_value</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span><span id="__span-84-35"><a id="__codelineno-84-35" name="__codelineno-84-35" href="#__codelineno-84-35"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-84-36"><a id="__codelineno-84-36" name="__codelineno-84-36" href="#__codelineno-84-36"></a><span class="sd">    &gt;&gt;&gt; every_element_has_equal_value([-4, -3, -2, 3, 2, 4])</span>
</span><span id="__span-84-37"><a id="__codelineno-84-37" name="__codelineno-84-37" href="#__codelineno-84-37"></a><span class="sd">    False</span>
</span><span id="__span-84-38"><a id="__codelineno-84-38" name="__codelineno-84-38" href="#__codelineno-84-38"></a><span class="sd">    &gt;&gt;&gt; every_element_has_equal_value([4, 3, 2, 3, 2, 4])</span>
</span><span id="__span-84-39"><a id="__codelineno-84-39" name="__codelineno-84-39" href="#__codelineno-84-39"></a><span class="sd">    True</span>
</span><span id="__span-84-40"><a id="__codelineno-84-40" name="__codelineno-84-40" href="#__codelineno-84-40"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-84-41"><a id="__codelineno-84-41" name="__codelineno-84-41" href="#__codelineno-84-41"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>
</span><span id="__span-84-42"><a id="__codelineno-84-42" name="__codelineno-84-42" href="#__codelineno-84-42"></a>        <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">i</span> <span class="o">==</span> <span class="n">j</span> <span class="ow">or</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))]):</span>
</span><span id="__span-84-43"><a id="__codelineno-84-43" name="__codelineno-84-43" href="#__codelineno-84-43"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-84-44"><a id="__codelineno-84-44" name="__codelineno-84-44" href="#__codelineno-84-44"></a>    <span class="k">return</span> <span class="kc">True</span>
</span></code></pre></div>
<hr />
<p>在做第三个问题时，发现了如果 <code>sorted</code> 函数传入的是一个字典，那么会返回以键为元素排好序的列表</p>
<h3 id="2_13">2<a class="headerlink" href="#2_13" title="Permanent link">&para;</a></h3>
<p>John 第一个问题中运用了 <code>map</code> 函数来获取 <code>min_abs</code> ，感觉比我的代码看起来更简洁些</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-85-1"><a id="__codelineno-85-1" name="__codelineno-85-1" href="#__codelineno-85-1"></a><span class="n">min_abs</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">abs</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
</span></code></pre></div>
<p>John <code>return</code> 的那一行代码，提供了使用 <code>filter</code> 函数的另一种写法(由于 <code>filter</code> 返回的是一个迭代器，所以需要转换成列表)，</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-86-1"><a id="__codelineno-86-1" name="__codelineno-86-1" href="#__codelineno-86-1"></a><span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="n">min_abs</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))))</span>
</span></code></pre></div>
<p><a class="glightbox" href="../images/cs61a_117.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_117" loading="lazy" src="../images/cs61a_117.png" /></a></p>
<hr />
<p>John 在第二个问题中又提供了第二种方法，利用 <code>zip</code> 函数，并且<strong>利用切片来获取相邻元素</strong>(感觉太强了😲，完全没想到能这样用 <code>zip</code> )</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-87-1"><a id="__codelineno-87-1" name="__codelineno-87-1" href="#__codelineno-87-1"></a><span class="k">return</span> <span class="nb">max</span><span class="p">([</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">s</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:])])</span>
</span></code></pre></div>
<p><a class="glightbox" href="../images/cs61a_118.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_118" loading="lazy" src="../images/cs61a_118.png" /></a></p>
<hr />
<p>第三个问题 John 用了跟我的思路不同的另一种思路来实现</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-88-1"><a id="__codelineno-88-1" name="__codelineno-88-1" href="#__codelineno-88-1"></a><span class="k">return</span> <span class="p">{</span><span class="n">d</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">s</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="n">d</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">x</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="n">d</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">s</span><span class="p">])}</span>
</span></code></pre></div>
<p><a class="glightbox" href="../images/cs61a_119.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_119" loading="lazy" src="../images/cs61a_119.png" /></a></p>
<hr />
<p>第四个问题，John 一开始的思路感觉感觉和我的差不多，但是也比我的代码要简洁，</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-89-1"><a id="__codelineno-89-1" name="__codelineno-89-1" href="#__codelineno-89-1"></a><span class="k">return</span> <span class="nb">all</span><span class="p">([</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">s</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))])</span>
</span></code></pre></div>
<p>但是 John 提供了第二种思路，<strong><mark>如果列表中有两个相同的数，那么意味着这个数的个数大于等于2</mark></strong>，</p>
<p><a class="glightbox" href="../images/cs61a_121.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_121" loading="lazy" src="../images/cs61a_121.png" /></a></p>
<p>因此可以这样写</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-90-1"><a id="__codelineno-90-1" name="__codelineno-90-1" href="#__codelineno-90-1"></a><span class="k">return</span> <span class="nb">all</span><span class="p">([</span><span class="nb">sum</span><span class="p">([</span><span class="mi">1</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">s</span> <span class="k">if</span> <span class="n">y</span> <span class="o">==</span> <span class="n">x</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">s</span><span class="p">])</span>
</span></code></pre></div>
<p>而进一步，可以借助 <code>min</code> 来判断最小的结果大于 1 就可以了，</p>
<p>而然后，列表有一个 <code>.count()</code> 方法，计算某个元素的个数，因此得到(应该是)最简洁的写法(真给我看得全程惊呆了😲)</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-91-1"><a id="__codelineno-91-1" name="__codelineno-91-1" href="#__codelineno-91-1"></a><span class="k">return</span> <span class="nb">min</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">s</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span>
</span></code></pre></div>
<p><a class="glightbox" href="../images/cs61a_120.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_120" loading="lazy" src="../images/cs61a_120.png" /></a></p>
<h3 id="3_10">3<a class="headerlink" href="#3_10" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_122.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_122" loading="lazy" src="../images/cs61a_122.png" /></a></p>
<p>这里的第三和第四个问题感觉有点意思，第四个问题我一开始想没有想出来，最后看了 John 的编写才想明白</p>
<p><a class="glightbox" href="../images/cs61a_123.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_123" loading="lazy" src="../images/cs61a_123.png" /></a></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-92-1"><a id="__codelineno-92-1" name="__codelineno-92-1" href="#__codelineno-92-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">merge</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
</span><span id="__span-92-2"><a id="__codelineno-92-2" name="__codelineno-92-2" href="#__codelineno-92-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a sorted Link with the elements of sorted s &amp; t.</span>
</span><span id="__span-92-3"><a id="__codelineno-92-3" name="__codelineno-92-3" href="#__codelineno-92-3"></a>
</span><span id="__span-92-4"><a id="__codelineno-92-4" name="__codelineno-92-4" href="#__codelineno-92-4"></a><span class="sd">    &gt;&gt;&gt; a = Link(1, Link(5))</span>
</span><span id="__span-92-5"><a id="__codelineno-92-5" name="__codelineno-92-5" href="#__codelineno-92-5"></a><span class="sd">    &gt;&gt;&gt; b = Link(1, Link(4))</span>
</span><span id="__span-92-6"><a id="__codelineno-92-6" name="__codelineno-92-6" href="#__codelineno-92-6"></a><span class="sd">    &gt;&gt;&gt; merge(a, b)</span>
</span><span id="__span-92-7"><a id="__codelineno-92-7" name="__codelineno-92-7" href="#__codelineno-92-7"></a><span class="sd">    Link(1, Link(1, Link(4, Link(5))))</span>
</span><span id="__span-92-8"><a id="__codelineno-92-8" name="__codelineno-92-8" href="#__codelineno-92-8"></a><span class="sd">    &gt;&gt;&gt; a</span>
</span><span id="__span-92-9"><a id="__codelineno-92-9" name="__codelineno-92-9" href="#__codelineno-92-9"></a><span class="sd">    Link(1, Link(5))</span>
</span><span id="__span-92-10"><a id="__codelineno-92-10" name="__codelineno-92-10" href="#__codelineno-92-10"></a><span class="sd">    &gt;&gt;&gt; b</span>
</span><span id="__span-92-11"><a id="__codelineno-92-11" name="__codelineno-92-11" href="#__codelineno-92-11"></a><span class="sd">    Link(1, Link(4))</span>
</span><span id="__span-92-12"><a id="__codelineno-92-12" name="__codelineno-92-12" href="#__codelineno-92-12"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-92-13"><a id="__codelineno-92-13" name="__codelineno-92-13" href="#__codelineno-92-13"></a>    <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="n">Link</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-92-14"><a id="__codelineno-92-14" name="__codelineno-92-14" href="#__codelineno-92-14"></a>        <span class="k">return</span> <span class="n">t</span>
</span><span id="__span-92-15"><a id="__codelineno-92-15" name="__codelineno-92-15" href="#__codelineno-92-15"></a>    <span class="k">elif</span> <span class="n">t</span> <span class="ow">is</span> <span class="n">Link</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-92-16"><a id="__codelineno-92-16" name="__codelineno-92-16" href="#__codelineno-92-16"></a>        <span class="k">return</span> <span class="n">s</span>
</span><span id="__span-92-17"><a id="__codelineno-92-17" name="__codelineno-92-17" href="#__codelineno-92-17"></a>    <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">first</span> <span class="o">&lt;=</span> <span class="n">t</span><span class="o">.</span><span class="n">first</span><span class="p">:</span>
</span><span id="__span-92-18"><a id="__codelineno-92-18" name="__codelineno-92-18" href="#__codelineno-92-18"></a>        <span class="k">return</span> <span class="n">Link</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">merge</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>
</span><span id="__span-92-19"><a id="__codelineno-92-19" name="__codelineno-92-19" href="#__codelineno-92-19"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-92-20"><a id="__codelineno-92-20" name="__codelineno-92-20" href="#__codelineno-92-20"></a>        <span class="k">return</span> <span class="n">Link</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">merge</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">rest</span><span class="p">))</span>
</span><span id="__span-92-21"><a id="__codelineno-92-21" name="__codelineno-92-21" href="#__codelineno-92-21"></a>
</span><span id="__span-92-22"><a id="__codelineno-92-22" name="__codelineno-92-22" href="#__codelineno-92-22"></a><span class="k">def</span><span class="w"> </span><span class="nf">merge_in_place</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
</span><span id="__span-92-23"><a id="__codelineno-92-23" name="__codelineno-92-23" href="#__codelineno-92-23"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a sorted Link with the elements of sorted s &amp; t.</span>
</span><span id="__span-92-24"><a id="__codelineno-92-24" name="__codelineno-92-24" href="#__codelineno-92-24"></a>
</span><span id="__span-92-25"><a id="__codelineno-92-25" name="__codelineno-92-25" href="#__codelineno-92-25"></a><span class="sd">    &gt;&gt;&gt; a = Link(1, Link(5))</span>
</span><span id="__span-92-26"><a id="__codelineno-92-26" name="__codelineno-92-26" href="#__codelineno-92-26"></a><span class="sd">    &gt;&gt;&gt; b = Link(1, Link(4))</span>
</span><span id="__span-92-27"><a id="__codelineno-92-27" name="__codelineno-92-27" href="#__codelineno-92-27"></a><span class="sd">    &gt;&gt;&gt; merge(a, b)</span>
</span><span id="__span-92-28"><a id="__codelineno-92-28" name="__codelineno-92-28" href="#__codelineno-92-28"></a><span class="sd">    Link(1, Link(1, Link(4, Link(5))))</span>
</span><span id="__span-92-29"><a id="__codelineno-92-29" name="__codelineno-92-29" href="#__codelineno-92-29"></a><span class="sd">    &gt;&gt;&gt; a</span>
</span><span id="__span-92-30"><a id="__codelineno-92-30" name="__codelineno-92-30" href="#__codelineno-92-30"></a><span class="sd">    Link(1, Link(1, Link(4, Link(5))))</span>
</span><span id="__span-92-31"><a id="__codelineno-92-31" name="__codelineno-92-31" href="#__codelineno-92-31"></a><span class="sd">    &gt;&gt;&gt; b</span>
</span><span id="__span-92-32"><a id="__codelineno-92-32" name="__codelineno-92-32" href="#__codelineno-92-32"></a><span class="sd">    Link(1, Link(4, Link(5)))</span>
</span><span id="__span-92-33"><a id="__codelineno-92-33" name="__codelineno-92-33" href="#__codelineno-92-33"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-92-34"><a id="__codelineno-92-34" name="__codelineno-92-34" href="#__codelineno-92-34"></a>    <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="n">Link</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-92-35"><a id="__codelineno-92-35" name="__codelineno-92-35" href="#__codelineno-92-35"></a>        <span class="k">return</span> <span class="n">t</span>
</span><span id="__span-92-36"><a id="__codelineno-92-36" name="__codelineno-92-36" href="#__codelineno-92-36"></a>    <span class="k">elif</span> <span class="n">t</span> <span class="ow">is</span> <span class="n">Link</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-92-37"><a id="__codelineno-92-37" name="__codelineno-92-37" href="#__codelineno-92-37"></a>        <span class="k">return</span> <span class="n">s</span>
</span><span id="__span-92-38"><a id="__codelineno-92-38" name="__codelineno-92-38" href="#__codelineno-92-38"></a>    <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">first</span> <span class="o">&lt;=</span> <span class="n">t</span><span class="o">.</span><span class="n">first</span><span class="p">:</span>
</span><span id="__span-92-39"><a id="__codelineno-92-39" name="__codelineno-92-39" href="#__codelineno-92-39"></a>        <span class="c1"># return Link(s.first, merge(s.rest, t))</span>
</span><span id="__span-92-40"><a id="__codelineno-92-40" name="__codelineno-92-40" href="#__codelineno-92-40"></a>        <span class="n">s</span><span class="o">.</span><span class="n">rest</span> <span class="o">=</span> <span class="n">merge_in_place</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
</span><span id="__span-92-41"><a id="__codelineno-92-41" name="__codelineno-92-41" href="#__codelineno-92-41"></a>        <span class="k">return</span> <span class="n">s</span>
</span><span id="__span-92-42"><a id="__codelineno-92-42" name="__codelineno-92-42" href="#__codelineno-92-42"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-92-43"><a id="__codelineno-92-43" name="__codelineno-92-43" href="#__codelineno-92-43"></a>        <span class="c1"># return Link(t.first, merge(s, t.rest))</span>
</span><span id="__span-92-44"><a id="__codelineno-92-44" name="__codelineno-92-44" href="#__codelineno-92-44"></a>        <span class="n">t</span><span class="o">.</span><span class="n">rest</span> <span class="o">=</span> <span class="n">merge_in_place</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">rest</span><span class="p">)</span>
</span><span id="__span-92-45"><a id="__codelineno-92-45" name="__codelineno-92-45" href="#__codelineno-92-45"></a>        <span class="k">return</span> <span class="n">t</span>
</span></code></pre></div>
<h2 id="lecture-24-qa">Lecture 24 Q&amp;A<a class="headerlink" href="#lecture-24-qa" title="Permanent link">&para;</a></h2>
<h3 id="1_16">1<a class="headerlink" href="#1_16" title="Permanent link">&para;</a></h3>
<p>提到的17春(第二次期中模拟考)的一个题目</p>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p><strong>Perfect Engine!</strong></p>
<p>You are in an apocalyptic society and have been charged with making an n-gen, or a generator that computes all of the n-perfect numbers. However, in this apocalyptic society, <strong>built-in AND user-defined Python multiplication is forbidden</strong> in any form!</p>
<p>You have a blueprint for building a few n-gins from a natural number generator:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-93-1"><a id="__codelineno-93-1" name="__codelineno-93-1" href="#__codelineno-93-1"></a>A 2-gen:
</span><span id="__span-93-2"><a id="__codelineno-93-2" name="__codelineno-93-2" href="#__codelineno-93-2"></a>1 2 3 4 5 6 7 8 9 ...
</span><span id="__span-93-3"><a id="__codelineno-93-3" name="__codelineno-93-3" href="#__codelineno-93-3"></a>1 4 9 16 25 ...
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-94-1"><a id="__codelineno-94-1" name="__codelineno-94-1" href="#__codelineno-94-1"></a>A 3-gen:
</span><span id="__span-94-2"><a id="__codelineno-94-2" name="__codelineno-94-2" href="#__codelineno-94-2"></a>1 2 3 4 5 6 7 8 9 ...
</span><span id="__span-94-3"><a id="__codelineno-94-3" name="__codelineno-94-3" href="#__codelineno-94-3"></a>1 3 7 12 19 27 ...
</span><span id="__span-94-4"><a id="__codelineno-94-4" name="__codelineno-94-4" href="#__codelineno-94-4"></a>1 8 27 ...
</span></code></pre></div>
<p>Hint: Here is how <code>yield from</code> works. When used inside an iterable <code>yield from</code> will issue each element from another iterable as though it was issued from the first iterable. The following code is equivalent:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-95-1"><a id="__codelineno-95-1" name="__codelineno-95-1" href="#__codelineno-95-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">generator1</span> <span class="p">():</span>
</span><span id="__span-95-2"><a id="__codelineno-95-2" name="__codelineno-95-2" href="#__codelineno-95-2"></a>    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">generator2</span> <span class="p">():</span>
</span><span id="__span-95-3"><a id="__codelineno-95-3" name="__codelineno-95-3" href="#__codelineno-95-3"></a>        <span class="k">yield</span> <span class="n">item</span>
</span><span id="__span-95-4"><a id="__codelineno-95-4" name="__codelineno-95-4" href="#__codelineno-95-4"></a>    <span class="c1"># do more things in this generator</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-96-1"><a id="__codelineno-96-1" name="__codelineno-96-1" href="#__codelineno-96-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">generator1</span> <span class="p">():</span>
</span><span id="__span-96-2"><a id="__codelineno-96-2" name="__codelineno-96-2" href="#__codelineno-96-2"></a>    <span class="k">yield from</span> <span class="n">generator2</span> <span class="p">()</span>
</span><span id="__span-96-3"><a id="__codelineno-96-3" name="__codelineno-96-3" href="#__codelineno-96-3"></a>    <span class="c1"># more things on this generator</span>
</span></code></pre></div>
<p>Now its your job to build the perfect n-gen and power society out of the apocalypse! Good luck!</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-97-1"><a id="__codelineno-97-1" name="__codelineno-97-1" href="#__codelineno-97-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">nats</span><span class="p">():</span>
</span><span id="__span-97-2"><a id="__codelineno-97-2" name="__codelineno-97-2" href="#__codelineno-97-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-97-3"><a id="__codelineno-97-3" name="__codelineno-97-3" href="#__codelineno-97-3"></a><span class="sd">    A generator that yields</span>
</span><span id="__span-97-4"><a id="__codelineno-97-4" name="__codelineno-97-4" href="#__codelineno-97-4"></a><span class="sd">    all natural numbers.</span>
</span><span id="__span-97-5"><a id="__codelineno-97-5" name="__codelineno-97-5" href="#__codelineno-97-5"></a><span class="sd">    Might be helpful!</span>
</span><span id="__span-97-6"><a id="__codelineno-97-6" name="__codelineno-97-6" href="#__codelineno-97-6"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-97-7"><a id="__codelineno-97-7" name="__codelineno-97-7" href="#__codelineno-97-7"></a>    <span class="n">curr</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-97-8"><a id="__codelineno-97-8" name="__codelineno-97-8" href="#__codelineno-97-8"></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-97-9"><a id="__codelineno-97-9" name="__codelineno-97-9" href="#__codelineno-97-9"></a>        <span class="n">curr</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-97-10"><a id="__codelineno-97-10" name="__codelineno-97-10" href="#__codelineno-97-10"></a>        <span class="k">yield</span> <span class="n">curr</span>
</span><span id="__span-97-11"><a id="__codelineno-97-11" name="__codelineno-97-11" href="#__codelineno-97-11"></a>
</span><span id="__span-97-12"><a id="__codelineno-97-12" name="__codelineno-97-12" href="#__codelineno-97-12"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_skip</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">gen</span><span class="p">):</span>
</span><span id="__span-97-13"><a id="__codelineno-97-13" name="__codelineno-97-13" href="#__codelineno-97-13"></a>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-97-14"><a id="__codelineno-97-14" name="__codelineno-97-14" href="#__codelineno-97-14"></a>        <span class="k">yield from</span> <span class="n">____________</span>
</span><span id="__span-97-15"><a id="__codelineno-97-15" name="__codelineno-97-15" href="#__codelineno-97-15"></a>    <span class="n">curr</span> <span class="p">,</span> <span class="n">skip</span> <span class="o">=</span> <span class="n">________</span><span class="p">,</span> <span class="n">________</span>
</span><span id="__span-97-16"><a id="__codelineno-97-16" name="__codelineno-97-16" href="#__codelineno-97-16"></a>    <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">____________</span><span class="p">:</span>
</span><span id="__span-97-17"><a id="__codelineno-97-17" name="__codelineno-97-17" href="#__codelineno-97-17"></a>        <span class="k">if</span> <span class="n">skip</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
</span><span id="__span-97-18"><a id="__codelineno-97-18" name="__codelineno-97-18" href="#__codelineno-97-18"></a>            <span class="n">___________________</span>
</span><span id="__span-97-19"><a id="__codelineno-97-19" name="__codelineno-97-19" href="#__codelineno-97-19"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-97-20"><a id="__codelineno-97-20" name="__codelineno-97-20" href="#__codelineno-97-20"></a>            <span class="n">curr</span> <span class="o">=</span> <span class="n">__________________</span>
</span><span id="__span-97-21"><a id="__codelineno-97-21" name="__codelineno-97-21" href="#__codelineno-97-21"></a>            <span class="n">skip</span> <span class="o">=</span> <span class="n">_________________</span>
</span><span id="__span-97-22"><a id="__codelineno-97-22" name="__codelineno-97-22" href="#__codelineno-97-22"></a>            <span class="k">yield</span> <span class="n">_________________</span>
</span><span id="__span-97-23"><a id="__codelineno-97-23" name="__codelineno-97-23" href="#__codelineno-97-23"></a>
</span><span id="__span-97-24"><a id="__codelineno-97-24" name="__codelineno-97-24" href="#__codelineno-97-24"></a><span class="k">def</span><span class="w"> </span><span class="nf">perfect_ngen</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="__span-97-25"><a id="__codelineno-97-25" name="__codelineno-97-25" href="#__codelineno-97-25"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-97-26"><a id="__codelineno-97-26" name="__codelineno-97-26" href="#__codelineno-97-26"></a><span class="sd">    &gt;&gt;&gt; two_gen = perfect_ngen(2)</span>
</span><span id="__span-97-27"><a id="__codelineno-97-27" name="__codelineno-97-27" href="#__codelineno-97-27"></a><span class="sd">    &gt;&gt;&gt; next(two_gen)</span>
</span><span id="__span-97-28"><a id="__codelineno-97-28" name="__codelineno-97-28" href="#__codelineno-97-28"></a><span class="sd">    1</span>
</span><span id="__span-97-29"><a id="__codelineno-97-29" name="__codelineno-97-29" href="#__codelineno-97-29"></a><span class="sd">    &gt;&gt;&gt; next(two_gen)</span>
</span><span id="__span-97-30"><a id="__codelineno-97-30" name="__codelineno-97-30" href="#__codelineno-97-30"></a><span class="sd">    4</span>
</span><span id="__span-97-31"><a id="__codelineno-97-31" name="__codelineno-97-31" href="#__codelineno-97-31"></a><span class="sd">    &gt;&gt;&gt; next(two_gen)</span>
</span><span id="__span-97-32"><a id="__codelineno-97-32" name="__codelineno-97-32" href="#__codelineno-97-32"></a><span class="sd">    9</span>
</span><span id="__span-97-33"><a id="__codelineno-97-33" name="__codelineno-97-33" href="#__codelineno-97-33"></a><span class="sd">    &gt;&gt;&gt; three_gen = perfect_ngen(3)</span>
</span><span id="__span-97-34"><a id="__codelineno-97-34" name="__codelineno-97-34" href="#__codelineno-97-34"></a><span class="sd">    &gt;&gt;&gt; next(three_gen)</span>
</span><span id="__span-97-35"><a id="__codelineno-97-35" name="__codelineno-97-35" href="#__codelineno-97-35"></a><span class="sd">    1</span>
</span><span id="__span-97-36"><a id="__codelineno-97-36" name="__codelineno-97-36" href="#__codelineno-97-36"></a><span class="sd">    &gt;&gt;&gt; next(three_gen)</span>
</span><span id="__span-97-37"><a id="__codelineno-97-37" name="__codelineno-97-37" href="#__codelineno-97-37"></a><span class="sd">    8</span>
</span><span id="__span-97-38"><a id="__codelineno-97-38" name="__codelineno-97-38" href="#__codelineno-97-38"></a><span class="sd">    &gt;&gt;&gt; next(three_gen)</span>
</span><span id="__span-97-39"><a id="__codelineno-97-39" name="__codelineno-97-39" href="#__codelineno-97-39"></a><span class="sd">    27</span>
</span><span id="__span-97-40"><a id="__codelineno-97-40" name="__codelineno-97-40" href="#__codelineno-97-40"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-97-41"><a id="__codelineno-97-41" name="__codelineno-97-41" href="#__codelineno-97-41"></a>    <span class="n">gen</span> <span class="o">=</span> <span class="n">create_skip</span><span class="p">(</span><span class="n">____</span><span class="p">,</span> <span class="n">_______</span><span class="p">)</span>
</span><span id="__span-97-42"><a id="__codelineno-97-42" name="__codelineno-97-42" href="#__codelineno-97-42"></a>    <span class="k">while</span> <span class="n">_________________</span><span class="p">:</span>
</span><span id="__span-97-43"><a id="__codelineno-97-43" name="__codelineno-97-43" href="#__codelineno-97-43"></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">_________________</span>
</span><span id="__span-97-44"><a id="__codelineno-97-44" name="__codelineno-97-44" href="#__codelineno-97-44"></a>        <span class="n">gen</span> <span class="o">=</span> <span class="n">create_skip</span><span class="p">(</span><span class="n">____</span><span class="p">,</span> <span class="n">_______</span><span class="p">)</span>
</span><span id="__span-97-45"><a id="__codelineno-97-45" name="__codelineno-97-45" href="#__codelineno-97-45"></a>    <span class="k">return</span> <span class="n">gen</span>
</span></code></pre></div>
</div>
<p>感觉这题有点好玩，用到了一些数学上的结论，看了好一会才看懂题目，</p>
<p>大概是，要实现一个能返回 自然数的 n 次方生成器 的函数，而且不能使用乘法，</p>
<p>从给出的两个例子看，输出平方数列的方法是，将自然数列中的偶数(2的倍数)跳过，再将数列中之前的其他数加起来，和就刚好是平方，</p>
<p>而对于立方数列，与平方类似，先是将自然数列中 3的倍数跳过，然后将之前的其他数加起来，得到一个数列，再将这个数列再进行一次同样的操作(即跳过 3的倍数，取之前数的和，看到这里会发现 <strong>自然数列中，3的倍数刚好间隔为3，而新数列中刚好间隔为2</strong>，这一点会在给出的代码框架中被用上)，最后得到的数列就是立方数列(感觉好神奇😲)，</p>
<p>所以我就尝试了一下这个题目</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-98-1"><a id="__codelineno-98-1" name="__codelineno-98-1" href="#__codelineno-98-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">nats</span><span class="p">():</span>
</span><span id="__span-98-2"><a id="__codelineno-98-2" name="__codelineno-98-2" href="#__codelineno-98-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-98-3"><a id="__codelineno-98-3" name="__codelineno-98-3" href="#__codelineno-98-3"></a><span class="sd">    A generator that yields</span>
</span><span id="__span-98-4"><a id="__codelineno-98-4" name="__codelineno-98-4" href="#__codelineno-98-4"></a><span class="sd">    all natural numbers.</span>
</span><span id="__span-98-5"><a id="__codelineno-98-5" name="__codelineno-98-5" href="#__codelineno-98-5"></a><span class="sd">    Might be helpful!</span>
</span><span id="__span-98-6"><a id="__codelineno-98-6" name="__codelineno-98-6" href="#__codelineno-98-6"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-98-7"><a id="__codelineno-98-7" name="__codelineno-98-7" href="#__codelineno-98-7"></a>    <span class="n">curr</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-98-8"><a id="__codelineno-98-8" name="__codelineno-98-8" href="#__codelineno-98-8"></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-98-9"><a id="__codelineno-98-9" name="__codelineno-98-9" href="#__codelineno-98-9"></a>        <span class="n">curr</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-98-10"><a id="__codelineno-98-10" name="__codelineno-98-10" href="#__codelineno-98-10"></a>        <span class="k">yield</span> <span class="n">curr</span>
</span><span id="__span-98-11"><a id="__codelineno-98-11" name="__codelineno-98-11" href="#__codelineno-98-11"></a>
</span><span id="__span-98-12"><a id="__codelineno-98-12" name="__codelineno-98-12" href="#__codelineno-98-12"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_skip</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">gen</span><span class="p">):</span>
</span><span id="__span-98-13"><a id="__codelineno-98-13" name="__codelineno-98-13" href="#__codelineno-98-13"></a>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-98-14"><a id="__codelineno-98-14" name="__codelineno-98-14" href="#__codelineno-98-14"></a>        <span class="k">yield from</span> <span class="n">gen</span>
</span><span id="__span-98-15"><a id="__codelineno-98-15" name="__codelineno-98-15" href="#__codelineno-98-15"></a>    <span class="n">curr</span> <span class="p">,</span> <span class="n">skip</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
</span><span id="__span-98-16"><a id="__codelineno-98-16" name="__codelineno-98-16" href="#__codelineno-98-16"></a>    <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">gen</span><span class="p">:</span>
</span><span id="__span-98-17"><a id="__codelineno-98-17" name="__codelineno-98-17" href="#__codelineno-98-17"></a>        <span class="k">if</span> <span class="n">skip</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
</span><span id="__span-98-18"><a id="__codelineno-98-18" name="__codelineno-98-18" href="#__codelineno-98-18"></a>            <span class="n">skip</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-98-19"><a id="__codelineno-98-19" name="__codelineno-98-19" href="#__codelineno-98-19"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-98-20"><a id="__codelineno-98-20" name="__codelineno-98-20" href="#__codelineno-98-20"></a>            <span class="n">curr</span> <span class="o">=</span> <span class="n">curr</span> <span class="o">+</span> <span class="n">elem</span>
</span><span id="__span-98-21"><a id="__codelineno-98-21" name="__codelineno-98-21" href="#__codelineno-98-21"></a>            <span class="n">skip</span> <span class="o">=</span> <span class="n">skip</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="__span-98-22"><a id="__codelineno-98-22" name="__codelineno-98-22" href="#__codelineno-98-22"></a>            <span class="k">yield</span> <span class="n">curr</span>
</span><span id="__span-98-23"><a id="__codelineno-98-23" name="__codelineno-98-23" href="#__codelineno-98-23"></a>
</span><span id="__span-98-24"><a id="__codelineno-98-24" name="__codelineno-98-24" href="#__codelineno-98-24"></a><span class="k">def</span><span class="w"> </span><span class="nf">perfect_ngen</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="__span-98-25"><a id="__codelineno-98-25" name="__codelineno-98-25" href="#__codelineno-98-25"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-98-26"><a id="__codelineno-98-26" name="__codelineno-98-26" href="#__codelineno-98-26"></a><span class="sd">    &gt;&gt;&gt; two_gen = perfect_ngen(2)</span>
</span><span id="__span-98-27"><a id="__codelineno-98-27" name="__codelineno-98-27" href="#__codelineno-98-27"></a><span class="sd">    &gt;&gt;&gt; next(two_gen)</span>
</span><span id="__span-98-28"><a id="__codelineno-98-28" name="__codelineno-98-28" href="#__codelineno-98-28"></a><span class="sd">    1</span>
</span><span id="__span-98-29"><a id="__codelineno-98-29" name="__codelineno-98-29" href="#__codelineno-98-29"></a><span class="sd">    &gt;&gt;&gt; next(two_gen)</span>
</span><span id="__span-98-30"><a id="__codelineno-98-30" name="__codelineno-98-30" href="#__codelineno-98-30"></a><span class="sd">    4</span>
</span><span id="__span-98-31"><a id="__codelineno-98-31" name="__codelineno-98-31" href="#__codelineno-98-31"></a><span class="sd">    &gt;&gt;&gt; next(two_gen)</span>
</span><span id="__span-98-32"><a id="__codelineno-98-32" name="__codelineno-98-32" href="#__codelineno-98-32"></a><span class="sd">    9</span>
</span><span id="__span-98-33"><a id="__codelineno-98-33" name="__codelineno-98-33" href="#__codelineno-98-33"></a><span class="sd">    &gt;&gt;&gt; three_gen = perfect_ngen(3)</span>
</span><span id="__span-98-34"><a id="__codelineno-98-34" name="__codelineno-98-34" href="#__codelineno-98-34"></a><span class="sd">    &gt;&gt;&gt; next(three_gen)</span>
</span><span id="__span-98-35"><a id="__codelineno-98-35" name="__codelineno-98-35" href="#__codelineno-98-35"></a><span class="sd">    1</span>
</span><span id="__span-98-36"><a id="__codelineno-98-36" name="__codelineno-98-36" href="#__codelineno-98-36"></a><span class="sd">    &gt;&gt;&gt; next(three_gen)</span>
</span><span id="__span-98-37"><a id="__codelineno-98-37" name="__codelineno-98-37" href="#__codelineno-98-37"></a><span class="sd">    8</span>
</span><span id="__span-98-38"><a id="__codelineno-98-38" name="__codelineno-98-38" href="#__codelineno-98-38"></a><span class="sd">    &gt;&gt;&gt; next(three_gen)</span>
</span><span id="__span-98-39"><a id="__codelineno-98-39" name="__codelineno-98-39" href="#__codelineno-98-39"></a><span class="sd">    27</span>
</span><span id="__span-98-40"><a id="__codelineno-98-40" name="__codelineno-98-40" href="#__codelineno-98-40"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-98-41"><a id="__codelineno-98-41" name="__codelineno-98-41" href="#__codelineno-98-41"></a>    <span class="n">gen</span> <span class="o">=</span> <span class="n">create_skip</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">nats</span><span class="p">())</span>
</span><span id="__span-98-42"><a id="__codelineno-98-42" name="__codelineno-98-42" href="#__codelineno-98-42"></a>    <span class="k">while</span> <span class="n">n</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-98-43"><a id="__codelineno-98-43" name="__codelineno-98-43" href="#__codelineno-98-43"></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="__span-98-44"><a id="__codelineno-98-44" name="__codelineno-98-44" href="#__codelineno-98-44"></a>        <span class="n">gen</span> <span class="o">=</span> <span class="n">create_skip</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">gen</span><span class="p">)</span>
</span><span id="__span-98-45"><a id="__codelineno-98-45" name="__codelineno-98-45" href="#__codelineno-98-45"></a>    <span class="k">return</span> <span class="n">gen</span>
</span></code></pre></div>
<p><a class="glightbox" href="../images/cs61a_124.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_124" loading="lazy" src="../images/cs61a_124.png" /></a></p>
<h3 id="2_14">2<a class="headerlink" href="#2_14" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_128.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_128" loading="lazy" src="../images/cs61a_128.png" /></a></p>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-99-1"><a id="__codelineno-99-1" name="__codelineno-99-1" href="#__codelineno-99-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">smallest</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span><span id="__span-99-2"><a id="__codelineno-99-2" name="__codelineno-99-2" href="#__codelineno-99-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot; A sequence is near increasing if each element but the last two is smaller than all elements</span>
</span><span id="__span-99-3"><a id="__codelineno-99-3" name="__codelineno-99-3" href="#__codelineno-99-3"></a><span class="sd">    following its subsequent element. That is, element i must be smaller than elements i + 2, i + 3, i + 4 etc.</span>
</span><span id="__span-99-4"><a id="__codelineno-99-4" name="__codelineno-99-4" href="#__codelineno-99-4"></a><span class="sd">    Implement close, which takes a non-negative integer n and returns the largest near increasing sequence</span>
</span><span id="__span-99-5"><a id="__codelineno-99-5" name="__codelineno-99-5" href="#__codelineno-99-5"></a><span class="sd">    of digits within n as an integer. The arguments smallest and d are part of the implementation; you must</span>
</span><span id="__span-99-6"><a id="__codelineno-99-6" name="__codelineno-99-6" href="#__codelineno-99-6"></a><span class="sd">    determine their purpose. The only values you may use are integers and booleans (True and False) (no lists, strings, etc.).</span>
</span><span id="__span-99-7"><a id="__codelineno-99-7" name="__codelineno-99-7" href="#__codelineno-99-7"></a><span class="sd">    Return the longest sequence of near-increasing digits in n.</span>
</span><span id="__span-99-8"><a id="__codelineno-99-8" name="__codelineno-99-8" href="#__codelineno-99-8"></a><span class="sd">    &gt;&gt;&gt; close(123)</span>
</span><span id="__span-99-9"><a id="__codelineno-99-9" name="__codelineno-99-9" href="#__codelineno-99-9"></a><span class="sd">    123</span>
</span><span id="__span-99-10"><a id="__codelineno-99-10" name="__codelineno-99-10" href="#__codelineno-99-10"></a><span class="sd">    &gt;&gt;&gt; close(153)</span>
</span><span id="__span-99-11"><a id="__codelineno-99-11" name="__codelineno-99-11" href="#__codelineno-99-11"></a><span class="sd">    153</span>
</span><span id="__span-99-12"><a id="__codelineno-99-12" name="__codelineno-99-12" href="#__codelineno-99-12"></a><span class="sd">    &gt;&gt;&gt; close(1523)</span>
</span><span id="__span-99-13"><a id="__codelineno-99-13" name="__codelineno-99-13" href="#__codelineno-99-13"></a><span class="sd">    153</span>
</span><span id="__span-99-14"><a id="__codelineno-99-14" name="__codelineno-99-14" href="#__codelineno-99-14"></a><span class="sd">    &gt;&gt;&gt; close(15123)</span>
</span><span id="__span-99-15"><a id="__codelineno-99-15" name="__codelineno-99-15" href="#__codelineno-99-15"></a><span class="sd">    1123</span>
</span><span id="__span-99-16"><a id="__codelineno-99-16" name="__codelineno-99-16" href="#__codelineno-99-16"></a><span class="sd">    &gt;&gt;&gt; close(11111111)</span>
</span><span id="__span-99-17"><a id="__codelineno-99-17" name="__codelineno-99-17" href="#__codelineno-99-17"></a><span class="sd">    11</span>
</span><span id="__span-99-18"><a id="__codelineno-99-18" name="__codelineno-99-18" href="#__codelineno-99-18"></a><span class="sd">    &gt;&gt;&gt; close(985357)</span>
</span><span id="__span-99-19"><a id="__codelineno-99-19" name="__codelineno-99-19" href="#__codelineno-99-19"></a><span class="sd">    557</span>
</span><span id="__span-99-20"><a id="__codelineno-99-20" name="__codelineno-99-20" href="#__codelineno-99-20"></a><span class="sd">    &gt;&gt;&gt; close(14735476)</span>
</span><span id="__span-99-21"><a id="__codelineno-99-21" name="__codelineno-99-21" href="#__codelineno-99-21"></a><span class="sd">    143576</span>
</span><span id="__span-99-22"><a id="__codelineno-99-22" name="__codelineno-99-22" href="#__codelineno-99-22"></a><span class="sd">    &gt;&gt;&gt; close(812348567)</span>
</span><span id="__span-99-23"><a id="__codelineno-99-23" name="__codelineno-99-23" href="#__codelineno-99-23"></a><span class="sd">    1234567</span>
</span><span id="__span-99-24"><a id="__codelineno-99-24" name="__codelineno-99-24" href="#__codelineno-99-24"></a><span class="sd">    &gt;&gt;&gt; close(45671) # with a 1 is 71; without a 1 is 4567</span>
</span><span id="__span-99-25"><a id="__codelineno-99-25" name="__codelineno-99-25" href="#__codelineno-99-25"></a><span class="sd">    4567</span>
</span><span id="__span-99-26"><a id="__codelineno-99-26" name="__codelineno-99-26" href="#__codelineno-99-26"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-99-27"><a id="__codelineno-99-27" name="__codelineno-99-27" href="#__codelineno-99-27"></a>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-99-28"><a id="__codelineno-99-28" name="__codelineno-99-28" href="#__codelineno-99-28"></a>        <span class="k">return</span> <span class="mi">0</span>
</span><span id="__span-99-29"><a id="__codelineno-99-29" name="__codelineno-99-29" href="#__codelineno-99-29"></a>    <span class="n">no</span> <span class="o">=</span> <span class="n">close</span><span class="p">(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">10</span><span class="p">,</span> <span class="n">smallest</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</span><span id="__span-99-30"><a id="__codelineno-99-30" name="__codelineno-99-30" href="#__codelineno-99-30"></a>    <span class="k">if</span> <span class="n">smallest</span> <span class="o">&gt;</span> <span class="n">______</span><span class="p">:</span>
</span><span id="__span-99-31"><a id="__codelineno-99-31" name="__codelineno-99-31" href="#__codelineno-99-31"></a>        <span class="n">yes</span> <span class="o">=</span> <span class="n">______</span>
</span><span id="__span-99-32"><a id="__codelineno-99-32" name="__codelineno-99-32" href="#__codelineno-99-32"></a>        <span class="k">return</span> <span class="n">______</span><span class="p">(</span><span class="n">yes</span><span class="p">,</span> <span class="n">no</span><span class="p">)</span>
</span><span id="__span-99-33"><a id="__codelineno-99-33" name="__codelineno-99-33" href="#__codelineno-99-33"></a>    <span class="k">return</span> <span class="n">______</span>
</span></code></pre></div>
</div>
<p>这道题有点难想，一开始看完了 John 写出答案的整个过程但还是没想明白，</p>
<p>然后 John 换了一个简单的例子来讲解，实现获得最大的递增子序列函数</p>
<p><a class="glightbox" href="../images/cs61a_129.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_129" loading="lazy" src="../images/cs61a_129.png" /></a></p>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p>John:</p>
<p>...let's let's solve a simpler one, more complicated than this, but less complicated than this, let's get rid of this notion of near increasing, and just, uh, look for the longest increasing sequence within n. we would need to keep track of some notion of what's the smallest thing i've done so far, um, so what does this do, return the sequence of digits within n, sorry, the largest sequence of digits within n that is increasing. so how might it work, if i call increasing on here's some digits, let's see what we got we could have two, then four, then seven and eight, that's pretty long try one more, uh we could have three four five six seven, that's pretty long. i didn't check too carefully but it's about right.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-100-1"><a id="__codelineno-100-1" name="__codelineno-100-1" href="#__codelineno-100-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">increasing</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">smallest</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span><span id="__span-100-2"><a id="__codelineno-100-2" name="__codelineno-100-2" href="#__codelineno-100-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the largest sequence of digits within n that is increasing.</span>
</span><span id="__span-100-3"><a id="__codelineno-100-3" name="__codelineno-100-3" href="#__codelineno-100-3"></a>
</span><span id="__span-100-4"><a id="__codelineno-100-4" name="__codelineno-100-4" href="#__codelineno-100-4"></a><span class="sd">    &gt;&gt;&gt; increasing(87247861)</span>
</span><span id="__span-100-5"><a id="__codelineno-100-5" name="__codelineno-100-5" href="#__codelineno-100-5"></a><span class="sd">    2478</span>
</span><span id="__span-100-6"><a id="__codelineno-100-6" name="__codelineno-100-6" href="#__codelineno-100-6"></a><span class="sd">    &gt;&gt;&gt; increasing(367456751)</span>
</span><span id="__span-100-7"><a id="__codelineno-100-7" name="__codelineno-100-7" href="#__codelineno-100-7"></a><span class="sd">    34567</span>
</span><span id="__span-100-8"><a id="__codelineno-100-8" name="__codelineno-100-8" href="#__codelineno-100-8"></a><span class="sd">    &quot;&quot;&quot;</span>
</span></code></pre></div>
<p>how will we do this one, if n equals zero, return zero. otherwise, if um the last digit of n is less than whatever is the smallest thing i've seen so far, then i might want to include it. so i'm going to just write this as, maybe i'll use n percent 10 in the result, or maybe not.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-101-1"><a id="__codelineno-101-1" name="__codelineno-101-1" href="#__codelineno-101-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">increasing</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">smallest</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span><span id="__span-101-2"><a id="__codelineno-101-2" name="__codelineno-101-2" href="#__codelineno-101-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the largest sequence of digits within n that is increasing.</span>
</span><span id="__span-101-3"><a id="__codelineno-101-3" name="__codelineno-101-3" href="#__codelineno-101-3"></a>
</span><span id="__span-101-4"><a id="__codelineno-101-4" name="__codelineno-101-4" href="#__codelineno-101-4"></a><span class="sd">    &gt;&gt;&gt; increasing(87247861)</span>
</span><span id="__span-101-5"><a id="__codelineno-101-5" name="__codelineno-101-5" href="#__codelineno-101-5"></a><span class="sd">    2478</span>
</span><span id="__span-101-6"><a id="__codelineno-101-6" name="__codelineno-101-6" href="#__codelineno-101-6"></a><span class="sd">    &gt;&gt;&gt; increasing(367456751)</span>
</span><span id="__span-101-7"><a id="__codelineno-101-7" name="__codelineno-101-7" href="#__codelineno-101-7"></a><span class="sd">    34567</span>
</span><span id="__span-101-8"><a id="__codelineno-101-8" name="__codelineno-101-8" href="#__codelineno-101-8"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-101-9"><a id="__codelineno-101-9" name="__codelineno-101-9" href="#__codelineno-101-9"></a>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-101-10"><a id="__codelineno-101-10" name="__codelineno-101-10" href="#__codelineno-101-10"></a>        <span class="k">return</span> <span class="mi">0</span>
</span><span id="__span-101-11"><a id="__codelineno-101-11" name="__codelineno-101-11" href="#__codelineno-101-11"></a>    <span class="k">elif</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">&lt;</span> <span class="n">smallest</span><span class="p">:</span>
</span><span id="__span-101-12"><a id="__codelineno-101-12" name="__codelineno-101-12" href="#__codelineno-101-12"></a>        <span class="c1"># Maybe I&#39;ll use n % 10 in the result or maybe not</span>
</span><span id="__span-101-13"><a id="__codelineno-101-13" name="__codelineno-101-13" href="#__codelineno-101-13"></a>    <span class="k">else</span><span class="p">:</span>
</span></code></pre></div>
<p>if n if the last digit is not allowed because it's bigger, than something that i've already decided i'm going to use, then i just can't use it. so that means the best i can do, is find the biggest increasing number within n divided by 10. okay so now we're going to have this notion of no and yes. no says i ignore n percent ten.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-102-1"><a id="__codelineno-102-1" name="__codelineno-102-1" href="#__codelineno-102-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">increasing</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">smallest</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span><span id="__span-102-2"><a id="__codelineno-102-2" name="__codelineno-102-2" href="#__codelineno-102-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the largest sequence of digits within n that is increasing.</span>
</span><span id="__span-102-3"><a id="__codelineno-102-3" name="__codelineno-102-3" href="#__codelineno-102-3"></a>
</span><span id="__span-102-4"><a id="__codelineno-102-4" name="__codelineno-102-4" href="#__codelineno-102-4"></a><span class="sd">    &gt;&gt;&gt; increasing(87247861)</span>
</span><span id="__span-102-5"><a id="__codelineno-102-5" name="__codelineno-102-5" href="#__codelineno-102-5"></a><span class="sd">    2478</span>
</span><span id="__span-102-6"><a id="__codelineno-102-6" name="__codelineno-102-6" href="#__codelineno-102-6"></a><span class="sd">    &gt;&gt;&gt; increasing(367456751)</span>
</span><span id="__span-102-7"><a id="__codelineno-102-7" name="__codelineno-102-7" href="#__codelineno-102-7"></a><span class="sd">    34567</span>
</span><span id="__span-102-8"><a id="__codelineno-102-8" name="__codelineno-102-8" href="#__codelineno-102-8"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-102-9"><a id="__codelineno-102-9" name="__codelineno-102-9" href="#__codelineno-102-9"></a>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-102-10"><a id="__codelineno-102-10" name="__codelineno-102-10" href="#__codelineno-102-10"></a>        <span class="k">return</span> <span class="mi">0</span>
</span><span id="__span-102-11"><a id="__codelineno-102-11" name="__codelineno-102-11" href="#__codelineno-102-11"></a>    <span class="k">elif</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">&lt;</span> <span class="n">smallest</span><span class="p">:</span>
</span><span id="__span-102-12"><a id="__codelineno-102-12" name="__codelineno-102-12" href="#__codelineno-102-12"></a>        <span class="c1"># Maybe I&#39;ll use n % 10 in the result or maybe not</span>
</span><span id="__span-102-13"><a id="__codelineno-102-13" name="__codelineno-102-13" href="#__codelineno-102-13"></a>        <span class="n">no</span> <span class="o">=</span> <span class="n">increasing</span><span class="p">(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">10</span><span class="p">)</span>
</span><span id="__span-102-14"><a id="__codelineno-102-14" name="__codelineno-102-14" href="#__codelineno-102-14"></a>        <span class="n">yes</span>
</span><span id="__span-102-15"><a id="__codelineno-102-15" name="__codelineno-102-15" href="#__codelineno-102-15"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-102-16"><a id="__codelineno-102-16" name="__codelineno-102-16" href="#__codelineno-102-16"></a>        <span class="k">return</span> <span class="n">increasing</span><span class="p">(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">10</span><span class="p">)</span>
</span></code></pre></div>
<p>this is the same as that, which is why this had kind of a funny structure, we'll talk about that later. it is important that when you're looking for the smallest thing within, and ignoring the last digit you still respect, how whatever digits you've decided to keep already along the way, so you have to pass in this notion of what's the smallest thing i've already decided to use. and then if you decide to use n percent 10, which is smaller than the smallest, now you can still find more digits, but they're not allowed to just be smaller than the smallest thing you had previously seen, now they have to be smaller than n percent 10. it turns out that this could be simplified, because we know that this is smaller than that, so i could trim this down, and i'd get the same result. but i'm going to leave it like this just so we can compare it with the other thing in a minute. and then here i would say, well, maybe i found the best thing without using this digit.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-103-1"><a id="__codelineno-103-1" name="__codelineno-103-1" href="#__codelineno-103-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">increasing</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">smallest</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span><span id="__span-103-2"><a id="__codelineno-103-2" name="__codelineno-103-2" href="#__codelineno-103-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the largest sequence of digits within n that is increasing.</span>
</span><span id="__span-103-3"><a id="__codelineno-103-3" name="__codelineno-103-3" href="#__codelineno-103-3"></a>
</span><span id="__span-103-4"><a id="__codelineno-103-4" name="__codelineno-103-4" href="#__codelineno-103-4"></a><span class="sd">    &gt;&gt;&gt; increasing(87247861)</span>
</span><span id="__span-103-5"><a id="__codelineno-103-5" name="__codelineno-103-5" href="#__codelineno-103-5"></a><span class="sd">    2478</span>
</span><span id="__span-103-6"><a id="__codelineno-103-6" name="__codelineno-103-6" href="#__codelineno-103-6"></a><span class="sd">    &gt;&gt;&gt; increasing(367456751)</span>
</span><span id="__span-103-7"><a id="__codelineno-103-7" name="__codelineno-103-7" href="#__codelineno-103-7"></a><span class="sd">    34567</span>
</span><span id="__span-103-8"><a id="__codelineno-103-8" name="__codelineno-103-8" href="#__codelineno-103-8"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-103-9"><a id="__codelineno-103-9" name="__codelineno-103-9" href="#__codelineno-103-9"></a>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-103-10"><a id="__codelineno-103-10" name="__codelineno-103-10" href="#__codelineno-103-10"></a>        <span class="k">return</span> <span class="mi">0</span>
</span><span id="__span-103-11"><a id="__codelineno-103-11" name="__codelineno-103-11" href="#__codelineno-103-11"></a>    <span class="k">elif</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">&lt;</span> <span class="n">smallest</span><span class="p">:</span>
</span><span id="__span-103-12"><a id="__codelineno-103-12" name="__codelineno-103-12" href="#__codelineno-103-12"></a>        <span class="c1"># Maybe I&#39;ll use n % 10 in the result or maybe not</span>
</span><span id="__span-103-13"><a id="__codelineno-103-13" name="__codelineno-103-13" href="#__codelineno-103-13"></a>        <span class="n">no</span> <span class="o">=</span> <span class="n">increasing</span><span class="p">(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">10</span><span class="p">,</span> <span class="n">smallest</span><span class="p">)</span>
</span><span id="__span-103-14"><a id="__codelineno-103-14" name="__codelineno-103-14" href="#__codelineno-103-14"></a>        <span class="n">yes</span> <span class="o">=</span> <span class="n">increasing</span><span class="p">(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">10</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">10</span><span class="p">,</span> <span class="n">smallest</span><span class="p">))</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">10</span>
</span><span id="__span-103-15"><a id="__codelineno-103-15" name="__codelineno-103-15" href="#__codelineno-103-15"></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">no</span><span class="p">,</span> <span class="n">yes</span><span class="p">)</span>
</span><span id="__span-103-16"><a id="__codelineno-103-16" name="__codelineno-103-16" href="#__codelineno-103-16"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-103-17"><a id="__codelineno-103-17" name="__codelineno-103-17" href="#__codelineno-103-17"></a>        <span class="k">return</span> <span class="n">increasing</span><span class="p">(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">10</span><span class="p">,</span> <span class="n">smallest</span><span class="p">)</span>
</span></code></pre></div>
<p>...so uh so what now, if you can understand this, then you can eventually understand this, but i agree that like close is just a much, like a considerably more complicated version of increasing. so i would focus on understanding this first what's going on here. let's just look at the mechanics, we either use one or we don't, in the in the choice where we don't, we just kind of pretend it's not there, and then we either use six or we don't, and in the choice where we don't we just pretend it's not there, and then we either use eight or we don't, in the choice that we do now, we have to make sure that everything else that we choose from here is smaller than eight. so we're going to have eight in the end, but we make a recursive call, that is i want the longest increasing sequence within eight seven two four seven, you know everything that's left over, except for all of the digits there have to be smaller than eight, and that's how i got this number. so if that makes sense then look at the difference between this, and that the difference between this and that is that, like we're just tucking away the most recent digit, and we're gonna include it in this notion of smallest, one step later than we otherwise would. so you're allowed to ignore the five, when you're checking to make sure that one is small enough, because that's just the rules of how this works.</p>
<hr />
<p>John:</p>
<p>...让我们解决一个更简单的问题，比这个复杂，但比这个简单，让我们摆脱近似递增的概念，只是寻找n中最长的递增序列。我们需要保持某种关于到目前为止我做过的最小的概念，那么这个函数是干什么的，返回n中递增的最大数字序列。所以它可能是怎么工作的，如果我在这里的一些数字上调用increasing，让我们看看我们得到了什么，我们可能有2，然后4，然后7和8，这很长，再试一次，我们可能有3，4，5，6，7，这也很长。我没有仔细检查，但大致是对的。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-104-1"><a id="__codelineno-104-1" name="__codelineno-104-1" href="#__codelineno-104-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">increasing</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">smallest</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span><span id="__span-104-2"><a id="__codelineno-104-2" name="__codelineno-104-2" href="#__codelineno-104-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the largest sequence of digits within n that is increasing.</span>
</span><span id="__span-104-3"><a id="__codelineno-104-3" name="__codelineno-104-3" href="#__codelineno-104-3"></a>
</span><span id="__span-104-4"><a id="__codelineno-104-4" name="__codelineno-104-4" href="#__codelineno-104-4"></a><span class="sd">    &gt;&gt;&gt; increasing(87247861)</span>
</span><span id="__span-104-5"><a id="__codelineno-104-5" name="__codelineno-104-5" href="#__codelineno-104-5"></a><span class="sd">    2478</span>
</span><span id="__span-104-6"><a id="__codelineno-104-6" name="__codelineno-104-6" href="#__codelineno-104-6"></a><span class="sd">    &gt;&gt;&gt; increasing(367456751)</span>
</span><span id="__span-104-7"><a id="__codelineno-104-7" name="__codelineno-104-7" href="#__codelineno-104-7"></a><span class="sd">    34567</span>
</span><span id="__span-104-8"><a id="__codelineno-104-8" name="__codelineno-104-8" href="#__codelineno-104-8"></a><span class="sd">    &quot;&quot;&quot;</span>
</span></code></pre></div>
<p>我们要如何解决这个问题，如果n等于零，返回零。否则，如果n的最后一位数字小于到目前为止我看到的最小值，那么我可能想要包含它。所以我将写成这样，也许我会在结果中使用n % 10，或者也许不会。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-105-1"><a id="__codelineno-105-1" name="__codelineno-105-1" href="#__codelineno-105-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">increasing</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">smallest</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span><span id="__span-105-2"><a id="__codelineno-105-2" name="__codelineno-105-2" href="#__codelineno-105-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the largest sequence of digits within n that is increasing.</span>
</span><span id="__span-105-3"><a id="__codelineno-105-3" name="__codelineno-105-3" href="#__codelineno-105-3"></a>
</span><span id="__span-105-4"><a id="__codelineno-105-4" name="__codelineno-105-4" href="#__codelineno-105-4"></a><span class="sd">    &gt;&gt;&gt; increasing(87247861)</span>
</span><span id="__span-105-5"><a id="__codelineno-105-5" name="__codelineno-105-5" href="#__codelineno-105-5"></a><span class="sd">    2478</span>
</span><span id="__span-105-6"><a id="__codelineno-105-6" name="__codelineno-105-6" href="#__codelineno-105-6"></a><span class="sd">    &gt;&gt;&gt; increasing(367456751)</span>
</span><span id="__span-105-7"><a id="__codelineno-105-7" name="__codelineno-105-7" href="#__codelineno-105-7"></a><span class="sd">    34567</span>
</span><span id="__span-105-8"><a id="__codelineno-105-8" name="__codelineno-105-8" href="#__codelineno-105-8"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-105-9"><a id="__codelineno-105-9" name="__codelineno-105-9" href="#__codelineno-105-9"></a>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-105-10"><a id="__codelineno-105-10" name="__codelineno-105-10" href="#__codelineno-105-10"></a>        <span class="k">return</span> <span class="mi">0</span>
</span><span id="__span-105-11"><a id="__codelineno-105-11" name="__codelineno-105-11" href="#__codelineno-105-11"></a>    <span class="k">elif</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">&lt;</span> <span class="n">smallest</span><span class="p">:</span>
</span><span id="__span-105-12"><a id="__codelineno-105-12" name="__codelineno-105-12" href="#__codelineno-105-12"></a>        <span class="c1"># Maybe I&#39;ll use n % 10 in the result or maybe not</span>
</span><span id="__span-105-13"><a id="__codelineno-105-13" name="__codelineno-105-13" href="#__codelineno-105-13"></a>    <span class="k">else</span><span class="p">:</span>
</span></code></pre></div>
<p>如果n的最后一位不允许，因为它比我已经决定要使用的某个东西要大，那么我就不能使用它。所以这意味着我能做的最好的事情是，在n除以10的范围内找到最大的递增数。好的，现在我们将有no和yes的概念。no表示我忽略n除以10的余数。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-106-1"><a id="__codelineno-106-1" name="__codelineno-106-1" href="#__codelineno-106-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">increasing</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">smallest</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span><span id="__span-106-2"><a id="__codelineno-106-2" name="__codelineno-106-2" href="#__codelineno-106-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the largest sequence of digits within n that is increasing.</span>
</span><span id="__span-106-3"><a id="__codelineno-106-3" name="__codelineno-106-3" href="#__codelineno-106-3"></a>
</span><span id="__span-106-4"><a id="__codelineno-106-4" name="__codelineno-106-4" href="#__codelineno-106-4"></a><span class="sd">    &gt;&gt;&gt; increasing(87247861)</span>
</span><span id="__span-106-5"><a id="__codelineno-106-5" name="__codelineno-106-5" href="#__codelineno-106-5"></a><span class="sd">    2478</span>
</span><span id="__span-106-6"><a id="__codelineno-106-6" name="__codelineno-106-6" href="#__codelineno-106-6"></a><span class="sd">    &gt;&gt;&gt; increasing(367456751)</span>
</span><span id="__span-106-7"><a id="__codelineno-106-7" name="__codelineno-106-7" href="#__codelineno-106-7"></a><span class="sd">    34567</span>
</span><span id="__span-106-8"><a id="__codelineno-106-8" name="__codelineno-106-8" href="#__codelineno-106-8"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-106-9"><a id="__codelineno-106-9" name="__codelineno-106-9" href="#__codelineno-106-9"></a>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-106-10"><a id="__codelineno-106-10" name="__codelineno-106-10" href="#__codelineno-106-10"></a>        <span class="k">return</span> <span class="mi">0</span>
</span><span id="__span-106-11"><a id="__codelineno-106-11" name="__codelineno-106-11" href="#__codelineno-106-11"></a>    <span class="k">elif</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">&lt;</span> <span class="n">smallest</span><span class="p">:</span>
</span><span id="__span-106-12"><a id="__codelineno-106-12" name="__codelineno-106-12" href="#__codelineno-106-12"></a>        <span class="c1"># Maybe I&#39;ll use n % 10 in the result or maybe not</span>
</span><span id="__span-106-13"><a id="__codelineno-106-13" name="__codelineno-106-13" href="#__codelineno-106-13"></a>        <span class="n">no</span> <span class="o">=</span> <span class="n">increasing</span><span class="p">(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">10</span><span class="p">)</span>
</span><span id="__span-106-14"><a id="__codelineno-106-14" name="__codelineno-106-14" href="#__codelineno-106-14"></a>        <span class="n">yes</span>
</span><span id="__span-106-15"><a id="__codelineno-106-15" name="__codelineno-106-15" href="#__codelineno-106-15"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-106-16"><a id="__codelineno-106-16" name="__codelineno-106-16" href="#__codelineno-106-16"></a>        <span class="k">return</span> <span class="n">increasing</span><span class="p">(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">10</span><span class="p">)</span>
</span></code></pre></div>
<p>这与那个相同，这就是为什么这个有点奇怪的结构，我们稍后会讨论的原因。在查找最小值时，忽略最后一位数字时，仍然要尊重沿途已经决定要保留的任何数字的规则，因此您必须传递这个已经决定使用的最小值的概念。然后，如果决定使用n % 10，这小于最小值，现在仍然可以找到更多的数字，但它们不能仅仅小于之前已经看到的最小值，现在它们必须小于n % 10。事实证明，这可以简化，因为我们知道这小于那，所以我可以缩短这个，然后得到相同的结果。但我会保留它，只是为了在一分钟内与另一种情况进行比较。然后在这里我会说，嗯，也许我已经找到了不使用这个数字的最好的结果。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-107-1"><a id="__codelineno-107-1" name="__codelineno-107-1" href="#__codelineno-107-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">increasing</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">smallest</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span><span id="__span-107-2"><a id="__codelineno-107-2" name="__codelineno-107-2" href="#__codelineno-107-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the largest sequence of digits within n that is increasing.</span>
</span><span id="__span-107-3"><a id="__codelineno-107-3" name="__codelineno-107-3" href="#__codelineno-107-3"></a>
</span><span id="__span-107-4"><a id="__codelineno-107-4" name="__codelineno-107-4" href="#__codelineno-107-4"></a><span class="sd">    &gt;&gt;&gt; increasing(87247861)</span>
</span><span id="__span-107-5"><a id="__codelineno-107-5" name="__codelineno-107-5" href="#__codelineno-107-5"></a><span class="sd">    2478</span>
</span><span id="__span-107-6"><a id="__codelineno-107-6" name="__codelineno-107-6" href="#__codelineno-107-6"></a><span class="sd">    &gt;&gt;&gt; increasing(367456751)</span>
</span><span id="__span-107-7"><a id="__codelineno-107-7" name="__codelineno-107-7" href="#__codelineno-107-7"></a><span class="sd">    34567</span>
</span><span id="__span-107-8"><a id="__codelineno-107-8" name="__codelineno-107-8" href="#__codelineno-107-8"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-107-9"><a id="__codelineno-107-9" name="__codelineno-107-9" href="#__codelineno-107-9"></a>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-107-10"><a id="__codelineno-107-10" name="__codelineno-107-10" href="#__codelineno-107-10"></a>        <span class="k">return</span> <span class="mi">0</span>
</span><span id="__span-107-11"><a id="__codelineno-107-11" name="__codelineno-107-11" href="#__codelineno-107-11"></a>    <span class="k">elif</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">&lt;</span> <span class="n">smallest</span><span class="p">:</span>
</span><span id="__span-107-12"><a id="__codelineno-107-12" name="__codelineno-107-12" href="#__codelineno-107-12"></a>        <span class="c1"># Maybe I&#39;ll use n % 10 in the result or maybe not</span>
</span><span id="__span-107-13"><a id="__codelineno-107-13" name="__codelineno-107-13" href="#__codelineno-107-13"></a>        <span class="n">no</span> <span class="o">=</span> <span class="n">increasing</span><span class="p">(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">10</span><span class="p">,</span> <span class="n">smallest</span><span class="p">)</span>
</span><span id="__span-107-14"><a id="__codelineno-107-14" name="__codelineno-107-14" href="#__codelineno-107-14"></a>        <span class="n">yes</span> <span class="o">=</span> <span class="n">increasing</span><span class="p">(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">10</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">10</span><span class="p">,</span> <span class="n">smallest</span><span class="p">))</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">10</span>
</span><span id="__span-107-15"><a id="__codelineno-107-15" name="__codelineno-107-15" href="#__codelineno-107-15"></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">no</span><span class="p">,</span> <span class="n">yes</span><span class="p">)</span>
</span><span id="__span-107-16"><a id="__codelineno-107-16" name="__codelineno-107-16" href="#__codelineno-107-16"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-107-17"><a id="__codelineno-107-17" name="__codelineno-107-17" href="#__codelineno-107-17"></a>        <span class="k">return</span> <span class="n">increasing</span><span class="p">(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">10</span><span class="p">,</span> <span class="n">smallest</span><span class="p">)</span>
</span></code></pre></div>
<p>...所以，如果您能理解这一点，那么最终您就能理解这一点，但我同意close只是increasing的一个更复杂的版本。所以我建议先理解这个，这里发生了什么。让我们只看看机制，我们要么使用数字1，要么不使用，在我们不使用的选择中，我们只是假装它不存在，然后我们要么使用6，要么不使用，在我们不使用的选择中，我们只是假装它不存在，然后我们要么使用8，要么不使用，在我们使用的选择中，我们必须确保从这里选择的其他所有东西都小于8。所以最后我们会得到8，但是我们进行递归调用，也就是我要找到87247中最长的递增序列，你知道除了所有的数字之外，都必须小于8，这就是我得到这个数字的方式。所以如果这有意义，然后看看这个和那个之间的区别，这和那个之间的区别是，我们只是藏起了最近的数字，然后我们会在这个最小值的概念中包含它，比我们本来想的要晚一步。所以在检查1是否足够小时，您可以忽略5，因为这只是这个工作规则。</p>
</div>
<p>所以，如果拿 <code>increasing</code> 的例子来理解，就是先判断 <code>n</code> 的个位是否比 之前(之前即当前数位右边的数位，可以通过递归的方式来理解)浏览/判断过的位数的最小值 小，小就意味着是可以构成递增序列/满足递增条件的，那么再分出是否使用这个位数的两种情况，如果打算使用，就将最小值更新( <code>min(n % 10, smallest)</code> ，但由于 <code>elif</code> 已经判断过了，确实也可以直接使用 <code>n % 10</code> )，如果不打算使用就不改变最小值。而如果不满足递增条件，就刚好跟不打算使用的情况一样。</p>
<p>理解了 <code>increasing</code> 再去理解 <code>close</code> 就会好理解很多，除了 <code>d</code> 几乎都一样，而 <code>d</code> 的作用就是为了让位数晚传一位(满足 near increasing 的要求)</p>
<h3 id="3_11">3<a class="headerlink" href="#3_11" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_125.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_125" loading="lazy" src="../images/cs61a_125.png" /></a></p>
<p>John 提到了一种使用 <em>同时赋值 Simultaneous Assignment</em> 的特殊情况，</p>
<p>John 说到在使用<em>同时赋值</em>时，会先计算等号右边的结果，再<strong>按顺序</strong>赋值给左边的，所以在这一行代码中</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-108-1"><a id="__codelineno-108-1" name="__codelineno-108-1" href="#__codelineno-108-1"></a><span class="n">L</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span> <span class="n">L</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">rest</span>
</span></code></pre></div>
<p>会先将 <code>L.rest</code> 指向 <code>L.rest.rest</code> ，然后再将变量名 <code>L</code> 指向 <code>L.rest.rest</code> ，所以会有如下图的改变</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">前</label><label for="__tabbed_1_2">后</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><a class="glightbox" href="../images/cs61a_126.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_126" loading="lazy" src="../images/cs61a_126.png" /></a></p>
</div>
<div class="tabbed-block">
<p><a class="glightbox" href="../images/cs61a_127.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_127" loading="lazy" src="../images/cs61a_127.png" /></a></p>
</div>
</div>
</div>
<p>先是含有 <code>1</code> 的节点的 <code>rest</code> 指向含有 <code>3</code> 的节点(即 <code>L.rest.rest</code> )，再是 <code>L</code> 指向含有 <code>3</code> 的节点</p>
<h2 id="lab-09">Lab 09<a class="headerlink" href="#lab-09" title="Permanent link">&para;</a></h2>
<h3 id="1_17">1<a class="headerlink" href="#1_17" title="Permanent link">&para;</a></h3>
<p>Q3，做的时候想了好一会，做完之后我感觉蛮有意思的，</p>
<p>这一题和上一题Q2很像，但是需要判断是否是(非严格)升序，所以提供的框架是构建一个 <code>subseq_helper</code> 函数，来记录前一个数的大小，</p>
<ul>
<li>如果当前的数比前一个数小，就可以直接忽略这个数</li>
<li>如果大于等于，就需要分情况，当前这个数是否被使用(感觉算是Q2的升级版)</li>
</ul>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-109-1"><a id="__codelineno-109-1" name="__codelineno-109-1" href="#__codelineno-109-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">inc_subseqs</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span><span id="__span-109-2"><a id="__codelineno-109-2" name="__codelineno-109-2" href="#__codelineno-109-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">subseq_helper</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">prev</span><span class="p">):</span>
</span><span id="__span-109-3"><a id="__codelineno-109-3" name="__codelineno-109-3" href="#__codelineno-109-3"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span><span class="p">:</span>
</span><span id="__span-109-4"><a id="__codelineno-109-4" name="__codelineno-109-4" href="#__codelineno-109-4"></a>            <span class="k">return</span> <span class="p">[[]]</span>
</span><span id="__span-109-5"><a id="__codelineno-109-5" name="__codelineno-109-5" href="#__codelineno-109-5"></a>        <span class="k">elif</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">prev</span><span class="p">:</span>
</span><span id="__span-109-6"><a id="__codelineno-109-6" name="__codelineno-109-6" href="#__codelineno-109-6"></a>            <span class="k">return</span> <span class="n">subseq_helper</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">prev</span><span class="p">)</span>
</span><span id="__span-109-7"><a id="__codelineno-109-7" name="__codelineno-109-7" href="#__codelineno-109-7"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-109-8"><a id="__codelineno-109-8" name="__codelineno-109-8" href="#__codelineno-109-8"></a>            <span class="n">a</span> <span class="o">=</span> <span class="n">subseq_helper</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="__span-109-9"><a id="__codelineno-109-9" name="__codelineno-109-9" href="#__codelineno-109-9"></a>            <span class="n">b</span> <span class="o">=</span> <span class="n">subseq_helper</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">prev</span><span class="p">)</span>
</span><span id="__span-109-10"><a id="__codelineno-109-10" name="__codelineno-109-10" href="#__codelineno-109-10"></a>            <span class="k">return</span> <span class="n">insert_into_all</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span>
</span><span id="__span-109-11"><a id="__codelineno-109-11" name="__codelineno-109-11" href="#__codelineno-109-11"></a>    <span class="k">return</span> <span class="n">subseq_helper</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></code></pre></div>
</details>
<h3 id="2_15">2<a class="headerlink" href="#2_15" title="Permanent link">&para;</a></h3>
<p>Q4 这题也有点意思，我想到的递归的思路就是，把大的树分成两个小的，</p>
<p>然后一开始是把两个小的加起来，然后错了，捋了一下，发现应该是把两个小的 结果/可能 相乘，最后就对了</p>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-110-1"><a id="__codelineno-110-1" name="__codelineno-110-1" href="#__codelineno-110-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">num_trees</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="__span-110-2"><a id="__codelineno-110-2" name="__codelineno-110-2" href="#__codelineno-110-2"></a>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-110-3"><a id="__codelineno-110-3" name="__codelineno-110-3" href="#__codelineno-110-3"></a>        <span class="k">return</span> <span class="mi">1</span>
</span><span id="__span-110-4"><a id="__codelineno-110-4" name="__codelineno-110-4" href="#__codelineno-110-4"></a>    <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="n">num_trees</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="n">num_trees</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)])</span>
</span></code></pre></div>
</details>
<h3 id="3_12">3<a class="headerlink" href="#3_12" title="Permanent link">&para;</a></h3>
<p>Q5，有点难想感觉(但是做完以后感觉这题又不是很复杂😂)</p>
<blockquote>
<p>一开始 <code>for</code> 语句里 <code>g</code> 之后没写 <code>()</code> ，然后就发生了报错😅</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-111-1"><a id="__codelineno-111-1" name="__codelineno-111-1" href="#__codelineno-111-1"></a><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
</span><span id="__span-111-2"><a id="__codelineno-111-2" name="__codelineno-111-2" href="#__codelineno-111-2"></a>  <span class="n">File</span> <span class="s2">&quot;E:\Courses\cs61a\lab\lab09\lab09.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">121</span><span class="p">,</span> <span class="ow">in</span> <span class="n">make_generators_generator</span>
</span><span id="__span-111-3"><a id="__codelineno-111-3" name="__codelineno-111-3" href="#__codelineno-111-3"></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span>
</span><span id="__span-111-4"><a id="__codelineno-111-4" name="__codelineno-111-4" href="#__codelineno-111-4"></a><span class="ne">TypeError</span><span class="p">:</span> <span class="s1">&#39;function&#39;</span> <span class="nb">object</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">iterable</span>
</span></code></pre></div>
<p>之后这样类似的要注意</p>
</blockquote>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-112-1"><a id="__codelineno-112-1" name="__codelineno-112-1" href="#__codelineno-112-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_generators_generator</span><span class="p">(</span><span class="n">g</span><span class="p">):</span>
</span><span id="__span-112-2"><a id="__codelineno-112-2" name="__codelineno-112-2" href="#__codelineno-112-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">gen</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
</span><span id="__span-112-3"><a id="__codelineno-112-3" name="__codelineno-112-3" href="#__codelineno-112-3"></a>        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="p">():</span>
</span><span id="__span-112-4"><a id="__codelineno-112-4" name="__codelineno-112-4" href="#__codelineno-112-4"></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-112-5"><a id="__codelineno-112-5" name="__codelineno-112-5" href="#__codelineno-112-5"></a>                <span class="k">break</span>
</span><span id="__span-112-6"><a id="__codelineno-112-6" name="__codelineno-112-6" href="#__codelineno-112-6"></a>            <span class="k">yield</span> <span class="n">e</span>
</span><span id="__span-112-7"><a id="__codelineno-112-7" name="__codelineno-112-7" href="#__codelineno-112-7"></a>            <span class="n">i</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="__span-112-8"><a id="__codelineno-112-8" name="__codelineno-112-8" href="#__codelineno-112-8"></a>    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-112-9"><a id="__codelineno-112-9" name="__codelineno-112-9" href="#__codelineno-112-9"></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">g</span><span class="p">():</span>
</span><span id="__span-112-10"><a id="__codelineno-112-10" name="__codelineno-112-10" href="#__codelineno-112-10"></a>        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-112-11"><a id="__codelineno-112-11" name="__codelineno-112-11" href="#__codelineno-112-11"></a>        <span class="k">yield</span> <span class="n">gen</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
</span></code></pre></div>
</details>
<h3 id="4_7">4<a class="headerlink" href="#4_7" title="Permanent link">&para;</a></h3>
<p>Q12，感觉这题蛮有意思，定义了某种模板(可以从 doctest 中看出来)，感觉之后说不定能参考</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-113-1"><a id="__codelineno-113-1" name="__codelineno-113-1" href="#__codelineno-113-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_to_string</span><span class="p">(</span><span class="n">front</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">back</span><span class="p">,</span> <span class="n">empty_repr</span><span class="p">):</span>
</span><span id="__span-113-2"><a id="__codelineno-113-2" name="__codelineno-113-2" href="#__codelineno-113-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot; Returns a function that turns linked lists to strings.</span>
</span><span id="__span-113-3"><a id="__codelineno-113-3" name="__codelineno-113-3" href="#__codelineno-113-3"></a>
</span><span id="__span-113-4"><a id="__codelineno-113-4" name="__codelineno-113-4" href="#__codelineno-113-4"></a><span class="sd">    &gt;&gt;&gt; kevins_to_string = make_to_string(&quot;[&quot;, &quot;|-]--&gt;&quot;, &quot;&quot;, &quot;[]&quot;)</span>
</span><span id="__span-113-5"><a id="__codelineno-113-5" name="__codelineno-113-5" href="#__codelineno-113-5"></a><span class="sd">    &gt;&gt;&gt; jerrys_to_string = make_to_string(&quot;(&quot;, &quot; . &quot;, &quot;)&quot;, &quot;()&quot;)</span>
</span><span id="__span-113-6"><a id="__codelineno-113-6" name="__codelineno-113-6" href="#__codelineno-113-6"></a><span class="sd">    &gt;&gt;&gt; lst = Link(1, Link(2, Link(3, Link(4))))</span>
</span><span id="__span-113-7"><a id="__codelineno-113-7" name="__codelineno-113-7" href="#__codelineno-113-7"></a><span class="sd">    &gt;&gt;&gt; kevins_to_string(lst)</span>
</span><span id="__span-113-8"><a id="__codelineno-113-8" name="__codelineno-113-8" href="#__codelineno-113-8"></a><span class="sd">    &#39;[1|-]--&gt;[2|-]--&gt;[3|-]--&gt;[4|-]--&gt;[]&#39;</span>
</span><span id="__span-113-9"><a id="__codelineno-113-9" name="__codelineno-113-9" href="#__codelineno-113-9"></a><span class="sd">    &gt;&gt;&gt; kevins_to_string(Link.empty)</span>
</span><span id="__span-113-10"><a id="__codelineno-113-10" name="__codelineno-113-10" href="#__codelineno-113-10"></a><span class="sd">    &#39;[]&#39;</span>
</span><span id="__span-113-11"><a id="__codelineno-113-11" name="__codelineno-113-11" href="#__codelineno-113-11"></a><span class="sd">    &gt;&gt;&gt; jerrys_to_string(lst)</span>
</span><span id="__span-113-12"><a id="__codelineno-113-12" name="__codelineno-113-12" href="#__codelineno-113-12"></a><span class="sd">    &#39;(1 . (2 . (3 . (4 . ()))))&#39;</span>
</span><span id="__span-113-13"><a id="__codelineno-113-13" name="__codelineno-113-13" href="#__codelineno-113-13"></a><span class="sd">    &gt;&gt;&gt; jerrys_to_string(Link.empty)</span>
</span><span id="__span-113-14"><a id="__codelineno-113-14" name="__codelineno-113-14" href="#__codelineno-113-14"></a><span class="sd">    &#39;()&#39;</span>
</span><span id="__span-113-15"><a id="__codelineno-113-15" name="__codelineno-113-15" href="#__codelineno-113-15"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-113-16"><a id="__codelineno-113-16" name="__codelineno-113-16" href="#__codelineno-113-16"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">printer</span><span class="p">(</span><span class="n">lnk</span><span class="p">):</span>
</span><span id="__span-113-17"><a id="__codelineno-113-17" name="__codelineno-113-17" href="#__codelineno-113-17"></a>        <span class="k">if</span> <span class="n">______________</span><span class="p">:</span>
</span><span id="__span-113-18"><a id="__codelineno-113-18" name="__codelineno-113-18" href="#__codelineno-113-18"></a>            <span class="k">return</span> <span class="n">_________________________</span>
</span><span id="__span-113-19"><a id="__codelineno-113-19" name="__codelineno-113-19" href="#__codelineno-113-19"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-113-20"><a id="__codelineno-113-20" name="__codelineno-113-20" href="#__codelineno-113-20"></a>            <span class="k">return</span> <span class="n">_________________________</span>
</span><span id="__span-113-21"><a id="__codelineno-113-21" name="__codelineno-113-21" href="#__codelineno-113-21"></a>    <span class="k">return</span> <span class="n">printer</span>
</span></code></pre></div>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-114-1"><a id="__codelineno-114-1" name="__codelineno-114-1" href="#__codelineno-114-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_to_string</span><span class="p">(</span><span class="n">front</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">back</span><span class="p">,</span> <span class="n">empty_repr</span><span class="p">):</span>
</span><span id="__span-114-2"><a id="__codelineno-114-2" name="__codelineno-114-2" href="#__codelineno-114-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">printer</span><span class="p">(</span><span class="n">lnk</span><span class="p">):</span>
</span><span id="__span-114-3"><a id="__codelineno-114-3" name="__codelineno-114-3" href="#__codelineno-114-3"></a>        <span class="k">if</span> <span class="n">lnk</span> <span class="ow">is</span> <span class="n">Link</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-114-4"><a id="__codelineno-114-4" name="__codelineno-114-4" href="#__codelineno-114-4"></a>            <span class="k">return</span> <span class="n">empty_repr</span>
</span><span id="__span-114-5"><a id="__codelineno-114-5" name="__codelineno-114-5" href="#__codelineno-114-5"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-114-6"><a id="__codelineno-114-6" name="__codelineno-114-6" href="#__codelineno-114-6"></a>            <span class="k">return</span> <span class="n">front</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">lnk</span><span class="o">.</span><span class="n">first</span><span class="p">)</span> <span class="o">+</span> <span class="n">mid</span> <span class="o">+</span> <span class="n">printer</span><span class="p">(</span><span class="n">lnk</span><span class="o">.</span><span class="n">rest</span><span class="p">)</span> <span class="o">+</span> <span class="n">back</span>
</span><span id="__span-114-7"><a id="__codelineno-114-7" name="__codelineno-114-7" href="#__codelineno-114-7"></a>    <span class="k">return</span> <span class="n">printer</span>
</span></code></pre></div>
</details>
<h3 id="5_5">5<a class="headerlink" href="#5_5" title="Permanent link">&para;</a></h3>
<p>Q13，给的代码框架感觉值得学习，而且一开始还没想明白要怎么编写😂</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-115-1"><a id="__codelineno-115-1" name="__codelineno-115-1" href="#__codelineno-115-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">prune_small</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span><span id="__span-115-2"><a id="__codelineno-115-2" name="__codelineno-115-2" href="#__codelineno-115-2"></a>    <span class="k">while</span> <span class="n">___________________________</span><span class="p">:</span>
</span><span id="__span-115-3"><a id="__codelineno-115-3" name="__codelineno-115-3" href="#__codelineno-115-3"></a>        <span class="n">largest</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">_______________</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">____________________</span><span class="p">)</span>
</span><span id="__span-115-4"><a id="__codelineno-115-4" name="__codelineno-115-4" href="#__codelineno-115-4"></a>        <span class="n">_________________________</span>
</span><span id="__span-115-5"><a id="__codelineno-115-5" name="__codelineno-115-5" href="#__codelineno-115-5"></a>    <span class="k">for</span> <span class="n">__</span> <span class="ow">in</span> <span class="n">_____________</span><span class="p">:</span>
</span><span id="__span-115-6"><a id="__codelineno-115-6" name="__codelineno-115-6" href="#__codelineno-115-6"></a>        <span class="n">___________________</span>
</span></code></pre></div>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-116-1"><a id="__codelineno-116-1" name="__codelineno-116-1" href="#__codelineno-116-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">prune_small</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span><span id="__span-116-2"><a id="__codelineno-116-2" name="__codelineno-116-2" href="#__codelineno-116-2"></a>    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">branches</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">n</span><span class="p">:</span>
</span><span id="__span-116-3"><a id="__codelineno-116-3" name="__codelineno-116-3" href="#__codelineno-116-3"></a>        <span class="n">largest</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">b</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">branches</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
</span><span id="__span-116-4"><a id="__codelineno-116-4" name="__codelineno-116-4" href="#__codelineno-116-4"></a>        <span class="n">t</span><span class="o">.</span><span class="n">branches</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">largest</span><span class="p">)</span>
</span><span id="__span-116-5"><a id="__codelineno-116-5" name="__codelineno-116-5" href="#__codelineno-116-5"></a>    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">branches</span><span class="p">:</span>
</span><span id="__span-116-6"><a id="__codelineno-116-6" name="__codelineno-116-6" href="#__codelineno-116-6"></a>        <span class="n">prune_small</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></code></pre></div>
</details>
<h2 id="lecture-25-users">Lecture 25 Users<a class="headerlink" href="#lecture-25-users" title="Permanent link">&para;</a></h2>
<h3 id="1_18">1<a class="headerlink" href="#1_18" title="Permanent link">&para;</a></h3>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p>Alan Kay:</p>
<p>...We realized that was an incredibly important principle for user interface design. Why spend two weeks trying to read an MS-DOS manual to see how to copy a file or open up an application? What do you get from it? Much better to find a way of designing the user interface so that the person who uses it acts like an intermediate from the first time they sit down, and then they get into a process that is rewarding in itself.</p>
<hr />
<p>Alan Kay:</p>
<p>...我们意识到这是界面设计中非常重要的原则。为什么要花两周的时间阅读MS-DOS手册，看如何复制文件或打开应用程序呢？从中得到了什么？更好的方法是设计用户界面，使使用者从第一次坐下来就像一个中间人，然后他们进入一个本身就是有益的过程。</p>
</div>
<p>Alan Kay 借助一个实验，</p>
<blockquote>
<p>让一个40多岁的大妈，通过简单的训练，短时间内上手网球的实验，</p>
<p>实验者通过教会这个大妈网球对打和发球的一些诀窍，而不是系统学习，来让她快速上手网球</p>
</blockquote>
<p>提到了用户界面设计的一个重要的理念，用户界面应该要设计得能让用户快速学会并上手(而不是需要花大量的时间去查阅说明书来学习)，使用户感觉自己像一个 <em>中等水平的学生 intermediate</em> ，于是之后的学习就能得到积极的反馈(所以就会有兴趣去学习)</p>
<h2 id="lecture-25-qa">Lecture 25 Q&amp;A<a class="headerlink" href="#lecture-25-qa" title="Permanent link">&para;</a></h2>
<h3 id="1_19">1<a class="headerlink" href="#1_19" title="Permanent link">&para;</a></h3>
<p>提到的20春(第二次期中考试)的一题</p>
<p><a class="glightbox" href="../images/cs61a_130.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_130" loading="lazy" src="../images/cs61a_130.png" /></a></p>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-117-1"><a id="__codelineno-117-1" name="__codelineno-117-1" href="#__codelineno-117-1"></a><span class="sd">&quot;&quot;&quot;This question involves plucking the leaves off a tree one by one.</span>
</span><span id="__span-117-2"><a id="__codelineno-117-2" name="__codelineno-117-2" href="#__codelineno-117-2"></a>
</span><span id="__span-117-3"><a id="__codelineno-117-3" name="__codelineno-117-3" href="#__codelineno-117-3"></a><span class="sd">Definitions:</span>
</span><span id="__span-117-4"><a id="__codelineno-117-4" name="__codelineno-117-4" href="#__codelineno-117-4"></a>
</span><span id="__span-117-5"><a id="__codelineno-117-5" name="__codelineno-117-5" href="#__codelineno-117-5"></a><span class="sd">1) A &quot;number tree&quot; is a Tree whose labels are _unique_ positive integers.</span>
</span><span id="__span-117-6"><a id="__codelineno-117-6" name="__codelineno-117-6" href="#__codelineno-117-6"></a><span class="sd">   No repeated labels appear in a number tree.</span>
</span><span id="__span-117-7"><a id="__codelineno-117-7" name="__codelineno-117-7" href="#__codelineno-117-7"></a>
</span><span id="__span-117-8"><a id="__codelineno-117-8" name="__codelineno-117-8" href="#__codelineno-117-8"></a><span class="sd">2) A &quot;plucking order&quot; for a number tree t is a sequence of unique positive</span>
</span><span id="__span-117-9"><a id="__codelineno-117-9" name="__codelineno-117-9" href="#__codelineno-117-9"></a><span class="sd">   integers that are all labels of t.</span>
</span><span id="__span-117-10"><a id="__codelineno-117-10" name="__codelineno-117-10" href="#__codelineno-117-10"></a>
</span><span id="__span-117-11"><a id="__codelineno-117-11" name="__codelineno-117-11" href="#__codelineno-117-11"></a><span class="sd">3) A plucking order is &quot;valid&quot; if both of these conditions are true:</span>
</span><span id="__span-117-12"><a id="__codelineno-117-12" name="__codelineno-117-12" href="#__codelineno-117-12"></a><span class="sd">   (a) the plucking order contains all labels of t, and</span>
</span><span id="__span-117-13"><a id="__codelineno-117-13" name="__codelineno-117-13" href="#__codelineno-117-13"></a><span class="sd">   (b) in the plucking order contains all labels of t, and</span>
</span><span id="__span-117-14"><a id="__codelineno-117-14" name="__codelineno-117-14" href="#__codelineno-117-14"></a><span class="sd">       the labels of all its descendant nodes. Thus, leaves appear first.</span>
</span><span id="__span-117-15"><a id="__codelineno-117-15" name="__codelineno-117-15" href="#__codelineno-117-15"></a>
</span><span id="__span-117-16"><a id="__codelineno-117-16" name="__codelineno-117-16" href="#__codelineno-117-16"></a><span class="sd">Note: redwood, pine, and cyprus are all kinds of trees.</span>
</span><span id="__span-117-17"><a id="__codelineno-117-17" name="__codelineno-117-17" href="#__codelineno-117-17"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-117-18"><a id="__codelineno-117-18" name="__codelineno-117-18" href="#__codelineno-117-18"></a>
</span><span id="__span-117-19"><a id="__codelineno-117-19" name="__codelineno-117-19" href="#__codelineno-117-19"></a><span class="sd">&quot;&quot;&quot;A: (3 pts) Implement order, which takes a number tree called rewood. It returns</span>
</span><span id="__span-117-20"><a id="__codelineno-117-20" name="__codelineno-117-20" href="#__codelineno-117-20"></a><span class="sd">a valid plucking order as a list of numbers. If there is more than one valid</span>
</span><span id="__span-117-21"><a id="__codelineno-117-21" name="__codelineno-117-21" href="#__codelineno-117-21"></a><span class="sd">plucking order for redwood, your order function can return any one of them.</span>
</span><span id="__span-117-22"><a id="__codelineno-117-22" name="__codelineno-117-22" href="#__codelineno-117-22"></a>
</span><span id="__span-117-23"><a id="__codelineno-117-23" name="__codelineno-117-23" href="#__codelineno-117-23"></a><span class="sd">IMPORTANT: You do not need to return EVERY valid plucking order; just one.</span>
</span><span id="__span-117-24"><a id="__codelineno-117-24" name="__codelineno-117-24" href="#__codelineno-117-24"></a>
</span><span id="__span-117-25"><a id="__codelineno-117-25" name="__codelineno-117-25" href="#__codelineno-117-25"></a><span class="sd">Check the doctests with: python3 ok -q a</span>
</span><span id="__span-117-26"><a id="__codelineno-117-26" name="__codelineno-117-26" href="#__codelineno-117-26"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-117-27"><a id="__codelineno-117-27" name="__codelineno-117-27" href="#__codelineno-117-27"></a><span class="k">def</span><span class="w"> </span><span class="nf">order</span><span class="p">(</span><span class="n">redwood</span><span class="p">):</span>
</span><span id="__span-117-28"><a id="__codelineno-117-28" name="__codelineno-117-28" href="#__codelineno-117-28"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a list containing a valid plucking order for the labels of t.</span>
</span><span id="__span-117-29"><a id="__codelineno-117-29" name="__codelineno-117-29" href="#__codelineno-117-29"></a>
</span><span id="__span-117-30"><a id="__codelineno-117-30" name="__codelineno-117-30" href="#__codelineno-117-30"></a><span class="sd">    &gt;&gt;&gt; order(Tree(1, [Tree(2, [Tree(3, [Tree(4)])])]))               # The only valid plucking order.</span>
</span><span id="__span-117-31"><a id="__codelineno-117-31" name="__codelineno-117-31" href="#__codelineno-117-31"></a><span class="sd">    [4, 3, 2, 1]</span>
</span><span id="__span-117-32"><a id="__codelineno-117-32" name="__codelineno-117-32" href="#__codelineno-117-32"></a><span class="sd">    &gt;&gt;&gt; order(Tree(1, [Tree(2), Tree(3)])) in [[2, 3, 1], [3, 2, 1]]  # Therre are 2 valid orders.</span>
</span><span id="__span-117-33"><a id="__codelineno-117-33" name="__codelineno-117-33" href="#__codelineno-117-33"></a><span class="sd">    True</span>
</span><span id="__span-117-34"><a id="__codelineno-117-34" name="__codelineno-117-34" href="#__codelineno-117-34"></a><span class="sd">    &gt;&gt;&gt; o = order(Tree(1, [Tree(2, [Tree(3)]), Tree(4, [Tree(5)])]))  # There are many valid orders,</span>
</span><span id="__span-117-35"><a id="__codelineno-117-35" name="__codelineno-117-35" href="#__codelineno-117-35"></a><span class="sd">    &gt;&gt;&gt; o.index(5) &lt; o.index(4)                                       # but all have 5 before 4,</span>
</span><span id="__span-117-36"><a id="__codelineno-117-36" name="__codelineno-117-36" href="#__codelineno-117-36"></a><span class="sd">    True</span>
</span><span id="__span-117-37"><a id="__codelineno-117-37" name="__codelineno-117-37" href="#__codelineno-117-37"></a><span class="sd">    &gt;&gt;&gt; o.index(3) &lt; o.index(2)                                       # and 3 before 2,</span>
</span><span id="__span-117-38"><a id="__codelineno-117-38" name="__codelineno-117-38" href="#__codelineno-117-38"></a><span class="sd">    True</span>
</span><span id="__span-117-39"><a id="__codelineno-117-39" name="__codelineno-117-39" href="#__codelineno-117-39"></a><span class="sd">    &gt;&gt;&gt; o[4:]                                                         # and 1 at the end.</span>
</span><span id="__span-117-40"><a id="__codelineno-117-40" name="__codelineno-117-40" href="#__codelineno-117-40"></a><span class="sd">    [1]</span>
</span><span id="__span-117-41"><a id="__codelineno-117-41" name="__codelineno-117-41" href="#__codelineno-117-41"></a>
</span><span id="__span-117-42"><a id="__codelineno-117-42" name="__codelineno-117-42" href="#__codelineno-117-42"></a><span class="sd">    &gt;&gt;&gt; order(Tree(7, [Tree(4, [Tree(6)]), Tree(5)])) in [[6, 5, 4, 7], [5, 6, 4, 7], [6, 4, 5, 7]]</span>
</span><span id="__span-117-43"><a id="__codelineno-117-43" name="__codelineno-117-43" href="#__codelineno-117-43"></a><span class="sd">    True</span>
</span><span id="__span-117-44"><a id="__codelineno-117-44" name="__codelineno-117-44" href="#__codelineno-117-44"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-117-45"><a id="__codelineno-117-45" name="__codelineno-117-45" href="#__codelineno-117-45"></a>    <span class="n">plucking_order</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-117-46"><a id="__codelineno-117-46" name="__codelineno-117-46" href="#__codelineno-117-46"></a>    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">______</span><span class="p">:</span>
</span><span id="__span-117-47"><a id="__codelineno-117-47" name="__codelineno-117-47" href="#__codelineno-117-47"></a>        <span class="n">______</span>
</span><span id="__span-117-48"><a id="__codelineno-117-48" name="__codelineno-117-48" href="#__codelineno-117-48"></a>    <span class="k">return</span> <span class="n">plucking_order</span> <span class="o">+</span> <span class="p">[</span><span class="n">redwood</span><span class="o">.</span><span class="n">label</span><span class="p">]</span>
</span><span id="__span-117-49"><a id="__codelineno-117-49" name="__codelineno-117-49" href="#__codelineno-117-49"></a>
</span><span id="__span-117-50"><a id="__codelineno-117-50" name="__codelineno-117-50" href="#__codelineno-117-50"></a>
</span><span id="__span-117-51"><a id="__codelineno-117-51" name="__codelineno-117-51" href="#__codelineno-117-51"></a><span class="sd">&quot;&quot;&quot;B: (5 pts) Implement pluck, which takes a number tree called pine and returns</span>
</span><span id="__span-117-52"><a id="__codelineno-117-52" name="__codelineno-117-52" href="#__codelineno-117-52"></a><span class="sd">a function that is called repeatedly on the elements of a plucking order. If that</span>
</span><span id="__span-117-53"><a id="__codelineno-117-53" name="__codelineno-117-53" href="#__codelineno-117-53"></a><span class="sd">plucking order is valid, the final call returns &#39;success!&#39;. Otherwise, if one of</span>
</span><span id="__span-117-54"><a id="__codelineno-117-54" name="__codelineno-117-54" href="#__codelineno-117-54"></a><span class="sd">the repeated calls is on a number that is not part of a valid plucking order, the</span>
</span><span id="__span-117-55"><a id="__codelineno-117-55" name="__codelineno-117-55" href="#__codelineno-117-55"></a><span class="sd">error string &#39;Hey, not valid!&#39; is returned.</span>
</span><span id="__span-117-56"><a id="__codelineno-117-56" name="__codelineno-117-56" href="#__codelineno-117-56"></a>
</span><span id="__span-117-57"><a id="__codelineno-117-57" name="__codelineno-117-57" href="#__codelineno-117-57"></a><span class="sd">Since pine is a number tree and the values passed to plucker form a plucking</span>
</span><span id="__span-117-58"><a id="__codelineno-117-58" name="__codelineno-117-58" href="#__codelineno-117-58"></a><span class="sd">order, you can assume that:</span>
</span><span id="__span-117-59"><a id="__codelineno-117-59" name="__codelineno-117-59" href="#__codelineno-117-59"></a><span class="sd">- The labels of pine are unique,</span>
</span><span id="__span-117-60"><a id="__codelineno-117-60" name="__codelineno-117-60" href="#__codelineno-117-60"></a><span class="sd">- All values k passed to the plucker function are unique for a given pine, and</span>
</span><span id="__span-117-61"><a id="__codelineno-117-61" name="__codelineno-117-61" href="#__codelineno-117-61"></a><span class="sd">- All values k are labels of pine.</span>
</span><span id="__span-117-62"><a id="__codelineno-117-62" name="__codelineno-117-62" href="#__codelineno-117-62"></a>
</span><span id="__span-117-63"><a id="__codelineno-117-63" name="__codelineno-117-63" href="#__codelineno-117-63"></a><span class="sd">Check the doctests with: python3 ok -q b</span>
</span><span id="__span-117-64"><a id="__codelineno-117-64" name="__codelineno-117-64" href="#__codelineno-117-64"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-117-65"><a id="__codelineno-117-65" name="__codelineno-117-65" href="#__codelineno-117-65"></a><span class="k">def</span><span class="w"> </span><span class="nf">pluck</span><span class="p">(</span><span class="n">pine</span><span class="p">):</span>
</span><span id="__span-117-66"><a id="__codelineno-117-66" name="__codelineno-117-66" href="#__codelineno-117-66"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a function that returns whether a plucking order is valid</span>
</span><span id="__span-117-67"><a id="__codelineno-117-67" name="__codelineno-117-67" href="#__codelineno-117-67"></a><span class="sd">    for a number tree t when called repeatedly on elements of a plucking order.</span>
</span><span id="__span-117-68"><a id="__codelineno-117-68" name="__codelineno-117-68" href="#__codelineno-117-68"></a>
</span><span id="__span-117-69"><a id="__codelineno-117-69" name="__codelineno-117-69" href="#__codelineno-117-69"></a><span class="sd">    Calling the function returned by pluck should not mutate pine.</span>
</span><span id="__span-117-70"><a id="__codelineno-117-70" name="__codelineno-117-70" href="#__codelineno-117-70"></a>
</span><span id="__span-117-71"><a id="__codelineno-117-71" name="__codelineno-117-71" href="#__codelineno-117-71"></a><span class="sd">           +---+</span>
</span><span id="__span-117-72"><a id="__codelineno-117-72" name="__codelineno-117-72" href="#__codelineno-117-72"></a><span class="sd">           | 1 |</span>
</span><span id="__span-117-73"><a id="__codelineno-117-73" name="__codelineno-117-73" href="#__codelineno-117-73"></a><span class="sd">           +---+</span>
</span><span id="__span-117-74"><a id="__codelineno-117-74" name="__codelineno-117-74" href="#__codelineno-117-74"></a><span class="sd">           /   \----          /                 +---+         +---+</span>
</span><span id="__span-117-75"><a id="__codelineno-117-75" name="__codelineno-117-75" href="#__codelineno-117-75"></a><span class="sd">       | 2 |         | 6 |</span>
</span><span id="__span-117-76"><a id="__codelineno-117-76" name="__codelineno-117-76" href="#__codelineno-117-76"></a><span class="sd">       +---+         +---+</span>
</span><span id="__span-117-77"><a id="__codelineno-117-77" name="__codelineno-117-77" href="#__codelineno-117-77"></a><span class="sd">         |            /          |           /          +---+      +---+ +---+</span>
</span><span id="__span-117-78"><a id="__codelineno-117-78" name="__codelineno-117-78" href="#__codelineno-117-78"></a><span class="sd">       | 3 |      | 7 | | 8 |</span>
</span><span id="__span-117-79"><a id="__codelineno-117-79" name="__codelineno-117-79" href="#__codelineno-117-79"></a><span class="sd">       +---+      +---+ +---+</span>
</span><span id="__span-117-80"><a id="__codelineno-117-80" name="__codelineno-117-80" href="#__codelineno-117-80"></a><span class="sd">        / \               |</span>
</span><span id="__span-117-81"><a id="__codelineno-117-81" name="__codelineno-117-81" href="#__codelineno-117-81"></a><span class="sd">       /   \              |</span>
</span><span id="__span-117-82"><a id="__codelineno-117-82" name="__codelineno-117-82" href="#__codelineno-117-82"></a><span class="sd">    +---+ +---+         +---+</span>
</span><span id="__span-117-83"><a id="__codelineno-117-83" name="__codelineno-117-83" href="#__codelineno-117-83"></a><span class="sd">    | 4 | | 5 |         | 9 |</span>
</span><span id="__span-117-84"><a id="__codelineno-117-84" name="__codelineno-117-84" href="#__codelineno-117-84"></a><span class="sd">    +---+ +---+         +---+</span>
</span><span id="__span-117-85"><a id="__codelineno-117-85" name="__codelineno-117-85" href="#__codelineno-117-85"></a>
</span><span id="__span-117-86"><a id="__codelineno-117-86" name="__codelineno-117-86" href="#__codelineno-117-86"></a><span class="sd">    &gt;&gt;&gt; b0 = Tree(2, [Tree(3, [Tree(4), Tree(5)])])</span>
</span><span id="__span-117-87"><a id="__codelineno-117-87" name="__codelineno-117-87" href="#__codelineno-117-87"></a><span class="sd">    &gt;&gt;&gt; b1 = Tree(6, [Tree(7), Tree(8, [Tree(9)])])</span>
</span><span id="__span-117-88"><a id="__codelineno-117-88" name="__codelineno-117-88" href="#__codelineno-117-88"></a><span class="sd">    &gt;&gt;&gt; t = Tree(1, [b0, b1])</span>
</span><span id="__span-117-89"><a id="__codelineno-117-89" name="__codelineno-117-89" href="#__codelineno-117-89"></a><span class="sd">    &gt;&gt;&gt; pluck(t)(9)(8)(7)(6)(5)(4)(3)(2)(1)</span>
</span><span id="__span-117-90"><a id="__codelineno-117-90" name="__codelineno-117-90" href="#__codelineno-117-90"></a><span class="sd">    &#39;success!&#39;</span>
</span><span id="__span-117-91"><a id="__codelineno-117-91" name="__codelineno-117-91" href="#__codelineno-117-91"></a><span class="sd">    &gt;&gt;&gt; pluck(t)(5)(9)(4)(7)(3)(8)(6)(2)(1)</span>
</span><span id="__span-117-92"><a id="__codelineno-117-92" name="__codelineno-117-92" href="#__codelineno-117-92"></a><span class="sd">    &#39;success!&#39;</span>
</span><span id="__span-117-93"><a id="__codelineno-117-93" name="__codelineno-117-93" href="#__codelineno-117-93"></a><span class="sd">    &gt;&gt;&gt; pluck(t)(2)</span>
</span><span id="__span-117-94"><a id="__codelineno-117-94" name="__codelineno-117-94" href="#__codelineno-117-94"></a><span class="sd">    &#39;Hey, not valid!&#39;</span>
</span><span id="__span-117-95"><a id="__codelineno-117-95" name="__codelineno-117-95" href="#__codelineno-117-95"></a><span class="sd">    &gt;&gt;&gt; pluck(t)(5)(9)(7)(6)</span>
</span><span id="__span-117-96"><a id="__codelineno-117-96" name="__codelineno-117-96" href="#__codelineno-117-96"></a><span class="sd">    &#39;Hey, not valid!&#39;</span>
</span><span id="__span-117-97"><a id="__codelineno-117-97" name="__codelineno-117-97" href="#__codelineno-117-97"></a>
</span><span id="__span-117-98"><a id="__codelineno-117-98" name="__codelineno-117-98" href="#__codelineno-117-98"></a><span class="sd">    &gt;&gt;&gt; pluck(b0)(5)(2)</span>
</span><span id="__span-117-99"><a id="__codelineno-117-99" name="__codelineno-117-99" href="#__codelineno-117-99"></a><span class="sd">    &#39;Hey, not valid!&#39;</span>
</span><span id="__span-117-100"><a id="__codelineno-117-100" name="__codelineno-117-100" href="#__codelineno-117-100"></a><span class="sd">    &gt;&gt;&gt; pluck(b0)(4)(5)(3)(2)</span>
</span><span id="__span-117-101"><a id="__codelineno-117-101" name="__codelineno-117-101" href="#__codelineno-117-101"></a><span class="sd">    &#39;success!&#39;</span>
</span><span id="__span-117-102"><a id="__codelineno-117-102" name="__codelineno-117-102" href="#__codelineno-117-102"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-117-103"><a id="__codelineno-117-103" name="__codelineno-117-103" href="#__codelineno-117-103"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plucker</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
</span><span id="__span-117-104"><a id="__codelineno-117-104" name="__codelineno-117-104" href="#__codelineno-117-104"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">pluck_one_leaf</span><span class="p">(</span><span class="n">cyprus</span><span class="p">):</span>
</span><span id="__span-117-105"><a id="__codelineno-117-105" name="__codelineno-117-105" href="#__codelineno-117-105"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Return a copy of cyprus without leaf k and check that k is a</span>
</span><span id="__span-117-106"><a id="__codelineno-117-106" name="__codelineno-117-106" href="#__codelineno-117-106"></a><span class="sd">            leaf label, not an interior node label.</span>
</span><span id="__span-117-107"><a id="__codelineno-117-107" name="__codelineno-117-107" href="#__codelineno-117-107"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-117-108"><a id="__codelineno-117-108" name="__codelineno-117-108" href="#__codelineno-117-108"></a>            <span class="k">if</span> <span class="n">______</span><span class="p">:</span>
</span><span id="__span-117-109"><a id="__codelineno-117-109" name="__codelineno-117-109" href="#__codelineno-117-109"></a>                <span class="n">______</span>
</span><span id="__span-117-110"><a id="__codelineno-117-110" name="__codelineno-117-110" href="#__codelineno-117-110"></a>            <span class="n">plucked_branches</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-117-111"><a id="__codelineno-117-111" name="__codelineno-117-111" href="#__codelineno-117-111"></a>            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">cyprus</span><span class="o">.</span><span class="n">branches</span><span class="p">:</span>
</span><span id="__span-117-112"><a id="__codelineno-117-112" name="__codelineno-117-112" href="#__codelineno-117-112"></a>                <span class="n">skip_this_leaf</span> <span class="o">=</span> <span class="n">______</span> <span class="ow">and</span> <span class="n">______</span>
</span><span id="__span-117-113"><a id="__codelineno-117-113" name="__codelineno-117-113" href="#__codelineno-117-113"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_this_leaf</span><span class="p">:</span>
</span><span id="__span-117-114"><a id="__codelineno-117-114" name="__codelineno-117-114" href="#__codelineno-117-114"></a>                    <span class="n">plucked_branch_or_error</span> <span class="o">=</span> <span class="n">pluck_one_leaf</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</span><span id="__span-117-115"><a id="__codelineno-117-115" name="__codelineno-117-115" href="#__codelineno-117-115"></a>                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plucked_branch_or_error</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="__span-117-116"><a id="__codelineno-117-116" name="__codelineno-117-116" href="#__codelineno-117-116"></a>                        <span class="k">return</span> <span class="n">plucked_branch_or_error</span>
</span><span id="__span-117-117"><a id="__codelineno-117-117" name="__codelineno-117-117" href="#__codelineno-117-117"></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-117-118"><a id="__codelineno-117-118" name="__codelineno-117-118" href="#__codelineno-117-118"></a>                        <span class="n">______</span>
</span><span id="__span-117-119"><a id="__codelineno-117-119" name="__codelineno-117-119" href="#__codelineno-117-119"></a>            <span class="k">return</span> <span class="n">Tree</span><span class="p">(</span><span class="n">______</span><span class="p">,</span> <span class="n">plucked_branches</span><span class="p">)</span>
</span><span id="__span-117-120"><a id="__codelineno-117-120" name="__codelineno-117-120" href="#__codelineno-117-120"></a>        <span class="k">nonlocal</span> <span class="n">pine</span>
</span><span id="__span-117-121"><a id="__codelineno-117-121" name="__codelineno-117-121" href="#__codelineno-117-121"></a>        <span class="k">if</span> <span class="n">pine</span><span class="o">.</span><span class="n">is_leaf</span><span class="p">():</span>
</span><span id="__span-117-122"><a id="__codelineno-117-122" name="__codelineno-117-122" href="#__codelineno-117-122"></a>            <span class="k">assert</span> <span class="n">k</span> <span class="o">==</span> <span class="n">pine</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="s1">&#39;all k must appear in pine&#39;</span>
</span><span id="__span-117-123"><a id="__codelineno-117-123" name="__codelineno-117-123" href="#__codelineno-117-123"></a>            <span class="k">return</span> <span class="s1">&#39;success!&#39;</span>
</span><span id="__span-117-124"><a id="__codelineno-117-124" name="__codelineno-117-124" href="#__codelineno-117-124"></a>        <span class="n">______</span>
</span><span id="__span-117-125"><a id="__codelineno-117-125" name="__codelineno-117-125" href="#__codelineno-117-125"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pine</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="__span-117-126"><a id="__codelineno-117-126" name="__codelineno-117-126" href="#__codelineno-117-126"></a>            <span class="k">return</span> <span class="n">pine</span>
</span><span id="__span-117-127"><a id="__codelineno-117-127" name="__codelineno-117-127" href="#__codelineno-117-127"></a>        <span class="k">return</span> <span class="n">plucker</span>
</span><span id="__span-117-128"><a id="__codelineno-117-128" name="__codelineno-117-128" href="#__codelineno-117-128"></a>    <span class="k">return</span> <span class="n">plucker</span>
</span></code></pre></div>
</div>
<blockquote>
<p>需要用到的 <em>树 Tree</em> 类</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-118-1"><a id="__codelineno-118-1" name="__codelineno-118-1" href="#__codelineno-118-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Tree</span><span class="p">:</span>
</span><span id="__span-118-2"><a id="__codelineno-118-2" name="__codelineno-118-2" href="#__codelineno-118-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">branches</span><span class="o">=</span><span class="p">[]):</span>
</span><span id="__span-118-3"><a id="__codelineno-118-3" name="__codelineno-118-3" href="#__codelineno-118-3"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
</span><span id="__span-118-4"><a id="__codelineno-118-4" name="__codelineno-118-4" href="#__codelineno-118-4"></a>        <span class="k">for</span> <span class="n">branch</span> <span class="ow">in</span> <span class="n">branches</span><span class="p">:</span>
</span><span id="__span-118-5"><a id="__codelineno-118-5" name="__codelineno-118-5" href="#__codelineno-118-5"></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">branch</span><span class="p">,</span> <span class="n">Tree</span><span class="p">)</span>
</span><span id="__span-118-6"><a id="__codelineno-118-6" name="__codelineno-118-6" href="#__codelineno-118-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">branches</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">branches</span><span class="p">)</span>
</span><span id="__span-118-7"><a id="__codelineno-118-7" name="__codelineno-118-7" href="#__codelineno-118-7"></a>        
</span><span id="__span-118-8"><a id="__codelineno-118-8" name="__codelineno-118-8" href="#__codelineno-118-8"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_leaf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-118-9"><a id="__codelineno-118-9" name="__codelineno-118-9" href="#__codelineno-118-9"></a>        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">branches</span>
</span></code></pre></div>
</blockquote>
<p>于是尝试写了一下，</p>
<p>a题十分地简单</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-119-1"><a id="__codelineno-119-1" name="__codelineno-119-1" href="#__codelineno-119-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">order</span><span class="p">(</span><span class="n">redwood</span><span class="p">):</span>
</span><span id="__span-119-2"><a id="__codelineno-119-2" name="__codelineno-119-2" href="#__codelineno-119-2"></a>        <span class="n">plucking_order</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-119-3"><a id="__codelineno-119-3" name="__codelineno-119-3" href="#__codelineno-119-3"></a>    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">redwood</span><span class="o">.</span><span class="n">branches</span><span class="p">:</span>
</span><span id="__span-119-4"><a id="__codelineno-119-4" name="__codelineno-119-4" href="#__codelineno-119-4"></a>        <span class="n">plucking_order</span> <span class="o">+=</span> <span class="n">order</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</span><span id="__span-119-5"><a id="__codelineno-119-5" name="__codelineno-119-5" href="#__codelineno-119-5"></a>    <span class="k">return</span> <span class="n">plucking_order</span> <span class="o">+</span> <span class="p">[</span><span class="n">redwood</span><span class="o">.</span><span class="n">label</span><span class="p">]</span>
</span></code></pre></div>
<p>b题有点难度，但是照着框架去分析思考，最终也不难做出来</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-120-1"><a id="__codelineno-120-1" name="__codelineno-120-1" href="#__codelineno-120-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">pluck</span><span class="p">(</span><span class="n">pine</span><span class="p">):</span>
</span><span id="__span-120-2"><a id="__codelineno-120-2" name="__codelineno-120-2" href="#__codelineno-120-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plucker</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
</span><span id="__span-120-3"><a id="__codelineno-120-3" name="__codelineno-120-3" href="#__codelineno-120-3"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">pluck_one_leaf</span><span class="p">(</span><span class="n">cyprus</span><span class="p">):</span>
</span><span id="__span-120-4"><a id="__codelineno-120-4" name="__codelineno-120-4" href="#__codelineno-120-4"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Return a copy of cyprus without leaf k and check that k is a</span>
</span><span id="__span-120-5"><a id="__codelineno-120-5" name="__codelineno-120-5" href="#__codelineno-120-5"></a><span class="sd">            leaf label, not an interior node label.</span>
</span><span id="__span-120-6"><a id="__codelineno-120-6" name="__codelineno-120-6" href="#__codelineno-120-6"></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="__span-120-7"><a id="__codelineno-120-7" name="__codelineno-120-7" href="#__codelineno-120-7"></a>            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="n">cyprus</span><span class="o">.</span><span class="n">label</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">cyprus</span><span class="o">.</span><span class="n">is_leaf</span><span class="p">():</span>
</span><span id="__span-120-8"><a id="__codelineno-120-8" name="__codelineno-120-8" href="#__codelineno-120-8"></a>                <span class="k">return</span> <span class="s2">&quot;Hey, not valid!&quot;</span>
</span><span id="__span-120-9"><a id="__codelineno-120-9" name="__codelineno-120-9" href="#__codelineno-120-9"></a>            <span class="n">plucked_branches</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-120-10"><a id="__codelineno-120-10" name="__codelineno-120-10" href="#__codelineno-120-10"></a>            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">cyprus</span><span class="o">.</span><span class="n">branches</span><span class="p">:</span>
</span><span id="__span-120-11"><a id="__codelineno-120-11" name="__codelineno-120-11" href="#__codelineno-120-11"></a>                <span class="n">skip_this_leaf</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">is_leaf</span><span class="p">()</span> <span class="ow">and</span> <span class="n">b</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">k</span>
</span><span id="__span-120-12"><a id="__codelineno-120-12" name="__codelineno-120-12" href="#__codelineno-120-12"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_this_leaf</span><span class="p">:</span>
</span><span id="__span-120-13"><a id="__codelineno-120-13" name="__codelineno-120-13" href="#__codelineno-120-13"></a>                    <span class="n">plucked_branch_or_error</span> <span class="o">=</span> <span class="n">pluck_one_leaf</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</span><span id="__span-120-14"><a id="__codelineno-120-14" name="__codelineno-120-14" href="#__codelineno-120-14"></a>                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plucked_branch_or_error</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="__span-120-15"><a id="__codelineno-120-15" name="__codelineno-120-15" href="#__codelineno-120-15"></a>                        <span class="k">return</span> <span class="n">plucked_branch_or_error</span>
</span><span id="__span-120-16"><a id="__codelineno-120-16" name="__codelineno-120-16" href="#__codelineno-120-16"></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-120-17"><a id="__codelineno-120-17" name="__codelineno-120-17" href="#__codelineno-120-17"></a>                        <span class="n">plucked_branches</span> <span class="o">+=</span> <span class="p">[</span><span class="n">plucked_branch_or_error</span><span class="p">]</span>
</span><span id="__span-120-18"><a id="__codelineno-120-18" name="__codelineno-120-18" href="#__codelineno-120-18"></a>            <span class="k">return</span> <span class="n">Tree</span><span class="p">(</span><span class="n">cyprus</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">plucked_branches</span><span class="p">)</span>
</span><span id="__span-120-19"><a id="__codelineno-120-19" name="__codelineno-120-19" href="#__codelineno-120-19"></a>        <span class="k">nonlocal</span> <span class="n">pine</span>
</span><span id="__span-120-20"><a id="__codelineno-120-20" name="__codelineno-120-20" href="#__codelineno-120-20"></a>        <span class="k">if</span> <span class="n">pine</span><span class="o">.</span><span class="n">is_leaf</span><span class="p">():</span>
</span><span id="__span-120-21"><a id="__codelineno-120-21" name="__codelineno-120-21" href="#__codelineno-120-21"></a>            <span class="k">assert</span> <span class="n">k</span> <span class="o">==</span> <span class="n">pine</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="s1">&#39;all k must appear in pine&#39;</span>
</span><span id="__span-120-22"><a id="__codelineno-120-22" name="__codelineno-120-22" href="#__codelineno-120-22"></a>            <span class="k">return</span> <span class="s1">&#39;success!&#39;</span>
</span><span id="__span-120-23"><a id="__codelineno-120-23" name="__codelineno-120-23" href="#__codelineno-120-23"></a>        <span class="n">pine</span> <span class="o">=</span> <span class="n">pluck_one_leaf</span><span class="p">(</span><span class="n">pine</span><span class="p">)</span>
</span><span id="__span-120-24"><a id="__codelineno-120-24" name="__codelineno-120-24" href="#__codelineno-120-24"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pine</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="__span-120-25"><a id="__codelineno-120-25" name="__codelineno-120-25" href="#__codelineno-120-25"></a>            <span class="k">return</span> <span class="n">pine</span>
</span><span id="__span-120-26"><a id="__codelineno-120-26" name="__codelineno-120-26" href="#__codelineno-120-26"></a>        <span class="k">return</span> <span class="n">plucker</span>
</span><span id="__span-120-27"><a id="__codelineno-120-27" name="__codelineno-120-27" href="#__codelineno-120-27"></a>    <span class="k">return</span> <span class="n">plucker</span>
</span></code></pre></div>
<h3 id="2_16">2<a class="headerlink" href="#2_16" title="Permanent link">&para;</a></h3>
<p>提到了18秋第二次期中考试的一题</p>
<p><a class="glightbox" href="../images/cs61a_131.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_131" loading="lazy" src="../images/cs61a_131.png" /></a></p>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p><strong>Trictionary or Treat</strong></p>
<p><strong>Definition.</strong> A <em>trictionary</em> is a pair of <code>Tree</code> instances <code>k</code> and <code>v</code> that have identical structure: each node in <code>k</code> has a corresponding node in <code>v</code> . The labels in <code>k</code> are called <em>keys</em>. Each key may be the label for multiple nodes in <code>k</code> , and the <em>values</em> for that key are the labels of all the corresponding nodes in <code>v</code> .</p>
<p>A <em>lookup function</em> returns one of the values for a key. Specifically, a lookup function for a node in <code>k</code> is a function that takes <code>v</code> as an argument and returns the label for the corresponding node in <code>v</code> .</p>
<p>Implement the generator function <code>lookups</code> , which takes a <code>Tree</code> instance <code>k</code> and some <code>key</code> . It yields all <em>lookup functions</em> for nodes in <code>k</code> that have <code>key</code> as their label. The <code>new_lookup</code> function is part of the implementation.</p>
<ul>
<li>
<p><code>k</code> :</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-121-1"><a id="__codelineno-121-1" name="__codelineno-121-1" href="#__codelineno-121-1"></a>        5
</span><span id="__span-121-2"><a id="__codelineno-121-2" name="__codelineno-121-2" href="#__codelineno-121-2"></a>      / | \
</span><span id="__span-121-3"><a id="__codelineno-121-3" name="__codelineno-121-3" href="#__codelineno-121-3"></a>    7   8   5
</span><span id="__span-121-4"><a id="__codelineno-121-4" name="__codelineno-121-4" href="#__codelineno-121-4"></a>  /   / |  / \
</span><span id="__span-121-5"><a id="__codelineno-121-5" name="__codelineno-121-5" href="#__codelineno-121-5"></a>2    3  4  4  2 
</span></code></pre></div>
</li>
<li>
<p><code>v</code> :</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-122-1"><a id="__codelineno-122-1" name="__codelineno-122-1" href="#__codelineno-122-1"></a>        &#39;Go&#39;
</span><span id="__span-122-2"><a id="__codelineno-122-2" name="__codelineno-122-2" href="#__codelineno-122-2"></a>       / | \
</span><span id="__span-122-3"><a id="__codelineno-122-3" name="__codelineno-122-3" href="#__codelineno-122-3"></a>    &#39;C&#39; &#39;A&#39; &#39;L&#39;
</span><span id="__span-122-4"><a id="__codelineno-122-4" name="__codelineno-122-4" href="#__codelineno-122-4"></a>   /   / |  / \
</span><span id="__span-122-5"><a id="__codelineno-122-5" name="__codelineno-122-5" href="#__codelineno-122-5"></a>&#39;C&#39;  &#39;S&#39; 6  1 &#39;A&#39; 
</span></code></pre></div>
</li>
</ul>
<table>
<thead>
<tr>
<th><u><em>key</em></u></th>
<th><u><em>values</em></u></th>
</tr>
</thead>
<tbody>
<tr>
<td>2</td>
<td>'C', 'A'</td>
</tr>
<tr>
<td>3</td>
<td>'S'</td>
</tr>
<tr>
<td>4</td>
<td>6, 1</td>
</tr>
<tr>
<td>5</td>
<td>'Go', 'L'</td>
</tr>
<tr>
<td>7</td>
<td>'C'</td>
</tr>
<tr>
<td>8</td>
<td>'A'</td>
</tr>
</tbody>
</table>
<div class="language-python highlight"><pre><span></span><code><span id="__span-123-1"><a id="__codelineno-123-1" name="__codelineno-123-1" href="#__codelineno-123-1"></a><span class="n">k</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="n">Tree</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="p">[</span><span class="n">Tree</span><span class="p">(</span><span class="mi">2</span><span class="p">)]),</span> <span class="n">Tree</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="p">[</span><span class="n">Tree</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Tree</span><span class="p">(</span><span class="mi">4</span><span class="p">)]),</span> <span class="n">Tree</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="n">Tree</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">Tree</span><span class="p">(</span><span class="mi">2</span><span class="p">)])])</span>
</span><span id="__span-123-2"><a id="__codelineno-123-2" name="__codelineno-123-2" href="#__codelineno-123-2"></a><span class="n">v</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="s1">&#39;Go&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">Tree</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">Tree</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">)]),</span> <span class="n">Tree</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">Tree</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">),</span> <span class="n">Tree</span><span class="p">(</span><span class="mi">6</span><span class="p">)]),</span> <span class="n">Tree</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">Tree</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Tree</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)])])</span>
</span><span id="__span-123-3"><a id="__codelineno-123-3" name="__codelineno-123-3" href="#__codelineno-123-3"></a>
</span><span id="__span-123-4"><a id="__codelineno-123-4" name="__codelineno-123-4" href="#__codelineno-123-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">lookups</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span><span id="__span-123-5"><a id="__codelineno-123-5" name="__codelineno-123-5" href="#__codelineno-123-5"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Yield one lookup function for each node of k that has the label key.</span>
</span><span id="__span-123-6"><a id="__codelineno-123-6" name="__codelineno-123-6" href="#__codelineno-123-6"></a>
</span><span id="__span-123-7"><a id="__codelineno-123-7" name="__codelineno-123-7" href="#__codelineno-123-7"></a><span class="sd">    &gt;&gt;&gt; [f(v) for f in lookups(k, 2)]</span>
</span><span id="__span-123-8"><a id="__codelineno-123-8" name="__codelineno-123-8" href="#__codelineno-123-8"></a><span class="sd">    [&#39;c&#39;, &#39;A&#39;]</span>
</span><span id="__span-123-9"><a id="__codelineno-123-9" name="__codelineno-123-9" href="#__codelineno-123-9"></a><span class="sd">    &gt;&gt;&gt; [f(v) for f in lookups(k, 3)]</span>
</span><span id="__span-123-10"><a id="__codelineno-123-10" name="__codelineno-123-10" href="#__codelineno-123-10"></a><span class="sd">    [&#39;S&#39;]</span>
</span><span id="__span-123-11"><a id="__codelineno-123-11" name="__codelineno-123-11" href="#__codelineno-123-11"></a><span class="sd">    &gt;&gt;&gt; [f(v) for f in lookups(k, 6)]</span>
</span><span id="__span-123-12"><a id="__codelineno-123-12" name="__codelineno-123-12" href="#__codelineno-123-12"></a><span class="sd">    []</span>
</span><span id="__span-123-13"><a id="__codelineno-123-13" name="__codelineno-123-13" href="#__codelineno-123-13"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-123-14"><a id="__codelineno-123-14" name="__codelineno-123-14" href="#__codelineno-123-14"></a>    <span class="k">if</span> <span class="n">______</span><span class="p">:</span>
</span><span id="__span-123-15"><a id="__codelineno-123-15" name="__codelineno-123-15" href="#__codelineno-123-15"></a>        <span class="k">yield</span> <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">______</span>
</span><span id="__span-123-16"><a id="__codelineno-123-16" name="__codelineno-123-16" href="#__codelineno-123-16"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">branches</span><span class="p">)):</span>
</span><span id="__span-123-17"><a id="__codelineno-123-17" name="__codelineno-123-17" href="#__codelineno-123-17"></a>        <span class="n">______</span><span class="p">:</span>
</span><span id="__span-123-18"><a id="__codelineno-123-18" name="__codelineno-123-18" href="#__codelineno-123-18"></a>            <span class="k">yield</span> <span class="n">new_lookup</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">lookup</span><span class="p">)</span>
</span><span id="__span-123-19"><a id="__codelineno-123-19" name="__codelineno-123-19" href="#__codelineno-123-19"></a>
</span><span id="__span-123-20"><a id="__codelineno-123-20" name="__codelineno-123-20" href="#__codelineno-123-20"></a><span class="k">def</span><span class="w"> </span><span class="nf">new_lookup</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
</span><span id="__span-123-21"><a id="__codelineno-123-21" name="__codelineno-123-21" href="#__codelineno-123-21"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">g</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
</span><span id="__span-123-22"><a id="__codelineno-123-22" name="__codelineno-123-22" href="#__codelineno-123-22"></a>        <span class="k">return</span> <span class="n">______</span>
</span><span id="__span-123-23"><a id="__codelineno-123-23" name="__codelineno-123-23" href="#__codelineno-123-23"></a>    <span class="k">return</span> <span class="n">g</span>
</span></code></pre></div>
</div>
<p>这题有点难度，首先使理解题目的意思，<code>lookups</code> 是需要生成能返回在(输入的) 树 <code>v</code> 中对应位置的值的函数。</p>
<p>题目给的框架也不是很容易看懂，我先是看到 <code>yield new_lookup(i, lookup)</code> 这行(看到 <code>lookup</code> )，所以猜上面一行是</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-124-1"><a id="__codelineno-124-1" name="__codelineno-124-1" href="#__codelineno-124-1"></a><span class="k">for</span> <span class="n">lookup</span> <span class="ow">in</span> <span class="n">lookups</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">branches</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">key</span><span class="p">):</span>
</span></code></pre></div>
<p>这一行应该是用来递归，所以进而就很容易想到上面的 <code>if</code> 语句是 <strong>base case</strong> 即走到了叶子节点，于是，在最简单的情况下，就直接判断 树 <code>k</code> 的值和 <code>key</code> 是否相等就行了，所以</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-125-1"><a id="__codelineno-125-1" name="__codelineno-125-1" href="#__codelineno-125-1"></a><span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">is_leaf</span><span class="p">()</span> <span class="ow">and</span> <span class="n">k</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">key</span><span class="p">:</span>
</span><span id="__span-125-2"><a id="__codelineno-125-2" name="__codelineno-125-2" href="#__codelineno-125-2"></a>    <span class="k">return</span> <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">label</span>
</span></code></pre></div>
<p>最后是 <code>new_lookup</code> 的部分(想了一会才想出来)，看到 <code>i</code> 所以想到 <code>i</code> 是用来传递路径相关的信息的(重点是需要理解传入的 <code>lookup</code> ，是子树的查找函数，所以 <code>new_lookup</code> 中需要的也是传入对应 <code>v</code> 的子树)，因此</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-126-1"><a id="__codelineno-126-1" name="__codelineno-126-1" href="#__codelineno-126-1"></a><span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">branches</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></code></pre></div>
<blockquote>
<p>完整代码</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-127-1"><a id="__codelineno-127-1" name="__codelineno-127-1" href="#__codelineno-127-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">lookups</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span><span id="__span-127-2"><a id="__codelineno-127-2" name="__codelineno-127-2" href="#__codelineno-127-2"></a>    <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">is_leaf</span><span class="p">()</span> <span class="ow">and</span> <span class="n">k</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">key</span><span class="p">:</span>
</span><span id="__span-127-3"><a id="__codelineno-127-3" name="__codelineno-127-3" href="#__codelineno-127-3"></a>        <span class="k">yield</span> <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">label</span>
</span><span id="__span-127-4"><a id="__codelineno-127-4" name="__codelineno-127-4" href="#__codelineno-127-4"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">branches</span><span class="p">)):</span>
</span><span id="__span-127-5"><a id="__codelineno-127-5" name="__codelineno-127-5" href="#__codelineno-127-5"></a>        <span class="k">for</span> <span class="n">lookup</span> <span class="ow">in</span> <span class="n">lookups</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">branches</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">key</span><span class="p">):</span>
</span><span id="__span-127-6"><a id="__codelineno-127-6" name="__codelineno-127-6" href="#__codelineno-127-6"></a>            <span class="k">yield</span> <span class="n">new_lookup</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">lookup</span><span class="p">)</span>
</span><span id="__span-127-7"><a id="__codelineno-127-7" name="__codelineno-127-7" href="#__codelineno-127-7"></a>        
</span><span id="__span-127-8"><a id="__codelineno-127-8" name="__codelineno-127-8" href="#__codelineno-127-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">new_lookup</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
</span><span id="__span-127-9"><a id="__codelineno-127-9" name="__codelineno-127-9" href="#__codelineno-127-9"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">g</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
</span><span id="__span-127-10"><a id="__codelineno-127-10" name="__codelineno-127-10" href="#__codelineno-127-10"></a>        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">branches</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="__span-127-11"><a id="__codelineno-127-11" name="__codelineno-127-11" href="#__codelineno-127-11"></a>    <span class="k">return</span> <span class="n">g</span>
</span></code></pre></div>
</blockquote>
<hr />
<p>看了John的讲解，发现 <code>if</code> 那一行正确答案应该没有 <code>k.is_leaf()</code> ，上面的代码能通过只是因为刚好测试的值都在叶子节点，所以正确的代码应该是</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-128-1"><a id="__codelineno-128-1" name="__codelineno-128-1" href="#__codelineno-128-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">lookups</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span><span id="__span-128-2"><a id="__codelineno-128-2" name="__codelineno-128-2" href="#__codelineno-128-2"></a>    <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">key</span><span class="p">:</span>
</span><span id="__span-128-3"><a id="__codelineno-128-3" name="__codelineno-128-3" href="#__codelineno-128-3"></a>        <span class="k">yield</span> <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">label</span>
</span><span id="__span-128-4"><a id="__codelineno-128-4" name="__codelineno-128-4" href="#__codelineno-128-4"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">branches</span><span class="p">)):</span>
</span><span id="__span-128-5"><a id="__codelineno-128-5" name="__codelineno-128-5" href="#__codelineno-128-5"></a>        <span class="k">for</span> <span class="n">lookup</span> <span class="ow">in</span> <span class="n">lookups</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">branches</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">key</span><span class="p">):</span>
</span><span id="__span-128-6"><a id="__codelineno-128-6" name="__codelineno-128-6" href="#__codelineno-128-6"></a>            <span class="k">yield</span> <span class="n">new_lookup</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">lookup</span><span class="p">)</span>
</span><span id="__span-128-7"><a id="__codelineno-128-7" name="__codelineno-128-7" href="#__codelineno-128-7"></a>
</span><span id="__span-128-8"><a id="__codelineno-128-8" name="__codelineno-128-8" href="#__codelineno-128-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">new_lookup</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
</span><span id="__span-128-9"><a id="__codelineno-128-9" name="__codelineno-128-9" href="#__codelineno-128-9"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">g</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
</span><span id="__span-128-10"><a id="__codelineno-128-10" name="__codelineno-128-10" href="#__codelineno-128-10"></a>        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">branches</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="__span-128-11"><a id="__codelineno-128-11" name="__codelineno-128-11" href="#__codelineno-128-11"></a>    <span class="k">return</span> <span class="n">g</span>
</span></code></pre></div>
<p><a class="glightbox" href="../images/cs61a_132.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_132" loading="lazy" src="../images/cs61a_132.png" /></a></p>
<h2 id="lecture-26-ethical-ai-data">Lecture 26 Ethical AI &amp; Data<a class="headerlink" href="#lecture-26-ethical-ai-data" title="Permanent link">&para;</a></h2>
<h3 id="1_20">1<a class="headerlink" href="#1_20" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_148.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_148" loading="lazy" src="../images/cs61a_148.png" /></a></p>
<p>Hany 在介绍 <em>监督学习 supervised learning</em> 时，提到了<strong>线性</strong>处理二维数据一种方法，通过找到一个投影面(线)，使得在投影面上，同类之间距离尽可能小，而异类之间的距离尽可能大，于是通过其法线就可以获得分割线</p>
<h3 id="2_17">2<a class="headerlink" href="#2_17" title="Permanent link">&para;</a></h3>
<p>Hany在这节课的最后关于AI的使用的看法，我认为说的很好</p>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p>Hany:</p>
<p>...We just seem to be stuck at around 65% (accuracy).</p>
<p>Okay, I posit I cannot prove, but I posit: I think that this is a fundamentally hard problem, and I am unconvinced that you can actually do better than this. Because think about what you're asking the algorithm to do. You're asking it to predict the future from a relatively small amount of data, and the future, two years in advance, of a fairly complex set of social, economic, personal, and just what is random dumb luck going to happen in somebody's life. And I don't think that's a stretch of imagination to say that this is really hard.</p>
<p>So here's a question for you: should we even be doing this? Should we actually be trying to predict whether somebody's going to commit a crime in the future and then incarcerate them if we think that they are, if the accuracy is 65%? What if the accuracy is 75%? What if it's 85%? What if it's you? What if it's somebody you love? Do you want this algorithm being applied to somebody with this kind of error rate? What's an acceptable error rate? Are these things really better than humans? How do you deal with the bias? Nobody has good answers to these things.</p>
<p>So here's a question. Now I come back to the title. right? Just because you can do something doesn't mean you should. And as you enter into what is undoubtedly an incredibly exciting time for us in terms of computation and AI and data, and the impact that we can have on the world, we have to start thinking about what are the negative aspects of what we are doing. Should we be trying to make these decisions? And if we do, the answer may be yes, but then are they accurate? Are they fair? Do they disproportionately affect women, people of color, LGBTQ community, people who are not born in this country, people who aren't native speakers, whatever it is? We have to think about the consequences of that.</p>
<p>We have spent the last 20 years with the mantra of "move fast and break things," and while lots of good things have come from that, some really bad things have come from this. Bias in algorithms for hiring, bias in algorithms in healthcare, bias in algorithms in the financial sectors, bias in algorithms in the criminal justice system, bias in facial recognition. We've got to tread lightly here. And what that means is you can't come at this after the fact. You can't develop, deploy, and then debug on the fly. This isn't a word processing software. If you have a bug, somebody loses a document. This is the real world where you make a mistake and somebody sits in jail, or somebody doesn't get a home loan, or somebody doesn't get a small business loan, or somebody doesn't get a job or go to the university. We are impacting real people's lives with our algorithms and our data, and if we don't understand these things, we have the potential to do way more harm than we do good.</p>
<p>And so the free-for-all of the last two decades, in my opinion, should be over. And I want to emphasize that I am not anti-technology. I'm not saying don't do things. I'm not saying don't innovate. But I'm saying think, think carefully about the consequences of what you are doing and make sure that there is transparency, there is fairness, and there is accuracy in how these technologies are being used. And more generally, making sure that you understand how your technologies can be misused as well because almost all technologies have benefits and drawbacks, and we have to start thinking about those things up front and simply try to mitigate the harm while harnessing the phenomenal power of technology and AI and data.</p>
<p>All right, I'm done. I hope you enjoyed this and I hope you learned something from it. We'll see you soon.</p>
<hr />
<p>Hany:</p>
<p>...我们似乎卡在了65%左右（准确率）。</p>
<p>好的，我假设我不能证明，但我假设：我认为这是一个基本上的难题，我不相信你能做得比这更好。因为想想你要算法做什么。你让它从相对较少的数据中预测未来，未来是两年后，涉及到一组相当复杂的社会、经济、个人因素，还有在某人生活中会发生的随机运气。我认为这并不是一种夸张，说这真的很难。</p>
<p>那么这里有一个问题给你：我们甚至应该这样做吗？我们真的应该尝试预测某人将来是否会犯罪，然后如果我们认为他们会犯罪就监禁他们，即使准确率是65%吗？如果准确率是75%怎么办？如果是85%呢？如果是你呢？如果是你爱的人呢？你希望这种算法应用于有这种错误率的人吗？什么是可以接受的错误率？这些东西真的比人类更好吗？如何处理偏见？没有人对这些问题有好的答案。</p>
<p>所以这里有一个问题。现在我回到标题，对吧？仅仅因为你能做某事并不意味着你应该这样做。当你进入计算、人工智能和数据方面无疑是一个非常激动人心的时刻，以及我们可以对世界产生的影响时，我们必须开始思考我们正在做的事情的负面方面。我们应该尝试做这些决定吗？如果是，答案可能是肯定的，但它们是否准确？是否公平？它们是否对女性、有色人种、LGBTQ社区、不在这个国家出生的人、不是本土说话者的人等产生不成比例的影响？我们必须考虑这些后果。</p>
<p>在过去的20年里，我们一直奉行“迅速行动并打破一切”的口号，虽然从中获得了很多好处，但也从中产生了一些非常糟糕的事情。在招聘算法中存在的偏见，在医疗保健领域的算法中存在的偏见，在金融领域的算法中存在的偏见，在刑事司法系统的算法中存在的偏见，在面部识别中存在的偏见。我们必须小心行事。这意味着你不能在事后就这么做。你不能开发、部署，然后在飞行中调试。这不是文字处理软件。如果有一个错误，某人就会丢失一份文件。这是真实的世界，你犯了一个错误，有人坐在监狱里，或者有人没有获得房屋贷款，或者有人没有获得小额贷款，或者有人没有得到工作或上大学。我们正在影响真实人们的生活，用我们的算法和数据，如果我们不理解这些事情，我们可能会造成比做好事更多的伤害。</p>
<p>因此，在我看来，过去20年的放任态度应该结束了。我想强调的是，我并不是反对技术。我并不是说不要做事情。我并不是说不要创新。但我说的是要考虑，要仔细考虑你正在做的事情的后果，并确保在使用这些技术的方式上有透明度、公平性和准确性。更一般地说，确保你了解你的技术如何被滥用，因为几乎所有技术都有利弊，我们必须开始从一开始就考虑这些事情，尽力减轻伤害，同时利用技术和人工智能和数据的巨大力量。</p>
<p>好了，我说完了。希望你喜欢这个，希望你从中学到了一些东西。我们很快就会见面。</p>
</div>
<h2 id="lecture-27-scheme">Lecture 27 Scheme<a class="headerlink" href="#lecture-27-scheme" title="Permanent link">&para;</a></h2>
<h3 id="1_21">1<a class="headerlink" href="#1_21" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_133.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_133" loading="lazy" src="../images/cs61a_133.png" /></a></p>
<p>感觉 scheme 这个表达式有点像逆波兰式😂</p>
<hr />
<p><a class="glightbox" href="../images/cs61a_134.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_134" loading="lazy" src="../images/cs61a_134.png" /></a></p>
<p>scheme 语言里的一些用法(看John的demo应该就可以看懂了)</p>
<hr />
<p><a class="glightbox" href="../images/cs61a_135.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_135" loading="lazy" src="../images/cs61a_135.png" /></a></p>
<p>scheme 中的一些语句</p>
<blockquote>
<p>John 说到 scheme 使用的 <em>环境模型 model of environments</em> 和 python 的一样</p>
</blockquote>
<h3 id="2_18">2<a class="headerlink" href="#2_18" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_136.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_136" loading="lazy" src="../images/cs61a_136.png" /></a></p>
<p>John 演示scheme中的嵌套函数时，构造了一个求平方根的递归函数，</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-129-1"><a id="__codelineno-129-1" name="__codelineno-129-1" href="#__codelineno-129-1"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nb">sqrt</span><span class="w"> </span><span class="nv">x</span><span class="p">)</span>
</span><span id="__span-129-2"><a id="__codelineno-129-2" name="__codelineno-129-2" href="#__codelineno-129-2"></a><span class="w">  </span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">update</span><span class="w"> </span><span class="nv">guess</span><span class="p">)</span>
</span><span id="__span-129-3"><a id="__codelineno-129-3" name="__codelineno-129-3" href="#__codelineno-129-3"></a><span class="w">    </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">=</span><span class="w"> </span><span class="p">(</span><span class="nf">square</span><span class="w"> </span><span class="nv">guess</span><span class="p">)</span><span class="w"> </span><span class="nv">x</span><span class="p">)</span>
</span><span id="__span-129-4"><a id="__codelineno-129-4" name="__codelineno-129-4" href="#__codelineno-129-4"></a><span class="w">        </span><span class="nv">guess</span>
</span><span id="__span-129-5"><a id="__codelineno-129-5" name="__codelineno-129-5" href="#__codelineno-129-5"></a><span class="w">        </span><span class="p">(</span><span class="nf">update</span><span class="w"> </span><span class="p">(</span><span class="nf">average</span><span class="w"> </span><span class="nv">guess</span><span class="w"> </span><span class="p">(</span><span class="nb">/</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">guess</span><span class="p">)))))</span>
</span><span id="__span-129-6"><a id="__codelineno-129-6" name="__codelineno-129-6" href="#__codelineno-129-6"></a><span class="w">  </span><span class="p">(</span><span class="nf">update</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
</span></code></pre></div>
<blockquote>
<p>翻译成 python 应该大致是这样</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-130-1"><a id="__codelineno-130-1" name="__codelineno-130-1" href="#__codelineno-130-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-130-2"><a id="__codelineno-130-2" name="__codelineno-130-2" href="#__codelineno-130-2"></a> <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="n">guess</span><span class="p">):</span>
</span><span id="__span-130-3"><a id="__codelineno-130-3" name="__codelineno-130-3" href="#__codelineno-130-3"></a>     <span class="k">if</span> <span class="n">guess</span> <span class="o">^</span> <span class="mi">2</span> <span class="o">==</span> <span class="n">x</span><span class="p">:</span>
</span><span id="__span-130-4"><a id="__codelineno-130-4" name="__codelineno-130-4" href="#__codelineno-130-4"></a>         <span class="k">return</span> <span class="n">guess</span>
</span><span id="__span-130-5"><a id="__codelineno-130-5" name="__codelineno-130-5" href="#__codelineno-130-5"></a>     <span class="k">else</span><span class="p">:</span>
</span><span id="__span-130-6"><a id="__codelineno-130-6" name="__codelineno-130-6" href="#__codelineno-130-6"></a>         <span class="k">return</span> <span class="n">update</span><span class="p">((</span><span class="n">x</span> <span class="o">//</span> <span class="n">guess</span> <span class="o">+</span> <span class="n">guess</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="__span-130-7"><a id="__codelineno-130-7" name="__codelineno-130-7" href="#__codelineno-130-7"></a> <span class="k">return</span> <span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></code></pre></div>
</blockquote>
<p>并且其中使用了
$$
guess = \frac{x}{guess} + guess
$$
的迭代方法，感觉很厉害</p>
<hr />
<p>询问了同学之后，发现这就是(以前学过的)对勾函数，最后收敛于 <span class="arithmatex">\(\sqrt{x}\)</span> 😂</p>
<h3 id="3_13">3<a class="headerlink" href="#3_13" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_137.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_137" loading="lazy" src="../images/cs61a_137.png" /></a></p>
<p>scheme中的 lambda 匿名函数(类比 python 中的很好理解)</p>
<h3 id="4_8">4<a class="headerlink" href="#4_8" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_138.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_138" loading="lazy" src="../images/cs61a_138.png" /></a></p>
<p>John 演示用 scheme 画 <em>谢尔宾斯基三角形 Sierpinski's Triangle</em> ，</p>
<p>用递归的方式画，每个大的三角形(的三条边)由(三个)小的三角形组成，因此</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-131-1"><a id="__codelineno-131-1" name="__codelineno-131-1" href="#__codelineno-131-1"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">repeat</span><span class="w"> </span><span class="nv">k</span><span class="w"> </span><span class="nv">fn</span><span class="p">)</span>
</span><span id="__span-131-2"><a id="__codelineno-131-2" name="__codelineno-131-2" href="#__codelineno-131-2"></a><span class="w">  </span><span class="p">(</span><span class="nf">fn</span><span class="p">)</span>
</span><span id="__span-131-3"><a id="__codelineno-131-3" name="__codelineno-131-3" href="#__codelineno-131-3"></a><span class="w">  </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">&gt;</span><span class="w"> </span><span class="nv">k</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">repeat</span><span class="w"> </span><span class="p">(</span><span class="nb">-</span><span class="w"> </span><span class="nv">k</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="nv">fn</span><span class="p">)))</span>
</span><span id="__span-131-4"><a id="__codelineno-131-4" name="__codelineno-131-4" href="#__codelineno-131-4"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">tri</span><span class="w"> </span><span class="nv">fn</span><span class="p">)</span>
</span><span id="__span-131-5"><a id="__codelineno-131-5" name="__codelineno-131-5" href="#__codelineno-131-5"></a><span class="w">  </span><span class="p">(</span><span class="nf">repeat</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="nf">fn</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">lt</span><span class="w"> </span><span class="mi">120</span><span class="p">))))</span>
</span><span id="__span-131-6"><a id="__codelineno-131-6" name="__codelineno-131-6" href="#__codelineno-131-6"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">sier</span><span class="w"> </span><span class="nv">d</span><span class="w"> </span><span class="nv">k</span><span class="p">)</span>
</span><span id="__span-131-7"><a id="__codelineno-131-7" name="__codelineno-131-7" href="#__codelineno-131-7"></a><span class="w">  </span><span class="p">(</span><span class="nf">tri</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">=</span><span class="w"> </span><span class="nv">d</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">fd</span><span class="w"> </span><span class="nv">k</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">leg</span><span class="w"> </span><span class="nv">d</span><span class="w"> </span><span class="nv">k</span><span class="p">)))))</span>
</span><span id="__span-131-8"><a id="__codelineno-131-8" name="__codelineno-131-8" href="#__codelineno-131-8"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">leg</span><span class="w"> </span><span class="nv">d</span><span class="w"> </span><span class="nv">k</span><span class="p">)</span>
</span><span id="__span-131-9"><a id="__codelineno-131-9" name="__codelineno-131-9" href="#__codelineno-131-9"></a><span class="w">  </span><span class="p">(</span><span class="nf">sier</span><span class="w"> </span><span class="p">(</span><span class="nb">-</span><span class="w"> </span><span class="nv">d</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">/</span><span class="w"> </span><span class="nv">k</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span>
</span><span id="__span-131-10"><a id="__codelineno-131-10" name="__codelineno-131-10" href="#__codelineno-131-10"></a><span class="w">  </span><span class="p">(</span><span class="nf">penup</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">fd</span><span class="w"> </span><span class="nv">k</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">pendown</span><span class="p">))</span>
</span></code></pre></div>
<p>代码大概是 <code>sier</code> 和 <code>leg</code> 相互调用的递归，</p>
<p>翻译成 python 大致是这样</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-132-1"><a id="__codelineno-132-1" name="__codelineno-132-1" href="#__codelineno-132-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">repeat</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">fn</span><span class="p">):</span>
</span><span id="__span-132-2"><a id="__codelineno-132-2" name="__codelineno-132-2" href="#__codelineno-132-2"></a>    <span class="n">fn</span><span class="p">()</span>
</span><span id="__span-132-3"><a id="__codelineno-132-3" name="__codelineno-132-3" href="#__codelineno-132-3"></a>    <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-132-4"><a id="__codelineno-132-4" name="__codelineno-132-4" href="#__codelineno-132-4"></a>        <span class="n">repeat</span><span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">fn</span><span class="p">)</span>
</span><span id="__span-132-5"><a id="__codelineno-132-5" name="__codelineno-132-5" href="#__codelineno-132-5"></a>
</span><span id="__span-132-6"><a id="__codelineno-132-6" name="__codelineno-132-6" href="#__codelineno-132-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">tri</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
</span><span id="__span-132-7"><a id="__codelineno-132-7" name="__codelineno-132-7" href="#__codelineno-132-7"></a>    <span class="n">repeat</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">fn</span><span class="p">()</span> <span class="ow">and</span> <span class="n">turn_left</span><span class="p">(</span><span class="mi">120</span><span class="p">))</span>
</span><span id="__span-132-8"><a id="__codelineno-132-8" name="__codelineno-132-8" href="#__codelineno-132-8"></a>
</span><span id="__span-132-9"><a id="__codelineno-132-9" name="__codelineno-132-9" href="#__codelineno-132-9"></a><span class="k">def</span><span class="w"> </span><span class="nf">sier</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span><span id="__span-132-10"><a id="__codelineno-132-10" name="__codelineno-132-10" href="#__codelineno-132-10"></a>    <span class="n">tri</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="p">(</span><span class="n">move_forward</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">leg</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">k</span><span class="p">)))</span>
</span><span id="__span-132-11"><a id="__codelineno-132-11" name="__codelineno-132-11" href="#__codelineno-132-11"></a>
</span><span id="__span-132-12"><a id="__codelineno-132-12" name="__codelineno-132-12" href="#__codelineno-132-12"></a><span class="k">def</span><span class="w"> </span><span class="nf">leg</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span><span id="__span-132-13"><a id="__codelineno-132-13" name="__codelineno-132-13" href="#__codelineno-132-13"></a>    <span class="n">sier</span><span class="p">(</span><span class="n">d</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="__span-132-14"><a id="__codelineno-132-14" name="__codelineno-132-14" href="#__codelineno-132-14"></a>    <span class="n">pen_up</span><span class="p">()</span>
</span><span id="__span-132-15"><a id="__codelineno-132-15" name="__codelineno-132-15" href="#__codelineno-132-15"></a>    <span class="n">move_forward</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</span><span id="__span-132-16"><a id="__codelineno-132-16" name="__codelineno-132-16" href="#__codelineno-132-16"></a>    <span class="n">pen_down</span><span class="p">()</span>
</span></code></pre></div>
<blockquote>
<p>其中 <code>turn_left</code> <code>move_forward</code> <code>pen_up</code> <code>pen_down</code> </p>
<p>分别对应 scheme 中的内置函数 <code>lr</code> <code>fd</code> <code>penup</code> <code>pendown</code></p>
</blockquote>
<h3 id="5_6">5<a class="headerlink" href="#5_6" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_139.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_139" loading="lazy" src="../images/cs61a_139.png" /></a></p>
<p><code>cond</code> 语句，可以类比 <code>if-elif-else</code> 语句，而且，可以理解为这个语句也可以返回值，所以可以像图中右上一样写</p>
<p><code>begin</code> 语句，将多个语句合成一个( <code>begin</code> )语句</p>
<hr />
<p><a class="glightbox" href="../images/cs61a_140.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_140" loading="lazy" src="../images/cs61a_140.png" /></a></p>
<p><code>let</code> 可以在其中定义临时的变量，格式是 <code>(let ((a 1) (b 2) ...) (...))</code> ，<code>let</code> 后第一个括号内是若干个定义临时变量的 <em>对 part</em> ，第二个括号是要执行的语句或者要返回的值</p>
<h3 id="6_3">6<a class="headerlink" href="#6_3" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_141.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_141" loading="lazy" src="../images/cs61a_141.png" /></a></p>
<p>scheme 中 链表 list 相关内容</p>
<h3 id="7_2">7<a class="headerlink" href="#7_2" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_142.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_142" loading="lazy" src="../images/cs61a_142.png" /></a></p>
<p><strong><em>引用 quotation</em></strong> (感觉似乎理解了 c++ 中的引用)，可以将<strong>符号本身</strong>传入到表达式中</p>
<blockquote>
<p>Special form to indicate that the expression itself is the value.</p>
<p>表示表达式本身就是值的特殊形式。</p>
</blockquote>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-133-1"><a id="__codelineno-133-1" name="__codelineno-133-1" href="#__codelineno-133-1"></a><span class="nv">scm&gt;</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">b</span><span class="p">)</span>
</span><span id="__span-133-2"><a id="__codelineno-133-2" name="__codelineno-133-2" href="#__codelineno-133-2"></a><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">b</span><span class="p">)</span>
</span><span id="__span-133-3"><a id="__codelineno-133-3" name="__codelineno-133-3" href="#__codelineno-133-3"></a><span class="nv">scm&gt;</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="nb">zero?</span><span class="w"> </span><span class="nv">a</span><span class="p">)</span>
</span><span id="__span-133-4"><a id="__codelineno-133-4" name="__codelineno-133-4" href="#__codelineno-133-4"></a><span class="p">(</span><span class="nb">zero?</span><span class="w"> </span><span class="nv">a</span><span class="p">)</span>
</span></code></pre></div>
<p>也可以是在表达式前加 单引号 <code>'</code> ，那么表达式中的符号都会以<em>引用</em>的形式使用</p>
<hr />
<p>John 的demo演示</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-134-1"><a id="__codelineno-134-1" name="__codelineno-134-1" href="#__codelineno-134-1"></a><span class="nv">scm&gt;</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-134-2"><a id="__codelineno-134-2" name="__codelineno-134-2" href="#__codelineno-134-2"></a><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-134-3"><a id="__codelineno-134-3" name="__codelineno-134-3" href="#__codelineno-134-3"></a><span class="nv">scm&gt;</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="nv">a</span><span class="p">)</span>
</span><span id="__span-134-4"><a id="__codelineno-134-4" name="__codelineno-134-4" href="#__codelineno-134-4"></a><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="nv">a</span><span class="p">)</span>
</span><span id="__span-134-5"><a id="__codelineno-134-5" name="__codelineno-134-5" href="#__codelineno-134-5"></a><span class="nv">scm&gt;</span><span class="w"> </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="ss">&#39;a</span><span class="p">)</span>
</span><span id="__span-134-6"><a id="__codelineno-134-6" name="__codelineno-134-6" href="#__codelineno-134-6"></a><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="nv">a</span><span class="p">)</span>
</span><span id="__span-134-7"><a id="__codelineno-134-7" name="__codelineno-134-7" href="#__codelineno-134-7"></a><span class="nv">scm&gt;</span><span class="w"> </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nv">a</span><span class="p">)</span>
</span><span id="__span-134-8"><a id="__codelineno-134-8" name="__codelineno-134-8" href="#__codelineno-134-8"></a><span class="nv">Traceback</span><span class="w"> </span><span class="p">(</span><span class="nf">most</span><span class="w"> </span><span class="nv">recent</span><span class="w"> </span><span class="nv">call</span><span class="w"> </span><span class="nb">last</span><span class="p">)</span><span class="nv">:</span>
</span><span id="__span-134-9"><a id="__codelineno-134-9" name="__codelineno-134-9" href="#__codelineno-134-9"></a><span class="w">  </span><span class="mi">0</span><span class="w">     </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nv">a</span><span class="p">)</span>
</span><span id="__span-134-10"><a id="__codelineno-134-10" name="__codelineno-134-10" href="#__codelineno-134-10"></a><span class="w">  </span><span class="mi">1</span><span class="w">     </span><span class="nv">a</span>
</span><span id="__span-134-11"><a id="__codelineno-134-11" name="__codelineno-134-11" href="#__codelineno-134-11"></a><span class="nv">Error:</span><span class="w"> </span><span class="nv">unknown</span><span class="w"> </span><span class="nv">identifier:</span><span class="w"> </span><span class="nv">a</span>
</span></code></pre></div>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p>John:</p>
<p>When quoting a list, you get a list, but all the expressions within it are quoted as well.</p>
<p>...I can't evaluate a until I've define it, but I can refer to a before I've defined it, because it's just a symbol. It could mean something in the future, it just hasn't been defined yet.</p>
<hr />
<p>John:</p>
<p>引用列表时，你会得到一个列表，但其中的所有表达式也会被引用。</p>
<p>...在定义a之前，我无法评估它，但在定义之前，我可以参考a，因为它只是一个符号。它可能在未来有意义，只是还没有定义。</p>
</div>
<h3 id="8_1">8<a class="headerlink" href="#8_1" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_143.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_143" loading="lazy" src="../images/cs61a_143.png" /></a></p>
<p>scheme 的内置函数 <code>eval</code> 可以计算引用形式的表达式(可见于上图) (感觉可以理解为 反向引用，或者说 解引用)</p>
<h3 id="9_1">9<a class="headerlink" href="#9_1" title="Permanent link">&para;</a></h3>
<p>John 关于符号表达式的演示(看起来感觉很厉害😲)</p>
<p><a class="glightbox" href="../images/cs61a_144.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_144" loading="lazy" src="../images/cs61a_144.png" /></a></p>
<blockquote>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-135-1"><a id="__codelineno-135-1" name="__codelineno-135-1" href="#__codelineno-135-1"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">fact</span><span class="w"> </span><span class="nv">n</span><span class="p">)</span>
</span><span id="__span-135-2"><a id="__codelineno-135-2" name="__codelineno-135-2" href="#__codelineno-135-2"></a><span class="w">  </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">=</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="p">(</span><span class="nf">fact</span><span class="w"> </span><span class="p">(</span><span class="nb">-</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="mi">1</span><span class="p">)))))</span>
</span><span id="__span-135-3"><a id="__codelineno-135-3" name="__codelineno-135-3" href="#__codelineno-135-3"></a>
</span><span id="__span-135-4"><a id="__codelineno-135-4" name="__codelineno-135-4" href="#__codelineno-135-4"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">fact-exp</span><span class="w"> </span><span class="nv">n</span><span class="p">)</span>
</span><span id="__span-135-5"><a id="__codelineno-135-5" name="__codelineno-135-5" href="#__codelineno-135-5"></a><span class="w">  </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">=</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="ss">&#39;*</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="p">(</span><span class="nf">fact-exp</span><span class="w"> </span><span class="p">(</span><span class="nb">-</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="mi">1</span><span class="p">)))))</span>
</span></code></pre></div>
</blockquote>
<p><a class="glightbox" href="../images/cs61a_145.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_145" loading="lazy" src="../images/cs61a_145.png" /></a></p>
<blockquote>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-136-1"><a id="__codelineno-136-1" name="__codelineno-136-1" href="#__codelineno-136-1"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">fib</span><span class="w"> </span><span class="nv">n</span><span class="p">)</span>
</span><span id="__span-136-2"><a id="__codelineno-136-2" name="__codelineno-136-2" href="#__codelineno-136-2"></a><span class="w">  </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">&lt;=</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="p">(</span><span class="nf">fib</span><span class="w"> </span><span class="p">(</span><span class="nb">-</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="w"> </span><span class="p">(</span><span class="nf">fib</span><span class="w"> </span><span class="p">(</span><span class="nb">-</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="mi">1</span><span class="p">)))))</span>
</span><span id="__span-136-3"><a id="__codelineno-136-3" name="__codelineno-136-3" href="#__codelineno-136-3"></a>
</span><span id="__span-136-4"><a id="__codelineno-136-4" name="__codelineno-136-4" href="#__codelineno-136-4"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">fib-exp</span><span class="w"> </span><span class="nv">n</span><span class="p">)</span>
</span><span id="__span-136-5"><a id="__codelineno-136-5" name="__codelineno-136-5" href="#__codelineno-136-5"></a><span class="w">  </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">&lt;=</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="ss">&#39;+</span><span class="w"> </span><span class="p">(</span><span class="nf">fib-exp</span><span class="w"> </span><span class="p">(</span><span class="nb">-</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="w"> </span><span class="p">(</span><span class="nf">fib-exp</span><span class="w"> </span><span class="p">(</span><span class="nb">-</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="mi">1</span><span class="p">)))))</span>
</span></code></pre></div>
</blockquote>
<h3 id="10_1">10<a class="headerlink" href="#10_1" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_146.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_146" loading="lazy" src="../images/cs61a_146.png" /></a></p>
<p><em>准引用 quasiquotation</em> ，可以被<strong>中断</strong>的引用</p>
<p>反引号 <code>`</code> 的引用效果可以被 逗号 <code>,</code> 中断，即 <code>,</code> 后的括号以及更里面的括号取消引用效果，而其他地方还是有引用效果</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-137-1"><a id="__codelineno-137-1" name="__codelineno-137-1" href="#__codelineno-137-1"></a><span class="nv">scm&gt;</span><span class="w"> </span><span class="o">`</span><span class="p">(</span><span class="nf">a</span><span class="w"> </span><span class="o">,</span><span class="p">(</span><span class="nb">+</span><span class="p">)</span><span class="w"> </span><span class="nv">b</span><span class="p">)</span>
</span><span id="__span-137-2"><a id="__codelineno-137-2" name="__codelineno-137-2" href="#__codelineno-137-2"></a><span class="p">(</span><span class="nf">a</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="nv">b</span><span class="p">)</span>
</span><span id="__span-137-3"><a id="__codelineno-137-3" name="__codelineno-137-3" href="#__codelineno-137-3"></a><span class="nv">scm&gt;</span><span class="w"> </span><span class="o">`</span><span class="p">(</span><span class="nf">a</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="p">)</span><span class="w"> </span><span class="nv">b</span><span class="p">)</span>
</span><span id="__span-137-4"><a id="__codelineno-137-4" name="__codelineno-137-4" href="#__codelineno-137-4"></a><span class="p">(</span><span class="nf">a</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="p">)</span><span class="w"> </span><span class="nv">b</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="11_1">11<a class="headerlink" href="#11_1" title="Permanent link">&para;</a></h3>
<p>John 关于 <em>准引用 quasiquotation</em> 引用的演示，</p>
<p>用<em>准引用</em>构造了类似于 <code>while</code> 的(某种程度上)通用的循环结构(给我看傻了😲)</p>
<p><a class="glightbox" href="../images/cs61a_147.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_147" loading="lazy" src="../images/cs61a_147.png" /></a></p>
<blockquote>
<p><strong>分号 <code>;</code> 表示注释</strong></p>
</blockquote>
<p>我的理解是，如果 <code>begin</code> 中的 <code>condition</code> <code>add-to-total</code> 等不加逗号 <code>,</code> 的话，返回的表达式中会直接就是 <code>condition</code> <code>add-to-total</code> 等<strong>这些符号本身</strong>，而加了逗号 <code>,</code> 之后，最后的表达式就会是 在使用 <code>sum-while</code> 时 具体传入的值，因此在使用 <code>sum-while</code> 时应该传入的是引用形式的表达式(即如 John 演示的一样，<code>(sum-while 1 '(&lt; (* x x) 50) 'x '(+ x 1))</code> )</p>
<blockquote>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-138-1"><a id="__codelineno-138-1" name="__codelineno-138-1" href="#__codelineno-138-1"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">sum-while</span><span class="w"> </span><span class="nv">initial-x</span><span class="w"> </span><span class="nv">condition</span><span class="w">       </span><span class="nv">add-to-total</span><span class="w"> </span><span class="nv">update-x</span><span class="p">)</span>
</span><span id="__span-138-2"><a id="__codelineno-138-2" name="__codelineno-138-2" href="#__codelineno-138-2"></a><span class="w">  </span><span class="c1">;     (sum-while 1         &#39;(&lt; (* x x) 50) &#39;x           &#39;(+ x 1))</span>
</span><span id="__span-138-3"><a id="__codelineno-138-3" name="__codelineno-138-3" href="#__codelineno-138-3"></a><span class="w">  </span><span class="o">`</span><span class="p">(</span><span class="k">begin</span>
</span><span id="__span-138-4"><a id="__codelineno-138-4" name="__codelineno-138-4" href="#__codelineno-138-4"></a><span class="w">     </span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">f</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">total</span><span class="p">)</span>
</span><span id="__span-138-5"><a id="__codelineno-138-5" name="__codelineno-138-5" href="#__codelineno-138-5"></a><span class="w">       </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="o">,</span><span class="nv">condition</span>
</span><span id="__span-138-6"><a id="__codelineno-138-6" name="__codelineno-138-6" href="#__codelineno-138-6"></a><span class="w">         </span><span class="p">(</span><span class="nf">f</span><span class="w"> </span><span class="o">,</span><span class="nv">update-x</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="nv">total</span><span class="w"> </span><span class="o">,</span><span class="nv">add-to-total</span><span class="p">))</span>
</span><span id="__span-138-7"><a id="__codelineno-138-7" name="__codelineno-138-7" href="#__codelineno-138-7"></a><span class="w">         </span><span class="nv">total</span><span class="p">))</span>
</span><span id="__span-138-8"><a id="__codelineno-138-8" name="__codelineno-138-8" href="#__codelineno-138-8"></a><span class="w">     </span><span class="p">(</span><span class="nf">f</span><span class="w"> </span><span class="o">,</span><span class="nv">initial-x</span><span class="w"> </span><span class="mi">0</span><span class="p">)))</span>
</span></code></pre></div>
</blockquote>
<h2 id="lecture-27-qa">Lecture 27  Q&amp;A<a class="headerlink" href="#lecture-27-qa" title="Permanent link">&para;</a></h2>
<h3 id="1_22">1<a class="headerlink" href="#1_22" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_149.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_149" loading="lazy" src="../images/cs61a_149.png" /></a></p>
<p>有人向提问到 scheme 中的 <code>print</code> 的返回值是什么，于是 John 开始演示</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-139-1"><a id="__codelineno-139-1" name="__codelineno-139-1" href="#__codelineno-139-1"></a><span class="nv">scm&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="p">(</span><span class="nf">print</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
</span><span id="__span-139-2"><a id="__codelineno-139-2" name="__codelineno-139-2" href="#__codelineno-139-2"></a><span class="mi">1</span>
</span><span id="__span-139-3"><a id="__codelineno-139-3" name="__codelineno-139-3" href="#__codelineno-139-3"></a><span class="nv">s</span>
</span><span id="__span-139-4"><a id="__codelineno-139-4" name="__codelineno-139-4" href="#__codelineno-139-4"></a><span class="nv">scm&gt;</span><span class="w"> </span><span class="nv">s</span>
</span><span id="__span-139-5"><a id="__codelineno-139-5" name="__codelineno-139-5" href="#__codelineno-139-5"></a><span class="nv">scm&gt;</span><span class="w"> </span><span class="nv">print</span><span class="p">(</span><span class="nf">s</span><span class="p">)</span>
</span><span id="__span-139-6"><a id="__codelineno-139-6" name="__codelineno-139-6" href="#__codelineno-139-6"></a><span class="nv">undefined</span>
</span></code></pre></div>
<p>John之后解释道，scheme 中的 <code>undefined</code> 和 python 中的 <code>None</code> 类似，但也有区别， <code>None</code> 还会用于一些比较，但 <code>undefined</code> 基本上不会被使用</p>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p>John:</p>
<p>Well, we get this special value called "undefined." That's it. It's kind of close to Python's "None," except for here's the rule. This is more of a conventional rule than enforced by the language, but here's the rule: you're never supposed to do anything with the undefined value.</p>
<p>Whereas in Python, people use "None" for all kinds of stuff. They compare whether something is "None," etc. That basically never shows up in Scheme code. So when you get this undefined value, which happens to exist, the idea is you should never do anything with it. You should never check to see if it's equal to another undefined. You should never check to see how many undefineds there are in a list or something like that. You should just stop.</p>
<p>So basically, like this expression is legal, but it's a no-no. You should never take the value of "print" and do something else with it.</p>
<hr />
<p>John:</p>
<p>嗯，我们有这个特殊的值叫做 "undefined"。就是这样，它有点类似于 Python 的 "None"，除了这里有一个规则。这更像是一种约定俗成的规则，而不是语言强制的，但这就是规则：你永远不应该对 "undefined" 值做任何事情。</p>
<p>而在 Python 中，人们用 "None" 来处理各种事情。他们比较某个东西是否为 "None" 等等。这基本上在 Scheme 代码中几乎不会出现。所以当你得到这个存在的 "undefined" 值时，理念是你不应该对它做任何事情。你不应该检查它是否等于另一个 "undefined"，你不应该检查列表中有多少个 "undefined" 等等。你应该停止。</p>
<p>所以基本上，像这个表达式是合法的，但是是不推荐的。你永远不应该获取 "print" 的值然后用它做其他事情。</p>
</div>
<h3 id="2_19">2<a class="headerlink" href="#2_19" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_150.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_150" loading="lazy" src="../images/cs61a_150.png" /></a></p>
<p>有人问道 scheme 中有没有与 python 中 <code>non local</code> 类似的操作，</p>
<p>于是 John 演示了使用 <code>set!</code> 的一种方式</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-140-1"><a id="__codelineno-140-1" name="__codelineno-140-1" href="#__codelineno-140-1"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">make-withdraw</span><span class="w"> </span><span class="nv">balance</span><span class="p">)</span>
</span><span id="__span-140-2"><a id="__codelineno-140-2" name="__codelineno-140-2" href="#__codelineno-140-2"></a><span class="w">  </span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">withdraw</span><span class="w"> </span><span class="nv">amount</span><span class="p">)</span>
</span><span id="__span-140-3"><a id="__codelineno-140-3" name="__codelineno-140-3" href="#__codelineno-140-3"></a><span class="w">    </span><span class="p">(</span><span class="k">set!</span><span class="w"> </span><span class="nv">balance</span><span class="w"> </span><span class="p">(</span><span class="nb">-</span><span class="w"> </span><span class="nv">balance</span><span class="w"> </span><span class="nv">amount</span><span class="p">))</span>
</span><span id="__span-140-4"><a id="__codelineno-140-4" name="__codelineno-140-4" href="#__codelineno-140-4"></a><span class="w">    </span><span class="nv">balance</span><span class="p">)</span>
</span><span id="__span-140-5"><a id="__codelineno-140-5" name="__codelineno-140-5" href="#__codelineno-140-5"></a><span class="w">  </span><span class="nv">withdraw</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="3_14">3<a class="headerlink" href="#3_14" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_151.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_151" loading="lazy" src="../images/cs61a_151.png" /></a></p>
<p>John 提到 scheme 中的 <code>=</code> 和 <code>equal?</code></p>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p>John:</p>
<p>So anyway, there's a bunch of different equals, and no, I don't think you need to know the difference between all of them. But if you want to know, like this ( <code>eq?</code> ), it is like <code>is</code> . This ( <code>=</code> ) is like nothing that exists in Python because it only works for numbers.</p>
<p>This ( <code>equal?</code> ) is a lot like the equal sign. Yeah, in Python, I think that just like this will check, okay, so yeah, this ( <code>equal?</code> ) will check whether two things are generally equal, just like in Python, 2 equals 2 is true, and also a list containing 2 and a list containing 2 is true. So, um, yeah, this ( <code>equal?</code> ) is usually the one you want.</p>
<p>But if you want to check for "is", it looks like that ( <code>eq?</code> ), and this ( <code>=</code> ) is some like weird thing that only works with numbers.</p>
<hr />
<p>John:</p>
<p>总之，有很多不同的等号，我不认为你需要了解它们之间的区别。但是如果你想知道，比如这个( <code>eq?</code> )，就像 <code>is</code> 。这个( <code>=</code> )在Python中并不存在，因为它只适用于数字。</p>
<p>这个( <code>equal?</code> )很像等号。是的，在Python中，我认为就像这个会检查，好的，所以是的，这个( <code>equal?</code> )将检查两个东西是否大致相等，就像在Python中，2等于2是真的，还有一个包含2的列表和一个包含2的列表也是真的。所以，嗯，这个( <code>equal?</code> )通常是你想要的。</p>
<p>但是如果你想检查“is”，它看起来像这样( <code>eq?</code> )，而这个( <code>=</code> )是一些奇怪的东西，只对数字起作用。</p>
</div>
<h2 id="lab-10">Lab 10<a class="headerlink" href="#lab-10" title="Permanent link">&para;</a></h2>
<h3 id="1_23">1<a class="headerlink" href="#1_23" title="Permanent link">&para;</a></h3>
<p>指导网页上有写如何使用提供的 scheme 解释器以及编辑器</p>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p><strong>Scheme</strong></p>
<p>Scheme is a famous functional programming language from the 1970s. It is a dialect of Lisp (which stands for LISt Processing). The first observation most people make is the unique syntax, which uses a prefix notation and (often many) nested parentheses (see http://xkcd.com/297/). Scheme features first-class functions and optimized tail-recursion, which were relatively new features at the time.</p>
<blockquote>
<p>Our course uses a custom version of Scheme (which you will build for Project 4) included in the starter ZIP archive. To start the interpreter, type <code>python3 scheme</code>. To run a Scheme program interactively, type <code>python3 scheme -i &lt;file.scm&gt;</code>. To exit the Scheme interpreter, type <code>(exit)</code>.</p>
</blockquote>
<p>You may find it useful to try <a href="https://code.cs61a.org/scheme">code.cs61a.org/scheme</a> when working through problems, as it can draw environment and box-and-pointer diagrams and it lets you walk your code step-by-step (similar to Python Tutor). Don't forget to submit your code through Ok though!</p>
<p><strong>Scheme Editor</strong></p>
<p>As you're writing your code, you can debug using the Scheme Editor. In your <code>scheme</code> folder you will find a new editor. To run this editor, run <code>python3 editor</code>. This should pop up a window in your browser; if it does not, please navigate to <a href="localhost:31415">localhost:31415</a> and you should see it.</p>
<p>Make sure to run <code>python3 ok</code> in a separate tab or window so that the editor keeps running.</p>
<p>If you find that your code works in the online editor but not in your own interpreter, it's possible you have a bug in code from an earlier part that you'll have to track down. Every once in a while there's a bug that our tests don't catch, and if you find one you should let us know!</p>
</div>
<p>运行</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-141-1"><a id="__codelineno-141-1" name="__codelineno-141-1" href="#__codelineno-141-1"></a>python<span class="w"> </span>./scheme<span class="w"> </span><span class="o">[</span>-i<span class="w"> </span>&lt;file.scm&gt;<span class="o">]</span>
</span></code></pre></div>
<p>打开 scheme 解释器，以及加载文件并打开。</p>
<p>运行</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-142-1"><a id="__codelineno-142-1" name="__codelineno-142-1" href="#__codelineno-142-1"></a>python<span class="w"> </span>editor
</span></code></pre></div>
<p>打开 scheme 编辑器，在线编辑和测试(网址在 <a href="http://127.0.0.1:31415">http://127.0.0.1:31415</a>)</p>
<p><a class="glightbox" href="../images/cs61a_159.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_159" loading="lazy" src="../images/cs61a_159.png" /></a></p>
<h3 id="2_20">2<a class="headerlink" href="#2_20" title="Permanent link">&para;</a></h3>
<p>Q5中，需要将 <code>'YOUR-CODE-HERE</code> 这一行注释掉或者删去，否则会有如下报错</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-143-1"><a id="__codelineno-143-1" name="__codelineno-143-1" href="#__codelineno-143-1"></a><span class="nv">Traceback</span><span class="w"> </span><span class="p">(</span><span class="nf">most</span><span class="w"> </span><span class="nv">recent</span><span class="w"> </span><span class="nv">call</span><span class="w"> </span><span class="nb">last</span><span class="p">)</span><span class="nv">:</span>
</span><span id="__span-143-2"><a id="__codelineno-143-2" name="__codelineno-143-2" href="#__codelineno-143-2"></a><span class="w">  </span><span class="mi">0</span><span class="w">     </span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="nv">lst</span><span class="w"> </span><span class="p">(</span><span class="k">quote</span><span class="w"> </span><span class="nv">your-code-here</span><span class="p">)</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-143-3"><a id="__codelineno-143-3" name="__codelineno-143-3" href="#__codelineno-143-3"></a><span class="nv">Error:</span><span class="w"> </span><span class="nv">too</span><span class="w"> </span><span class="nv">many</span><span class="w"> </span><span class="nv">operands</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">form</span>
</span></code></pre></div>
<h3 id="3_15">3<a class="headerlink" href="#3_15" title="Permanent link">&para;</a></h3>
<p>Q6 中，本来以为很简单，一开始递归的 base case 是用 <code>(= lst nil)</code> 来判断，但是报错了</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-144-1"><a id="__codelineno-144-1" name="__codelineno-144-1" href="#__codelineno-144-1"></a>Error:<span class="w"> </span>operand<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(())</span><span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>a<span class="w"> </span>number
</span></code></pre></div>
<p>大概应该指的是， <code>lst</code> 和 <code>nil</code> 不是数，所以不能用 <code>=</code> 比较。</p>
<p>最后在在线终端解释器中，摸索了好一会，发现了一个函数 <code>length</code> ，能返回<em>链表</em>的长度，于是将判断条件改成</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-145-1"><a id="__codelineno-145-1" name="__codelineno-145-1" href="#__codelineno-145-1"></a><span class="p">(</span><span class="nb">zero?</span><span class="w"> </span><span class="p">(</span><span class="nb">length</span><span class="w"> </span><span class="nv">lst</span><span class="p">))</span>
</span></code></pre></div>
<p>最终解决</p>
<details class="note">
<summary>code</summary>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-146-1"><a id="__codelineno-146-1" name="__codelineno-146-1" href="#__codelineno-146-1"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nb">remove</span><span class="w"> </span><span class="nv">item</span><span class="w"> </span><span class="nv">lst</span><span class="p">)</span>
</span><span id="__span-146-2"><a id="__codelineno-146-2" name="__codelineno-146-2" href="#__codelineno-146-2"></a><span class="w">  </span><span class="ss">&#39;YOUR-CODE-HERE</span>
</span><span id="__span-146-3"><a id="__codelineno-146-3" name="__codelineno-146-3" href="#__codelineno-146-3"></a><span class="w">  </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">zero?</span><span class="w"> </span><span class="p">(</span><span class="nb">length</span><span class="w"> </span><span class="nv">lst</span><span class="p">))</span>
</span><span id="__span-146-4"><a id="__codelineno-146-4" name="__codelineno-146-4" href="#__codelineno-146-4"></a><span class="w">      </span><span class="nv">nil</span>
</span><span id="__span-146-5"><a id="__codelineno-146-5" name="__codelineno-146-5" href="#__codelineno-146-5"></a><span class="w">      </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">=</span><span class="w"> </span><span class="nv">item</span><span class="w"> </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="nv">lst</span><span class="p">))</span>
</span><span id="__span-146-6"><a id="__codelineno-146-6" name="__codelineno-146-6" href="#__codelineno-146-6"></a><span class="w">          </span><span class="p">(</span><span class="nb">remove</span><span class="w"> </span><span class="nv">item</span><span class="w"> </span><span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="nv">lst</span><span class="p">))</span>
</span><span id="__span-146-7"><a id="__codelineno-146-7" name="__codelineno-146-7" href="#__codelineno-146-7"></a><span class="w">          </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="nv">lst</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">remove</span><span class="w"> </span><span class="nv">item</span><span class="w"> </span><span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="nv">lst</span><span class="p">)))))</span>
</span><span id="__span-146-8"><a id="__codelineno-146-8" name="__codelineno-146-8" href="#__codelineno-146-8"></a><span class="p">)</span>
</span></code></pre></div>
</details>
<hr />
<p>之后发现其实还可以用 <code>equal?</code> (或 <code>eq?</code> )函数，</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-147-1"><a id="__codelineno-147-1" name="__codelineno-147-1" href="#__codelineno-147-1"></a><span class="nv">scm&gt;</span><span class="w"> </span><span class="p">(</span><span class="nb">equal?</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="nv">nil</span><span class="p">)</span>
</span><span id="__span-147-2"><a id="__codelineno-147-2" name="__codelineno-147-2" href="#__codelineno-147-2"></a><span class="no">#t</span>
</span><span id="__span-147-3"><a id="__codelineno-147-3" name="__codelineno-147-3" href="#__codelineno-147-3"></a><span class="nv">scm&gt;</span><span class="w"> </span><span class="p">(</span><span class="nb">equal?</span><span class="w"> </span><span class="o">&#39;</span><span class="p">()</span><span class="w"> </span><span class="nv">nil</span><span class="p">)</span>
</span><span id="__span-147-4"><a id="__codelineno-147-4" name="__codelineno-147-4" href="#__codelineno-147-4"></a><span class="no">#t</span>
</span></code></pre></div>
<hr />
<p>写到 hw07 时发现，其实这题提示中说的 <code>filter-lst</code> 函数其实想说的是 <code>filter</code> ，之前输入 <code>filter-lst</code> 显示没有这个函数，</p>
<p>用上 <code>filter</code> 函数答案就会变得非常简单</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-148-1"><a id="__codelineno-148-1" name="__codelineno-148-1" href="#__codelineno-148-1"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nb">remove</span><span class="w"> </span><span class="nv">item</span><span class="w"> </span><span class="nv">lst</span><span class="p">)</span>
</span><span id="__span-148-2"><a id="__codelineno-148-2" name="__codelineno-148-2" href="#__codelineno-148-2"></a><span class="w">  </span><span class="ss">&#39;YOUR-CODE-HERE</span>
</span><span id="__span-148-3"><a id="__codelineno-148-3" name="__codelineno-148-3" href="#__codelineno-148-3"></a><span class="w">  </span><span class="p">(</span><span class="nb">filter</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">not</span><span class="w"> </span><span class="p">(</span><span class="nb">=</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">item</span><span class="p">)))</span><span class="w"> </span><span class="nv">lst</span><span class="p">)</span>
</span><span id="__span-148-4"><a id="__codelineno-148-4" name="__codelineno-148-4" href="#__codelineno-148-4"></a><span class="p">)</span>
</span></code></pre></div>
<h2 id="hw-06">HW 06<a class="headerlink" href="#hw-06" title="Permanent link">&para;</a></h2>
<h3 id="1_24">1<a class="headerlink" href="#1_24" title="Permanent link">&para;</a></h3>
<p>Q3中，在处理奇数情况时，一开始我写的是</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-149-1"><a id="__codelineno-149-1" name="__codelineno-149-1" href="#__codelineno-149-1"></a><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="p">(</span><span class="nf">square</span><span class="w"> </span><span class="p">(</span><span class="nf">pow</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="p">(</span><span class="nb">/</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="mi">2</span><span class="p">))))</span>
</span></code></pre></div>
<p>但是在跑第一个测试用例时，</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-150-1"><a id="__codelineno-150-1" name="__codelineno-150-1" href="#__codelineno-150-1"></a><span class="p">(</span><span class="nf">pow</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
</span></code></pre></div>
<p>显示递归溢出了</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-151-1"><a id="__codelineno-151-1" name="__codelineno-151-1" href="#__codelineno-151-1"></a><span class="c1"># Error: expected</span>
</span><span id="__span-151-2"><a id="__codelineno-151-2" name="__codelineno-151-2" href="#__codelineno-151-2"></a><span class="c1">#     32</span>
</span><span id="__span-151-3"><a id="__codelineno-151-3" name="__codelineno-151-3" href="#__codelineno-151-3"></a><span class="c1"># but got</span>
</span><span id="__span-151-4"><a id="__codelineno-151-4" name="__codelineno-151-4" href="#__codelineno-151-4"></a><span class="c1">#     Traceback (most recent call last):</span>
</span><span id="__span-151-5"><a id="__codelineno-151-5" name="__codelineno-151-5" href="#__codelineno-151-5"></a><span class="c1">#       ...</span>
</span><span id="__span-151-6"><a id="__codelineno-151-6" name="__codelineno-151-6" href="#__codelineno-151-6"></a><span class="c1">#     RecursionError: maximum recursion depth exceeded in __instancecheck__</span>
</span></code></pre></div>
<p>猜测是因为除法的问题，于是去测试了一下，发现 <code>/</code> 不是整除</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-152-1"><a id="__codelineno-152-1" name="__codelineno-152-1" href="#__codelineno-152-1"></a><span class="nv">scm&gt;</span><span class="w"> </span><span class="p">(</span><span class="nb">/</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-152-2"><a id="__codelineno-152-2" name="__codelineno-152-2" href="#__codelineno-152-2"></a><span class="mf">2.5</span>
</span><span id="__span-152-3"><a id="__codelineno-152-3" name="__codelineno-152-3" href="#__codelineno-152-3"></a><span class="nv">scm&gt;</span><span class="w"> </span><span class="p">(</span><span class="nb">/</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-152-4"><a id="__codelineno-152-4" name="__codelineno-152-4" href="#__codelineno-152-4"></a><span class="mi">2</span>
</span></code></pre></div>
<p>于是将基数情况的代码修改成了</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-153-1"><a id="__codelineno-153-1" name="__codelineno-153-1" href="#__codelineno-153-1"></a><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="p">(</span><span class="nf">square</span><span class="w"> </span><span class="p">(</span><span class="nf">pow</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="p">(</span><span class="nb">/</span><span class="w"> </span><span class="p">(</span><span class="nb">-</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="mi">2</span><span class="p">))))</span>
</span></code></pre></div>
<details class="note">
<summary>code</summary>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-154-1"><a id="__codelineno-154-1" name="__codelineno-154-1" href="#__codelineno-154-1"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">pow</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="p">)</span>
</span><span id="__span-154-2"><a id="__codelineno-154-2" name="__codelineno-154-2" href="#__codelineno-154-2"></a><span class="w">  </span><span class="ss">&#39;YOUR-CODE-HERE</span>
</span><span id="__span-154-3"><a id="__codelineno-154-3" name="__codelineno-154-3" href="#__codelineno-154-3"></a><span class="w">  </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">=</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-154-4"><a id="__codelineno-154-4" name="__codelineno-154-4" href="#__codelineno-154-4"></a><span class="w">      </span><span class="nv">x</span>
</span><span id="__span-154-5"><a id="__codelineno-154-5" name="__codelineno-154-5" href="#__codelineno-154-5"></a><span class="w">      </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">even?</span><span class="w"> </span><span class="nv">y</span><span class="p">)</span>
</span><span id="__span-154-6"><a id="__codelineno-154-6" name="__codelineno-154-6" href="#__codelineno-154-6"></a><span class="w">          </span><span class="p">(</span><span class="nf">square</span><span class="w"> </span><span class="p">(</span><span class="nf">pow</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="p">(</span><span class="nb">/</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="mi">2</span><span class="p">)))</span>
</span><span id="__span-154-7"><a id="__codelineno-154-7" name="__codelineno-154-7" href="#__codelineno-154-7"></a><span class="w">          </span><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="p">(</span><span class="nf">square</span><span class="w"> </span><span class="p">(</span><span class="nf">pow</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="p">(</span><span class="nb">/</span><span class="w"> </span><span class="p">(</span><span class="nb">-</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="mi">2</span><span class="p">))))))</span>
</span><span id="__span-154-8"><a id="__codelineno-154-8" name="__codelineno-154-8" href="#__codelineno-154-8"></a><span class="p">)</span>
</span></code></pre></div>
</details>
<h2 id="lecture-28-exception">Lecture 28 Exception<a class="headerlink" href="#lecture-28-exception" title="Permanent link">&para;</a></h2>
<h3 id="1_25">1<a class="headerlink" href="#1_25" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_152.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_152" loading="lazy" src="../images/cs61a_152.png" /></a></p>
<p>在运行 <code>py</code> 文件时，可以使用 <code>-O</code> 选项来忽略 <code>assert</code> 语句来提高程序执行效率</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-155-1"><a id="__codelineno-155-1" name="__codelineno-155-1" href="#__codelineno-155-1"></a>python<span class="w"> </span>-O
</span></code></pre></div>
<hr />
<p><a class="glightbox" href="../images/cs61a_153.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_153" loading="lazy" src="../images/cs61a_153.png" /></a></p>
<p><code>__debug__</code> 可以查看 <code>assert</code> 语句是否会被执行</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-156-1"><a id="__codelineno-156-1" name="__codelineno-156-1" href="#__codelineno-156-1"></a>C:<span class="se">\U</span>sers<span class="se">\R</span>onald&gt;python
</span><span id="__span-156-2"><a id="__codelineno-156-2" name="__codelineno-156-2" href="#__codelineno-156-2"></a>Python<span class="w"> </span><span class="m">3</span>.10.9<span class="w"> </span><span class="o">(</span>tags/v3.10.9:1dd9be6,<span class="w"> </span>Dec<span class="w">  </span><span class="m">6</span><span class="w"> </span><span class="m">2022</span>,<span class="w"> </span><span class="m">19</span>:43:38<span class="o">)</span><span class="w"> </span><span class="o">[</span>MSC<span class="w"> </span>v.1934<span class="w"> </span><span class="m">32</span><span class="w"> </span>bit<span class="w"> </span><span class="o">(</span>Intel<span class="o">)]</span><span class="w"> </span>on<span class="w"> </span>win32
</span><span id="__span-156-3"><a id="__codelineno-156-3" name="__codelineno-156-3" href="#__codelineno-156-3"></a>Type<span class="w"> </span><span class="s2">&quot;help&quot;</span>,<span class="w"> </span><span class="s2">&quot;copyright&quot;</span>,<span class="w"> </span><span class="s2">&quot;credits&quot;</span><span class="w"> </span>or<span class="w"> </span><span class="s2">&quot;license&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>information.
</span><span id="__span-156-4"><a id="__codelineno-156-4" name="__codelineno-156-4" href="#__codelineno-156-4"></a>&gt;&gt;&gt;<span class="w"> </span>__debug__
</span><span id="__span-156-5"><a id="__codelineno-156-5" name="__codelineno-156-5" href="#__codelineno-156-5"></a>True
</span><span id="__span-156-6"><a id="__codelineno-156-6" name="__codelineno-156-6" href="#__codelineno-156-6"></a>&gt;&gt;&gt;<span class="w"> </span>^Z
</span><span id="__span-156-7"><a id="__codelineno-156-7" name="__codelineno-156-7" href="#__codelineno-156-7"></a>
</span><span id="__span-156-8"><a id="__codelineno-156-8" name="__codelineno-156-8" href="#__codelineno-156-8"></a>
</span><span id="__span-156-9"><a id="__codelineno-156-9" name="__codelineno-156-9" href="#__codelineno-156-9"></a>C:<span class="se">\U</span>sers<span class="se">\R</span>onald&gt;python<span class="w"> </span>-O
</span><span id="__span-156-10"><a id="__codelineno-156-10" name="__codelineno-156-10" href="#__codelineno-156-10"></a>Python<span class="w"> </span><span class="m">3</span>.10.9<span class="w"> </span><span class="o">(</span>tags/v3.10.9:1dd9be6,<span class="w"> </span>Dec<span class="w">  </span><span class="m">6</span><span class="w"> </span><span class="m">2022</span>,<span class="w"> </span><span class="m">19</span>:43:38<span class="o">)</span><span class="w"> </span><span class="o">[</span>MSC<span class="w"> </span>v.1934<span class="w"> </span><span class="m">32</span><span class="w"> </span>bit<span class="w"> </span><span class="o">(</span>Intel<span class="o">)]</span><span class="w"> </span>on<span class="w"> </span>win32
</span><span id="__span-156-11"><a id="__codelineno-156-11" name="__codelineno-156-11" href="#__codelineno-156-11"></a>Type<span class="w"> </span><span class="s2">&quot;help&quot;</span>,<span class="w"> </span><span class="s2">&quot;copyright&quot;</span>,<span class="w"> </span><span class="s2">&quot;credits&quot;</span><span class="w"> </span>or<span class="w"> </span><span class="s2">&quot;license&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>information.
</span><span id="__span-156-12"><a id="__codelineno-156-12" name="__codelineno-156-12" href="#__codelineno-156-12"></a>&gt;&gt;&gt;<span class="w"> </span>__debug__
</span><span id="__span-156-13"><a id="__codelineno-156-13" name="__codelineno-156-13" href="#__codelineno-156-13"></a>False
</span><span id="__span-156-14"><a id="__codelineno-156-14" name="__codelineno-156-14" href="#__codelineno-156-14"></a>&gt;&gt;&gt;
</span></code></pre></div>
<h3 id="2_21">2<a class="headerlink" href="#2_21" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_154.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_154" loading="lazy" src="../images/cs61a_154.png" /></a></p>
<p><em>引发错误 raise error</em></p>
<p><code>raise</code> 后的表达式必须是 <code>BaseException</code> 的实例或者它的子类，</p>
<p>如上图，John 还介绍了中<em>错误</em>类型</p>
<hr />
<p>John 的 demo 演示</p>
<p><a class="glightbox" href="../images/cs61a_155.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_155" loading="lazy" src="../images/cs61a_155.png" /></a></p>
<h3 id="3_16">3<a class="headerlink" href="#3_16" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_156.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_156" loading="lazy" src="../images/cs61a_156.png" /></a></p>
<p><code>try</code> 语句的用法，如果在执行 <code>try</code> 之后的代码中引起了错误，并且错误是 <code>except</code> 后 <code>&lt;exception class&gt;</code> 的子类时，就会执行 <code>except</code> 中的语句(如果没有引起错误就不会执行)</p>
<p>John的demo演示</p>
<p><a class="glightbox" href="../images/cs61a_157.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_157" loading="lazy" src="../images/cs61a_157.png" /></a></p>
<h3 id="4_9">4<a class="headerlink" href="#4_9" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_158.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_158" loading="lazy" src="../images/cs61a_158.png" /></a></p>
<p>John提到了一个 <code>reduce</code> 函数(python没内置，scheme内置了)，在之后的demo演示中，分别用迭代和递归实现了 <code>reduce</code></p>
<ul>
<li>
<p>迭代</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-157-1"><a id="__codelineno-157-1" name="__codelineno-157-1" href="#__codelineno-157-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">reduce</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">initial</span><span class="p">):</span>
</span><span id="__span-157-2"><a id="__codelineno-157-2" name="__codelineno-157-2" href="#__codelineno-157-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Combine elements of s using f starting with initial.</span>
</span><span id="__span-157-3"><a id="__codelineno-157-3" name="__codelineno-157-3" href="#__codelineno-157-3"></a>
</span><span id="__span-157-4"><a id="__codelineno-157-4" name="__codelineno-157-4" href="#__codelineno-157-4"></a><span class="sd">    &gt;&gt;&gt; reduce(mul, [2, 4, 8], 1)</span>
</span><span id="__span-157-5"><a id="__codelineno-157-5" name="__codelineno-157-5" href="#__codelineno-157-5"></a><span class="sd">    64</span>
</span><span id="__span-157-6"><a id="__codelineno-157-6" name="__codelineno-157-6" href="#__codelineno-157-6"></a><span class="sd">    &gt;&gt;&gt; reduce(add, [1, 2, 3, 4], 0)</span>
</span><span id="__span-157-7"><a id="__codelineno-157-7" name="__codelineno-157-7" href="#__codelineno-157-7"></a><span class="sd">    10</span>
</span><span id="__span-157-8"><a id="__codelineno-157-8" name="__codelineno-157-8" href="#__codelineno-157-8"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-157-9"><a id="__codelineno-157-9" name="__codelineno-157-9" href="#__codelineno-157-9"></a>    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
</span><span id="__span-157-10"><a id="__codelineno-157-10" name="__codelineno-157-10" href="#__codelineno-157-10"></a>        <span class="n">initial</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">initial</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="__span-157-11"><a id="__codelineno-157-11" name="__codelineno-157-11" href="#__codelineno-157-11"></a>    <span class="k">return</span> <span class="n">initial</span>
</span></code></pre></div>
</li>
<li>
<p>递归</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-158-1"><a id="__codelineno-158-1" name="__codelineno-158-1" href="#__codelineno-158-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">reduce</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">initial</span><span class="p">):</span>
</span><span id="__span-158-2"><a id="__codelineno-158-2" name="__codelineno-158-2" href="#__codelineno-158-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Combine elements of s using f starting with initial.</span>
</span><span id="__span-158-3"><a id="__codelineno-158-3" name="__codelineno-158-3" href="#__codelineno-158-3"></a>
</span><span id="__span-158-4"><a id="__codelineno-158-4" name="__codelineno-158-4" href="#__codelineno-158-4"></a><span class="sd">    &gt;&gt;&gt; reduce(mul, [2, 4, 8], 1)</span>
</span><span id="__span-158-5"><a id="__codelineno-158-5" name="__codelineno-158-5" href="#__codelineno-158-5"></a><span class="sd">    64</span>
</span><span id="__span-158-6"><a id="__codelineno-158-6" name="__codelineno-158-6" href="#__codelineno-158-6"></a><span class="sd">    &gt;&gt;&gt; reduce(add, [1, 2, 3, 4], 0)</span>
</span><span id="__span-158-7"><a id="__codelineno-158-7" name="__codelineno-158-7" href="#__codelineno-158-7"></a><span class="sd">    10</span>
</span><span id="__span-158-8"><a id="__codelineno-158-8" name="__codelineno-158-8" href="#__codelineno-158-8"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-158-9"><a id="__codelineno-158-9" name="__codelineno-158-9" href="#__codelineno-158-9"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span><span class="p">:</span>
</span><span id="__span-158-10"><a id="__codelineno-158-10" name="__codelineno-158-10" href="#__codelineno-158-10"></a>        <span class="k">return</span> <span class="n">initial</span>
</span><span id="__span-158-11"><a id="__codelineno-158-11" name="__codelineno-158-11" href="#__codelineno-158-11"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-158-12"><a id="__codelineno-158-12" name="__codelineno-158-12" href="#__codelineno-158-12"></a>        <span class="n">first</span><span class="p">,</span> <span class="n">rest</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="__span-158-13"><a id="__codelineno-158-13" name="__codelineno-158-13" href="#__codelineno-158-13"></a>        <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">rest</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">initial</span><span class="p">,</span> <span class="n">first</span><span class="p">))</span>
</span></code></pre></div>
</li>
</ul>
<h2 id="lecture-28-qa">Lecture 28 Q&amp;A<a class="headerlink" href="#lecture-28-qa" title="Permanent link">&para;</a></h2>
<h3 id="1_26">1<a class="headerlink" href="#1_26" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_160.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_160" loading="lazy" src="../images/cs61a_160.png" /></a></p>
<p><code>try</code> 语句结构中的 <code>finally</code> 语句，</p>
<p><code>finally</code> 中的代码无论 <code>try</code> 中是否引发错误最终都会被执行(从图上 John 的演示中可以看到)，所以 <code>finally</code> 中一般用来释放资源释放内存(如关闭在 <code>try</code> 中加载的文件，或者断开网络连接)</p>
<h3 id="2_22">2<a class="headerlink" href="#2_22" title="Permanent link">&para;</a></h3>
<p>有人提问 <code>try</code> 中引发的错误是否存在于 <code>global</code> 框架中，John 进行演示</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-159-1"><a id="__codelineno-159-1" name="__codelineno-159-1" href="#__codelineno-159-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">try</span><span class="p">:</span>
</span><span id="__span-159-2"><a id="__codelineno-159-2" name="__codelineno-159-2" href="#__codelineno-159-2"></a><span class="o">...</span>     <span class="mi">1</span><span class="o">/</span><span class="mi">0</span>
</span><span id="__span-159-3"><a id="__codelineno-159-3" name="__codelineno-159-3" href="#__codelineno-159-3"></a><span class="o">...</span> <span class="k">except</span> <span class="ne">ZeroDivisionError</span> <span class="k">as</span> <span class="n">n</span><span class="p">:</span>
</span><span id="__span-159-4"><a id="__codelineno-159-4" name="__codelineno-159-4" href="#__codelineno-159-4"></a><span class="o">...</span>     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;n is&quot;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span id="__span-159-5"><a id="__codelineno-159-5" name="__codelineno-159-5" href="#__codelineno-159-5"></a><span class="o">...</span>
</span><span id="__span-159-6"><a id="__codelineno-159-6" name="__codelineno-159-6" href="#__codelineno-159-6"></a><span class="n">n</span> <span class="ow">is</span> <span class="n">division</span> <span class="n">by</span> <span class="n">zero</span>
</span><span id="__span-159-7"><a id="__codelineno-159-7" name="__codelineno-159-7" href="#__codelineno-159-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">n</span>
</span><span id="__span-159-8"><a id="__codelineno-159-8" name="__codelineno-159-8" href="#__codelineno-159-8"></a><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
</span><span id="__span-159-9"><a id="__codelineno-159-9" name="__codelineno-159-9" href="#__codelineno-159-9"></a>  <span class="n">File</span> <span class="s2">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
</span><span id="__span-159-10"><a id="__codelineno-159-10" name="__codelineno-159-10" href="#__codelineno-159-10"></a><span class="n">Nameerror</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;n&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</span></code></pre></div>
<p>随后 John 又展示了一下错误实例</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-160-1"><a id="__codelineno-160-1" name="__codelineno-160-1" href="#__codelineno-160-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">return_an_error</span><span class="p">():</span>
</span><span id="__span-160-2"><a id="__codelineno-160-2" name="__codelineno-160-2" href="#__codelineno-160-2"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-160-3"><a id="__codelineno-160-3" name="__codelineno-160-3" href="#__codelineno-160-3"></a>        <span class="mi">1</span><span class="o">/</span><span class="mi">0</span>
</span><span id="__span-160-4"><a id="__codelineno-160-4" name="__codelineno-160-4" href="#__codelineno-160-4"></a>    <span class="k">except</span> <span class="ne">ZeroDivisionError</span> <span class="k">as</span> <span class="n">n</span><span class="p">:</span>
</span><span id="__span-160-5"><a id="__codelineno-160-5" name="__codelineno-160-5" href="#__codelineno-160-5"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;n is&quot;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span id="__span-160-6"><a id="__codelineno-160-6" name="__codelineno-160-6" href="#__codelineno-160-6"></a>        <span class="k">return</span> <span class="n">n</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-161-1"><a id="__codelineno-161-1" name="__codelineno-161-1" href="#__codelineno-161-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">e</span> <span class="o">=</span> <span class="n">return_an_error</span><span class="p">()</span>
</span><span id="__span-161-2"><a id="__codelineno-161-2" name="__codelineno-161-2" href="#__codelineno-161-2"></a><span class="n">n</span> <span class="ow">is</span> <span class="n">division</span> <span class="n">by</span> <span class="n">zero</span>
</span><span id="__span-161-3"><a id="__codelineno-161-3" name="__codelineno-161-3" href="#__codelineno-161-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">e</span>
</span><span id="__span-161-4"><a id="__codelineno-161-4" name="__codelineno-161-4" href="#__codelineno-161-4"></a><span class="ne">ZeroDivisionError</span><span class="p">(</span><span class="s1">&#39;division by zero&#39;</span><span class="p">)</span>
</span><span id="__span-161-5"><a id="__codelineno-161-5" name="__codelineno-161-5" href="#__codelineno-161-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="__span-161-6"><a id="__codelineno-161-6" name="__codelineno-161-6" href="#__codelineno-161-6"></a><span class="s1">&#39;division by zero&#39;</span>
</span><span id="__span-161-7"><a id="__codelineno-161-7" name="__codelineno-161-7" href="#__codelineno-161-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="__span-161-8"><a id="__codelineno-161-8" name="__codelineno-161-8" href="#__codelineno-161-8"></a><span class="s2">&quot;ZeroDivisionError(&#39;division by zero&#39;)&quot;</span>
</span><span id="__span-161-9"><a id="__codelineno-161-9" name="__codelineno-161-9" href="#__codelineno-161-9"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="ne">Exception</span><span class="p">)</span>
</span><span id="__span-161-10"><a id="__codelineno-161-10" name="__codelineno-161-10" href="#__codelineno-161-10"></a><span class="kc">True</span>
</span><span id="__span-161-11"><a id="__codelineno-161-11" name="__codelineno-161-11" href="#__codelineno-161-11"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="ne">ZeroDivisionError</span><span class="p">)</span>
</span><span id="__span-161-12"><a id="__codelineno-161-12" name="__codelineno-161-12" href="#__codelineno-161-12"></a><span class="kc">True</span>
</span></code></pre></div>
<h3 id="3_17">3<a class="headerlink" href="#3_17" title="Permanent link">&para;</a></h3>
<p>有人提问19年秋季期末考试的这一题</p>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p><strong>Mull It Over</strong></p>
<p><em>Uh oh!</em> Someone evaluated <code>(define * +)</code> . Now <code>(* 3 2)</code> evaluates to 5 instead of 6! Let's fix it.</p>
<p><strong>Important</strong>: Answer all questions on this page without calling the built-in multiplication procedure.</p>
<p><strong>(a)</strong> Implement <code>mulxy</code> , which multiplies integers <code>x</code> and <code>y</code> . <strong>Hint</strong>: <code>(- 2)</code> evaluates to -2.</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-162-1"><a id="__codelineno-162-1" name="__codelineno-162-1" href="#__codelineno-162-1"></a><span class="c1">;; multiply x by y (without using the * operator).</span>
</span><span id="__span-162-2"><a id="__codelineno-162-2" name="__codelineno-162-2" href="#__codelineno-162-2"></a><span class="c1">;; (mulxy 3 4) -&gt; 12           ; 12 = 3 + 3 + 3 + 3</span>
</span><span id="__span-162-3"><a id="__codelineno-162-3" name="__codelineno-162-3" href="#__codelineno-162-3"></a><span class="c1">;; (mulxy (- 3) (- 4)) -&gt; 12   ; 12 = - ( -3 + -3 + -3 + -3 )</span>
</span><span id="__span-162-4"><a id="__codelineno-162-4" name="__codelineno-162-4" href="#__codelineno-162-4"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">mulxy</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="p">)</span>
</span><span id="__span-162-5"><a id="__codelineno-162-5" name="__codelineno-162-5" href="#__codelineno-162-5"></a><span class="w">  </span><span class="p">(</span><span class="k">cond</span><span class="w"> </span><span class="p">((</span><span class="nb">&lt;</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">-</span><span class="w"> </span><span class="nv">______</span><span class="w"> </span><span class="p">))</span>
</span><span id="__span-162-6"><a id="__codelineno-162-6" name="__codelineno-162-6" href="#__codelineno-162-6"></a><span class="w">        </span><span class="p">((</span><span class="nb">=</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-162-7"><a id="__codelineno-162-7" name="__codelineno-162-7" href="#__codelineno-162-7"></a><span class="w">        </span><span class="p">(</span><span class="k">else</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nv">______</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="p">(</span><span class="nf">mulxy</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">______</span><span class="p">)))))</span>
</span></code></pre></div>
<p><strong>(b)</strong> Implement <code>mul-expr</code> , which takes an expression <code>e</code> that contains only calls to <code>*</code> and numbers. It returns the normal value of <code>e</code> under a Scheme interpreter with an unmodified <code>*</code> operator that multiplies.</p>
<p>You may call the <code>mul</code> procedure defined below.</p>
<p><strong>Important</strong>: Fill each blank with only a single symbol.</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-163-1"><a id="__codelineno-163-1" name="__codelineno-163-1" href="#__codelineno-163-1"></a><span class="c1">;; Multiply together a list of numbers.</span>
</span><span id="__span-163-2"><a id="__codelineno-163-2" name="__codelineno-163-2" href="#__codelineno-163-2"></a><span class="c1">;; (mul &#39;(2 3 4 2)) -&gt; 48</span>
</span><span id="__span-163-3"><a id="__codelineno-163-3" name="__codelineno-163-3" href="#__codelineno-163-3"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">mul</span><span class="w"> </span><span class="nv">s</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">reduce</span><span class="w"> </span><span class="nv">mulxy</span><span class="w"> </span><span class="nv">s</span><span class="p">))</span>
</span><span id="__span-163-4"><a id="__codelineno-163-4" name="__codelineno-163-4" href="#__codelineno-163-4"></a>
</span><span id="__span-163-5"><a id="__codelineno-163-5" name="__codelineno-163-5" href="#__codelineno-163-5"></a><span class="c1">;; Evaluate an expression with only calls to * and numbers.</span>
</span><span id="__span-163-6"><a id="__codelineno-163-6" name="__codelineno-163-6" href="#__codelineno-163-6"></a><span class="c1">;; (mul-expr &#39;(* (* 1 2) (* 3 (* 4 1 1) 2))) -&gt; 48</span>
</span><span id="__span-163-7"><a id="__codelineno-163-7" name="__codelineno-163-7" href="#__codelineno-163-7"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">mul-expr</span><span class="w"> </span><span class="nv">e</span><span class="p">)</span>
</span><span id="__span-163-8"><a id="__codelineno-163-8" name="__codelineno-163-8" href="#__codelineno-163-8"></a><span class="w">  </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">number?</span><span class="w"> </span><span class="nv">e</span><span class="p">)</span><span class="w"> </span><span class="nv">e</span>
</span><span id="__span-163-9"><a id="__codelineno-163-9" name="__codelineno-163-9" href="#__codelineno-163-9"></a><span class="w">      </span><span class="p">(</span><span class="nf">______</span><span class="w"> </span><span class="p">(</span><span class="nf">______</span><span class="w"> </span><span class="nv">______</span><span class="w"> </span><span class="p">(</span><span class="nf">______</span><span class="w"> </span><span class="nv">e</span><span class="p">)))))</span>
</span></code></pre></div>
<p><strong>(c)</strong> Implement <code>*-to-mul</code> , which takes any expression <code>e</code> . It returns an expression like <code>e</code> , but with all calls to <code>*</code> replaced with calls to <code>mul</code> . Note that <code>*</code> takes an arbitrary number of arguments, while <code>mul</code> always takes exactly one argument: a list of numbers. You should account for this difference.</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-164-1"><a id="__codelineno-164-1" name="__codelineno-164-1" href="#__codelineno-164-1"></a><span class="c1">;; Convert all calls to * to calls to mul in expression e.</span>
</span><span id="__span-164-2"><a id="__codelineno-164-2" name="__codelineno-164-2" href="#__codelineno-164-2"></a><span class="c1">;; (eval (*-to-mul &#39;(* 1 (+ 2 3) (+ 4 5 (* 6 1))))) -&gt; 75</span>
</span><span id="__span-164-3"><a id="__codelineno-164-3" name="__codelineno-164-3" href="#__codelineno-164-3"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">*-to-mul</span><span class="w"> </span><span class="nv">e</span><span class="p">)</span>
</span><span id="__span-164-4"><a id="__codelineno-164-4" name="__codelineno-164-4" href="#__codelineno-164-4"></a><span class="w">  </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">not</span><span class="w"> </span><span class="p">(</span><span class="nb">list?</span><span class="w"> </span><span class="nv">e</span><span class="p">))</span><span class="w"> </span><span class="nv">e</span>
</span><span id="__span-164-5"><a id="__codelineno-164-5" name="__codelineno-164-5" href="#__codelineno-164-5"></a><span class="w">      </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nf">op</span><span class="w"> </span><span class="nv">______</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">rest</span><span class="w"> </span><span class="nv">______</span><span class="p">))</span>
</span><span id="__span-164-6"><a id="__codelineno-164-6" name="__codelineno-164-6" href="#__codelineno-164-6"></a><span class="w">        </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">equal?</span><span class="w"> </span><span class="nv">op</span><span class="w"> </span><span class="ss">&#39;*</span><span class="p">)</span>
</span><span id="__span-164-7"><a id="__codelineno-164-7" name="__codelineno-164-7" href="#__codelineno-164-7"></a><span class="w">            </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="nv">______</span><span class="p">)</span>
</span><span id="__span-164-8"><a id="__codelineno-164-8" name="__codelineno-164-8" href="#__codelineno-164-8"></a><span class="w">            </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="nv">op</span><span class="w"> </span><span class="nv">rest</span><span class="p">)))))</span>
</span></code></pre></div>
</div>
<p>我先尝试自己做了一下，</p>
<p>第一题很简单</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-165-1"><a id="__codelineno-165-1" name="__codelineno-165-1" href="#__codelineno-165-1"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">mulxy</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="p">)</span>
</span><span id="__span-165-2"><a id="__codelineno-165-2" name="__codelineno-165-2" href="#__codelineno-165-2"></a><span class="w">  </span><span class="p">(</span><span class="k">cond</span><span class="w"> </span><span class="p">((</span><span class="nb">&lt;</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">-</span><span class="w"> </span><span class="p">(</span><span class="nf">mulxy</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="p">(</span><span class="nb">-</span><span class="w"> </span><span class="nv">y</span><span class="p">))))</span>
</span><span id="__span-165-3"><a id="__codelineno-165-3" name="__codelineno-165-3" href="#__codelineno-165-3"></a><span class="w">        </span><span class="p">((</span><span class="nb">=</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-165-4"><a id="__codelineno-165-4" name="__codelineno-165-4" href="#__codelineno-165-4"></a><span class="w">        </span><span class="p">(</span><span class="k">else</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="p">(</span><span class="nf">mulxy</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="p">(</span><span class="nb">-</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="mi">1</span><span class="p">))))))</span>
</span></code></pre></div>
<p>第二题由于每一个空只能填一个 symbol，想了很久没想到可行的填法，感觉应该是需要使用一些特殊的函数。</p>
<p>John 使用了scheme内置的 <code>map</code> 函数</p>
<p><a class="glightbox" href="../images/cs61a_161.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_161" loading="lazy" src="../images/cs61a_161.png" /></a></p>
<p>scheme 中的 <code>map</code> 和 python 中的 <code>map</code> 效果差不多，都是传入一个函数和一个链表/序列，然后将函数应用到每一个元素上，</p>
<p>因此</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-166-1"><a id="__codelineno-166-1" name="__codelineno-166-1" href="#__codelineno-166-1"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">mul-expr</span><span class="w"> </span><span class="nv">e</span><span class="p">)</span>
</span><span id="__span-166-2"><a id="__codelineno-166-2" name="__codelineno-166-2" href="#__codelineno-166-2"></a><span class="w">  </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">number?</span><span class="w"> </span><span class="nv">e</span><span class="p">)</span><span class="w"> </span><span class="nv">e</span>
</span><span id="__span-166-3"><a id="__codelineno-166-3" name="__codelineno-166-3" href="#__codelineno-166-3"></a><span class="w">      </span><span class="p">(</span><span class="nf">mul</span><span class="w"> </span><span class="p">(</span><span class="nb">map</span><span class="w"> </span><span class="nv">mul-expr</span><span class="w"> </span><span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="nv">e</span><span class="p">)))))</span>
</span></code></pre></div>
<p>第三题也比较难，先是根据我的理解写出了</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-167-1"><a id="__codelineno-167-1" name="__codelineno-167-1" href="#__codelineno-167-1"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">*-to-mul</span><span class="w"> </span><span class="nv">e</span><span class="p">)</span>
</span><span id="__span-167-2"><a id="__codelineno-167-2" name="__codelineno-167-2" href="#__codelineno-167-2"></a><span class="w">  </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">not</span><span class="w"> </span><span class="p">(</span><span class="nb">list?</span><span class="w"> </span><span class="nv">e</span><span class="p">))</span><span class="w"> </span><span class="nv">e</span>
</span><span id="__span-167-3"><a id="__codelineno-167-3" name="__codelineno-167-3" href="#__codelineno-167-3"></a><span class="w">      </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nf">op</span><span class="w"> </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="nv">e</span><span class="p">))</span><span class="w"> </span><span class="p">(</span><span class="nf">rest</span><span class="w"> </span><span class="p">(</span><span class="nb">map</span><span class="w"> </span><span class="nv">*-to-mul</span><span class="w"> </span><span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="nv">e</span><span class="p">))))</span>
</span><span id="__span-167-4"><a id="__codelineno-167-4" name="__codelineno-167-4" href="#__codelineno-167-4"></a><span class="w">        </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">equal?</span><span class="w"> </span><span class="nv">op</span><span class="w"> </span><span class="ss">&#39;*</span><span class="p">)</span>
</span><span id="__span-167-5"><a id="__codelineno-167-5" name="__codelineno-167-5" href="#__codelineno-167-5"></a><span class="w">            </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="nv">______</span><span class="p">)</span>
</span><span id="__span-167-6"><a id="__codelineno-167-6" name="__codelineno-167-6" href="#__codelineno-167-6"></a><span class="w">            </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="nv">op</span><span class="w"> </span><span class="nv">rest</span><span class="p">)))))</span>
</span></code></pre></div>
<p><code>(list ______)</code> 这一行，一开始尝试 <code>(list mul rest)</code> ，但是测试时显示</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-168-1"><a id="__codelineno-168-1" name="__codelineno-168-1" href="#__codelineno-168-1"></a><span class="nv">scm&gt;</span><span class="w"> </span><span class="p">(</span><span class="nb">eval</span><span class="w"> </span><span class="p">(</span><span class="nf">*-to-mul</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">1</span><span class="p">)))))</span>
</span><span id="__span-168-2"><a id="__codelineno-168-2" name="__codelineno-168-2" href="#__codelineno-168-2"></a><span class="nv">Traceback</span><span class="w"> </span><span class="p">(</span><span class="nf">most</span><span class="w"> </span><span class="nv">recent</span><span class="w"> </span><span class="nv">call</span><span class="w"> </span><span class="nb">last</span><span class="p">)</span><span class="nv">:</span>
</span><span id="__span-168-3"><a id="__codelineno-168-3" name="__codelineno-168-3" href="#__codelineno-168-3"></a><span class="w">  </span><span class="mi">0</span><span class="w">     </span><span class="p">(</span><span class="nb">eval</span><span class="w"> </span><span class="p">(</span><span class="nf">*-to-mul</span><span class="w"> </span><span class="p">(</span><span class="k">quote</span><span class="w"> </span><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">1</span><span class="p">))))))</span>
</span><span id="__span-168-4"><a id="__codelineno-168-4" name="__codelineno-168-4" href="#__codelineno-168-4"></a><span class="w">  </span><span class="mi">1</span><span class="w">     </span><span class="p">((</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="nf">s</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">reduce</span><span class="w"> </span><span class="nv">mulxy</span><span class="w"> </span><span class="nv">s</span><span class="p">))</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="p">((</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="nf">s</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">reduce</span><span class="w"> </span><span class="nv">mulxy</span><span class="w"> </span><span class="nv">s</span><span class="p">))</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="w"> </span><span class="mi">1</span><span class="p">)))))</span>
</span><span id="__span-168-5"><a id="__codelineno-168-5" name="__codelineno-168-5" href="#__codelineno-168-5"></a><span class="w">  </span><span class="mi">2</span><span class="w">     </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="nf">s</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">reduce</span><span class="w"> </span><span class="nv">mulxy</span><span class="w"> </span><span class="nv">s</span><span class="p">))</span>
</span><span id="__span-168-6"><a id="__codelineno-168-6" name="__codelineno-168-6" href="#__codelineno-168-6"></a><span class="nv">Error:</span><span class="w"> </span><span class="nv">malformed</span><span class="w"> </span><span class="nv">list:</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="nf">s</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">reduce</span><span class="w"> </span><span class="nv">mulxy</span><span class="w"> </span><span class="nv">s</span><span class="p">))</span>
</span><span id="__span-168-7"><a id="__codelineno-168-7" name="__codelineno-168-7" href="#__codelineno-168-7"></a><span class="nv">scm&gt;</span><span class="w"> </span><span class="p">(</span><span class="nf">*-to-mul</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">1</span><span class="p">))))</span>
</span><span id="__span-168-8"><a id="__codelineno-168-8" name="__codelineno-168-8" href="#__codelineno-168-8"></a><span class="p">((</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="nf">s</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">reduce</span><span class="w"> </span><span class="nv">mulxy</span><span class="w"> </span><span class="nv">s</span><span class="p">))</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="p">((</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="nf">s</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">reduce</span><span class="w"> </span><span class="nv">mulxy</span><span class="w"> </span><span class="nv">s</span><span class="p">))</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="w"> </span><span class="mi">1</span><span class="p">)))))</span>
</span></code></pre></div>
<p>然后我意识到，应该把 <code>mul</code> 改成 <code>'mul</code> ，因为<strong>需要返回的是一个表达式，表达式中的符号和函数应该是引用的形式</strong>，</p>
<p>修改成 <code>(list 'mul rest)</code> 之后，测试显示</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-169-1"><a id="__codelineno-169-1" name="__codelineno-169-1" href="#__codelineno-169-1"></a><span class="nv">scm&gt;</span><span class="w"> </span><span class="p">(</span><span class="nb">eval</span><span class="w"> </span><span class="p">(</span><span class="nf">*-to-mul</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">1</span><span class="p">)))))</span>
</span><span id="__span-169-2"><a id="__codelineno-169-2" name="__codelineno-169-2" href="#__codelineno-169-2"></a><span class="nv">Traceback</span><span class="w"> </span><span class="p">(</span><span class="nf">most</span><span class="w"> </span><span class="nv">recent</span><span class="w"> </span><span class="nv">call</span><span class="w"> </span><span class="nb">last</span><span class="p">)</span><span class="nv">:</span>
</span><span id="__span-169-3"><a id="__codelineno-169-3" name="__codelineno-169-3" href="#__codelineno-169-3"></a><span class="w">  </span><span class="mi">0</span><span class="w">     </span><span class="p">(</span><span class="nb">eval</span><span class="w"> </span><span class="p">(</span><span class="nf">*-to-mul</span><span class="w"> </span><span class="p">(</span><span class="k">quote</span><span class="w"> </span><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">1</span><span class="p">))))))</span>
</span><span id="__span-169-4"><a id="__codelineno-169-4" name="__codelineno-169-4" href="#__codelineno-169-4"></a><span class="w">  </span><span class="mi">1</span><span class="w">     </span><span class="p">(</span><span class="nf">mul</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="p">(</span><span class="nf">mul</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="w"> </span><span class="mi">1</span><span class="p">)))))</span>
</span><span id="__span-169-5"><a id="__codelineno-169-5" name="__codelineno-169-5" href="#__codelineno-169-5"></a><span class="w">  </span><span class="mi">2</span><span class="w">     </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="p">(</span><span class="nf">mul</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="w"> </span><span class="mi">1</span><span class="p">))))</span>
</span><span id="__span-169-6"><a id="__codelineno-169-6" name="__codelineno-169-6" href="#__codelineno-169-6"></a><span class="nv">Error:</span><span class="w"> </span><span class="nv">int</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nb">not</span><span class="w"> </span><span class="nv">callable:</span><span class="w"> </span><span class="mi">1</span>
</span></code></pre></div>
<blockquote>
<p>本来看到上面的</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-170-1"><a id="__codelineno-170-1" name="__codelineno-170-1" href="#__codelineno-170-1"></a><span class="c1">;; (mul &#39;(2 3 4 2)) -&gt; 48</span>
</span></code></pre></div>
<p>将代码尝试改成了</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-171-1"><a id="__codelineno-171-1" name="__codelineno-171-1" href="#__codelineno-171-1"></a><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="ss">&#39;mul</span><span class="w"> </span><span class="p">(</span><span class="ss">&#39;quote</span><span class="w"> </span><span class="nv">rest</span><span class="p">))</span>
</span></code></pre></div>
<p>但是测试时显示</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-172-1"><a id="__codelineno-172-1" name="__codelineno-172-1" href="#__codelineno-172-1"></a><span class="nv">Traceback</span><span class="w"> </span><span class="p">(</span><span class="nf">most</span><span class="w"> </span><span class="nv">recent</span><span class="w"> </span><span class="nv">call</span><span class="w"> </span><span class="nb">last</span><span class="p">)</span><span class="nv">:</span>
</span><span id="__span-172-2"><a id="__codelineno-172-2" name="__codelineno-172-2" href="#__codelineno-172-2"></a><span class="w">  </span><span class="o">...</span><span class="w">   </span><span class="o">...</span>
</span><span id="__span-172-3"><a id="__codelineno-172-3" name="__codelineno-172-3" href="#__codelineno-172-3"></a><span class="w">  </span><span class="mi">4</span><span class="w">     </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="p">(</span><span class="k">quote</span><span class="w"> </span><span class="nv">mul</span><span class="p">)</span><span class="w"> </span><span class="p">((</span><span class="k">quote</span><span class="w"> </span><span class="k">quote</span><span class="p">)</span><span class="w"> </span><span class="nv">rest</span><span class="p">))</span>
</span><span id="__span-172-4"><a id="__codelineno-172-4" name="__codelineno-172-4" href="#__codelineno-172-4"></a><span class="w">  </span><span class="mi">5</span><span class="w">     </span><span class="p">((</span><span class="k">quote</span><span class="w"> </span><span class="k">quote</span><span class="p">)</span><span class="w"> </span><span class="nv">rest</span><span class="p">)</span>
</span><span id="__span-172-5"><a id="__codelineno-172-5" name="__codelineno-172-5" href="#__codelineno-172-5"></a><span class="nv">Error:</span><span class="w"> </span><span class="nv">str</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nb">not</span><span class="w"> </span><span class="nv">callable:</span><span class="w"> </span><span class="k">quote</span>
</span></code></pre></div>
</blockquote>
<p>最后想不出答案。</p>
<p><a class="glightbox" href="../images/cs61a_162.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_162" loading="lazy" src="../images/cs61a_162.png" /></a></p>
<p>John 利用一个例子来进行讲解，</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-173-1"><a id="__codelineno-173-1" name="__codelineno-173-1" href="#__codelineno-173-1"></a><span class="p">(</span><span class="nf">*-to-mul</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="p">)))</span>
</span></code></pre></div>
<p><strong>应该得到的是</strong>(感觉我之前做的时候是没想到这个关键的地方)</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-174-1"><a id="__codelineno-174-1" name="__codelineno-174-1" href="#__codelineno-174-1"></a><span class="p">(</span><span class="nf">mul</span><span class="w"> </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">(</span><span class="nf">mul</span><span class="w"> </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="p">))))</span>
</span></code></pre></div>
<blockquote>
<p>Hany 期间问道为什么不是 <code>(mul (1 2 (mul (3 4))))</code></p>
<p>John 说 因为 <code>1</code> 不是可调用的，如果这样写<strong>就会调用 <code>1</code></strong></p>
</blockquote>
<p>所以最后正确的答案是(John 的代码有一些问题，递归应该发生在定义 <code>rest</code> 的时候(否则如果第一个是 <code>+</code> 就会不发生替换))</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-175-1"><a id="__codelineno-175-1" name="__codelineno-175-1" href="#__codelineno-175-1"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">*-to-mul</span><span class="w"> </span><span class="nv">e</span><span class="p">)</span>
</span><span id="__span-175-2"><a id="__codelineno-175-2" name="__codelineno-175-2" href="#__codelineno-175-2"></a><span class="w">  </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">not</span><span class="w"> </span><span class="p">(</span><span class="nb">list?</span><span class="w"> </span><span class="nv">e</span><span class="p">))</span><span class="w"> </span><span class="nv">e</span>
</span><span id="__span-175-3"><a id="__codelineno-175-3" name="__codelineno-175-3" href="#__codelineno-175-3"></a><span class="w">      </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nf">op</span><span class="w"> </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="nv">e</span><span class="p">))</span><span class="w"> </span><span class="p">(</span><span class="nf">rest</span><span class="w"> </span><span class="p">(</span><span class="nb">map</span><span class="w"> </span><span class="nv">*-to-mul</span><span class="w"> </span><span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="nv">e</span><span class="p">))))</span>
</span><span id="__span-175-4"><a id="__codelineno-175-4" name="__codelineno-175-4" href="#__codelineno-175-4"></a><span class="w">        </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">equal?</span><span class="w"> </span><span class="nv">op</span><span class="w"> </span><span class="ss">&#39;*</span><span class="p">)</span>
</span><span id="__span-175-5"><a id="__codelineno-175-5" name="__codelineno-175-5" href="#__codelineno-175-5"></a><span class="w">            </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="ss">&#39;mul</span><span class="w"> </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="ss">&#39;list</span><span class="w"> </span><span class="nv">rest</span><span class="p">))</span>
</span><span id="__span-175-6"><a id="__codelineno-175-6" name="__codelineno-175-6" href="#__codelineno-175-6"></a><span class="w">            </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="nv">op</span><span class="w"> </span><span class="nv">rest</span><span class="p">)))))</span>
</span></code></pre></div>
<p>(这题是真的难想😱)</p>
<h3 id="4_10">4<a class="headerlink" href="#4_10" title="Permanent link">&para;</a></h3>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p>John:</p>
<p>You can think of a list as built from a bunch of <code>cons</code> . <code>cons</code> is like the most fundamental operation, and what it does is it just adds one element to the beginning of an existing list.</p>
<hr />
<p>John:</p>
<p>你可以将列表看作是由一堆 <code>cons</code> 构建而成的。 <code>cons</code> 就像是最基本的操作，它的作用是在现有列表的开头添加一个元素。</p>
</div>
<p>我觉得 John 这个对 <code>cons</code> 函数的解释很好，把 <code>cons</code> 理解成 <strong>一个在现有列表开头插入新元素的函数</strong> 就更方便</p>
<h3 id="5_7">5<a class="headerlink" href="#5_7" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_163.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_163" loading="lazy" src="../images/cs61a_163.png" /></a></p>
<p>John 又提到了scheme中的 <code>append</code> 函数，能将两个链表合并到一起</p>
<h2 id="lecture-29-calculater">Lecture 29 Calculater<a class="headerlink" href="#lecture-29-calculater" title="Permanent link">&para;</a></h2>
<h3 id="1_27">1<a class="headerlink" href="#1_27" title="Permanent link">&para;</a></h3>
<p>John 讲解 <em>解析 parse</em> 一个语言的语句的过程</p>
<p><a class="glightbox" href="../images/cs61a_164.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_164" loading="lazy" src="../images/cs61a_164.png" /></a></p>
<h3 id="2_23">2<a class="headerlink" href="#2_23" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_165.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_165" loading="lazy" src="../images/cs61a_165.png" /></a></p>
<p>scheme 中的减法和除法稍微特殊一些，如果只有一个参数，就直接取相反数或者倒数，如果有多个参数，就是拿第一个去减或除之后剩余的数</p>
<h3 id="3_18">3<a class="headerlink" href="#3_18" title="Permanent link">&para;</a></h3>
<p>用 python 实现 scheme 中(适用于数学运算表达式的) <code>eval</code> 函数</p>
<p><a class="glightbox" href="../images/cs61a_166.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_166" loading="lazy" src="../images/cs61a_166.png" /></a></p>
<h3 id="4_11">4<a class="headerlink" href="#4_11" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_167.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_167" loading="lazy" src="../images/cs61a_167.png" /></a></p>
<p><strong><em>交互式解释器 interactive interpreter</em> 的工作流程 *读取-求值-输出循环 Read-Eval-Print Loop (REPL)</strong>* </p>
<ul>
<li>从用户的文本输入中读取</li>
<li>将文本 <em>解析 parse</em> 为表达式</li>
<li>计算表达式</li>
<li>如果发生错误，报告错误</li>
<li>输出表达式计算结果的值，并重复上述过程</li>
</ul>
<h3 id="5_8">5<a class="headerlink" href="#5_8" title="Permanent link">&para;</a></h3>
<p>John 说到 <em>交互式解释器 interactive interpreter</em> 不能因为程序的错误就中断整个程序，所以需要进行 exception 的处理</p>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p>John:</p>
<p>...So, an interactive interpreter should print information about each error. So that when those errors occur, the programmer who generated them can figure out what to change in order to get rid of the error. And a well-designed interactive interpreter should never really halt; it should stop evaluating the current expression and print out the arrow, but then give the programmer a chance to revise what they've done. So, the user should have the opportunity to try again in the current environment, instead of having the whole program crash. And that's exactly what happens here.</p>
<p>So, as you can see, I'm able to continue entering expressions. The only way I can quit out of this game calculator is by pressing in my system control "d," which says this is the end of the file. Then it will say, "Calculation is complete," and finally, the program will end.</p>
<p>Now, how do we control for all this? Well, we put both the parsing and evaluation within a <code>try</code> statement,</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-176-1"><a id="__codelineno-176-1" name="__codelineno-176-1" href="#__codelineno-176-1"></a><span class="nd">@main</span>
</span><span id="__span-176-2"><a id="__codelineno-176-2" name="__codelineno-176-2" href="#__codelineno-176-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">read_eval_print_loop</span><span class="p">():</span>
</span><span id="__span-176-3"><a id="__codelineno-176-3" name="__codelineno-176-3" href="#__codelineno-176-3"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Run a read-eval-print loop for Calculator.&quot;&quot;&quot;</span>
</span><span id="__span-176-4"><a id="__codelineno-176-4" name="__codelineno-176-4" href="#__codelineno-176-4"></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-176-5"><a id="__codelineno-176-5" name="__codelineno-176-5" href="#__codelineno-176-5"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-176-6"><a id="__codelineno-176-6" name="__codelineno-176-6" href="#__codelineno-176-6"></a>            <span class="n">src</span> <span class="o">=</span> <span class="n">buffer_input</span><span class="p">()</span>
</span><span id="__span-176-7"><a id="__codelineno-176-7" name="__codelineno-176-7" href="#__codelineno-176-7"></a>            <span class="k">while</span> <span class="n">src</span><span class="o">.</span><span class="n">more_on_line</span><span class="p">:</span>
</span><span id="__span-176-8"><a id="__codelineno-176-8" name="__codelineno-176-8" href="#__codelineno-176-8"></a>                <span class="n">expression</span> <span class="o">=</span> <span class="n">scheme_read</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
</span><span id="__span-176-9"><a id="__codelineno-176-9" name="__codelineno-176-9" href="#__codelineno-176-9"></a>                <span class="nb">print</span><span class="p">(</span><span class="n">calc_eval</span><span class="p">(</span><span class="n">expression</span><span class="p">))</span>
</span><span id="__span-176-10"><a id="__codelineno-176-10" name="__codelineno-176-10" href="#__codelineno-176-10"></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">SyntaxError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="ne">ZeroDivisionError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span><span id="__span-176-11"><a id="__codelineno-176-11" name="__codelineno-176-11" href="#__codelineno-176-11"></a>            <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</span><span id="__span-176-12"><a id="__codelineno-176-12" name="__codelineno-176-12" href="#__codelineno-176-12"></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">KeyboardInterrupt</span><span class="p">,</span> <span class="ne">EOFError</span><span class="p">):</span>  <span class="c1"># &lt;Control&gt;-D, etc.</span>
</span><span id="__span-176-13"><a id="__codelineno-176-13" name="__codelineno-176-13" href="#__codelineno-176-13"></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Calculation completed.&#39;</span><span class="p">)</span>
</span><span id="__span-176-14"><a id="__codelineno-176-14" name="__codelineno-176-14" href="#__codelineno-176-14"></a>            <span class="k">return</span>
</span></code></pre></div>
<p>that knows to look for syntax, type, value, and zero division errors – all the things that can occur, and just prints those errors out. And then, since this is all embedded within the suite of a <code>while</code> statement, we'll go back and try again. So, the only way to stop is to reach the end of a file or a keyboard interrupt, at which point it will print "Calculation is complete."</p>
<hr />
<p>John:</p>
<p>因此，交互式解释器应该打印有关每个错误的信息，以便当这些错误发生时，生成它们的程序员能够弄清楚要更改什么以消除错误。一个设计良好的交互式解释器实际上不应该停止；它应该停止评估当前表达式并打印出箭头，然后给程序员一个机会来修改他们所做的事情。因此，用户应该有机会在当前环境中再次尝试，而不是使整个程序崩溃。这正是这里发生的情况。</p>
<p>所以，正如你所见，我能够继续输入表达式。退出这个游戏计算器的唯一方法是按下我的系统控制 “d”，这表示这是文件的结尾。然后它将显示 “Calculation is complete”，最后程序将结束。</p>
<p>现在，我们如何控制所有这些呢？嗯，我们将解析和评估都放在一个 <code>try</code> 语句中， </p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-177-1"><a id="__codelineno-177-1" name="__codelineno-177-1" href="#__codelineno-177-1"></a><span class="nd">@main</span>
</span><span id="__span-177-2"><a id="__codelineno-177-2" name="__codelineno-177-2" href="#__codelineno-177-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">read_eval_print_loop</span><span class="p">():</span>
</span><span id="__span-177-3"><a id="__codelineno-177-3" name="__codelineno-177-3" href="#__codelineno-177-3"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Run a read-eval-print loop for Calculator.&quot;&quot;&quot;</span>
</span><span id="__span-177-4"><a id="__codelineno-177-4" name="__codelineno-177-4" href="#__codelineno-177-4"></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-177-5"><a id="__codelineno-177-5" name="__codelineno-177-5" href="#__codelineno-177-5"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-177-6"><a id="__codelineno-177-6" name="__codelineno-177-6" href="#__codelineno-177-6"></a>            <span class="n">src</span> <span class="o">=</span> <span class="n">buffer_input</span><span class="p">()</span>
</span><span id="__span-177-7"><a id="__codelineno-177-7" name="__codelineno-177-7" href="#__codelineno-177-7"></a>            <span class="k">while</span> <span class="n">src</span><span class="o">.</span><span class="n">more_on_line</span><span class="p">:</span>
</span><span id="__span-177-8"><a id="__codelineno-177-8" name="__codelineno-177-8" href="#__codelineno-177-8"></a>                <span class="n">expression</span> <span class="o">=</span> <span class="n">scheme_read</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
</span><span id="__span-177-9"><a id="__codelineno-177-9" name="__codelineno-177-9" href="#__codelineno-177-9"></a>                <span class="nb">print</span><span class="p">(</span><span class="n">calc_eval</span><span class="p">(</span><span class="n">expression</span><span class="p">))</span>
</span><span id="__span-177-10"><a id="__codelineno-177-10" name="__codelineno-177-10" href="#__codelineno-177-10"></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">SyntaxError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="ne">ZeroDivisionError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span><span id="__span-177-11"><a id="__codelineno-177-11" name="__codelineno-177-11" href="#__codelineno-177-11"></a>            <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</span><span id="__span-177-12"><a id="__codelineno-177-12" name="__codelineno-177-12" href="#__codelineno-177-12"></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">KeyboardInterrupt</span><span class="p">,</span> <span class="ne">EOFError</span><span class="p">):</span>  <span class="c1"># &lt;Control&gt;-D, etc.</span>
</span><span id="__span-177-13"><a id="__codelineno-177-13" name="__codelineno-177-13" href="#__codelineno-177-13"></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Calculation completed.&#39;</span><span class="p">)</span>
</span><span id="__span-177-14"><a id="__codelineno-177-14" name="__codelineno-177-14" href="#__codelineno-177-14"></a>            <span class="k">return</span>
</span></code></pre></div>
<p>该语句知道如何查找语法、类型、值和零除错误，即所有可能发生的事情，并只是打印出这些错误。然后，由于所有这些都嵌套在一个 <code>while</code> 语句的套件中，我们将回到并尝试再次执行。因此，唯一停止的方式是到达文件的末尾或键盘中断，此时它将打印 “Calculation is complete”。</p>
</div>
<h2 id="lecture-29-qa">Lecture 29 Q&amp;A<a class="headerlink" href="#lecture-29-qa" title="Permanent link">&para;</a></h2>
<h3 id="1_28">1<a class="headerlink" href="#1_28" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../images/cs61a_168.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_168" loading="lazy" src="../images/cs61a_168.png" /></a></p>
<p>有人提问道(python)代码中的 <code>@main</code> 有什么作用，</p>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p>John:</p>
<p>...Yeah, so this main decorator is something that's specific to 61a. It just says if you run the file, this is the function that should be called. So if I run the whole <code>scalc.py</code> file, it's not going to call as scheme list instead, it's going to call <code>read_eval_print_loop</code> .</p>
<hr />
<p>John:</p>
<p>...是的，所以这个主装饰器是61a特有的东西。它只是说，如果你运行文件，这就是应该调用的函数。因此，如果我运行整个 <code>scalc.py</code> 文件，它不会调用scheme-list，而是调用 <code>read_eval_print_loop</code> 。</p>
</div>
<p>这个和</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-178-1"><a id="__codelineno-178-1" name="__codelineno-178-1" href="#__codelineno-178-1"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">=</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span><span id="__span-178-2"><a id="__codelineno-178-2" name="__codelineno-178-2" href="#__codelineno-178-2"></a>    <span class="o">...</span>
</span></code></pre></div>
<p>有点像，不过封装成函数再加上 <code>@main</code> 还有一点好处就是还可以再次进行调用</p>
<h2 id="hw-07">HW 07<a class="headerlink" href="#hw-07" title="Permanent link">&para;</a></h2>
<h3 id="1_29">1<a class="headerlink" href="#1_29" title="Permanent link">&para;</a></h3>
<p>在 Q1 的题目说明中提到了 <code>filter</code> 函数，跟这题要实现的 <code>filter-lst</code> 用法一样(用于链表上)，也是需要一个 <em>谓词 predicate</em> (传入一个参数然后返回真假的函数) 和一个链表，然后就会筛选出为真的元素</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-179-1"><a id="__codelineno-179-1" name="__codelineno-179-1" href="#__codelineno-179-1"></a><span class="nv">scm&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">x</span><span class="w"> </span><span class="nv">y</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">&gt;</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
</span><span id="__span-179-2"><a id="__codelineno-179-2" name="__codelineno-179-2" href="#__codelineno-179-2"></a><span class="nv">x</span>
</span><span id="__span-179-3"><a id="__codelineno-179-3" name="__codelineno-179-3" href="#__codelineno-179-3"></a><span class="nv">scm&gt;</span><span class="w"> </span><span class="p">(</span><span class="nb">filter</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="p">))</span>
</span><span id="__span-179-4"><a id="__codelineno-179-4" name="__codelineno-179-4" href="#__codelineno-179-4"></a><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
</span></code></pre></div>
<blockquote>
<p>这题要求实现的函数叫做 <code>filter-lst</code> ，所以有可能 <code>filter</code> 函数还可以作用于其他的数据类型</p>
</blockquote>
<hr />
<details class="note">
<summary>code</summary>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-180-1"><a id="__codelineno-180-1" name="__codelineno-180-1" href="#__codelineno-180-1"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">filter-lst</span><span class="w"> </span><span class="nv">fn</span><span class="w"> </span><span class="nv">lst</span><span class="p">)</span>
</span><span id="__span-180-2"><a id="__codelineno-180-2" name="__codelineno-180-2" href="#__codelineno-180-2"></a><span class="w">  </span><span class="ss">&#39;YOUR-CODE-HERE</span>
</span><span id="__span-180-3"><a id="__codelineno-180-3" name="__codelineno-180-3" href="#__codelineno-180-3"></a><span class="w">  </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">eq?</span><span class="w"> </span><span class="nv">lst</span><span class="w"> </span><span class="nv">nil</span><span class="p">)</span>
</span><span id="__span-180-4"><a id="__codelineno-180-4" name="__codelineno-180-4" href="#__codelineno-180-4"></a><span class="w">      </span><span class="nv">nil</span>
</span><span id="__span-180-5"><a id="__codelineno-180-5" name="__codelineno-180-5" href="#__codelineno-180-5"></a><span class="w">      </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nf">fn</span><span class="w"> </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="nv">lst</span><span class="p">))</span>
</span><span id="__span-180-6"><a id="__codelineno-180-6" name="__codelineno-180-6" href="#__codelineno-180-6"></a><span class="w">          </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="nv">lst</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">filter-lst</span><span class="w"> </span><span class="nv">fn</span><span class="w"> </span><span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="nv">lst</span><span class="p">)))</span>
</span><span id="__span-180-7"><a id="__codelineno-180-7" name="__codelineno-180-7" href="#__codelineno-180-7"></a><span class="w">          </span><span class="p">(</span><span class="nf">filter-lst</span><span class="w"> </span><span class="nv">fn</span><span class="w"> </span><span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="nv">lst</span><span class="p">))))</span>
</span><span id="__span-180-8"><a id="__codelineno-180-8" name="__codelineno-180-8" href="#__codelineno-180-8"></a><span class="p">)</span>
</span></code></pre></div>
</details>
<h3 id="2_24">2<a class="headerlink" href="#2_24" title="Permanent link">&para;</a></h3>
<p>Q4 这题有点难(主要是一直想用python中的 <code>in</code> 而scheme中用不了😅)，</p>
<p>最后写出来主要是题目中提示可以使用第一题中实现的 <code>filter-lst</code> 函数，然后我又猜测还是需要使用递归来实现，那么<strong>传入 <code>filter-lst</code> 函数的链表应该就是 <code>(cdr lst)</code></strong> ，</p>
<p>进而， <code>filter-lst</code> 筛出来的链表应该还要递归地放入 <code>no-repeats</code> 中，最后再加上 base case 就成功实现了</p>
<details class="note">
<summary>code</summary>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-181-1"><a id="__codelineno-181-1" name="__codelineno-181-1" href="#__codelineno-181-1"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">no-repeats</span><span class="w"> </span><span class="nv">lst</span><span class="p">)</span>
</span><span id="__span-181-2"><a id="__codelineno-181-2" name="__codelineno-181-2" href="#__codelineno-181-2"></a><span class="w">  </span><span class="ss">&#39;YOUR-CODE-HERE</span>
</span><span id="__span-181-3"><a id="__codelineno-181-3" name="__codelineno-181-3" href="#__codelineno-181-3"></a><span class="w">  </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">equal?</span><span class="w"> </span><span class="nv">lst</span><span class="w"> </span><span class="nv">nil</span><span class="p">)</span>
</span><span id="__span-181-4"><a id="__codelineno-181-4" name="__codelineno-181-4" href="#__codelineno-181-4"></a><span class="w">      </span><span class="nv">nil</span>
</span><span id="__span-181-5"><a id="__codelineno-181-5" name="__codelineno-181-5" href="#__codelineno-181-5"></a><span class="w">      </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="nv">lst</span><span class="p">)</span>
</span><span id="__span-181-6"><a id="__codelineno-181-6" name="__codelineno-181-6" href="#__codelineno-181-6"></a><span class="w">            </span><span class="p">(</span><span class="nf">no-repeats</span><span class="w"> </span><span class="p">(</span><span class="nf">filter-lst</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">not</span><span class="w"> </span><span class="p">(</span><span class="nb">=</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="nv">lst</span><span class="p">))))</span>
</span><span id="__span-181-7"><a id="__codelineno-181-7" name="__codelineno-181-7" href="#__codelineno-181-7"></a><span class="w">                                    </span><span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="nv">lst</span><span class="p">)))))</span>
</span><span id="__span-181-8"><a id="__codelineno-181-8" name="__codelineno-181-8" href="#__codelineno-181-8"></a><span class="p">)</span>
</span></code></pre></div>
</details>
<h2 id="lab-11">Lab 11<a class="headerlink" href="#lab-11" title="Permanent link">&para;</a></h2>
<h3 id="1_30">1<a class="headerlink" href="#1_30" title="Permanent link">&para;</a></h3>
<p>Q3这题需要把题目意思理解清楚， <code>CallExpr</code> 实例中的 <code>operator</code> 和 <code>operands</code> 相当于变量名，需要调用它们的 <code>eval</code> 方法并传入环境来获取对应的值或者实例，</p>
<p>最后，操作符 <code>operator</code> 需要调用 <code>apply</code> 方法来进行使用</p>
<blockquote>
<p><strong>Hint:</strong> Since the operator and operands are all instances of <code>Expr</code>, you can evaluate them by calling their <code>eval</code> methods. Also, you can apply a function (an instance of <code>PrimitiveFunction</code> or <code>LambdaFunction</code>) by calling its <code>apply</code> method, which takes in a list of arguments (<code>Value</code> instances).</p>
</blockquote>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-182-1"><a id="__codelineno-182-1" name="__codelineno-182-1" href="#__codelineno-182-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">CallExpr</span><span class="p">(</span><span class="n">Expr</span><span class="p">):</span>
</span><span id="__span-182-2"><a id="__codelineno-182-2" name="__codelineno-182-2" href="#__codelineno-182-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
</span><span id="__span-182-3"><a id="__codelineno-182-3" name="__codelineno-182-3" href="#__codelineno-182-3"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">operator</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">env</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">([</span><span class="n">operand</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">env</span><span class="p">)</span> <span class="k">for</span> <span class="n">operand</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">operands</span><span class="p">])</span>
</span></code></pre></div>
</details>
<h3 id="2_25">2<a class="headerlink" href="#2_25" title="Permanent link">&para;</a></h3>
<p>Q4中，需要更新以字典形式存储的环境，结合Q3的函数说明，可以知道可以使用字典的 <code>update</code> 方法，</p>
<blockquote>
<p>在终端中试了一下</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-183-1"><a id="__codelineno-183-1" name="__codelineno-183-1" href="#__codelineno-183-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">dict</span>
</span><span id="__span-183-2"><a id="__codelineno-183-2" name="__codelineno-183-2" href="#__codelineno-183-2"></a><span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="err">&#39;</span><span class="nc">dict</span><span class="s1">&#39;&gt;</span>
</span><span id="__span-183-3"><a id="__codelineno-183-3" name="__codelineno-183-3" href="#__codelineno-183-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">dict</span><span class="o">.</span><span class="n">update</span>
</span><span id="__span-183-4"><a id="__codelineno-183-4" name="__codelineno-183-4" href="#__codelineno-183-4"></a><span class="o">&lt;</span><span class="n">method</span> <span class="s1">&#39;update&#39;</span> <span class="n">of</span> <span class="s1">&#39;dict&#39;</span> <span class="n">objects</span><span class="o">&gt;</span>
</span><span id="__span-183-5"><a id="__codelineno-183-5" name="__codelineno-183-5" href="#__codelineno-183-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">dict</span><span class="o">.</span><span class="n">extend</span>
</span><span id="__span-183-6"><a id="__codelineno-183-6" name="__codelineno-183-6" href="#__codelineno-183-6"></a><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
</span><span id="__span-183-7"><a id="__codelineno-183-7" name="__codelineno-183-7" href="#__codelineno-183-7"></a><span class="n">File</span> <span class="s2">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
</span><span id="__span-183-8"><a id="__codelineno-183-8" name="__codelineno-183-8" href="#__codelineno-183-8"></a><span class="ne">AttributeError</span><span class="p">:</span> <span class="nb">type</span> <span class="nb">object</span> <span class="s1">&#39;dict&#39;</span> <span class="n">has</span> <span class="n">no</span> <span class="n">attribute</span> <span class="s1">&#39;extend&#39;</span>
</span><span id="__span-183-9"><a id="__codelineno-183-9" name="__codelineno-183-9" href="#__codelineno-183-9"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">dict</span><span class="o">.</span><span class="n">append</span>
</span><span id="__span-183-10"><a id="__codelineno-183-10" name="__codelineno-183-10" href="#__codelineno-183-10"></a><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
</span><span id="__span-183-11"><a id="__codelineno-183-11" name="__codelineno-183-11" href="#__codelineno-183-11"></a><span class="n">File</span> <span class="s2">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
</span><span id="__span-183-12"><a id="__codelineno-183-12" name="__codelineno-183-12" href="#__codelineno-183-12"></a><span class="ne">AttributeError</span><span class="p">:</span> <span class="nb">type</span> <span class="nb">object</span> <span class="s1">&#39;dict&#39;</span> <span class="n">has</span> <span class="n">no</span> <span class="n">attribute</span> <span class="s1">&#39;append&#39;</span>
</span></code></pre></div>
</blockquote>
<hr />
<p><code>dict.update()</code> 没有返回值(和列表的 <code>append</code> 和 <code>extend</code> 一样)，所以一开始我用</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-184-1"><a id="__codelineno-184-1" name="__codelineno-184-1" href="#__codelineno-184-1"></a><span class="n">new_env</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="n">arguments</span><span class="p">)))</span>
</span></code></pre></div>
<p>然后报了 <code>NoneType</code> 的错误。</p>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-185-1"><a id="__codelineno-185-1" name="__codelineno-185-1" href="#__codelineno-185-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">LambdaFunction</span><span class="p">(</span><span class="n">Value</span><span class="p">):</span>
</span><span id="__span-185-2"><a id="__codelineno-185-2" name="__codelineno-185-2" href="#__codelineno-185-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arguments</span><span class="p">):</span>
</span><span id="__span-185-3"><a id="__codelineno-185-3" name="__codelineno-185-3" href="#__codelineno-185-3"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">arguments</span><span class="p">):</span>
</span><span id="__span-185-4"><a id="__codelineno-185-4" name="__codelineno-185-4" href="#__codelineno-185-4"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Oof! Cannot apply number </span><span class="si">{}</span><span class="s2"> to arguments </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-185-5"><a id="__codelineno-185-5" name="__codelineno-185-5" href="#__codelineno-185-5"></a>                <span class="n">comma_separated</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">),</span> <span class="n">comma_separated</span><span class="p">(</span><span class="n">arguments</span><span class="p">)))</span>
</span><span id="__span-185-6"><a id="__codelineno-185-6" name="__codelineno-185-6" href="#__codelineno-185-6"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-185-7"><a id="__codelineno-185-7" name="__codelineno-185-7" href="#__codelineno-185-7"></a>        <span class="n">new_env</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="__span-185-8"><a id="__codelineno-185-8" name="__codelineno-185-8" href="#__codelineno-185-8"></a>        <span class="n">new_env</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="n">arguments</span><span class="p">)))</span>
</span><span id="__span-185-9"><a id="__codelineno-185-9" name="__codelineno-185-9" href="#__codelineno-185-9"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">new_env</span><span class="p">)</span>
</span></code></pre></div>
</details>
<h3 id="3_19">3<a class="headerlink" href="#3_19" title="Permanent link">&para;</a></h3>
<p>Q5没什么明确的要求，我直接在</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-186-1"><a id="__codelineno-186-1" name="__codelineno-186-1" href="#__codelineno-186-1"></a><span class="k">except</span> <span class="p">(</span><span class="ne">SyntaxError</span><span class="p">,</span> <span class="ne">NameError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="ne">OverflowError</span><span class="p">,</span> <span class="ne">ZeroDivisionError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span></code></pre></div>
<p>这一行添加了 <code>OverflowError</code> 和 <code>ZeroDivisionError</code></p>
<h2 id="project-scheme">Project Scheme<a class="headerlink" href="#project-scheme" title="Permanent link">&para;</a></h2>
<h3 id="1_31">1<a class="headerlink" href="#1_31" title="Permanent link">&para;</a></h3>
<p>Problem 1的前面某题我卡了一小会😅</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-187-1"><a id="__codelineno-187-1" name="__codelineno-187-1" href="#__codelineno-187-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">scheme_reader</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="__span-187-2"><a id="__codelineno-187-2" name="__codelineno-187-2" href="#__codelineno-187-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">tokens</span> <span class="o">=</span> <span class="n">tokenize_lines</span><span class="p">([</span><span class="s2">&quot;(+ 1 &quot;</span><span class="p">,</span> <span class="s2">&quot;(23 4)) (&quot;</span><span class="p">])</span>
</span><span id="__span-187-3"><a id="__codelineno-187-3" name="__codelineno-187-3" href="#__codelineno-187-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">src</span> <span class="o">=</span> <span class="n">Buffer</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
</span><span id="__span-187-4"><a id="__codelineno-187-4" name="__codelineno-187-4" href="#__codelineno-187-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">src</span><span class="o">.</span><span class="n">current</span><span class="p">()</span>
</span><span id="__span-187-5"><a id="__codelineno-187-5" name="__codelineno-187-5" href="#__codelineno-187-5"></a><span class="err">?</span> <span class="o">...</span>
</span><span id="__span-187-6"><a id="__codelineno-187-6" name="__codelineno-187-6" href="#__codelineno-187-6"></a><span class="o">--</span> <span class="n">OK</span><span class="err">!</span> <span class="o">--</span>
</span><span id="__span-187-7"><a id="__codelineno-187-7" name="__codelineno-187-7" href="#__codelineno-187-7"></a>
</span><span id="__span-187-8"><a id="__codelineno-187-8" name="__codelineno-187-8" href="#__codelineno-187-8"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">src</span><span class="o">.</span><span class="n">pop_first</span><span class="p">()</span>
</span><span id="__span-187-9"><a id="__codelineno-187-9" name="__codelineno-187-9" href="#__codelineno-187-9"></a><span class="err">?</span> <span class="o">...</span>
</span><span id="__span-187-10"><a id="__codelineno-187-10" name="__codelineno-187-10" href="#__codelineno-187-10"></a><span class="o">--</span> <span class="n">OK</span><span class="err">!</span> <span class="o">--</span>
</span><span id="__span-187-11"><a id="__codelineno-187-11" name="__codelineno-187-11" href="#__codelineno-187-11"></a>
</span><span id="__span-187-12"><a id="__codelineno-187-12" name="__codelineno-187-12" href="#__codelineno-187-12"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">src</span><span class="o">.</span><span class="n">current</span><span class="p">()</span>
</span><span id="__span-187-13"><a id="__codelineno-187-13" name="__codelineno-187-13" href="#__codelineno-187-13"></a><span class="err">?</span> <span class="o">...</span>
</span><span id="__span-187-14"><a id="__codelineno-187-14" name="__codelineno-187-14" href="#__codelineno-187-14"></a><span class="o">--</span> <span class="n">OK</span><span class="err">!</span> <span class="o">--</span>
</span><span id="__span-187-15"><a id="__codelineno-187-15" name="__codelineno-187-15" href="#__codelineno-187-15"></a>
</span><span id="__span-187-16"><a id="__codelineno-187-16" name="__codelineno-187-16" href="#__codelineno-187-16"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">src</span><span class="o">.</span><span class="n">pop_first</span><span class="p">()</span>
</span><span id="__span-187-17"><a id="__codelineno-187-17" name="__codelineno-187-17" href="#__codelineno-187-17"></a><span class="err">?</span> <span class="o">...</span>
</span><span id="__span-187-18"><a id="__codelineno-187-18" name="__codelineno-187-18" href="#__codelineno-187-18"></a><span class="o">--</span> <span class="n">OK</span><span class="err">!</span> <span class="o">--</span>
</span><span id="__span-187-19"><a id="__codelineno-187-19" name="__codelineno-187-19" href="#__codelineno-187-19"></a>
</span><span id="__span-187-20"><a id="__codelineno-187-20" name="__codelineno-187-20" href="#__codelineno-187-20"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">src</span><span class="o">.</span><span class="n">pop_first</span><span class="p">()</span>
</span><span id="__span-187-21"><a id="__codelineno-187-21" name="__codelineno-187-21" href="#__codelineno-187-21"></a><span class="err">?</span> <span class="o">...</span>
</span><span id="__span-187-22"><a id="__codelineno-187-22" name="__codelineno-187-22" href="#__codelineno-187-22"></a><span class="o">--</span> <span class="n">OK</span><span class="err">!</span> <span class="o">--</span>
</span><span id="__span-187-23"><a id="__codelineno-187-23" name="__codelineno-187-23" href="#__codelineno-187-23"></a>
</span><span id="__span-187-24"><a id="__codelineno-187-24" name="__codelineno-187-24" href="#__codelineno-187-24"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">scheme_read</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>  <span class="c1"># Removes the next complete expression in src and returns it as a Pair</span>
</span><span id="__span-187-25"><a id="__codelineno-187-25" name="__codelineno-187-25" href="#__codelineno-187-25"></a><span class="err">?</span> 
</span></code></pre></div>
<p>最后是看了 <code>scheme_reader.py</code> 中 <code>scheme_read</code> 的函数说明中</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-188-1"><a id="__codelineno-188-1" name="__codelineno-188-1" href="#__codelineno-188-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">scheme_read</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>
</span><span id="__span-188-2"><a id="__codelineno-188-2" name="__codelineno-188-2" href="#__codelineno-188-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Read the next expression from SRC, a Buffer of tokens.</span>
</span><span id="__span-188-3"><a id="__codelineno-188-3" name="__codelineno-188-3" href="#__codelineno-188-3"></a>
</span><span id="__span-188-4"><a id="__codelineno-188-4" name="__codelineno-188-4" href="#__codelineno-188-4"></a><span class="sd">    ...</span>
</span><span id="__span-188-5"><a id="__codelineno-188-5" name="__codelineno-188-5" href="#__codelineno-188-5"></a><span class="sd">    &gt;&gt;&gt; scheme_read(Buffer(tokenize_lines([&#39;(+ 1 2)&#39;])))</span>
</span><span id="__span-188-6"><a id="__codelineno-188-6" name="__codelineno-188-6" href="#__codelineno-188-6"></a><span class="sd">    Pair(&#39;+&#39;, Pair(1, Pair(2, nil)))</span>
</span><span id="__span-188-7"><a id="__codelineno-188-7" name="__codelineno-188-7" href="#__codelineno-188-7"></a><span class="sd">    &quot;&quot;&quot;</span>
</span></code></pre></div>
<p>才明白 <code>returns it as a Pair</code> 具体返回是什么样子。</p>
<p>然后看到了题目说明中的</p>
<blockquote>
<p><code>scheme_read</code>:</p>
<ul>
<li>If the current token is <code>(</code>, the expression is a pair or list. Call <code>read_tail</code> on the rest of <code>src</code> and return its result.</li>
</ul>
<p><code>read_tail</code>:</p>
<ul>
<li>If the token is <code>)</code>, then we've reached the end of the list or pair. <strong>Remove this token from the buffer</strong> and return the <code>nil</code> object.</li>
</ul>
</blockquote>
<p>所以明白只会读取到第一个右括号 <code>)</code> ，因此最后正确答案是</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-189-1"><a id="__codelineno-189-1" name="__codelineno-189-1" href="#__codelineno-189-1"></a><span class="n">Pair</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="n">Pair</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">nil</span><span class="p">))</span>
</span></code></pre></div>
<blockquote>
<p>但是有个地方感觉有点小离谱😅，少了个空格居然显示错误</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-190-1"><a id="__codelineno-190-1" name="__codelineno-190-1" href="#__codelineno-190-1"></a><span class="err">?</span> <span class="n">Pair</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="n">Pair</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">nil</span><span class="p">))</span>
</span><span id="__span-190-2"><a id="__codelineno-190-2" name="__codelineno-190-2" href="#__codelineno-190-2"></a><span class="o">--</span> <span class="n">Not</span> <span class="n">quite</span><span class="o">.</span> <span class="n">Try</span> <span class="n">again</span><span class="err">!</span> <span class="o">--</span>
</span><span id="__span-190-3"><a id="__codelineno-190-3" name="__codelineno-190-3" href="#__codelineno-190-3"></a>
</span><span id="__span-190-4"><a id="__codelineno-190-4" name="__codelineno-190-4" href="#__codelineno-190-4"></a><span class="err">?</span> <span class="n">Pair</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="n">Pair</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">nil</span><span class="p">))</span>
</span><span id="__span-190-5"><a id="__codelineno-190-5" name="__codelineno-190-5" href="#__codelineno-190-5"></a><span class="o">--</span> <span class="n">OK</span><span class="err">!</span> <span class="o">--</span>
</span></code></pre></div>
</blockquote>
<hr />
<p>在实现 <code>read_tail</code> 时，意识到题目说明中的这句话</p>
<blockquote>
<p>Both functions mutate the buffer, removing the tokens that have already been processed.</p>
</blockquote>
<p>就是说，(比如被 <code>scheme_read</code> 调用的) <code>read_tail</code> 中需要<em>突变</em> <code>src</code> (移除已经使用过的<em>令牌</em>)，这样在 <code>read_tail</code> 中使用过的 <em>令牌 tokens</em> ，就不会被 <code>scheme_read</code> 或者上一层 <code>read_tail</code> 再次使用</p>
<hr />
<p>没想到Problem 1就写了半小时(算上解锁花了一小时😇)。</p>
<p>这题主要是需要完全理解题目的意思，如果有bug就回去<strong>重新理解题目(仔细阅读题目的说明)</strong>就好了。</p>
<p>一开始我写的是</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-191-1"><a id="__codelineno-191-1" name="__codelineno-191-1" href="#__codelineno-191-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">scheme_read</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>
</span><span id="__span-191-2"><a id="__codelineno-191-2" name="__codelineno-191-2" href="#__codelineno-191-2"></a>    <span class="k">if</span> <span class="n">src</span><span class="o">.</span><span class="n">current</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-191-3"><a id="__codelineno-191-3" name="__codelineno-191-3" href="#__codelineno-191-3"></a>        <span class="k">raise</span> <span class="ne">EOFError</span>
</span><span id="__span-191-4"><a id="__codelineno-191-4" name="__codelineno-191-4" href="#__codelineno-191-4"></a>    <span class="n">val</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">pop_first</span><span class="p">()</span> <span class="c1"># Get and remove the first token</span>
</span><span id="__span-191-5"><a id="__codelineno-191-5" name="__codelineno-191-5" href="#__codelineno-191-5"></a>    <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="s1">&#39;nil&#39;</span><span class="p">:</span>
</span><span id="__span-191-6"><a id="__codelineno-191-6" name="__codelineno-191-6" href="#__codelineno-191-6"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-191-7"><a id="__codelineno-191-7" name="__codelineno-191-7" href="#__codelineno-191-7"></a>        <span class="k">return</span> <span class="n">nil</span>
</span><span id="__span-191-8"><a id="__codelineno-191-8" name="__codelineno-191-8" href="#__codelineno-191-8"></a>    <span class="k">elif</span> <span class="n">val</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span><span class="p">:</span>
</span><span id="__span-191-9"><a id="__codelineno-191-9" name="__codelineno-191-9" href="#__codelineno-191-9"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-191-10"><a id="__codelineno-191-10" name="__codelineno-191-10" href="#__codelineno-191-10"></a>        <span class="k">return</span> <span class="n">read_tail</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
</span><span id="__span-191-11"><a id="__codelineno-191-11" name="__codelineno-191-11" href="#__codelineno-191-11"></a>    <span class="o">...</span>
</span><span id="__span-191-12"><a id="__codelineno-191-12" name="__codelineno-191-12" href="#__codelineno-191-12"></a><span class="k">def</span><span class="w"> </span><span class="nf">read_tail</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>
</span><span id="__span-191-13"><a id="__codelineno-191-13" name="__codelineno-191-13" href="#__codelineno-191-13"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-191-14"><a id="__codelineno-191-14" name="__codelineno-191-14" href="#__codelineno-191-14"></a>        <span class="k">if</span> <span class="n">src</span><span class="o">.</span><span class="n">current</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-191-15"><a id="__codelineno-191-15" name="__codelineno-191-15" href="#__codelineno-191-15"></a>            <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="s1">&#39;unexpected end of file&#39;</span><span class="p">)</span>
</span><span id="__span-191-16"><a id="__codelineno-191-16" name="__codelineno-191-16" href="#__codelineno-191-16"></a>        <span class="k">elif</span> <span class="n">src</span><span class="o">.</span><span class="n">current</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span><span class="p">:</span>
</span><span id="__span-191-17"><a id="__codelineno-191-17" name="__codelineno-191-17" href="#__codelineno-191-17"></a>            <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-191-18"><a id="__codelineno-191-18" name="__codelineno-191-18" href="#__codelineno-191-18"></a>            <span class="n">src</span><span class="o">.</span><span class="n">pop_first</span><span class="p">()</span>
</span><span id="__span-191-19"><a id="__codelineno-191-19" name="__codelineno-191-19" href="#__codelineno-191-19"></a>            <span class="k">return</span> <span class="n">nil</span>
</span><span id="__span-191-20"><a id="__codelineno-191-20" name="__codelineno-191-20" href="#__codelineno-191-20"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-191-21"><a id="__codelineno-191-21" name="__codelineno-191-21" href="#__codelineno-191-21"></a>            <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-191-22"><a id="__codelineno-191-22" name="__codelineno-191-22" href="#__codelineno-191-22"></a>            <span class="k">return</span> <span class="n">Pair</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">pop_first</span><span class="p">(),</span> <span class="n">read_tail</span><span class="p">(</span><span class="n">src</span><span class="p">))</span>
</span><span id="__span-191-23"><a id="__codelineno-191-23" name="__codelineno-191-23" href="#__codelineno-191-23"></a>    <span class="k">except</span> <span class="ne">EOFError</span><span class="p">:</span>
</span><span id="__span-191-24"><a id="__codelineno-191-24" name="__codelineno-191-24" href="#__codelineno-191-24"></a>        <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="s1">&#39;unexpected end of file&#39;</span><span class="p">)</span>
</span></code></pre></div>
<p>然后报了这样的错误</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-192-1"><a id="__codelineno-192-1" name="__codelineno-192-1" href="#__codelineno-192-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">read_tail</span><span class="p">(</span><span class="n">Buffer</span><span class="p">(</span><span class="n">tokenize_lines</span><span class="p">([</span><span class="s1">&#39;(2)&#39;</span><span class="p">])))</span>
</span><span id="__span-192-2"><a id="__codelineno-192-2" name="__codelineno-192-2" href="#__codelineno-192-2"></a><span class="n">Pair</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="n">Pair</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">nil</span><span class="p">))</span>
</span><span id="__span-192-3"><a id="__codelineno-192-3" name="__codelineno-192-3" href="#__codelineno-192-3"></a>
</span><span id="__span-192-4"><a id="__codelineno-192-4" name="__codelineno-192-4" href="#__codelineno-192-4"></a><span class="c1"># Error: expected</span>
</span><span id="__span-192-5"><a id="__codelineno-192-5" name="__codelineno-192-5" href="#__codelineno-192-5"></a><span class="c1">#     SyntaxError</span>
</span><span id="__span-192-6"><a id="__codelineno-192-6" name="__codelineno-192-6" href="#__codelineno-192-6"></a><span class="c1"># but got</span>
</span><span id="__span-192-7"><a id="__codelineno-192-7" name="__codelineno-192-7" href="#__codelineno-192-7"></a><span class="c1">#     Pair(&#39;(&#39;, Pair(2, nil))</span>
</span></code></pre></div>
<p>然后看到了题目中的</p>
<blockquote>
<p><code>read_tail</code>:</p>
<ul>
<li>
<p>If none of the above cases apply, the next token is the operator in a combination, e.g. src contains <code>+ 2 3)</code>. To parse this:</p>
<ol>
<li>
<p><code>scheme_read</code> the next complete expression in the buffer.</p>
<p>...</p>
</li>
</ol>
</li>
</ul>
</blockquote>
<p>于是明白如果在 <code>read_tail</code> 中读到左括号 <code>(</code> ，就意味着读到了嵌套的表达式，需要调用 <code>scheme_read</code> 来处理这个内层的表达式，因此改成了</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-193-1"><a id="__codelineno-193-1" name="__codelineno-193-1" href="#__codelineno-193-1"></a><span class="k">if</span> <span class="n">src</span><span class="o">.</span><span class="n">current</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span><span class="p">:</span>
</span><span id="__span-193-2"><a id="__codelineno-193-2" name="__codelineno-193-2" href="#__codelineno-193-2"></a>    <span class="k">return</span> <span class="n">Pair</span><span class="p">(</span><span class="n">scheme_read</span><span class="p">(</span><span class="n">src</span><span class="p">),</span> <span class="n">read_tail</span><span class="p">(</span><span class="n">src</span><span class="p">))</span>
</span><span id="__span-193-3"><a id="__codelineno-193-3" name="__codelineno-193-3" href="#__codelineno-193-3"></a><span class="k">return</span> <span class="n">Pair</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">pop_first</span><span class="p">(),</span> <span class="n">read_tail</span><span class="p">(</span><span class="n">src</span><span class="p">))</span>
</span></code></pre></div>
<p>再次测试，原来错误的地方通过了，但是出现了新的报错</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-194-1"><a id="__codelineno-194-1" name="__codelineno-194-1" href="#__codelineno-194-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">read_line</span><span class="p">(</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span>
</span><span id="__span-194-2"><a id="__codelineno-194-2" name="__codelineno-194-2" href="#__codelineno-194-2"></a><span class="n">nil</span>
</span><span id="__span-194-3"><a id="__codelineno-194-3" name="__codelineno-194-3" href="#__codelineno-194-3"></a>
</span><span id="__span-194-4"><a id="__codelineno-194-4" name="__codelineno-194-4" href="#__codelineno-194-4"></a><span class="c1"># Error: expected</span>
</span><span id="__span-194-5"><a id="__codelineno-194-5" name="__codelineno-194-5" href="#__codelineno-194-5"></a><span class="c1">#     Pair(&#39;a&#39;, nil)</span>
</span><span id="__span-194-6"><a id="__codelineno-194-6" name="__codelineno-194-6" href="#__codelineno-194-6"></a><span class="c1"># but got</span>
</span><span id="__span-194-7"><a id="__codelineno-194-7" name="__codelineno-194-7" href="#__codelineno-194-7"></a><span class="c1">#     nil</span>
</span></code></pre></div>
<p>进行分析，感觉上一个错误也和这个差不多，但是已经被解决，说明问题不在 <code>read_tail</code> 中，所以应该在 <code>scheme_read</code> 中，于是进行查看，发现这里已经弹出过<em>令牌</em>了</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-195-1"><a id="__codelineno-195-1" name="__codelineno-195-1" href="#__codelineno-195-1"></a><span class="n">val</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">pop_first</span><span class="p">()</span> <span class="c1"># Get and remove the first token</span>
</span></code></pre></div>
<p>所以将之前的代码修改后，最后终于通过😭</p>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-196-1"><a id="__codelineno-196-1" name="__codelineno-196-1" href="#__codelineno-196-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">scheme_read</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>
</span><span id="__span-196-2"><a id="__codelineno-196-2" name="__codelineno-196-2" href="#__codelineno-196-2"></a>    <span class="k">if</span> <span class="n">src</span><span class="o">.</span><span class="n">current</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-196-3"><a id="__codelineno-196-3" name="__codelineno-196-3" href="#__codelineno-196-3"></a>        <span class="k">raise</span> <span class="ne">EOFError</span>
</span><span id="__span-196-4"><a id="__codelineno-196-4" name="__codelineno-196-4" href="#__codelineno-196-4"></a>    <span class="n">val</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">pop_first</span><span class="p">()</span> <span class="c1"># Get and remove the first token</span>
</span><span id="__span-196-5"><a id="__codelineno-196-5" name="__codelineno-196-5" href="#__codelineno-196-5"></a>    <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="s1">&#39;nil&#39;</span><span class="p">:</span>
</span><span id="__span-196-6"><a id="__codelineno-196-6" name="__codelineno-196-6" href="#__codelineno-196-6"></a>        <span class="c1"># BEGIN PROBLEM 1</span>
</span><span id="__span-196-7"><a id="__codelineno-196-7" name="__codelineno-196-7" href="#__codelineno-196-7"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-196-8"><a id="__codelineno-196-8" name="__codelineno-196-8" href="#__codelineno-196-8"></a>        <span class="k">return</span> <span class="n">nil</span>
</span><span id="__span-196-9"><a id="__codelineno-196-9" name="__codelineno-196-9" href="#__codelineno-196-9"></a>        <span class="c1"># END PROBLEM 1</span>
</span><span id="__span-196-10"><a id="__codelineno-196-10" name="__codelineno-196-10" href="#__codelineno-196-10"></a>    <span class="k">elif</span> <span class="n">val</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span><span class="p">:</span>
</span><span id="__span-196-11"><a id="__codelineno-196-11" name="__codelineno-196-11" href="#__codelineno-196-11"></a>        <span class="c1"># BEGIN PROBLEM 1</span>
</span><span id="__span-196-12"><a id="__codelineno-196-12" name="__codelineno-196-12" href="#__codelineno-196-12"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-196-13"><a id="__codelineno-196-13" name="__codelineno-196-13" href="#__codelineno-196-13"></a>        <span class="k">return</span> <span class="n">read_tail</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
</span><span id="__span-196-14"><a id="__codelineno-196-14" name="__codelineno-196-14" href="#__codelineno-196-14"></a>        <span class="c1"># END PROBLEM 1</span>
</span><span id="__span-196-15"><a id="__codelineno-196-15" name="__codelineno-196-15" href="#__codelineno-196-15"></a>    <span class="k">elif</span> <span class="n">val</span> <span class="o">==</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">:</span>
</span><span id="__span-196-16"><a id="__codelineno-196-16" name="__codelineno-196-16" href="#__codelineno-196-16"></a>        <span class="c1"># BEGIN PROBLEM 6</span>
</span><span id="__span-196-17"><a id="__codelineno-196-17" name="__codelineno-196-17" href="#__codelineno-196-17"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-196-18"><a id="__codelineno-196-18" name="__codelineno-196-18" href="#__codelineno-196-18"></a>        <span class="c1"># END PROBLEM 6</span>
</span><span id="__span-196-19"><a id="__codelineno-196-19" name="__codelineno-196-19" href="#__codelineno-196-19"></a>    <span class="k">elif</span> <span class="n">val</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">DELIMITERS</span><span class="p">:</span>
</span><span id="__span-196-20"><a id="__codelineno-196-20" name="__codelineno-196-20" href="#__codelineno-196-20"></a>        <span class="k">return</span> <span class="n">val</span>
</span><span id="__span-196-21"><a id="__codelineno-196-21" name="__codelineno-196-21" href="#__codelineno-196-21"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-196-22"><a id="__codelineno-196-22" name="__codelineno-196-22" href="#__codelineno-196-22"></a>        <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="s1">&#39;unexpected token: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
</span><span id="__span-196-23"><a id="__codelineno-196-23" name="__codelineno-196-23" href="#__codelineno-196-23"></a><span class="k">def</span><span class="w"> </span><span class="nf">read_tail</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>
</span><span id="__span-196-24"><a id="__codelineno-196-24" name="__codelineno-196-24" href="#__codelineno-196-24"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-196-25"><a id="__codelineno-196-25" name="__codelineno-196-25" href="#__codelineno-196-25"></a>        <span class="k">if</span> <span class="n">src</span><span class="o">.</span><span class="n">current</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-196-26"><a id="__codelineno-196-26" name="__codelineno-196-26" href="#__codelineno-196-26"></a>            <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="s1">&#39;unexpected end of file&#39;</span><span class="p">)</span>
</span><span id="__span-196-27"><a id="__codelineno-196-27" name="__codelineno-196-27" href="#__codelineno-196-27"></a>        <span class="k">elif</span> <span class="n">src</span><span class="o">.</span><span class="n">current</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span><span class="p">:</span>
</span><span id="__span-196-28"><a id="__codelineno-196-28" name="__codelineno-196-28" href="#__codelineno-196-28"></a>            <span class="c1"># BEGIN PROBLEM 1</span>
</span><span id="__span-196-29"><a id="__codelineno-196-29" name="__codelineno-196-29" href="#__codelineno-196-29"></a>            <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-196-30"><a id="__codelineno-196-30" name="__codelineno-196-30" href="#__codelineno-196-30"></a>            <span class="n">src</span><span class="o">.</span><span class="n">pop_first</span><span class="p">()</span>
</span><span id="__span-196-31"><a id="__codelineno-196-31" name="__codelineno-196-31" href="#__codelineno-196-31"></a>            <span class="k">return</span> <span class="n">nil</span>
</span><span id="__span-196-32"><a id="__codelineno-196-32" name="__codelineno-196-32" href="#__codelineno-196-32"></a>            <span class="c1"># END PROBLEM 1</span>
</span><span id="__span-196-33"><a id="__codelineno-196-33" name="__codelineno-196-33" href="#__codelineno-196-33"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-196-34"><a id="__codelineno-196-34" name="__codelineno-196-34" href="#__codelineno-196-34"></a>            <span class="c1"># BEGIN PROBLEM 1</span>
</span><span id="__span-196-35"><a id="__codelineno-196-35" name="__codelineno-196-35" href="#__codelineno-196-35"></a>            <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-196-36"><a id="__codelineno-196-36" name="__codelineno-196-36" href="#__codelineno-196-36"></a>            <span class="k">if</span> <span class="n">src</span><span class="o">.</span><span class="n">current</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span><span class="p">:</span>
</span><span id="__span-196-37"><a id="__codelineno-196-37" name="__codelineno-196-37" href="#__codelineno-196-37"></a>                <span class="k">return</span> <span class="n">Pair</span><span class="p">(</span><span class="n">scheme_read</span><span class="p">(</span><span class="n">src</span><span class="p">),</span> <span class="n">read_tail</span><span class="p">(</span><span class="n">src</span><span class="p">))</span>
</span><span id="__span-196-38"><a id="__codelineno-196-38" name="__codelineno-196-38" href="#__codelineno-196-38"></a>            <span class="k">return</span> <span class="n">Pair</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">pop_first</span><span class="p">(),</span> <span class="n">read_tail</span><span class="p">(</span><span class="n">src</span><span class="p">))</span>
</span><span id="__span-196-39"><a id="__codelineno-196-39" name="__codelineno-196-39" href="#__codelineno-196-39"></a>            <span class="c1"># END PROBLEM 1</span>
</span><span id="__span-196-40"><a id="__codelineno-196-40" name="__codelineno-196-40" href="#__codelineno-196-40"></a>    <span class="k">except</span> <span class="ne">EOFError</span><span class="p">:</span>
</span><span id="__span-196-41"><a id="__codelineno-196-41" name="__codelineno-196-41" href="#__codelineno-196-41"></a>        <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="s1">&#39;unexpected end of file&#39;</span><span class="p">)</span>
</span></code></pre></div>
</details>
<hr />
<p>Problem 13中发现了 由于Problem 1中代码存在漏洞 而导致的错误，重新阅读题目后，将代码修改正确(具体可见于第7条Problem 13)</p>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-197-1"><a id="__codelineno-197-1" name="__codelineno-197-1" href="#__codelineno-197-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">scheme_read</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>
</span><span id="__span-197-2"><a id="__codelineno-197-2" name="__codelineno-197-2" href="#__codelineno-197-2"></a>    <span class="k">if</span> <span class="n">src</span><span class="o">.</span><span class="n">current</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-197-3"><a id="__codelineno-197-3" name="__codelineno-197-3" href="#__codelineno-197-3"></a>        <span class="k">raise</span> <span class="ne">EOFError</span>
</span><span id="__span-197-4"><a id="__codelineno-197-4" name="__codelineno-197-4" href="#__codelineno-197-4"></a>    <span class="n">val</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">pop_first</span><span class="p">()</span> <span class="c1"># Get and remove the first token</span>
</span><span id="__span-197-5"><a id="__codelineno-197-5" name="__codelineno-197-5" href="#__codelineno-197-5"></a>    <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="s1">&#39;nil&#39;</span><span class="p">:</span>
</span><span id="__span-197-6"><a id="__codelineno-197-6" name="__codelineno-197-6" href="#__codelineno-197-6"></a>        <span class="c1"># BEGIN PROBLEM 1</span>
</span><span id="__span-197-7"><a id="__codelineno-197-7" name="__codelineno-197-7" href="#__codelineno-197-7"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-197-8"><a id="__codelineno-197-8" name="__codelineno-197-8" href="#__codelineno-197-8"></a>        <span class="k">return</span> <span class="n">nil</span>
</span><span id="__span-197-9"><a id="__codelineno-197-9" name="__codelineno-197-9" href="#__codelineno-197-9"></a>        <span class="c1"># END PROBLEM 1</span>
</span><span id="__span-197-10"><a id="__codelineno-197-10" name="__codelineno-197-10" href="#__codelineno-197-10"></a>    <span class="k">elif</span> <span class="n">val</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span><span class="p">:</span>
</span><span id="__span-197-11"><a id="__codelineno-197-11" name="__codelineno-197-11" href="#__codelineno-197-11"></a>        <span class="c1"># BEGIN PROBLEM 1</span>
</span><span id="__span-197-12"><a id="__codelineno-197-12" name="__codelineno-197-12" href="#__codelineno-197-12"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-197-13"><a id="__codelineno-197-13" name="__codelineno-197-13" href="#__codelineno-197-13"></a>        <span class="k">return</span> <span class="n">read_tail</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
</span><span id="__span-197-14"><a id="__codelineno-197-14" name="__codelineno-197-14" href="#__codelineno-197-14"></a>        <span class="c1"># END PROBLEM 1</span>
</span><span id="__span-197-15"><a id="__codelineno-197-15" name="__codelineno-197-15" href="#__codelineno-197-15"></a>    <span class="k">elif</span> <span class="n">val</span> <span class="o">==</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">:</span>
</span><span id="__span-197-16"><a id="__codelineno-197-16" name="__codelineno-197-16" href="#__codelineno-197-16"></a>        <span class="c1"># BEGIN PROBLEM 6</span>
</span><span id="__span-197-17"><a id="__codelineno-197-17" name="__codelineno-197-17" href="#__codelineno-197-17"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-197-18"><a id="__codelineno-197-18" name="__codelineno-197-18" href="#__codelineno-197-18"></a>        <span class="c1"># END PROBLEM 6</span>
</span><span id="__span-197-19"><a id="__codelineno-197-19" name="__codelineno-197-19" href="#__codelineno-197-19"></a>    <span class="k">elif</span> <span class="n">val</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">DELIMITERS</span><span class="p">:</span>
</span><span id="__span-197-20"><a id="__codelineno-197-20" name="__codelineno-197-20" href="#__codelineno-197-20"></a>        <span class="k">return</span> <span class="n">val</span>
</span><span id="__span-197-21"><a id="__codelineno-197-21" name="__codelineno-197-21" href="#__codelineno-197-21"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-197-22"><a id="__codelineno-197-22" name="__codelineno-197-22" href="#__codelineno-197-22"></a>        <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="s1">&#39;unexpected token: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
</span><span id="__span-197-23"><a id="__codelineno-197-23" name="__codelineno-197-23" href="#__codelineno-197-23"></a><span class="k">def</span><span class="w"> </span><span class="nf">read_tail</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>
</span><span id="__span-197-24"><a id="__codelineno-197-24" name="__codelineno-197-24" href="#__codelineno-197-24"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-197-25"><a id="__codelineno-197-25" name="__codelineno-197-25" href="#__codelineno-197-25"></a>        <span class="k">if</span> <span class="n">src</span><span class="o">.</span><span class="n">current</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-197-26"><a id="__codelineno-197-26" name="__codelineno-197-26" href="#__codelineno-197-26"></a>            <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="s1">&#39;unexpected end of file&#39;</span><span class="p">)</span>
</span><span id="__span-197-27"><a id="__codelineno-197-27" name="__codelineno-197-27" href="#__codelineno-197-27"></a>        <span class="k">elif</span> <span class="n">src</span><span class="o">.</span><span class="n">current</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span><span class="p">:</span>
</span><span id="__span-197-28"><a id="__codelineno-197-28" name="__codelineno-197-28" href="#__codelineno-197-28"></a>            <span class="c1"># BEGIN PROBLEM 1</span>
</span><span id="__span-197-29"><a id="__codelineno-197-29" name="__codelineno-197-29" href="#__codelineno-197-29"></a>            <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-197-30"><a id="__codelineno-197-30" name="__codelineno-197-30" href="#__codelineno-197-30"></a>            <span class="n">src</span><span class="o">.</span><span class="n">pop_first</span><span class="p">()</span>
</span><span id="__span-197-31"><a id="__codelineno-197-31" name="__codelineno-197-31" href="#__codelineno-197-31"></a>            <span class="k">return</span> <span class="n">nil</span>
</span><span id="__span-197-32"><a id="__codelineno-197-32" name="__codelineno-197-32" href="#__codelineno-197-32"></a>            <span class="c1"># END PROBLEM 1</span>
</span><span id="__span-197-33"><a id="__codelineno-197-33" name="__codelineno-197-33" href="#__codelineno-197-33"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-197-34"><a id="__codelineno-197-34" name="__codelineno-197-34" href="#__codelineno-197-34"></a>            <span class="c1"># BEGIN PROBLEM 1</span>
</span><span id="__span-197-35"><a id="__codelineno-197-35" name="__codelineno-197-35" href="#__codelineno-197-35"></a>            <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-197-36"><a id="__codelineno-197-36" name="__codelineno-197-36" href="#__codelineno-197-36"></a>            <span class="k">return</span> <span class="n">Pair</span><span class="p">(</span><span class="n">scheme_read</span><span class="p">(</span><span class="n">src</span><span class="p">),</span> <span class="n">read_tail</span><span class="p">(</span><span class="n">src</span><span class="p">))</span>
</span><span id="__span-197-37"><a id="__codelineno-197-37" name="__codelineno-197-37" href="#__codelineno-197-37"></a>            <span class="c1"># END PROBLEM 1</span>
</span><span id="__span-197-38"><a id="__codelineno-197-38" name="__codelineno-197-38" href="#__codelineno-197-38"></a>    <span class="k">except</span> <span class="ne">EOFError</span><span class="p">:</span>
</span><span id="__span-197-39"><a id="__codelineno-197-39" name="__codelineno-197-39" href="#__codelineno-197-39"></a>        <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="s1">&#39;unexpected end of file&#39;</span><span class="p">)</span>
</span></code></pre></div>
</details>
<h3 id="2_26">2<a class="headerlink" href="#2_26" title="Permanent link">&para;</a></h3>
<p>Problem 4，一开始我写的是</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-198-1"><a id="__codelineno-198-1" name="__codelineno-198-1" href="#__codelineno-198-1"></a><span class="n">operator</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="n">first</span><span class="p">)</span>
</span><span id="__span-198-2"><a id="__codelineno-198-2" name="__codelineno-198-2" href="#__codelineno-198-2"></a><span class="n">validate_procedure</span><span class="p">(</span><span class="n">operator</span><span class="p">)</span>
</span><span id="__span-198-3"><a id="__codelineno-198-3" name="__codelineno-198-3" href="#__codelineno-198-3"></a><span class="n">operands</span> <span class="o">=</span> <span class="n">rest</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">env</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span><span id="__span-198-4"><a id="__codelineno-198-4" name="__codelineno-198-4" href="#__codelineno-198-4"></a><span class="k">return</span> <span class="n">scheme_apply</span><span class="p">(</span><span class="n">operator</span><span class="p">,</span> <span class="n">operands</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span></code></pre></div>
<p>但是报了这样的错误</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-199-1"><a id="__codelineno-199-1" name="__codelineno-199-1" href="#__codelineno-199-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">scheme_reader</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="__span-199-2"><a id="__codelineno-199-2" name="__codelineno-199-2" href="#__codelineno-199-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">scheme</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="__span-199-3"><a id="__codelineno-199-3" name="__codelineno-199-3" href="#__codelineno-199-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">expr</span> <span class="o">=</span> <span class="n">read_line</span><span class="p">(</span><span class="s1">&#39;(+ 2 2)&#39;</span><span class="p">)</span>
</span><span id="__span-199-4"><a id="__codelineno-199-4" name="__codelineno-199-4" href="#__codelineno-199-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">create_global_frame</span><span class="p">())</span> <span class="c1"># Type SchemeError if you think this errors</span>
</span><span id="__span-199-5"><a id="__codelineno-199-5" name="__codelineno-199-5" href="#__codelineno-199-5"></a><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
</span><span id="__span-199-6"><a id="__codelineno-199-6" name="__codelineno-199-6" href="#__codelineno-199-6"></a>  <span class="o">...</span>
</span><span id="__span-199-7"><a id="__codelineno-199-7" name="__codelineno-199-7" href="#__codelineno-199-7"></a><span class="n">scheme_builtins</span><span class="o">.</span><span class="n">SchemeError</span><span class="p">:</span> <span class="n">unknown</span> <span class="n">identifier</span><span class="p">:</span> <span class="mi">2</span>
</span><span id="__span-199-8"><a id="__codelineno-199-8" name="__codelineno-199-8" href="#__codelineno-199-8"></a>
</span><span id="__span-199-9"><a id="__codelineno-199-9" name="__codelineno-199-9" href="#__codelineno-199-9"></a><span class="c1"># Error: expected</span>
</span><span id="__span-199-10"><a id="__codelineno-199-10" name="__codelineno-199-10" href="#__codelineno-199-10"></a><span class="c1">#     4</span>
</span><span id="__span-199-11"><a id="__codelineno-199-11" name="__codelineno-199-11" href="#__codelineno-199-11"></a><span class="c1"># but got</span>
</span><span id="__span-199-12"><a id="__codelineno-199-12" name="__codelineno-199-12" href="#__codelineno-199-12"></a><span class="c1">#     Traceback (most recent call last):</span>
</span><span id="__span-199-13"><a id="__codelineno-199-13" name="__codelineno-199-13" href="#__codelineno-199-13"></a><span class="c1">#       ...</span>
</span><span id="__span-199-14"><a id="__codelineno-199-14" name="__codelineno-199-14" href="#__codelineno-199-14"></a><span class="c1">#     SchemeError: unknown identifier: 2</span>
</span></code></pre></div>
<p>然后突然想到 <code>2</code> 并不是一个 <em>符号 symbol</em> ，所以 <code>env.lookup(2)</code> 应该是会报错，然后又会想起题目中的</p>
<blockquote>
<p>You'll have to recursively call <code>scheme_eval</code> in the first two steps.</p>
</blockquote>
<p>所以就知道需要如何修改了，最后修改后通过了测试</p>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-200-1"><a id="__codelineno-200-1" name="__codelineno-200-1" href="#__codelineno-200-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">scheme_eval</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">_</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> <span class="c1"># Optional third argument is ignored</span>
</span><span id="__span-200-2"><a id="__codelineno-200-2" name="__codelineno-200-2" href="#__codelineno-200-2"></a>    <span class="c1"># Evaluate atoms</span>
</span><span id="__span-200-3"><a id="__codelineno-200-3" name="__codelineno-200-3" href="#__codelineno-200-3"></a>    <span class="k">if</span> <span class="n">scheme_symbolp</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
</span><span id="__span-200-4"><a id="__codelineno-200-4" name="__codelineno-200-4" href="#__codelineno-200-4"></a>        <span class="k">return</span> <span class="n">env</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
</span><span id="__span-200-5"><a id="__codelineno-200-5" name="__codelineno-200-5" href="#__codelineno-200-5"></a>    <span class="k">elif</span> <span class="n">self_evaluating</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
</span><span id="__span-200-6"><a id="__codelineno-200-6" name="__codelineno-200-6" href="#__codelineno-200-6"></a>        <span class="k">return</span> <span class="n">expr</span>
</span><span id="__span-200-7"><a id="__codelineno-200-7" name="__codelineno-200-7" href="#__codelineno-200-7"></a>
</span><span id="__span-200-8"><a id="__codelineno-200-8" name="__codelineno-200-8" href="#__codelineno-200-8"></a>    <span class="c1"># All non-atomic expressions are lists (combinations)</span>
</span><span id="__span-200-9"><a id="__codelineno-200-9" name="__codelineno-200-9" href="#__codelineno-200-9"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">scheme_listp</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
</span><span id="__span-200-10"><a id="__codelineno-200-10" name="__codelineno-200-10" href="#__codelineno-200-10"></a>        <span class="k">raise</span> <span class="n">SchemeError</span><span class="p">(</span><span class="s1">&#39;malformed list: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">repl_str</span><span class="p">(</span><span class="n">expr</span><span class="p">)))</span>
</span><span id="__span-200-11"><a id="__codelineno-200-11" name="__codelineno-200-11" href="#__codelineno-200-11"></a>    <span class="n">first</span><span class="p">,</span> <span class="n">rest</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">expr</span><span class="o">.</span><span class="n">rest</span>
</span><span id="__span-200-12"><a id="__codelineno-200-12" name="__codelineno-200-12" href="#__codelineno-200-12"></a>    <span class="k">if</span> <span class="n">scheme_symbolp</span><span class="p">(</span><span class="n">first</span><span class="p">)</span> <span class="ow">and</span> <span class="n">first</span> <span class="ow">in</span> <span class="n">SPECIAL_FORMS</span><span class="p">:</span>
</span><span id="__span-200-13"><a id="__codelineno-200-13" name="__codelineno-200-13" href="#__codelineno-200-13"></a>        <span class="k">return</span> <span class="n">SPECIAL_FORMS</span><span class="p">[</span><span class="n">first</span><span class="p">](</span><span class="n">rest</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-200-14"><a id="__codelineno-200-14" name="__codelineno-200-14" href="#__codelineno-200-14"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-200-15"><a id="__codelineno-200-15" name="__codelineno-200-15" href="#__codelineno-200-15"></a>        <span class="c1"># BEGIN PROBLEM 4</span>
</span><span id="__span-200-16"><a id="__codelineno-200-16" name="__codelineno-200-16" href="#__codelineno-200-16"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-200-17"><a id="__codelineno-200-17" name="__codelineno-200-17" href="#__codelineno-200-17"></a>        <span class="n">operator</span> <span class="o">=</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-200-18"><a id="__codelineno-200-18" name="__codelineno-200-18" href="#__codelineno-200-18"></a>        <span class="n">validate_procedure</span><span class="p">(</span><span class="n">operator</span><span class="p">)</span>
</span><span id="__span-200-19"><a id="__codelineno-200-19" name="__codelineno-200-19" href="#__codelineno-200-19"></a>        <span class="n">operands</span> <span class="o">=</span> <span class="n">rest</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">env</span><span class="p">))</span>
</span><span id="__span-200-20"><a id="__codelineno-200-20" name="__codelineno-200-20" href="#__codelineno-200-20"></a>        <span class="k">return</span> <span class="n">scheme_apply</span><span class="p">(</span><span class="n">operator</span><span class="p">,</span> <span class="n">operands</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-200-21"><a id="__codelineno-200-21" name="__codelineno-200-21" href="#__codelineno-200-21"></a>        <span class="c1"># END PROBLEM 4</span>
</span></code></pre></div>
</details>
<h3 id="3_20">3<a class="headerlink" href="#3_20" title="Permanent link">&para;</a></h3>
<p>Problem 5，注意需要区分第二个操作数需要通过<em>求值</em>将符号或表达式变成对应值</p>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-201-1"><a id="__codelineno-201-1" name="__codelineno-201-1" href="#__codelineno-201-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">do_define_form</span><span class="p">(</span><span class="n">expressions</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
</span><span id="__span-201-2"><a id="__codelineno-201-2" name="__codelineno-201-2" href="#__codelineno-201-2"></a>    <span class="n">validate_form</span><span class="p">(</span><span class="n">expressions</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># Checks that expressions is a list of length at least 2</span>
</span><span id="__span-201-3"><a id="__codelineno-201-3" name="__codelineno-201-3" href="#__codelineno-201-3"></a>    <span class="n">target</span> <span class="o">=</span> <span class="n">expressions</span><span class="o">.</span><span class="n">first</span>
</span><span id="__span-201-4"><a id="__codelineno-201-4" name="__codelineno-201-4" href="#__codelineno-201-4"></a>    <span class="k">if</span> <span class="n">scheme_symbolp</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
</span><span id="__span-201-5"><a id="__codelineno-201-5" name="__codelineno-201-5" href="#__codelineno-201-5"></a>        <span class="n">validate_form</span><span class="p">(</span><span class="n">expressions</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># Checks that expressions is a list of length exactly 2</span>
</span><span id="__span-201-6"><a id="__codelineno-201-6" name="__codelineno-201-6" href="#__codelineno-201-6"></a>        <span class="c1"># BEGIN PROBLEM 5</span>
</span><span id="__span-201-7"><a id="__codelineno-201-7" name="__codelineno-201-7" href="#__codelineno-201-7"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-201-8"><a id="__codelineno-201-8" name="__codelineno-201-8" href="#__codelineno-201-8"></a>        <span class="n">env</span><span class="o">.</span><span class="n">define</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">))</span>
</span><span id="__span-201-9"><a id="__codelineno-201-9" name="__codelineno-201-9" href="#__codelineno-201-9"></a>        <span class="k">return</span> <span class="n">target</span>
</span><span id="__span-201-10"><a id="__codelineno-201-10" name="__codelineno-201-10" href="#__codelineno-201-10"></a>        <span class="c1"># END PROBLEM 5</span>
</span><span id="__span-201-11"><a id="__codelineno-201-11" name="__codelineno-201-11" href="#__codelineno-201-11"></a>    <span class="o">...</span>
</span></code></pre></div>
</details>
<h3 id="4_12">4<a class="headerlink" href="#4_12" title="Permanent link">&para;</a></h3>
<p>Problem 6中，一开始在 <code>scheme_read</code> 中写的是</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-202-1"><a id="__codelineno-202-1" name="__codelineno-202-1" href="#__codelineno-202-1"></a><span class="k">return</span> <span class="n">Pair</span><span class="p">(</span><span class="s2">&quot;quote&quot;</span><span class="p">,</span> <span class="n">scheme_read</span><span class="p">(</span><span class="n">src</span><span class="p">))</span>
</span></code></pre></div>
<p>但是报错了</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-203-1"><a id="__codelineno-203-1" name="__codelineno-203-1" href="#__codelineno-203-1"></a><span class="n">scm</span><span class="o">&gt;</span> <span class="s1">&#39;&#39;</span><span class="n">hello</span>
</span><span id="__span-203-2"><a id="__codelineno-203-2" name="__codelineno-203-2" href="#__codelineno-203-2"></a><span class="n">hello</span> <span class="nb">str</span>
</span><span id="__span-203-3"><a id="__codelineno-203-3" name="__codelineno-203-3" href="#__codelineno-203-3"></a><span class="c1"># Error: cdr can only be a pair, nil, or a promise but was hello</span>
</span><span id="__span-203-4"><a id="__codelineno-203-4" name="__codelineno-203-4" href="#__codelineno-203-4"></a>
</span><span id="__span-203-5"><a id="__codelineno-203-5" name="__codelineno-203-5" href="#__codelineno-203-5"></a><span class="c1"># Error: expected</span>
</span><span id="__span-203-6"><a id="__codelineno-203-6" name="__codelineno-203-6" href="#__codelineno-203-6"></a><span class="c1">#     (quote hello)</span>
</span><span id="__span-203-7"><a id="__codelineno-203-7" name="__codelineno-203-7" href="#__codelineno-203-7"></a><span class="c1"># but got</span>
</span><span id="__span-203-8"><a id="__codelineno-203-8" name="__codelineno-203-8" href="#__codelineno-203-8"></a><span class="c1">#     Traceback (most recent call last):</span>
</span><span id="__span-203-9"><a id="__codelineno-203-9" name="__codelineno-203-9" href="#__codelineno-203-9"></a><span class="c1">#       ...</span>
</span><span id="__span-203-10"><a id="__codelineno-203-10" name="__codelineno-203-10" href="#__codelineno-203-10"></a><span class="c1">#     SchemeError: cdr can only be a pair, nil, or a promise but was hello</span>
</span></code></pre></div>
<p>经过思考，大概理解了，我感觉 <code>'</code> 可以理解为<strong>只会有一个参数/操作数的函数</strong>(因为引号后只会有一个最外层的括号)，因此返回的结构就会是</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-204-1"><a id="__codelineno-204-1" name="__codelineno-204-1" href="#__codelineno-204-1"></a><span class="n">Pair</span><span class="p">(</span><span class="s2">&quot;quote&quot;</span><span class="p">,</span> <span class="n">Pair</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">nil</span><span class="p">))</span>
</span></code></pre></div>
<p><code>...</code> 就是被引用的部分，也就是那<strong>唯一的参数</strong>。</p>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><span class="filename">scheme.py</span><pre><span></span><code><span id="__span-205-1"><a id="__codelineno-205-1" name="__codelineno-205-1" href="#__codelineno-205-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">do_quote_form</span><span class="p">(</span><span class="n">expressions</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
</span><span id="__span-205-2"><a id="__codelineno-205-2" name="__codelineno-205-2" href="#__codelineno-205-2"></a>    <span class="n">validate_form</span><span class="p">(</span><span class="n">expressions</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-205-3"><a id="__codelineno-205-3" name="__codelineno-205-3" href="#__codelineno-205-3"></a>    <span class="c1"># BEGIN PROBLEM 6</span>
</span><span id="__span-205-4"><a id="__codelineno-205-4" name="__codelineno-205-4" href="#__codelineno-205-4"></a>    <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-205-5"><a id="__codelineno-205-5" name="__codelineno-205-5" href="#__codelineno-205-5"></a>    <span class="k">return</span> <span class="n">expressions</span><span class="o">.</span><span class="n">first</span>
</span><span id="__span-205-6"><a id="__codelineno-205-6" name="__codelineno-205-6" href="#__codelineno-205-6"></a>    <span class="c1"># END PROBLEM 6</span>
</span></code></pre></div>
<div class="language-python highlight"><span class="filename">scheme_reader.py</span><pre><span></span><code><span id="__span-206-1"><a id="__codelineno-206-1" name="__codelineno-206-1" href="#__codelineno-206-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">scheme_read</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>
</span><span id="__span-206-2"><a id="__codelineno-206-2" name="__codelineno-206-2" href="#__codelineno-206-2"></a>    <span class="o">...</span>
</span><span id="__span-206-3"><a id="__codelineno-206-3" name="__codelineno-206-3" href="#__codelineno-206-3"></a>    <span class="k">elif</span> <span class="n">val</span> <span class="o">==</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">:</span>
</span><span id="__span-206-4"><a id="__codelineno-206-4" name="__codelineno-206-4" href="#__codelineno-206-4"></a>        <span class="c1"># BEGIN PROBLEM 6</span>
</span><span id="__span-206-5"><a id="__codelineno-206-5" name="__codelineno-206-5" href="#__codelineno-206-5"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-206-6"><a id="__codelineno-206-6" name="__codelineno-206-6" href="#__codelineno-206-6"></a>        <span class="k">return</span> <span class="n">Pair</span><span class="p">(</span><span class="s2">&quot;quote&quot;</span><span class="p">,</span> <span class="n">Pair</span><span class="p">(</span><span class="n">scheme_read</span><span class="p">(</span><span class="n">src</span><span class="p">),</span> <span class="n">nil</span><span class="p">))</span>
</span><span id="__span-206-7"><a id="__codelineno-206-7" name="__codelineno-206-7" href="#__codelineno-206-7"></a>        <span class="c1"># END PROBLEM 6</span>
</span><span id="__span-206-8"><a id="__codelineno-206-8" name="__codelineno-206-8" href="#__codelineno-206-8"></a>    <span class="o">...</span>
</span><span id="__span-206-9"><a id="__codelineno-206-9" name="__codelineno-206-9" href="#__codelineno-206-9"></a><span class="k">def</span><span class="w"> </span><span class="nf">read_tail</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>
</span><span id="__span-206-10"><a id="__codelineno-206-10" name="__codelineno-206-10" href="#__codelineno-206-10"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-206-11"><a id="__codelineno-206-11" name="__codelineno-206-11" href="#__codelineno-206-11"></a>        <span class="o">...</span>
</span><span id="__span-206-12"><a id="__codelineno-206-12" name="__codelineno-206-12" href="#__codelineno-206-12"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-206-13"><a id="__codelineno-206-13" name="__codelineno-206-13" href="#__codelineno-206-13"></a>            <span class="c1"># BEGIN PROBLEM 1</span>
</span><span id="__span-206-14"><a id="__codelineno-206-14" name="__codelineno-206-14" href="#__codelineno-206-14"></a>            <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-206-15"><a id="__codelineno-206-15" name="__codelineno-206-15" href="#__codelineno-206-15"></a>            <span class="c1"># if src.current() == &#39;(&#39;:</span>
</span><span id="__span-206-16"><a id="__codelineno-206-16" name="__codelineno-206-16" href="#__codelineno-206-16"></a>            <span class="k">if</span> <span class="n">src</span><span class="o">.</span><span class="n">current</span><span class="p">()</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">):</span>
</span><span id="__span-206-17"><a id="__codelineno-206-17" name="__codelineno-206-17" href="#__codelineno-206-17"></a>                <span class="o">...</span>
</span><span id="__span-206-18"><a id="__codelineno-206-18" name="__codelineno-206-18" href="#__codelineno-206-18"></a>            <span class="o">...</span>
</span><span id="__span-206-19"><a id="__codelineno-206-19" name="__codelineno-206-19" href="#__codelineno-206-19"></a>            <span class="c1"># END PROBLEM 1</span>
</span><span id="__span-206-20"><a id="__codelineno-206-20" name="__codelineno-206-20" href="#__codelineno-206-20"></a>    <span class="o">...</span>
</span></code></pre></div>
</details>
<h3 id="5_9">5<a class="headerlink" href="#5_9" title="Permanent link">&para;</a></h3>
<p>解锁Problem 8的这题答案(参考 <code>do_lambda_form</code> 函数说明可以得知是 <code>Pair(...)</code> 的形式)有些难敲(主要是因为太长了😅)</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-207-1"><a id="__codelineno-207-1" name="__codelineno-207-1" href="#__codelineno-207-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">scheme_reader</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="__span-207-2"><a id="__codelineno-207-2" name="__codelineno-207-2" href="#__codelineno-207-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">scheme</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="__span-207-3"><a id="__codelineno-207-3" name="__codelineno-207-3" href="#__codelineno-207-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">env</span> <span class="o">=</span> <span class="n">create_global_frame</span><span class="p">()</span>
</span><span id="__span-207-4"><a id="__codelineno-207-4" name="__codelineno-207-4" href="#__codelineno-207-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">lambda_line</span> <span class="o">=</span> <span class="n">read_line</span><span class="p">(</span><span class="s2">&quot;(lambda (a b c) (+ a (* b c)))&quot;</span><span class="p">)</span>
</span><span id="__span-207-5"><a id="__codelineno-207-5" name="__codelineno-207-5" href="#__codelineno-207-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">lambda_proc</span> <span class="o">=</span> <span class="n">do_lambda_form</span><span class="p">(</span><span class="n">lambda_line</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-207-6"><a id="__codelineno-207-6" name="__codelineno-207-6" href="#__codelineno-207-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">lambda_proc</span><span class="o">.</span><span class="n">formals</span>
</span><span id="__span-207-7"><a id="__codelineno-207-7" name="__codelineno-207-7" href="#__codelineno-207-7"></a><span class="err">?</span> <span class="n">Pair</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">Pair</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">Pair</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">nil</span><span class="p">)))</span>
</span><span id="__span-207-8"><a id="__codelineno-207-8" name="__codelineno-207-8" href="#__codelineno-207-8"></a><span class="o">--</span> <span class="n">OK</span><span class="err">!</span> <span class="o">--</span>
</span><span id="__span-207-9"><a id="__codelineno-207-9" name="__codelineno-207-9" href="#__codelineno-207-9"></a>
</span><span id="__span-207-10"><a id="__codelineno-207-10" name="__codelineno-207-10" href="#__codelineno-207-10"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">lambda_proc</span><span class="o">.</span><span class="n">body</span> <span class="c1"># Remember that the body is a *list* of expressions!</span>
</span><span id="__span-207-11"><a id="__codelineno-207-11" name="__codelineno-207-11" href="#__codelineno-207-11"></a><span class="err">?</span> <span class="n">Pair</span><span class="p">(</span><span class="n">Pair</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">Pair</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">Pair</span><span class="p">(</span><span class="n">Pair</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">Pair</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">Pair</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">nil</span><span class="p">))),</span> <span class="n">nil</span><span class="p">))),</span> <span class="n">nil</span><span class="p">)</span>
</span><span id="__span-207-12"><a id="__codelineno-207-12" name="__codelineno-207-12" href="#__codelineno-207-12"></a><span class="o">--</span> <span class="n">OK</span><span class="err">!</span> <span class="o">--</span>
</span></code></pre></div>
<h3 id="6_4">6<a class="headerlink" href="#6_4" title="Permanent link">&para;</a></h3>
<p>Problem 10，这题不难，但我用循环迭代实现了之后，突然想到 <code>Pair</code> 有 <code>map</code> 方法，所以突发奇想想用 <code>map</code> 来实现(利用 <code>map</code> 来获取 <code>Pair</code> 中所有的元素)</p>
<details class="note">
<summary>code</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">实现一</label><label for="__tabbed_2_2">实现二</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-python highlight"><pre><span></span><code><span id="__span-208-1"><a id="__codelineno-208-1" name="__codelineno-208-1" href="#__codelineno-208-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Frame</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="__span-208-2"><a id="__codelineno-208-2" name="__codelineno-208-2" href="#__codelineno-208-2"></a>    <span class="o">...</span>
</span><span id="__span-208-3"><a id="__codelineno-208-3" name="__codelineno-208-3" href="#__codelineno-208-3"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">make_child_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formals</span><span class="p">,</span> <span class="n">vals</span><span class="p">):</span>
</span><span id="__span-208-4"><a id="__codelineno-208-4" name="__codelineno-208-4" href="#__codelineno-208-4"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">formals</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">):</span>
</span><span id="__span-208-5"><a id="__codelineno-208-5" name="__codelineno-208-5" href="#__codelineno-208-5"></a>            <span class="k">raise</span> <span class="n">SchemeError</span><span class="p">(</span><span class="s1">&#39;Incorrect number of arguments to function call&#39;</span><span class="p">)</span>
</span><span id="__span-208-6"><a id="__codelineno-208-6" name="__codelineno-208-6" href="#__codelineno-208-6"></a>        <span class="c1"># BEGIN PROBLEM 10</span>
</span><span id="__span-208-7"><a id="__codelineno-208-7" name="__codelineno-208-7" href="#__codelineno-208-7"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-208-8"><a id="__codelineno-208-8" name="__codelineno-208-8" href="#__codelineno-208-8"></a>        <span class="n">child</span> <span class="o">=</span> <span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-208-9"><a id="__codelineno-208-9" name="__codelineno-208-9" href="#__codelineno-208-9"></a>        <span class="k">while</span> <span class="n">formals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">nil</span><span class="p">:</span>
</span><span id="__span-208-10"><a id="__codelineno-208-10" name="__codelineno-208-10" href="#__codelineno-208-10"></a>            <span class="n">child</span><span class="o">.</span><span class="n">define</span><span class="p">(</span><span class="n">formals</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">vals</span><span class="o">.</span><span class="n">first</span><span class="p">)</span>
</span><span id="__span-208-11"><a id="__codelineno-208-11" name="__codelineno-208-11" href="#__codelineno-208-11"></a>            <span class="n">formals</span><span class="p">,</span> <span class="n">vals</span> <span class="o">=</span> <span class="n">formals</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span> <span class="n">vals</span><span class="o">.</span><span class="n">rest</span>
</span><span id="__span-208-12"><a id="__codelineno-208-12" name="__codelineno-208-12" href="#__codelineno-208-12"></a>        <span class="k">return</span> <span class="n">child</span>
</span><span id="__span-208-13"><a id="__codelineno-208-13" name="__codelineno-208-13" href="#__codelineno-208-13"></a>        <span class="c1"># END PROBLEM 10</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-python highlight"><pre><span></span><code><span id="__span-209-1"><a id="__codelineno-209-1" name="__codelineno-209-1" href="#__codelineno-209-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Frame</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="__span-209-2"><a id="__codelineno-209-2" name="__codelineno-209-2" href="#__codelineno-209-2"></a>    <span class="o">...</span>
</span><span id="__span-209-3"><a id="__codelineno-209-3" name="__codelineno-209-3" href="#__codelineno-209-3"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">make_child_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formals</span><span class="p">,</span> <span class="n">vals</span><span class="p">):</span>
</span><span id="__span-209-4"><a id="__codelineno-209-4" name="__codelineno-209-4" href="#__codelineno-209-4"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">formals</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">):</span>
</span><span id="__span-209-5"><a id="__codelineno-209-5" name="__codelineno-209-5" href="#__codelineno-209-5"></a>            <span class="k">raise</span> <span class="n">SchemeError</span><span class="p">(</span><span class="s1">&#39;Incorrect number of arguments to function call&#39;</span><span class="p">)</span>
</span><span id="__span-209-6"><a id="__codelineno-209-6" name="__codelineno-209-6" href="#__codelineno-209-6"></a>        <span class="c1"># BEGIN PROBLEM 10</span>
</span><span id="__span-209-7"><a id="__codelineno-209-7" name="__codelineno-209-7" href="#__codelineno-209-7"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-209-8"><a id="__codelineno-209-8" name="__codelineno-209-8" href="#__codelineno-209-8"></a>        <span class="n">child</span> <span class="o">=</span> <span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-209-9"><a id="__codelineno-209-9" name="__codelineno-209-9" href="#__codelineno-209-9"></a>        <span class="n">formals_list</span><span class="p">,</span> <span class="n">vals_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="__span-209-10"><a id="__codelineno-209-10" name="__codelineno-209-10" href="#__codelineno-209-10"></a>        <span class="n">formals</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">formals_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span><span id="__span-209-11"><a id="__codelineno-209-11" name="__codelineno-209-11" href="#__codelineno-209-11"></a>        <span class="n">vals</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">vals_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span><span id="__span-209-12"><a id="__codelineno-209-12" name="__codelineno-209-12" href="#__codelineno-209-12"></a>        <span class="k">for</span> <span class="n">formal</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">formals_list</span><span class="p">,</span> <span class="n">vals_list</span><span class="p">):</span>
</span><span id="__span-209-13"><a id="__codelineno-209-13" name="__codelineno-209-13" href="#__codelineno-209-13"></a>            <span class="n">child</span><span class="o">.</span><span class="n">define</span><span class="p">(</span><span class="n">formal</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
</span><span id="__span-209-14"><a id="__codelineno-209-14" name="__codelineno-209-14" href="#__codelineno-209-14"></a>        <span class="k">return</span> <span class="n">child</span>
</span><span id="__span-209-15"><a id="__codelineno-209-15" name="__codelineno-209-15" href="#__codelineno-209-15"></a>        <span class="c1"># END PROBLEM 10</span>
</span></code></pre></div>
</div>
</div>
</div>
</details>
<h3 id="7_3">7<a class="headerlink" href="#7_3" title="Permanent link">&para;</a></h3>
<p>Problem 13不算复杂，但我写出来之后，报了一个错误</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-210-1"><a id="__codelineno-210-1" name="__codelineno-210-1" href="#__codelineno-210-1"></a><span class="n">scm</span><span class="o">&gt;</span> <span class="p">(</span><span class="n">cond</span> <span class="p">((</span><span class="o">=</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)</span> <span class="n">nil</span><span class="p">))</span>
</span><span id="__span-210-2"><a id="__codelineno-210-2" name="__codelineno-210-2" href="#__codelineno-210-2"></a><span class="c1"># Error: unknown identifier: nil</span>
</span><span id="__span-210-3"><a id="__codelineno-210-3" name="__codelineno-210-3" href="#__codelineno-210-3"></a>
</span><span id="__span-210-4"><a id="__codelineno-210-4" name="__codelineno-210-4" href="#__codelineno-210-4"></a><span class="c1"># Error: expected</span>
</span><span id="__span-210-5"><a id="__codelineno-210-5" name="__codelineno-210-5" href="#__codelineno-210-5"></a><span class="c1">#     ()</span>
</span><span id="__span-210-6"><a id="__codelineno-210-6" name="__codelineno-210-6" href="#__codelineno-210-6"></a><span class="c1"># but got</span>
</span><span id="__span-210-7"><a id="__codelineno-210-7" name="__codelineno-210-7" href="#__codelineno-210-7"></a><span class="c1">#     Traceback (most recent call last):</span>
</span><span id="__span-210-8"><a id="__codelineno-210-8" name="__codelineno-210-8" href="#__codelineno-210-8"></a><span class="c1">#       ...</span>
</span><span id="__span-210-9"><a id="__codelineno-210-9" name="__codelineno-210-9" href="#__codelineno-210-9"></a><span class="c1">#     SchemeError: unknown identifier: nil</span>
</span></code></pre></div>
<p>经过修改代码来查看错误地方的相关信息，进行到错误发生的地方前，打印 <code>clause.rest</code> 显示 <code>Pair('nil', nil)</code> ，这意味着是<strong>在读取的时候没有读取正确</strong>，于是回头查看Problem 1的 <code>scheme_read</code> 和 <code>read_tail</code> ，</p>
<p>而 <code>scheme_read</code> 中是有处理 <code>'nil'</code> 的相关代码的</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-211-1"><a id="__codelineno-211-1" name="__codelineno-211-1" href="#__codelineno-211-1"></a><span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="s1">&#39;nil&#39;</span><span class="p">:</span>
</span><span id="__span-211-2"><a id="__codelineno-211-2" name="__codelineno-211-2" href="#__codelineno-211-2"></a>    <span class="c1"># BEGIN PROBLEM 1</span>
</span><span id="__span-211-3"><a id="__codelineno-211-3" name="__codelineno-211-3" href="#__codelineno-211-3"></a>    <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-211-4"><a id="__codelineno-211-4" name="__codelineno-211-4" href="#__codelineno-211-4"></a>    <span class="k">return</span> <span class="n">nil</span>
</span><span id="__span-211-5"><a id="__codelineno-211-5" name="__codelineno-211-5" href="#__codelineno-211-5"></a>    <span class="c1"># END PROBLEM 1</span>
</span></code></pre></div>
<p>尝试直接运行scheme解释器进行测试</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-212-1"><a id="__codelineno-212-1" name="__codelineno-212-1" href="#__codelineno-212-1"></a>python<span class="w"> </span>scheme.py
</span></code></pre></div>
<p>发现直接输入 <code>nil</code> 时，能正确输出成空链表 <code>()</code> ，而<strong>当 <code>nil</code> 被嵌套包含时，就不能被正常转换</strong>，所以错误发生在 <code>read_tail</code> 中，</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-213-1"><a id="__codelineno-213-1" name="__codelineno-213-1" href="#__codelineno-213-1"></a><span class="nv">scm&gt;</span><span class="w"> </span><span class="nv">nil</span>
</span><span id="__span-213-2"><a id="__codelineno-213-2" name="__codelineno-213-2" href="#__codelineno-213-2"></a><span class="p">()</span>
</span><span id="__span-213-3"><a id="__codelineno-213-3" name="__codelineno-213-3" href="#__codelineno-213-3"></a><span class="nv">scm&gt;</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="nv">nil</span><span class="p">)</span>
</span><span id="__span-213-4"><a id="__codelineno-213-4" name="__codelineno-213-4" href="#__codelineno-213-4"></a><span class="nv">Error:</span><span class="w"> </span><span class="nv">unknown</span><span class="w"> </span><span class="nv">identifier:</span><span class="w"> </span><span class="nv">nil</span>
</span></code></pre></div>
<p>于是重新回去理解题目的说明</p>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p><code>read_tail</code>:</p>
<ul>
<li>If there are no more tokens, then the list is missing a close parenthesis and we should raise an error. <strong>(provided)</strong></li>
<li>If the token is <code>)</code>, then we've reached the end of the list or pair. <strong>Remove this token from the buffer</strong> and return the <code>nil</code> object.</li>
<li>If none of the above cases apply, the next token is the operator in a combination, e.g. src contains <code>+ 2 3)</code>. To parse this:<ol>
<li><code>scheme_read</code> the next complete expression in the buffer.</li>
<li>Call <code>read_tail</code> to read the rest of the combination until the matching closing parenthesis.</li>
<li>Return the results as a <code>Pair</code> instance, where the first element is the next complete expression from (1) and the second element is the rest of the combination from (2).</li>
</ol>
</li>
</ul>
</div>
<p>三个情况刚好对应所给的代码框架中的 <code>if-elif-else</code> 的三块代码，因此，根据题目的意思， <code>else</code> 处的代码应该为</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-214-1"><a id="__codelineno-214-1" name="__codelineno-214-1" href="#__codelineno-214-1"></a><span class="k">return</span> <span class="n">Pair</span><span class="p">(</span><span class="n">scheme_read</span><span class="p">(</span><span class="n">src</span><span class="p">),</span> <span class="n">read_tail</span><span class="p">(</span><span class="n">src</span><span class="p">))</span>
</span></code></pre></div>
<p>测试Problem 1通过，再测试Problem 13，终于通过了😇</p>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-215-1"><a id="__codelineno-215-1" name="__codelineno-215-1" href="#__codelineno-215-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">do_cond_form</span><span class="p">(</span><span class="n">expressions</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
</span><span id="__span-215-2"><a id="__codelineno-215-2" name="__codelineno-215-2" href="#__codelineno-215-2"></a>    <span class="k">while</span> <span class="n">expressions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">nil</span><span class="p">:</span>
</span><span id="__span-215-3"><a id="__codelineno-215-3" name="__codelineno-215-3" href="#__codelineno-215-3"></a>        <span class="n">clause</span> <span class="o">=</span> <span class="n">expressions</span><span class="o">.</span><span class="n">first</span>
</span><span id="__span-215-4"><a id="__codelineno-215-4" name="__codelineno-215-4" href="#__codelineno-215-4"></a>        <span class="n">validate_form</span><span class="p">(</span><span class="n">clause</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-215-5"><a id="__codelineno-215-5" name="__codelineno-215-5" href="#__codelineno-215-5"></a>        <span class="k">if</span> <span class="n">clause</span><span class="o">.</span><span class="n">first</span> <span class="o">==</span> <span class="s1">&#39;else&#39;</span><span class="p">:</span>
</span><span id="__span-215-6"><a id="__codelineno-215-6" name="__codelineno-215-6" href="#__codelineno-215-6"></a>            <span class="n">test</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-215-7"><a id="__codelineno-215-7" name="__codelineno-215-7" href="#__codelineno-215-7"></a>            <span class="k">if</span> <span class="n">expressions</span><span class="o">.</span><span class="n">rest</span> <span class="o">!=</span> <span class="n">nil</span><span class="p">:</span>
</span><span id="__span-215-8"><a id="__codelineno-215-8" name="__codelineno-215-8" href="#__codelineno-215-8"></a>                <span class="k">raise</span> <span class="n">SchemeError</span><span class="p">(</span><span class="s1">&#39;else must be last&#39;</span><span class="p">)</span>
</span><span id="__span-215-9"><a id="__codelineno-215-9" name="__codelineno-215-9" href="#__codelineno-215-9"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-215-10"><a id="__codelineno-215-10" name="__codelineno-215-10" href="#__codelineno-215-10"></a>            <span class="n">test</span> <span class="o">=</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">clause</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-215-11"><a id="__codelineno-215-11" name="__codelineno-215-11" href="#__codelineno-215-11"></a>        <span class="k">if</span> <span class="n">is_true_primitive</span><span class="p">(</span><span class="n">test</span><span class="p">):</span>
</span><span id="__span-215-12"><a id="__codelineno-215-12" name="__codelineno-215-12" href="#__codelineno-215-12"></a>            <span class="c1"># BEGIN PROBLEM 13</span>
</span><span id="__span-215-13"><a id="__codelineno-215-13" name="__codelineno-215-13" href="#__codelineno-215-13"></a>            <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-215-14"><a id="__codelineno-215-14" name="__codelineno-215-14" href="#__codelineno-215-14"></a>            <span class="k">if</span> <span class="n">clause</span><span class="o">.</span><span class="n">rest</span> <span class="ow">is</span> <span class="n">nil</span><span class="p">:</span>
</span><span id="__span-215-15"><a id="__codelineno-215-15" name="__codelineno-215-15" href="#__codelineno-215-15"></a>                <span class="k">return</span> <span class="n">test</span>
</span><span id="__span-215-16"><a id="__codelineno-215-16" name="__codelineno-215-16" href="#__codelineno-215-16"></a>            <span class="k">return</span> <span class="n">eval_all</span><span class="p">(</span><span class="n">clause</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-215-17"><a id="__codelineno-215-17" name="__codelineno-215-17" href="#__codelineno-215-17"></a>            <span class="c1"># END PROBLEM 13</span>
</span><span id="__span-215-18"><a id="__codelineno-215-18" name="__codelineno-215-18" href="#__codelineno-215-18"></a>        <span class="n">expressions</span> <span class="o">=</span> <span class="n">expressions</span><span class="o">.</span><span class="n">rest</span>
</span></code></pre></div>
</details>
<h3 id="8_2">8<a class="headerlink" href="#8_2" title="Permanent link">&para;</a></h3>
<p>Problem 14中，需要注意 有可能要被赋值的符号对应的是一个表达式，所以需要进行<em>求值</em></p>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-216-1"><a id="__codelineno-216-1" name="__codelineno-216-1" href="#__codelineno-216-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_let_frame</span><span class="p">(</span><span class="n">bindings</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
</span><span id="__span-216-2"><a id="__codelineno-216-2" name="__codelineno-216-2" href="#__codelineno-216-2"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">scheme_listp</span><span class="p">(</span><span class="n">bindings</span><span class="p">):</span>
</span><span id="__span-216-3"><a id="__codelineno-216-3" name="__codelineno-216-3" href="#__codelineno-216-3"></a>        <span class="k">raise</span> <span class="n">SchemeError</span><span class="p">(</span><span class="s1">&#39;bad bindings list in let form&#39;</span><span class="p">)</span>
</span><span id="__span-216-4"><a id="__codelineno-216-4" name="__codelineno-216-4" href="#__codelineno-216-4"></a>    <span class="n">names</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="n">nil</span><span class="p">,</span> <span class="n">nil</span>
</span><span id="__span-216-5"><a id="__codelineno-216-5" name="__codelineno-216-5" href="#__codelineno-216-5"></a>    <span class="c1"># BEGIN PROBLEM 14</span>
</span><span id="__span-216-6"><a id="__codelineno-216-6" name="__codelineno-216-6" href="#__codelineno-216-6"></a>    <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-216-7"><a id="__codelineno-216-7" name="__codelineno-216-7" href="#__codelineno-216-7"></a>    <span class="k">while</span> <span class="n">bindings</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">nil</span><span class="p">:</span>
</span><span id="__span-216-8"><a id="__codelineno-216-8" name="__codelineno-216-8" href="#__codelineno-216-8"></a>        <span class="n">binding</span> <span class="o">=</span> <span class="n">bindings</span><span class="o">.</span><span class="n">first</span>
</span><span id="__span-216-9"><a id="__codelineno-216-9" name="__codelineno-216-9" href="#__codelineno-216-9"></a>        <span class="n">validate_form</span><span class="p">(</span><span class="n">binding</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="__span-216-10"><a id="__codelineno-216-10" name="__codelineno-216-10" href="#__codelineno-216-10"></a>        <span class="n">names</span> <span class="o">=</span> <span class="n">Pair</span><span class="p">(</span><span class="n">binding</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>
</span><span id="__span-216-11"><a id="__codelineno-216-11" name="__codelineno-216-11" href="#__codelineno-216-11"></a>        <span class="n">values</span> <span class="o">=</span> <span class="n">Pair</span><span class="p">(</span><span class="n">scheme_eval</span><span class="p">(</span><span class="n">binding</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">),</span> <span class="n">values</span><span class="p">)</span>
</span><span id="__span-216-12"><a id="__codelineno-216-12" name="__codelineno-216-12" href="#__codelineno-216-12"></a>        <span class="n">bindings</span> <span class="o">=</span> <span class="n">bindings</span><span class="o">.</span><span class="n">rest</span>
</span><span id="__span-216-13"><a id="__codelineno-216-13" name="__codelineno-216-13" href="#__codelineno-216-13"></a>    <span class="n">validate_formals</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
</span><span id="__span-216-14"><a id="__codelineno-216-14" name="__codelineno-216-14" href="#__codelineno-216-14"></a>    <span class="c1"># END PROBLEM 14</span>
</span><span id="__span-216-15"><a id="__codelineno-216-15" name="__codelineno-216-15" href="#__codelineno-216-15"></a>    <span class="k">return</span> <span class="n">env</span><span class="o">.</span><span class="n">make_child_frame</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
</span></code></pre></div>
</details>
<h3 id="9_2">9<a class="headerlink" href="#9_2" title="Permanent link">&para;</a></h3>
<p>Problem 16感觉蛮有意思</p>
<details class="note">
<summary>code</summary>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-217-1"><a id="__codelineno-217-1" name="__codelineno-217-1" href="#__codelineno-217-1"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nb">merge</span><span class="w"> </span><span class="nv">comp</span><span class="w"> </span><span class="nv">list1</span><span class="w"> </span><span class="nv">list2</span><span class="p">)</span>
</span><span id="__span-217-2"><a id="__codelineno-217-2" name="__codelineno-217-2" href="#__codelineno-217-2"></a><span class="w">  </span><span class="c1">; BEGIN PROBLEM 16</span>
</span><span id="__span-217-3"><a id="__codelineno-217-3" name="__codelineno-217-3" href="#__codelineno-217-3"></a><span class="w">  </span><span class="ss">&#39;replace-this-line</span>
</span><span id="__span-217-4"><a id="__codelineno-217-4" name="__codelineno-217-4" href="#__codelineno-217-4"></a><span class="w">  </span><span class="p">(</span><span class="k">cond</span><span class="w"> </span><span class="p">((</span><span class="nb">equal?</span><span class="w"> </span><span class="nv">list1</span><span class="w"> </span><span class="nv">nil</span><span class="p">)</span><span class="w"> </span><span class="nv">list2</span><span class="p">)</span>
</span><span id="__span-217-5"><a id="__codelineno-217-5" name="__codelineno-217-5" href="#__codelineno-217-5"></a><span class="w">        </span><span class="p">((</span><span class="nb">equal?</span><span class="w"> </span><span class="nv">list2</span><span class="w"> </span><span class="nv">nil</span><span class="p">)</span><span class="w"> </span><span class="nv">list1</span><span class="p">)</span>
</span><span id="__span-217-6"><a id="__codelineno-217-6" name="__codelineno-217-6" href="#__codelineno-217-6"></a><span class="w">        </span><span class="p">(</span><span class="k">else</span><span class="w"> </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nf">x</span><span class="w"> </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="nv">list1</span><span class="p">))</span><span class="w"> </span><span class="p">(</span><span class="nf">y</span><span class="w"> </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="nv">list2</span><span class="p">)))</span>
</span><span id="__span-217-7"><a id="__codelineno-217-7" name="__codelineno-217-7" href="#__codelineno-217-7"></a><span class="w">                   </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nf">comp</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="p">)</span>
</span><span id="__span-217-8"><a id="__codelineno-217-8" name="__codelineno-217-8" href="#__codelineno-217-8"></a><span class="w">                       </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="p">(</span><span class="nb">merge</span><span class="w"> </span><span class="nv">comp</span><span class="w"> </span><span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="nv">list1</span><span class="p">)</span><span class="w"> </span><span class="nv">list2</span><span class="p">))</span>
</span><span id="__span-217-9"><a id="__codelineno-217-9" name="__codelineno-217-9" href="#__codelineno-217-9"></a><span class="w">                       </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="p">(</span><span class="nb">merge</span><span class="w"> </span><span class="nv">comp</span><span class="w"> </span><span class="nv">list1</span><span class="w"> </span><span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="nv">list2</span><span class="p">)))))))</span>
</span><span id="__span-217-10"><a id="__codelineno-217-10" name="__codelineno-217-10" href="#__codelineno-217-10"></a><span class="w">  </span><span class="p">)</span>
</span><span id="__span-217-11"><a id="__codelineno-217-11" name="__codelineno-217-11" href="#__codelineno-217-11"></a><span class="w">  </span><span class="c1">; END PROBLEM 16</span>
</span></code></pre></div>
</details>
<hr />
<p>Problem 17代码有点绕(难写，debug起来也痛苦😅)</p>
<details class="note">
<summary>code</summary>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-218-1"><a id="__codelineno-218-1" name="__codelineno-218-1" href="#__codelineno-218-1"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">nondecreaselist</span><span class="w"> </span><span class="nv">s</span><span class="p">)</span>
</span><span id="__span-218-2"><a id="__codelineno-218-2" name="__codelineno-218-2" href="#__codelineno-218-2"></a><span class="w">    </span><span class="c1">; BEGIN PROBLEM 17</span>
</span><span id="__span-218-3"><a id="__codelineno-218-3" name="__codelineno-218-3" href="#__codelineno-218-3"></a><span class="w">    </span><span class="ss">&#39;replace-this-line</span>
</span><span id="__span-218-4"><a id="__codelineno-218-4" name="__codelineno-218-4" href="#__codelineno-218-4"></a><span class="w">    </span><span class="p">(</span><span class="k">cond</span><span class="w"> </span><span class="p">((</span><span class="nb">equal?</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="nv">nil</span><span class="p">)</span><span class="w"> </span><span class="nv">nil</span><span class="p">)</span>
</span><span id="__span-218-5"><a id="__codelineno-218-5" name="__codelineno-218-5" href="#__codelineno-218-5"></a><span class="w">          </span><span class="p">((</span><span class="nb">equal?</span><span class="w"> </span><span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="nv">s</span><span class="p">)</span><span class="w"> </span><span class="nv">nil</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="nv">s</span><span class="p">))</span>
</span><span id="__span-218-6"><a id="__codelineno-218-6" name="__codelineno-218-6" href="#__codelineno-218-6"></a><span class="w">          </span><span class="p">((</span><span class="nb">&gt;</span><span class="w"> </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="nv">s</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">cadr</span><span class="w"> </span><span class="nv">s</span><span class="p">))</span><span class="w"> </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="nv">s</span><span class="p">))</span><span class="w"> </span><span class="p">(</span><span class="nf">nondecreaselist</span><span class="w"> </span><span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="nv">s</span><span class="p">))))</span>
</span><span id="__span-218-7"><a id="__codelineno-218-7" name="__codelineno-218-7" href="#__codelineno-218-7"></a><span class="w">          </span><span class="p">(</span><span class="k">else</span><span class="w"> </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nf">rest</span><span class="w"> </span><span class="p">(</span><span class="nf">nondecreaselist</span><span class="w"> </span><span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="nv">s</span><span class="p">))))</span>
</span><span id="__span-218-8"><a id="__codelineno-218-8" name="__codelineno-218-8" href="#__codelineno-218-8"></a><span class="w">                     </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="nv">s</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="nv">rest</span><span class="p">))</span><span class="w"> </span><span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="nv">rest</span><span class="p">)))))</span>
</span><span id="__span-218-9"><a id="__codelineno-218-9" name="__codelineno-218-9" href="#__codelineno-218-9"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-218-10"><a id="__codelineno-218-10" name="__codelineno-218-10" href="#__codelineno-218-10"></a><span class="w">    </span><span class="c1">; END PROBLEM 17</span>
</span></code></pre></div>
</details>
<h3 id="10_2">10<a class="headerlink" href="#10_2" title="Permanent link">&para;</a></h3>
<p>Extra Credit，这题有点难度😅(依次修改了好几次最终才全部通过)，</p>
<p>一开始我写出来</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-219-1"><a id="__codelineno-219-1" name="__codelineno-219-1" href="#__codelineno-219-1"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">let-to-lambda</span><span class="w"> </span><span class="nv">expr</span><span class="p">)</span>
</span><span id="__span-219-2"><a id="__codelineno-219-2" name="__codelineno-219-2" href="#__codelineno-219-2"></a><span class="w">  </span><span class="p">(</span><span class="k">cond</span><span class="w"> </span><span class="p">((</span><span class="nf">atom?</span><span class="w"> </span><span class="nv">expr</span><span class="p">)</span>
</span><span id="__span-219-3"><a id="__codelineno-219-3" name="__codelineno-219-3" href="#__codelineno-219-3"></a><span class="w">         </span><span class="c1">; BEGIN PROBLEM EC</span>
</span><span id="__span-219-4"><a id="__codelineno-219-4" name="__codelineno-219-4" href="#__codelineno-219-4"></a><span class="w">         </span><span class="ss">&#39;replace-this-line</span>
</span><span id="__span-219-5"><a id="__codelineno-219-5" name="__codelineno-219-5" href="#__codelineno-219-5"></a><span class="w">         </span><span class="nv">expr</span>
</span><span id="__span-219-6"><a id="__codelineno-219-6" name="__codelineno-219-6" href="#__codelineno-219-6"></a><span class="w">         </span><span class="c1">; END PROBLEM EC</span>
</span><span id="__span-219-7"><a id="__codelineno-219-7" name="__codelineno-219-7" href="#__codelineno-219-7"></a><span class="w">         </span><span class="p">)</span>
</span><span id="__span-219-8"><a id="__codelineno-219-8" name="__codelineno-219-8" href="#__codelineno-219-8"></a><span class="w">        </span><span class="p">((</span><span class="nf">quoted?</span><span class="w"> </span><span class="nv">expr</span><span class="p">)</span>
</span><span id="__span-219-9"><a id="__codelineno-219-9" name="__codelineno-219-9" href="#__codelineno-219-9"></a><span class="w">         </span><span class="c1">; BEGIN PROBLEM EC</span>
</span><span id="__span-219-10"><a id="__codelineno-219-10" name="__codelineno-219-10" href="#__codelineno-219-10"></a><span class="w">         </span><span class="ss">&#39;replace-this-line</span>
</span><span id="__span-219-11"><a id="__codelineno-219-11" name="__codelineno-219-11" href="#__codelineno-219-11"></a><span class="w">         </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="ss">&#39;quote</span><span class="w"> </span><span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="nv">expr</span><span class="p">))</span>
</span><span id="__span-219-12"><a id="__codelineno-219-12" name="__codelineno-219-12" href="#__codelineno-219-12"></a><span class="w">         </span><span class="c1">; END PROBLEM EC</span>
</span><span id="__span-219-13"><a id="__codelineno-219-13" name="__codelineno-219-13" href="#__codelineno-219-13"></a><span class="w">         </span><span class="p">)</span>
</span><span id="__span-219-14"><a id="__codelineno-219-14" name="__codelineno-219-14" href="#__codelineno-219-14"></a><span class="w">        </span><span class="p">((</span><span class="k">or</span><span class="w"> </span><span class="p">(</span><span class="nf">lambda?</span><span class="w"> </span><span class="nv">expr</span><span class="p">)</span>
</span><span id="__span-219-15"><a id="__codelineno-219-15" name="__codelineno-219-15" href="#__codelineno-219-15"></a><span class="w">             </span><span class="p">(</span><span class="nf">define?</span><span class="w"> </span><span class="nv">expr</span><span class="p">))</span>
</span><span id="__span-219-16"><a id="__codelineno-219-16" name="__codelineno-219-16" href="#__codelineno-219-16"></a><span class="w">         </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nf">form</span><span class="w">   </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="nv">expr</span><span class="p">))</span>
</span><span id="__span-219-17"><a id="__codelineno-219-17" name="__codelineno-219-17" href="#__codelineno-219-17"></a><span class="w">               </span><span class="p">(</span><span class="nf">params</span><span class="w"> </span><span class="p">(</span><span class="nb">cadr</span><span class="w"> </span><span class="nv">expr</span><span class="p">))</span>
</span><span id="__span-219-18"><a id="__codelineno-219-18" name="__codelineno-219-18" href="#__codelineno-219-18"></a><span class="w">               </span><span class="p">(</span><span class="nf">body</span><span class="w">   </span><span class="p">(</span><span class="nb">cddr</span><span class="w"> </span><span class="nv">expr</span><span class="p">)))</span>
</span><span id="__span-219-19"><a id="__codelineno-219-19" name="__codelineno-219-19" href="#__codelineno-219-19"></a><span class="w">           </span><span class="c1">; BEGIN PROBLEM EC</span>
</span><span id="__span-219-20"><a id="__codelineno-219-20" name="__codelineno-219-20" href="#__codelineno-219-20"></a><span class="w">           </span><span class="ss">&#39;replace-this-line</span>
</span><span id="__span-219-21"><a id="__codelineno-219-21" name="__codelineno-219-21" href="#__codelineno-219-21"></a><span class="w">           </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="nv">form</span><span class="w"> </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="nv">params</span><span class="w"> </span><span class="nv">body</span><span class="p">))</span>
</span><span id="__span-219-22"><a id="__codelineno-219-22" name="__codelineno-219-22" href="#__codelineno-219-22"></a><span class="w">           </span><span class="c1">; END PROBLEM EC</span>
</span><span id="__span-219-23"><a id="__codelineno-219-23" name="__codelineno-219-23" href="#__codelineno-219-23"></a><span class="w">           </span><span class="p">))</span>
</span><span id="__span-219-24"><a id="__codelineno-219-24" name="__codelineno-219-24" href="#__codelineno-219-24"></a><span class="w">        </span><span class="p">((</span><span class="nf">let?</span><span class="w"> </span><span class="nv">expr</span><span class="p">)</span>
</span><span id="__span-219-25"><a id="__codelineno-219-25" name="__codelineno-219-25" href="#__codelineno-219-25"></a><span class="w">         </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nb">values</span><span class="w"> </span><span class="p">(</span><span class="nb">cadr</span><span class="w"> </span><span class="nv">expr</span><span class="p">))</span>
</span><span id="__span-219-26"><a id="__codelineno-219-26" name="__codelineno-219-26" href="#__codelineno-219-26"></a><span class="w">               </span><span class="p">(</span><span class="nf">body</span><span class="w">   </span><span class="p">(</span><span class="nb">cddr</span><span class="w"> </span><span class="nv">expr</span><span class="p">)))</span>
</span><span id="__span-219-27"><a id="__codelineno-219-27" name="__codelineno-219-27" href="#__codelineno-219-27"></a><span class="w">           </span><span class="c1">; BEGIN PROBLEM EC</span>
</span><span id="__span-219-28"><a id="__codelineno-219-28" name="__codelineno-219-28" href="#__codelineno-219-28"></a><span class="w">           </span><span class="ss">&#39;replace-this-line</span>
</span><span id="__span-219-29"><a id="__codelineno-219-29" name="__codelineno-219-29" href="#__codelineno-219-29"></a><span class="w">           </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nb">values</span><span class="w"> </span><span class="p">(</span><span class="nb">zip</span><span class="w"> </span><span class="nb">values</span><span class="p">)))</span>
</span><span id="__span-219-30"><a id="__codelineno-219-30" name="__codelineno-219-30" href="#__codelineno-219-30"></a><span class="w">                </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="ss">&#39;lambda</span><span class="w"> </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="nb">values</span><span class="p">)</span><span class="w"> </span><span class="nv">body</span><span class="p">))</span><span class="w"> </span><span class="p">(</span><span class="nb">cadr</span><span class="w"> </span><span class="nb">values</span><span class="p">)))</span>
</span><span id="__span-219-31"><a id="__codelineno-219-31" name="__codelineno-219-31" href="#__codelineno-219-31"></a><span class="w">           </span><span class="c1">; END PROBLEM EC</span>
</span><span id="__span-219-32"><a id="__codelineno-219-32" name="__codelineno-219-32" href="#__codelineno-219-32"></a><span class="w">           </span><span class="p">))</span>
</span><span id="__span-219-33"><a id="__codelineno-219-33" name="__codelineno-219-33" href="#__codelineno-219-33"></a><span class="w">        </span><span class="p">(</span><span class="k">else</span>
</span><span id="__span-219-34"><a id="__codelineno-219-34" name="__codelineno-219-34" href="#__codelineno-219-34"></a><span class="w">         </span><span class="c1">; BEGIN PROBLEM EC</span>
</span><span id="__span-219-35"><a id="__codelineno-219-35" name="__codelineno-219-35" href="#__codelineno-219-35"></a><span class="w">         </span><span class="ss">&#39;replace-this-line</span>
</span><span id="__span-219-36"><a id="__codelineno-219-36" name="__codelineno-219-36" href="#__codelineno-219-36"></a><span class="w">         </span><span class="nv">expr</span>
</span><span id="__span-219-37"><a id="__codelineno-219-37" name="__codelineno-219-37" href="#__codelineno-219-37"></a><span class="w">         </span><span class="c1">; END PROBLEM EC</span>
</span><span id="__span-219-38"><a id="__codelineno-219-38" name="__codelineno-219-38" href="#__codelineno-219-38"></a><span class="w">         </span><span class="p">)))</span>
</span></code></pre></div>
<p>然后根据测试用例的错误，发现还需要递归地应用表达式，依次发现4个地方需要递归：</p>
<ul>
<li><code>(cons form (cons params body))</code> 的 <code>body</code> </li>
<li><code>(cons (cons 'lambda (cons (car values) body)) (cadr values)))</code> 的 <code>body</code> 和 <code>(cadr values)</code> </li>
<li>最后的 <code>expr</code></li>
</ul>
<p>并且由于是很多个表达式，所以需要用到 <code>map</code> 函数</p>
<details class="note">
<summary>code</summary>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-220-1"><a id="__codelineno-220-1" name="__codelineno-220-1" href="#__codelineno-220-1"></a><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">let-to-lambda</span><span class="w"> </span><span class="nv">expr</span><span class="p">)</span>
</span><span id="__span-220-2"><a id="__codelineno-220-2" name="__codelineno-220-2" href="#__codelineno-220-2"></a><span class="w">  </span><span class="p">(</span><span class="k">cond</span><span class="w"> </span><span class="p">((</span><span class="nf">atom?</span><span class="w"> </span><span class="nv">expr</span><span class="p">)</span>
</span><span id="__span-220-3"><a id="__codelineno-220-3" name="__codelineno-220-3" href="#__codelineno-220-3"></a><span class="w">         </span><span class="c1">; BEGIN PROBLEM EC</span>
</span><span id="__span-220-4"><a id="__codelineno-220-4" name="__codelineno-220-4" href="#__codelineno-220-4"></a><span class="w">         </span><span class="ss">&#39;replace-this-line</span>
</span><span id="__span-220-5"><a id="__codelineno-220-5" name="__codelineno-220-5" href="#__codelineno-220-5"></a><span class="w">         </span><span class="nv">expr</span>
</span><span id="__span-220-6"><a id="__codelineno-220-6" name="__codelineno-220-6" href="#__codelineno-220-6"></a><span class="w">         </span><span class="c1">; END PROBLEM EC</span>
</span><span id="__span-220-7"><a id="__codelineno-220-7" name="__codelineno-220-7" href="#__codelineno-220-7"></a><span class="w">         </span><span class="p">)</span>
</span><span id="__span-220-8"><a id="__codelineno-220-8" name="__codelineno-220-8" href="#__codelineno-220-8"></a><span class="w">        </span><span class="p">((</span><span class="nf">quoted?</span><span class="w"> </span><span class="nv">expr</span><span class="p">)</span>
</span><span id="__span-220-9"><a id="__codelineno-220-9" name="__codelineno-220-9" href="#__codelineno-220-9"></a><span class="w">         </span><span class="c1">; BEGIN PROBLEM EC</span>
</span><span id="__span-220-10"><a id="__codelineno-220-10" name="__codelineno-220-10" href="#__codelineno-220-10"></a><span class="w">         </span><span class="ss">&#39;replace-this-line</span>
</span><span id="__span-220-11"><a id="__codelineno-220-11" name="__codelineno-220-11" href="#__codelineno-220-11"></a><span class="w">         </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="ss">&#39;quote</span><span class="w"> </span><span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="nv">expr</span><span class="p">))</span>
</span><span id="__span-220-12"><a id="__codelineno-220-12" name="__codelineno-220-12" href="#__codelineno-220-12"></a><span class="w">         </span><span class="c1">; END PROBLEM EC</span>
</span><span id="__span-220-13"><a id="__codelineno-220-13" name="__codelineno-220-13" href="#__codelineno-220-13"></a><span class="w">         </span><span class="p">)</span>
</span><span id="__span-220-14"><a id="__codelineno-220-14" name="__codelineno-220-14" href="#__codelineno-220-14"></a><span class="w">        </span><span class="p">((</span><span class="k">or</span><span class="w"> </span><span class="p">(</span><span class="nf">lambda?</span><span class="w"> </span><span class="nv">expr</span><span class="p">)</span>
</span><span id="__span-220-15"><a id="__codelineno-220-15" name="__codelineno-220-15" href="#__codelineno-220-15"></a><span class="w">             </span><span class="p">(</span><span class="nf">define?</span><span class="w"> </span><span class="nv">expr</span><span class="p">))</span>
</span><span id="__span-220-16"><a id="__codelineno-220-16" name="__codelineno-220-16" href="#__codelineno-220-16"></a><span class="w">         </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nf">form</span><span class="w">   </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="nv">expr</span><span class="p">))</span>
</span><span id="__span-220-17"><a id="__codelineno-220-17" name="__codelineno-220-17" href="#__codelineno-220-17"></a><span class="w">               </span><span class="p">(</span><span class="nf">params</span><span class="w"> </span><span class="p">(</span><span class="nb">cadr</span><span class="w"> </span><span class="nv">expr</span><span class="p">))</span>
</span><span id="__span-220-18"><a id="__codelineno-220-18" name="__codelineno-220-18" href="#__codelineno-220-18"></a><span class="w">               </span><span class="p">(</span><span class="nf">body</span><span class="w">   </span><span class="p">(</span><span class="nb">cddr</span><span class="w"> </span><span class="nv">expr</span><span class="p">)))</span>
</span><span id="__span-220-19"><a id="__codelineno-220-19" name="__codelineno-220-19" href="#__codelineno-220-19"></a><span class="w">           </span><span class="c1">; BEGIN PROBLEM EC</span>
</span><span id="__span-220-20"><a id="__codelineno-220-20" name="__codelineno-220-20" href="#__codelineno-220-20"></a><span class="w">           </span><span class="ss">&#39;replace-this-line</span>
</span><span id="__span-220-21"><a id="__codelineno-220-21" name="__codelineno-220-21" href="#__codelineno-220-21"></a><span class="w">           </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="nv">form</span><span class="w"> </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="nv">params</span><span class="w"> </span><span class="p">(</span><span class="nb">map</span><span class="w"> </span><span class="nv">let-to-lambda</span><span class="w"> </span><span class="nv">body</span><span class="p">)))</span>
</span><span id="__span-220-22"><a id="__codelineno-220-22" name="__codelineno-220-22" href="#__codelineno-220-22"></a><span class="w">           </span><span class="c1">; END PROBLEM EC</span>
</span><span id="__span-220-23"><a id="__codelineno-220-23" name="__codelineno-220-23" href="#__codelineno-220-23"></a><span class="w">           </span><span class="p">))</span>
</span><span id="__span-220-24"><a id="__codelineno-220-24" name="__codelineno-220-24" href="#__codelineno-220-24"></a><span class="w">        </span><span class="p">((</span><span class="nf">let?</span><span class="w"> </span><span class="nv">expr</span><span class="p">)</span>
</span><span id="__span-220-25"><a id="__codelineno-220-25" name="__codelineno-220-25" href="#__codelineno-220-25"></a><span class="w">         </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nb">values</span><span class="w"> </span><span class="p">(</span><span class="nb">cadr</span><span class="w"> </span><span class="nv">expr</span><span class="p">))</span>
</span><span id="__span-220-26"><a id="__codelineno-220-26" name="__codelineno-220-26" href="#__codelineno-220-26"></a><span class="w">               </span><span class="p">(</span><span class="nf">body</span><span class="w">   </span><span class="p">(</span><span class="nb">cddr</span><span class="w"> </span><span class="nv">expr</span><span class="p">)))</span>
</span><span id="__span-220-27"><a id="__codelineno-220-27" name="__codelineno-220-27" href="#__codelineno-220-27"></a><span class="w">           </span><span class="c1">; BEGIN PROBLEM EC</span>
</span><span id="__span-220-28"><a id="__codelineno-220-28" name="__codelineno-220-28" href="#__codelineno-220-28"></a><span class="w">           </span><span class="ss">&#39;replace-this-line</span>
</span><span id="__span-220-29"><a id="__codelineno-220-29" name="__codelineno-220-29" href="#__codelineno-220-29"></a><span class="w">           </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nb">values</span><span class="w"> </span><span class="p">(</span><span class="nb">zip</span><span class="w"> </span><span class="nb">values</span><span class="p">)))</span>
</span><span id="__span-220-30"><a id="__codelineno-220-30" name="__codelineno-220-30" href="#__codelineno-220-30"></a><span class="w">                </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="ss">&#39;lambda</span><span class="w"> </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="nb">values</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">map</span><span class="w"> </span><span class="nv">let-to-lambda</span><span class="w"> </span><span class="nv">body</span><span class="p">)))</span><span class="w"> </span><span class="p">(</span><span class="nb">map</span><span class="w"> </span><span class="nv">let-to-lambda</span><span class="w"> </span><span class="p">(</span><span class="nb">cadr</span><span class="w"> </span><span class="nb">values</span><span class="p">))))</span>
</span><span id="__span-220-31"><a id="__codelineno-220-31" name="__codelineno-220-31" href="#__codelineno-220-31"></a><span class="w">           </span><span class="c1">; END PROBLEM EC</span>
</span><span id="__span-220-32"><a id="__codelineno-220-32" name="__codelineno-220-32" href="#__codelineno-220-32"></a><span class="w">           </span><span class="p">))</span>
</span><span id="__span-220-33"><a id="__codelineno-220-33" name="__codelineno-220-33" href="#__codelineno-220-33"></a><span class="w">        </span><span class="p">(</span><span class="k">else</span>
</span><span id="__span-220-34"><a id="__codelineno-220-34" name="__codelineno-220-34" href="#__codelineno-220-34"></a><span class="w">         </span><span class="c1">; BEGIN PROBLEM EC</span>
</span><span id="__span-220-35"><a id="__codelineno-220-35" name="__codelineno-220-35" href="#__codelineno-220-35"></a><span class="w">         </span><span class="ss">&#39;replace-this-line</span>
</span><span id="__span-220-36"><a id="__codelineno-220-36" name="__codelineno-220-36" href="#__codelineno-220-36"></a><span class="w">         </span><span class="p">(</span><span class="nb">map</span><span class="w"> </span><span class="nv">let-to-lambda</span><span class="w"> </span><span class="nv">expr</span><span class="p">)</span>
</span><span id="__span-220-37"><a id="__codelineno-220-37" name="__codelineno-220-37" href="#__codelineno-220-37"></a><span class="w">         </span><span class="c1">; END PROBLEM EC</span>
</span><span id="__span-220-38"><a id="__codelineno-220-38" name="__codelineno-220-38" href="#__codelineno-220-38"></a><span class="w">         </span><span class="p">)))</span>
</span></code></pre></div>
</details>
<h3 id="11_2">11<a class="headerlink" href="#11_2" title="Permanent link">&para;</a></h3>
<p>Problem 11，这题题目我理解了好几遍最后才感觉算是完全理解正确</p>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p>Complete the function <code>optimize_tail_calls</code> in <code>scheme.py</code>. It returns an alternative to <code>scheme_eval</code> that is properly tail recursive. That is, the interpreter will allow an unbounded number of active <a href="http://en.wikipedia.org/wiki/Tail_call">tail calls</a> in constant space.</p>
<p>The <code>Thunk</code> class represents a <a href="http://en.wikipedia.org/wiki/Thunk">thunk</a>, an expression that needs to be evaluated in an environment. When <code>scheme_optimized_eval</code> receives a non-atomic expression in a <code>tail</code> context, then it returns an <code>Thunk</code> instance. Otherwise, it should repeatedly call <code>prior_eval_function</code> until the result is a value, rather than a <code>Thunk</code>.</p>
<p><strong>A successful implementation will require changes to several other functions, including some functions that we provided for you.</strong> All expressions throughout your interpreter that are in a tail context should be evaluated by calling <code>scheme_eval</code> with <code>True</code> as a third argument. Your goal is to determine which expressions are in a tail context throughout your code.</p>
<hr />
<p>在 <code>scheme.py</code> 中完成 <code>optimize_tail_calls</code> 函数。它返回 <code>scheme_eval</code> 的一种替代方法，可以正确处理尾递归。也就是说，解释器将允许在常量空间内有无限数量的活动<a href="http://en.wikipedia.org/wiki/Tail_call">尾调用</a>。</p>
<p><code>Thunk</code> 类表示一个<a href="http://en.wikipedia.org/wiki/Thunk">thunk</a>，即需要在环境中求值的表达式。当 <code>scheme_optimized_eval</code> 在 <code>尾</code> 上下文中接收到一个非原子表达式时，它将返回一个 <code>Thunk</code> 实例。否则，它应该反复调用 <code>prior_eval_function</code>，直到结果是一个值，而不是一个 <code>Thunk</code>。</p>
<p><strong>成功的实现将需要对其他几个函数进行更改，包括一些我们为您提供的函数。</strong> 在整个解释器中，所有在尾上下文中的表达式都应通过调用带有 <code>True</code> 作为第三个参数的 <code>scheme_eval</code> 来进行求值。您的目标是确定代码中哪些表达式在尾上下文中。</p>
</div>
<p>这题大概意思是，需要优化处理<em>求值</em>部分，对于 <em>尾递归 tail recursive</em> 的情况。</p>
<blockquote>
<p>The <code>Thunk</code> class represents a <a href="http://en.wikipedia.org/wiki/Thunk">thunk</a>, an expression that needs to be evaluated in an environment. When <code>scheme_optimized_eval</code> receives a non-atomic expression in a <code>tail</code> context, then it returns an <code>Thunk</code> instance. Otherwise, it should repeatedly call <code>prior_eval_function</code> until the result is a value, rather than a <code>Thunk</code>.</p>
</blockquote>
<p>这一段其实上我认为对应的就是提供的代码中的这个部分(non-atomic 刚好对应 <code>not scheme_symbolp(expr) and not self_evaluating(expr)</code> )</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-221-1"><a id="__codelineno-221-1" name="__codelineno-221-1" href="#__codelineno-221-1"></a><span class="k">if</span> <span class="n">tail</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">scheme_symbolp</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">self_evaluating</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
</span><span id="__span-221-2"><a id="__codelineno-221-2" name="__codelineno-221-2" href="#__codelineno-221-2"></a>    <span class="k">return</span> <span class="n">Thunk</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span></code></pre></div>
<blockquote>
<p>All expressions throughout your interpreter that are in a tail context should be evaluated by calling <code>scheme_eval</code> with <code>True</code> as a third argument. Your goal is to determine which expressions are in a tail context throughout your code.</p>
</blockquote>
<p>这句说的是，题目的关键就是需要找到/想到判断尾递归形式/格式的方法，并进行对应的处理。</p>
<p>最后就是这一句，</p>
<blockquote>
<p><strong>A successful implementation will require changes to several other functions, including some functions that we provided for you.</strong></p>
</blockquote>
<p>是说最终的实现还会需要修改一些函数，包括提供的函数，所以这意味着这题非常开放，很难，我尝试了很久也没有尝试出来。</p>
<p>最后看到 Lecture 35 和 36 刚好就是 Tail calls 和 Macros ，刚好分别对应19和20题，然后去看了一下lecture 35，发现课上有讲解这一题，所以就先跳过这一题了。(发现20题也需要用到tail call，所以也跳过了)</p>
<h3 id="12">12<a class="headerlink" href="#12" title="Permanent link">&para;</a></h3>
<p>看完了所有课程之后继续尝试完成之前没有完成的题目，</p>
<p>Problem 20 <em>宏 macro</em>，这题不算特别复杂，按照题目中说的，实现 <code>do_define_macro</code> 函数创建一个 <code>MacroProcedure</code> 类，再修改一下 <code>scheme_eval</code> 就行了，</p>
<p><code>do_define_macro</code> 中的代码基本上可以参考 <code>do_define_form</code> 的代码，</p>
<p><code>scheme_eval</code> 中，需要调用 <code>MacroProcedure</code> 的 <code>apply_macro</code> 方法，并不先<em>求值</em>而是直接传入参数的原始表达式，一开始我写的是</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-222-1"><a id="__codelineno-222-1" name="__codelineno-222-1" href="#__codelineno-222-1"></a><span class="k">return</span> <span class="n">operator</span><span class="o">.</span><span class="n">apply_macro</span><span class="p">(</span><span class="n">rest</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span></code></pre></div>
<p>但测试时显示这里返回的是</p>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-223-1"><a id="__codelineno-223-1" name="__codelineno-223-1" href="#__codelineno-223-1"></a><span class="nv">scm&gt;</span><span class="w"> </span><span class="p">(</span><span class="nf">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
</span><span id="__span-223-2"><a id="__codelineno-223-2" name="__codelineno-223-2" href="#__codelineno-223-2"></a><span class="o">....</span><span class="w">      </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">=</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-223-3"><a id="__codelineno-223-3" name="__codelineno-223-3" href="#__codelineno-223-3"></a><span class="o">....</span><span class="w">          </span><span class="mi">0</span>
</span><span id="__span-223-4"><a id="__codelineno-223-4" name="__codelineno-223-4" href="#__codelineno-223-4"></a><span class="o">....</span><span class="w">          </span><span class="nv">i</span><span class="p">))</span>
</span><span id="__span-223-5"><a id="__codelineno-223-5" name="__codelineno-223-5" href="#__codelineno-223-5"></a><span class="p">(</span><span class="nb">map</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="nf">i</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">=</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="nv">i</span><span class="p">))</span><span class="w"> </span><span class="p">(</span><span class="k">quote</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)))</span>
</span><span id="__span-223-6"><a id="__codelineno-223-6" name="__codelineno-223-6" href="#__codelineno-223-6"></a>
</span><span id="__span-223-7"><a id="__codelineno-223-7" name="__codelineno-223-7" href="#__codelineno-223-7"></a><span class="o">#</span><span class="w"> </span><span class="nv">Error:</span><span class="w"> </span><span class="nv">expected</span>
</span><span id="__span-223-8"><a id="__codelineno-223-8" name="__codelineno-223-8" href="#__codelineno-223-8"></a><span class="o">#</span><span class="w">     </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
</span><span id="__span-223-9"><a id="__codelineno-223-9" name="__codelineno-223-9" href="#__codelineno-223-9"></a><span class="o">#</span><span class="w"> </span><span class="nv">but</span><span class="w"> </span><span class="nv">got</span>
</span><span id="__span-223-10"><a id="__codelineno-223-10" name="__codelineno-223-10" href="#__codelineno-223-10"></a><span class="o">#</span><span class="w">     </span><span class="p">(</span><span class="nb">map</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="nf">i</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">=</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="nv">i</span><span class="p">))</span><span class="w"> </span><span class="p">(</span><span class="k">quote</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">)))</span>
</span></code></pre></div>
<p>所以最后再添加一个 <code>scheme_eval</code> 函数就可以了</p>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-224-1"><a id="__codelineno-224-1" name="__codelineno-224-1" href="#__codelineno-224-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">do_define_macro</span><span class="p">(</span><span class="n">expressions</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
</span><span id="__span-224-2"><a id="__codelineno-224-2" name="__codelineno-224-2" href="#__codelineno-224-2"></a>    <span class="c1"># BEGIN Problem 20</span>
</span><span id="__span-224-3"><a id="__codelineno-224-3" name="__codelineno-224-3" href="#__codelineno-224-3"></a>    <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-224-4"><a id="__codelineno-224-4" name="__codelineno-224-4" href="#__codelineno-224-4"></a>    <span class="n">validate_form</span><span class="p">(</span><span class="n">expressions</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="__span-224-5"><a id="__codelineno-224-5" name="__codelineno-224-5" href="#__codelineno-224-5"></a>    <span class="n">target</span> <span class="o">=</span> <span class="n">expressions</span><span class="o">.</span><span class="n">first</span>
</span><span id="__span-224-6"><a id="__codelineno-224-6" name="__codelineno-224-6" href="#__codelineno-224-6"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">Pair</span><span class="p">)</span> <span class="ow">and</span> <span class="n">scheme_symbolp</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">first</span><span class="p">):</span>
</span><span id="__span-224-7"><a id="__codelineno-224-7" name="__codelineno-224-7" href="#__codelineno-224-7"></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">first</span>
</span><span id="__span-224-8"><a id="__codelineno-224-8" name="__codelineno-224-8" href="#__codelineno-224-8"></a>        <span class="n">formals</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">rest</span>
</span><span id="__span-224-9"><a id="__codelineno-224-9" name="__codelineno-224-9" href="#__codelineno-224-9"></a>        <span class="n">validate_formals</span><span class="p">(</span><span class="n">formals</span><span class="p">)</span>
</span><span id="__span-224-10"><a id="__codelineno-224-10" name="__codelineno-224-10" href="#__codelineno-224-10"></a>        <span class="n">value</span> <span class="o">=</span> <span class="n">MacroProcedure</span><span class="p">(</span><span class="n">formals</span><span class="p">,</span> <span class="n">expressions</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-224-11"><a id="__codelineno-224-11" name="__codelineno-224-11" href="#__codelineno-224-11"></a>        <span class="n">env</span><span class="o">.</span><span class="n">define</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="__span-224-12"><a id="__codelineno-224-12" name="__codelineno-224-12" href="#__codelineno-224-12"></a>        <span class="k">return</span> <span class="n">name</span>
</span><span id="__span-224-13"><a id="__codelineno-224-13" name="__codelineno-224-13" href="#__codelineno-224-13"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-224-14"><a id="__codelineno-224-14" name="__codelineno-224-14" href="#__codelineno-224-14"></a>        <span class="n">bad_target</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">first</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">Pair</span><span class="p">)</span> <span class="k">else</span> <span class="n">target</span>
</span><span id="__span-224-15"><a id="__codelineno-224-15" name="__codelineno-224-15" href="#__codelineno-224-15"></a>        <span class="k">raise</span> <span class="n">SchemeError</span><span class="p">(</span><span class="s2">&quot;non-symbol: </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bad_target</span><span class="p">))</span>
</span><span id="__span-224-16"><a id="__codelineno-224-16" name="__codelineno-224-16" href="#__codelineno-224-16"></a>    <span class="c1"># END Problem 20</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-225-1"><a id="__codelineno-225-1" name="__codelineno-225-1" href="#__codelineno-225-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">scheme_eval</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">_</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> <span class="c1"># Optional third argument is ignored</span>
</span><span id="__span-225-2"><a id="__codelineno-225-2" name="__codelineno-225-2" href="#__codelineno-225-2"></a>    <span class="o">...</span>
</span><span id="__span-225-3"><a id="__codelineno-225-3" name="__codelineno-225-3" href="#__codelineno-225-3"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-225-4"><a id="__codelineno-225-4" name="__codelineno-225-4" href="#__codelineno-225-4"></a>        <span class="o">...</span>
</span><span id="__span-225-5"><a id="__codelineno-225-5" name="__codelineno-225-5" href="#__codelineno-225-5"></a>        <span class="n">validate_procedure</span><span class="p">(</span><span class="n">operator</span><span class="p">)</span>
</span><span id="__span-225-6"><a id="__codelineno-225-6" name="__codelineno-225-6" href="#__codelineno-225-6"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">operator</span><span class="p">,</span> <span class="n">MacroProcedure</span><span class="p">):</span>
</span><span id="__span-225-7"><a id="__codelineno-225-7" name="__codelineno-225-7" href="#__codelineno-225-7"></a>            <span class="k">return</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">apply_macro</span><span class="p">(</span><span class="n">rest</span><span class="p">,</span> <span class="n">env</span><span class="p">),</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-225-8"><a id="__codelineno-225-8" name="__codelineno-225-8" href="#__codelineno-225-8"></a>        <span class="o">...</span>
</span></code></pre></div>
</details>
<h3 id="13">13<a class="headerlink" href="#13" title="Permanent link">&para;</a></h3>
<p>Problem 19，做这题花了好久时间，也尝试了好多次。</p>
<blockquote>
<p>需要注意的是，题目中有一处写的是 <code>prior_eval_function</code> ，这里可能是忘记进行修改(20年夏季的scheme project对应的代码是 <code>prior_eval_function</code> )，应该对应的是代码中的 <code>original_scheme_eval</code></p>
</blockquote>
<p>刚开始是觉得需要在 <code>optimized_eval</code> 中进行是否是尾(调用)格式(in tail context)的判断，于是在函数中编写</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-226-1"><a id="__codelineno-226-1" name="__codelineno-226-1" href="#__codelineno-226-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">in_tail_context</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
</span><span id="__span-226-2"><a id="__codelineno-226-2" name="__codelineno-226-2" href="#__codelineno-226-2"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">Pair</span><span class="p">)</span> <span class="ow">and</span> <span class="n">scheme_symbolp</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">first</span><span class="p">):</span>
</span><span id="__span-226-3"><a id="__codelineno-226-3" name="__codelineno-226-3" href="#__codelineno-226-3"></a>        <span class="n">first</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">first</span>
</span><span id="__span-226-4"><a id="__codelineno-226-4" name="__codelineno-226-4" href="#__codelineno-226-4"></a>        <span class="k">if</span> <span class="n">first</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SPECIAL_FORMS</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="n">first</span><span class="p">),</span> <span class="n">LambdaProcedure</span><span class="p">):</span>
</span><span id="__span-226-5"><a id="__codelineno-226-5" name="__codelineno-226-5" href="#__codelineno-226-5"></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-226-6"><a id="__codelineno-226-6" name="__codelineno-226-6" href="#__codelineno-226-6"></a>        <span class="k">elif</span> <span class="n">first</span> <span class="o">==</span> <span class="s2">&quot;if&quot;</span><span class="p">:</span>
</span><span id="__span-226-7"><a id="__codelineno-226-7" name="__codelineno-226-7" href="#__codelineno-226-7"></a>            <span class="n">sub_expr_2</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">first</span>
</span><span id="__span-226-8"><a id="__codelineno-226-8" name="__codelineno-226-8" href="#__codelineno-226-8"></a>            <span class="n">sub_expr_3</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">first</span>
</span><span id="__span-226-9"><a id="__codelineno-226-9" name="__codelineno-226-9" href="#__codelineno-226-9"></a>            <span class="k">return</span> <span class="n">in_tail_context</span><span class="p">(</span><span class="n">sub_expr_2</span><span class="p">)</span> <span class="ow">or</span> <span class="n">in_tail_context</span><span class="p">(</span><span class="n">sub_expr_3</span><span class="p">)</span>
</span><span id="__span-226-10"><a id="__codelineno-226-10" name="__codelineno-226-10" href="#__codelineno-226-10"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-226-11"><a id="__codelineno-226-11" name="__codelineno-226-11" href="#__codelineno-226-11"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-226-12"><a id="__codelineno-226-12" name="__codelineno-226-12" href="#__codelineno-226-12"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-226-13"><a id="__codelineno-226-13" name="__codelineno-226-13" href="#__codelineno-226-13"></a>        <span class="k">return</span> <span class="kc">False</span>
</span></code></pre></div>
<p>因为在lecture 35 Tail Calls里，John说只需要注意 最后的表达式是调用lambda函数 和 <code>if</code> 表达式 这两种情况，</p>
<p><a class="glightbox" href="../images/cs61a_202.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cs61a_202" loading="lazy" src="../images/cs61a_202.png" /></a></p>
<p>所以我就只对这两种情况进行了判断。</p>
<p>然后，我的想法是，如果不符合尾格式，就使用原始的eval函数，如果符合的话，那么就应该是会得到 <code>Thunk</code> 类实例，那么应该循环进行求值(就不会递归溢出)，于是</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-227-1"><a id="__codelineno-227-1" name="__codelineno-227-1" href="#__codelineno-227-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">optimize_tail_calls</span><span class="p">(</span><span class="n">original_scheme_eval</span><span class="p">):</span>
</span><span id="__span-227-2"><a id="__codelineno-227-2" name="__codelineno-227-2" href="#__codelineno-227-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">optimized_eval</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">tail</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="__span-227-3"><a id="__codelineno-227-3" name="__codelineno-227-3" href="#__codelineno-227-3"></a>        <span class="k">if</span> <span class="n">tail</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">scheme_symbolp</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">self_evaluating</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
</span><span id="__span-227-4"><a id="__codelineno-227-4" name="__codelineno-227-4" href="#__codelineno-227-4"></a>            <span class="k">return</span> <span class="n">Thunk</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-227-5"><a id="__codelineno-227-5" name="__codelineno-227-5" href="#__codelineno-227-5"></a>
</span><span id="__span-227-6"><a id="__codelineno-227-6" name="__codelineno-227-6" href="#__codelineno-227-6"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">Thunk</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-227-7"><a id="__codelineno-227-7" name="__codelineno-227-7" href="#__codelineno-227-7"></a>        <span class="c1"># BEGIN PROBLEM 19</span>
</span><span id="__span-227-8"><a id="__codelineno-227-8" name="__codelineno-227-8" href="#__codelineno-227-8"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-227-9"><a id="__codelineno-227-9" name="__codelineno-227-9" href="#__codelineno-227-9"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">in_tail_context</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
</span><span id="__span-227-10"><a id="__codelineno-227-10" name="__codelineno-227-10" href="#__codelineno-227-10"></a>            <span class="o">...</span>
</span><span id="__span-227-11"><a id="__codelineno-227-11" name="__codelineno-227-11" href="#__codelineno-227-11"></a>
</span><span id="__span-227-12"><a id="__codelineno-227-12" name="__codelineno-227-12" href="#__codelineno-227-12"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">in_tail_context</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
</span><span id="__span-227-13"><a id="__codelineno-227-13" name="__codelineno-227-13" href="#__codelineno-227-13"></a>            <span class="k">return</span> <span class="n">original_scheme_eval</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-227-14"><a id="__codelineno-227-14" name="__codelineno-227-14" href="#__codelineno-227-14"></a>
</span><span id="__span-227-15"><a id="__codelineno-227-15" name="__codelineno-227-15" href="#__codelineno-227-15"></a>        <span class="k">while</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">Thunk</span><span class="p">):</span>
</span><span id="__span-227-16"><a id="__codelineno-227-16" name="__codelineno-227-16" href="#__codelineno-227-16"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">original_scheme_eval</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">expr</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">env</span><span class="p">)</span>
</span><span id="__span-227-17"><a id="__codelineno-227-17" name="__codelineno-227-17" href="#__codelineno-227-17"></a>        <span class="k">return</span> <span class="n">result</span>
</span><span id="__span-227-18"><a id="__codelineno-227-18" name="__codelineno-227-18" href="#__codelineno-227-18"></a>        <span class="c1"># END PROBLEM 19</span>
</span><span id="__span-227-19"><a id="__codelineno-227-19" name="__codelineno-227-19" href="#__codelineno-227-19"></a>    <span class="k">return</span> <span class="n">optimized_eval</span>
</span></code></pre></div>
<p>这里想到要用 <code>while</code> 循环，是因为原始的代码中有 <code>result = Thunk(expr, env)</code> 感觉很像是需要循环进行计算最后得到不是 <code>Thunk</code> 的 <code>result</code> 。</p>
<p>但测试发现不行，</p>
<p>然后捋了一下代码的流程，感觉应该是需要在<strong>某个自定义的尾递归(或者说body符合尾格式)的函数返回body时返回 <code>Thunk</code></strong> (所以为了运行这个函数之前的调用的eval和apply等函数就可以返回这个 <code>Thunk</code> 因此就不会溢出)，然后这个 <code>Thunk</code> 在 <code>optimized_eval</code> 中被循环<em>求值</em>，</p>
<p>所以觉得判断尾格式应该是在 <code>scheme_apply</code> 调用的 <code>eval_all</code> 中，于是将代码修改成了</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-228-1"><a id="__codelineno-228-1" name="__codelineno-228-1" href="#__codelineno-228-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">eval_all</span><span class="p">(</span><span class="n">expressions</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
</span><span id="__span-228-2"><a id="__codelineno-228-2" name="__codelineno-228-2" href="#__codelineno-228-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">in_tail_context</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
</span><span id="__span-228-3"><a id="__codelineno-228-3" name="__codelineno-228-3" href="#__codelineno-228-3"></a>        <span class="o">...</span>
</span><span id="__span-228-4"><a id="__codelineno-228-4" name="__codelineno-228-4" href="#__codelineno-228-4"></a>
</span><span id="__span-228-5"><a id="__codelineno-228-5" name="__codelineno-228-5" href="#__codelineno-228-5"></a>    <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-228-6"><a id="__codelineno-228-6" name="__codelineno-228-6" href="#__codelineno-228-6"></a>    <span class="k">while</span> <span class="n">expressions</span><span class="o">.</span><span class="n">rest</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">nil</span><span class="p">:</span>
</span><span id="__span-228-7"><a id="__codelineno-228-7" name="__codelineno-228-7" href="#__codelineno-228-7"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-228-8"><a id="__codelineno-228-8" name="__codelineno-228-8" href="#__codelineno-228-8"></a>        <span class="n">expressions</span> <span class="o">=</span> <span class="n">expressions</span><span class="o">.</span><span class="n">rest</span>
</span><span id="__span-228-9"><a id="__codelineno-228-9" name="__codelineno-228-9" href="#__codelineno-228-9"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">tail</span><span class="o">=</span><span class="n">in_tail_context</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">))</span>
</span><span id="__span-228-10"><a id="__codelineno-228-10" name="__codelineno-228-10" href="#__codelineno-228-10"></a>    <span class="k">return</span> <span class="n">result</span>
</span></code></pre></div>
<p>进行测试发现不行，</p>
<blockquote>
<div class="language-scheme highlight"><pre><span></span><code><span id="__span-229-1"><a id="__codelineno-229-1" name="__codelineno-229-1" href="#__codelineno-229-1"></a><span class="nv">scm&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="nf">sum</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="nv">total</span><span class="p">)</span>
</span><span id="__span-229-2"><a id="__codelineno-229-2" name="__codelineno-229-2" href="#__codelineno-229-2"></a><span class="o">....</span><span class="w">   </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">zero?</span><span class="w"> </span><span class="nv">n</span><span class="p">)</span>
</span><span id="__span-229-3"><a id="__codelineno-229-3" name="__codelineno-229-3" href="#__codelineno-229-3"></a><span class="o">....</span><span class="w">       </span><span class="nv">total</span>
</span><span id="__span-229-4"><a id="__codelineno-229-4" name="__codelineno-229-4" href="#__codelineno-229-4"></a><span class="o">....</span><span class="w">       </span><span class="p">(</span><span class="nf">sum</span><span class="w"> </span><span class="p">(</span><span class="nb">-</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="nv">total</span><span class="p">))))</span>
</span><span id="__span-229-5"><a id="__codelineno-229-5" name="__codelineno-229-5" href="#__codelineno-229-5"></a><span class="nv">sum</span>
</span><span id="__span-229-6"><a id="__codelineno-229-6" name="__codelineno-229-6" href="#__codelineno-229-6"></a><span class="nv">scm&gt;</span><span class="w"> </span><span class="p">(</span><span class="nf">sum</span><span class="w"> </span><span class="mi">1001</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
</span></code></pre></div>
</blockquote>
<p>然后想到是由于每次进入最后的 <code>sum</code> 时，都会新调用一个eval，所以就会递归溢出，</p>
<p>于是想到了在 <code>optimized_eval</code> 中直接处理这两种情况，</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-230-1"><a id="__codelineno-230-1" name="__codelineno-230-1" href="#__codelineno-230-1"></a><span class="k">while</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">Thunk</span><span class="p">):</span>
</span><span id="__span-230-2"><a id="__codelineno-230-2" name="__codelineno-230-2" href="#__codelineno-230-2"></a>    <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">first</span> <span class="o">==</span> <span class="s2">&quot;if&quot;</span><span class="p">:</span>
</span><span id="__span-230-3"><a id="__codelineno-230-3" name="__codelineno-230-3" href="#__codelineno-230-3"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">do_if_form</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">env</span><span class="p">,</span> <span class="n">in_tail</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-230-4"><a id="__codelineno-230-4" name="__codelineno-230-4" href="#__codelineno-230-4"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-230-5"><a id="__codelineno-230-5" name="__codelineno-230-5" href="#__codelineno-230-5"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">original_scheme_eval</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">expr</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">env</span><span class="p">)</span>
</span></code></pre></div>
<p>并且对 <code>do_if_form</code> 进行修改</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-231-1"><a id="__codelineno-231-1" name="__codelineno-231-1" href="#__codelineno-231-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">do_if_form</span><span class="p">(</span><span class="n">expressions</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">in_tail</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="__span-231-2"><a id="__codelineno-231-2" name="__codelineno-231-2" href="#__codelineno-231-2"></a>    <span class="n">validate_form</span><span class="p">(</span><span class="n">expressions</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="__span-231-3"><a id="__codelineno-231-3" name="__codelineno-231-3" href="#__codelineno-231-3"></a>    <span class="k">if</span> <span class="n">is_true_primitive</span><span class="p">(</span><span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">)):</span>
</span><span id="__span-231-4"><a id="__codelineno-231-4" name="__codelineno-231-4" href="#__codelineno-231-4"></a>        <span class="k">return</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">tail</span><span class="o">=</span><span class="n">in_tail</span><span class="p">)</span>
</span><span id="__span-231-5"><a id="__codelineno-231-5" name="__codelineno-231-5" href="#__codelineno-231-5"></a>    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">expressions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="__span-231-6"><a id="__codelineno-231-6" name="__codelineno-231-6" href="#__codelineno-231-6"></a>        <span class="k">return</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">tail</span><span class="o">=</span><span class="n">in_tail</span><span class="p">)</span>
</span></code></pre></div>
<blockquote>
<p>添加 <code>in_tail</code> 参数是因为，需要在这里就返回 <code>Thunk</code> 类，否则还是会形成递归</p>
</blockquote>
<p>然后进行测试，发现竟然真的能通过几个测试用例😮，但没全部通过，</p>
<p>但是感觉这样的思路(在 <code>eval_all</code> 中进行尾格式的判断)应该可以通过测试，于是将 <code>optimized_eval</code> 改成了</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-232-1"><a id="__codelineno-232-1" name="__codelineno-232-1" href="#__codelineno-232-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">optimized_eval</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">tail</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="__span-232-2"><a id="__codelineno-232-2" name="__codelineno-232-2" href="#__codelineno-232-2"></a>    <span class="k">if</span> <span class="n">tail</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">scheme_symbolp</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">self_evaluating</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
</span><span id="__span-232-3"><a id="__codelineno-232-3" name="__codelineno-232-3" href="#__codelineno-232-3"></a>        <span class="k">return</span> <span class="n">Thunk</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-232-4"><a id="__codelineno-232-4" name="__codelineno-232-4" href="#__codelineno-232-4"></a>
</span><span id="__span-232-5"><a id="__codelineno-232-5" name="__codelineno-232-5" href="#__codelineno-232-5"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">Thunk</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-232-6"><a id="__codelineno-232-6" name="__codelineno-232-6" href="#__codelineno-232-6"></a>    <span class="c1"># BEGIN PROBLEM 19</span>
</span><span id="__span-232-7"><a id="__codelineno-232-7" name="__codelineno-232-7" href="#__codelineno-232-7"></a>    <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-232-8"><a id="__codelineno-232-8" name="__codelineno-232-8" href="#__codelineno-232-8"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">original_scheme_eval</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-232-9"><a id="__codelineno-232-9" name="__codelineno-232-9" href="#__codelineno-232-9"></a>
</span><span id="__span-232-10"><a id="__codelineno-232-10" name="__codelineno-232-10" href="#__codelineno-232-10"></a>    <span class="k">while</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">Thunk</span><span class="p">):</span>
</span><span id="__span-232-11"><a id="__codelineno-232-11" name="__codelineno-232-11" href="#__codelineno-232-11"></a>        <span class="n">rest_expr</span><span class="p">,</span> <span class="n">env</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">env</span>
</span><span id="__span-232-12"><a id="__codelineno-232-12" name="__codelineno-232-12" href="#__codelineno-232-12"></a>        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">first</span> <span class="o">==</span> <span class="s2">&quot;if&quot;</span><span class="p">:</span>
</span><span id="__span-232-13"><a id="__codelineno-232-13" name="__codelineno-232-13" href="#__codelineno-232-13"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">do_if_form</span><span class="p">(</span><span class="n">rest_expr</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">in_tail</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-232-14"><a id="__codelineno-232-14" name="__codelineno-232-14" href="#__codelineno-232-14"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-232-15"><a id="__codelineno-232-15" name="__codelineno-232-15" href="#__codelineno-232-15"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">original_scheme_eval</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">expr</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-232-16"><a id="__codelineno-232-16" name="__codelineno-232-16" href="#__codelineno-232-16"></a>    <span class="k">return</span> <span class="n">result</span>
</span><span id="__span-232-17"><a id="__codelineno-232-17" name="__codelineno-232-17" href="#__codelineno-232-17"></a>    <span class="c1"># END PROBLEM 19</span>
</span></code></pre></div>
<p>然后测试发现只通过了两个例子，被卡在了第3个例子上，这个例子使用了 <code>cond</code> ，所以需要对这种情况进行处理，</p>
<p>于是修改 <code>eval_all</code> 中的 <code>in_tail_context</code> </p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-233-1"><a id="__codelineno-233-1" name="__codelineno-233-1" href="#__codelineno-233-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">in_tail_context</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
</span><span id="__span-233-2"><a id="__codelineno-233-2" name="__codelineno-233-2" href="#__codelineno-233-2"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">Pair</span><span class="p">):</span>
</span><span id="__span-233-3"><a id="__codelineno-233-3" name="__codelineno-233-3" href="#__codelineno-233-3"></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-233-4"><a id="__codelineno-233-4" name="__codelineno-233-4" href="#__codelineno-233-4"></a>
</span><span id="__span-233-5"><a id="__codelineno-233-5" name="__codelineno-233-5" href="#__codelineno-233-5"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">Pair</span><span class="p">)</span> <span class="ow">and</span> <span class="n">scheme_symbolp</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">first</span><span class="p">):</span>
</span><span id="__span-233-6"><a id="__codelineno-233-6" name="__codelineno-233-6" href="#__codelineno-233-6"></a>        <span class="n">first</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">first</span>
</span><span id="__span-233-7"><a id="__codelineno-233-7" name="__codelineno-233-7" href="#__codelineno-233-7"></a>        <span class="k">if</span> <span class="n">first</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SPECIAL_FORMS</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="n">first</span><span class="p">),</span> <span class="n">LambdaProcedure</span><span class="p">):</span>
</span><span id="__span-233-8"><a id="__codelineno-233-8" name="__codelineno-233-8" href="#__codelineno-233-8"></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-233-9"><a id="__codelineno-233-9" name="__codelineno-233-9" href="#__codelineno-233-9"></a>        <span class="k">elif</span> <span class="n">first</span> <span class="o">==</span> <span class="s2">&quot;if&quot;</span><span class="p">:</span>
</span><span id="__span-233-10"><a id="__codelineno-233-10" name="__codelineno-233-10" href="#__codelineno-233-10"></a>            <span class="n">sub_expr_2</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">first</span>
</span><span id="__span-233-11"><a id="__codelineno-233-11" name="__codelineno-233-11" href="#__codelineno-233-11"></a>            <span class="n">sub_expr_3</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">first</span>
</span><span id="__span-233-12"><a id="__codelineno-233-12" name="__codelineno-233-12" href="#__codelineno-233-12"></a>            <span class="k">return</span> <span class="n">in_tail_context</span><span class="p">(</span><span class="n">sub_expr_2</span><span class="p">)</span> <span class="ow">and</span> <span class="n">in_tail_context</span><span class="p">(</span><span class="n">sub_expr_3</span><span class="p">)</span>
</span><span id="__span-233-13"><a id="__codelineno-233-13" name="__codelineno-233-13" href="#__codelineno-233-13"></a>        <span class="k">elif</span> <span class="n">first</span> <span class="o">==</span> <span class="s2">&quot;cond&quot;</span><span class="p">:</span>
</span><span id="__span-233-14"><a id="__codelineno-233-14" name="__codelineno-233-14" href="#__codelineno-233-14"></a>            <span class="n">non_preds</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-233-15"><a id="__codelineno-233-15" name="__codelineno-233-15" href="#__codelineno-233-15"></a>            <span class="n">cond_expr</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">rest</span>
</span><span id="__span-233-16"><a id="__codelineno-233-16" name="__codelineno-233-16" href="#__codelineno-233-16"></a>            <span class="k">while</span> <span class="n">cond_expr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">nil</span><span class="p">:</span>
</span><span id="__span-233-17"><a id="__codelineno-233-17" name="__codelineno-233-17" href="#__codelineno-233-17"></a>                <span class="n">non_pred</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-233-18"><a id="__codelineno-233-18" name="__codelineno-233-18" href="#__codelineno-233-18"></a>                <span class="n">sub_expr</span> <span class="o">=</span> <span class="n">cond_expr</span><span class="o">.</span><span class="n">first</span>
</span><span id="__span-233-19"><a id="__codelineno-233-19" name="__codelineno-233-19" href="#__codelineno-233-19"></a>                <span class="k">while</span> <span class="n">sub_expr</span><span class="o">.</span><span class="n">rest</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">nil</span><span class="p">:</span>
</span><span id="__span-233-20"><a id="__codelineno-233-20" name="__codelineno-233-20" href="#__codelineno-233-20"></a>                    <span class="n">non_pred</span> <span class="o">=</span> <span class="n">sub_expr</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">first</span>
</span><span id="__span-233-21"><a id="__codelineno-233-21" name="__codelineno-233-21" href="#__codelineno-233-21"></a>                    <span class="n">sub_expr</span> <span class="o">=</span> <span class="n">sub_expr</span><span class="o">.</span><span class="n">rest</span>
</span><span id="__span-233-22"><a id="__codelineno-233-22" name="__codelineno-233-22" href="#__codelineno-233-22"></a>                <span class="n">non_preds</span> <span class="o">+=</span> <span class="p">[</span><span class="n">non_pred</span><span class="p">]</span>
</span><span id="__span-233-23"><a id="__codelineno-233-23" name="__codelineno-233-23" href="#__codelineno-233-23"></a>                <span class="n">cond_expr</span> <span class="o">=</span> <span class="n">cond_expr</span><span class="o">.</span><span class="n">rest</span>
</span><span id="__span-233-24"><a id="__codelineno-233-24" name="__codelineno-233-24" href="#__codelineno-233-24"></a>            <span class="k">return</span> <span class="nb">all</span><span class="p">([</span><span class="n">in_tail_context</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">non_preds</span><span class="p">])</span>
</span><span id="__span-233-25"><a id="__codelineno-233-25" name="__codelineno-233-25" href="#__codelineno-233-25"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-233-26"><a id="__codelineno-233-26" name="__codelineno-233-26" href="#__codelineno-233-26"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-233-27"><a id="__codelineno-233-27" name="__codelineno-233-27" href="#__codelineno-233-27"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-233-28"><a id="__codelineno-233-28" name="__codelineno-233-28" href="#__codelineno-233-28"></a>        <span class="k">return</span> <span class="kc">False</span>
</span></code></pre></div>
<p>然后发现，可能是由于 <code>do_cond_form</code> 中最后调用的是 <code>eval_all</code> (其中有判断尾形式的代码)所以就可以使用原本的eval来处理 <code>cond</code> 的情况，</p>
<p>然后测试被第5个例子 <code>let</code> 语句卡住，于是继续在 <code>in_tail_context</code> 中添加判断的情况，</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-234-1"><a id="__codelineno-234-1" name="__codelineno-234-1" href="#__codelineno-234-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">in_tail_context</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
</span><span id="__span-234-2"><a id="__codelineno-234-2" name="__codelineno-234-2" href="#__codelineno-234-2"></a>    <span class="o">...</span>
</span><span id="__span-234-3"><a id="__codelineno-234-3" name="__codelineno-234-3" href="#__codelineno-234-3"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">Pair</span><span class="p">)</span> <span class="ow">and</span> <span class="n">scheme_symbolp</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">first</span><span class="p">):</span>
</span><span id="__span-234-4"><a id="__codelineno-234-4" name="__codelineno-234-4" href="#__codelineno-234-4"></a>        <span class="n">first</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">first</span>
</span><span id="__span-234-5"><a id="__codelineno-234-5" name="__codelineno-234-5" href="#__codelineno-234-5"></a>        <span class="k">if</span> <span class="n">first</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SPECIAL_FORMS</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="n">first</span><span class="p">),</span> <span class="n">LambdaProcedure</span><span class="p">):</span>
</span><span id="__span-234-6"><a id="__codelineno-234-6" name="__codelineno-234-6" href="#__codelineno-234-6"></a>            <span class="o">...</span>
</span><span id="__span-234-7"><a id="__codelineno-234-7" name="__codelineno-234-7" href="#__codelineno-234-7"></a>        <span class="k">elif</span> <span class="n">first</span> <span class="o">==</span> <span class="s2">&quot;let&quot;</span><span class="p">:</span>
</span><span id="__span-234-8"><a id="__codelineno-234-8" name="__codelineno-234-8" href="#__codelineno-234-8"></a>            <span class="c1"># return True</span>
</span><span id="__span-234-9"><a id="__codelineno-234-9" name="__codelineno-234-9" href="#__codelineno-234-9"></a>            <span class="n">let_expr</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">rest</span>
</span><span id="__span-234-10"><a id="__codelineno-234-10" name="__codelineno-234-10" href="#__codelineno-234-10"></a>            <span class="k">while</span> <span class="n">let_expr</span><span class="o">.</span><span class="n">rest</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">nil</span><span class="p">:</span>
</span><span id="__span-234-11"><a id="__codelineno-234-11" name="__codelineno-234-11" href="#__codelineno-234-11"></a>                <span class="n">let_expr</span> <span class="o">=</span> <span class="n">let_expr</span><span class="o">.</span><span class="n">rest</span>
</span><span id="__span-234-12"><a id="__codelineno-234-12" name="__codelineno-234-12" href="#__codelineno-234-12"></a>            <span class="k">return</span> <span class="n">in_tail_context</span><span class="p">(</span><span class="n">let_expr</span><span class="o">.</span><span class="n">first</span><span class="p">)</span>
</span><span id="__span-234-13"><a id="__codelineno-234-13" name="__codelineno-234-13" href="#__codelineno-234-13"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-234-14"><a id="__codelineno-234-14" name="__codelineno-234-14" href="#__codelineno-234-14"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-234-15"><a id="__codelineno-234-15" name="__codelineno-234-15" href="#__codelineno-234-15"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-234-16"><a id="__codelineno-234-16" name="__codelineno-234-16" href="#__codelineno-234-16"></a>        <span class="k">return</span> <span class="kc">False</span>
</span></code></pre></div>
<p>再测试，被第6个例子 <code>or</code> 和 <code>and</code> 卡住，</p>
<p>然后看了一下之前的ppt，<code>and</code> <code>or</code> <code>begin</code> 的情况差不多，所以就一起判断了</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-235-1"><a id="__codelineno-235-1" name="__codelineno-235-1" href="#__codelineno-235-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">in_tail_context</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
</span><span id="__span-235-2"><a id="__codelineno-235-2" name="__codelineno-235-2" href="#__codelineno-235-2"></a>    <span class="o">...</span>
</span><span id="__span-235-3"><a id="__codelineno-235-3" name="__codelineno-235-3" href="#__codelineno-235-3"></a>    <span class="k">if</span> <span class="o">...</span><span class="p">:</span>
</span><span id="__span-235-4"><a id="__codelineno-235-4" name="__codelineno-235-4" href="#__codelineno-235-4"></a>        <span class="o">...</span>
</span><span id="__span-235-5"><a id="__codelineno-235-5" name="__codelineno-235-5" href="#__codelineno-235-5"></a>        <span class="k">elif</span> <span class="n">first</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;and&quot;</span><span class="p">,</span> <span class="s2">&quot;or&quot;</span><span class="p">,</span> <span class="s2">&quot;begin&quot;</span><span class="p">):</span>
</span><span id="__span-235-6"><a id="__codelineno-235-6" name="__codelineno-235-6" href="#__codelineno-235-6"></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-235-7"><a id="__codelineno-235-7" name="__codelineno-235-7" href="#__codelineno-235-7"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-235-8"><a id="__codelineno-235-8" name="__codelineno-235-8" href="#__codelineno-235-8"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-235-9"><a id="__codelineno-235-9" name="__codelineno-235-9" href="#__codelineno-235-9"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-235-10"><a id="__codelineno-235-10" name="__codelineno-235-10" href="#__codelineno-235-10"></a>        <span class="k">return</span> <span class="kc">False</span>
</span></code></pre></div>
<p>然后对应在 <code>do_and_form</code> 和 <code>do_or_form</code> 中进行修改</p>
<blockquote>
<p><code>do_begin_form</code> 由于和之前的 <code>do_cond_form</code> 一样最后调用的是 <code>eval_all</code> 所以就不用修改</p>
</blockquote>
<div class="language-python highlight"><pre><span></span><code><span id="__span-236-1"><a id="__codelineno-236-1" name="__codelineno-236-1" href="#__codelineno-236-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">do_and_form</span><span class="p">(</span><span class="n">expressions</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">in_tail</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="__span-236-2"><a id="__codelineno-236-2" name="__codelineno-236-2" href="#__codelineno-236-2"></a>    <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;#t&quot;</span>
</span><span id="__span-236-3"><a id="__codelineno-236-3" name="__codelineno-236-3" href="#__codelineno-236-3"></a>    <span class="k">while</span> <span class="n">expressions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">nil</span><span class="p">:</span>
</span><span id="__span-236-4"><a id="__codelineno-236-4" name="__codelineno-236-4" href="#__codelineno-236-4"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">Pair</span><span class="p">):</span>
</span><span id="__span-236-5"><a id="__codelineno-236-5" name="__codelineno-236-5" href="#__codelineno-236-5"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-236-6"><a id="__codelineno-236-6" name="__codelineno-236-6" href="#__codelineno-236-6"></a>        <span class="k">elif</span> <span class="n">in_tail</span> <span class="ow">and</span> <span class="n">scheme_symbolp</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">first</span><span class="p">):</span>
</span><span id="__span-236-7"><a id="__codelineno-236-7" name="__codelineno-236-7" href="#__codelineno-236-7"></a>            <span class="n">first</span> <span class="o">=</span> <span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">first</span>
</span><span id="__span-236-8"><a id="__codelineno-236-8" name="__codelineno-236-8" href="#__codelineno-236-8"></a>            <span class="k">if</span> <span class="n">first</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SPECIAL_FORMS</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="n">first</span><span class="p">),</span> <span class="n">LambdaProcedure</span><span class="p">):</span>
</span><span id="__span-236-9"><a id="__codelineno-236-9" name="__codelineno-236-9" href="#__codelineno-236-9"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">tail</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-236-10"><a id="__codelineno-236-10" name="__codelineno-236-10" href="#__codelineno-236-10"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-236-11"><a id="__codelineno-236-11" name="__codelineno-236-11" href="#__codelineno-236-11"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-236-12"><a id="__codelineno-236-12" name="__codelineno-236-12" href="#__codelineno-236-12"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-236-13"><a id="__codelineno-236-13" name="__codelineno-236-13" href="#__codelineno-236-13"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-236-14"><a id="__codelineno-236-14" name="__codelineno-236-14" href="#__codelineno-236-14"></a>
</span><span id="__span-236-15"><a id="__codelineno-236-15" name="__codelineno-236-15" href="#__codelineno-236-15"></a>        <span class="k">if</span> <span class="n">is_false_primitive</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">Thunk</span><span class="p">):</span>
</span><span id="__span-236-16"><a id="__codelineno-236-16" name="__codelineno-236-16" href="#__codelineno-236-16"></a>            <span class="k">break</span>
</span><span id="__span-236-17"><a id="__codelineno-236-17" name="__codelineno-236-17" href="#__codelineno-236-17"></a>        <span class="n">expressions</span> <span class="o">=</span> <span class="n">expressions</span><span class="o">.</span><span class="n">rest</span>
</span><span id="__span-236-18"><a id="__codelineno-236-18" name="__codelineno-236-18" href="#__codelineno-236-18"></a>    <span class="k">return</span> <span class="n">result</span>
</span><span id="__span-236-19"><a id="__codelineno-236-19" name="__codelineno-236-19" href="#__codelineno-236-19"></a>
</span><span id="__span-236-20"><a id="__codelineno-236-20" name="__codelineno-236-20" href="#__codelineno-236-20"></a><span class="k">def</span><span class="w"> </span><span class="nf">do_or_form</span><span class="p">(</span><span class="n">expressions</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">in_tail</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="__span-236-21"><a id="__codelineno-236-21" name="__codelineno-236-21" href="#__codelineno-236-21"></a>    <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;#f&quot;</span>
</span><span id="__span-236-22"><a id="__codelineno-236-22" name="__codelineno-236-22" href="#__codelineno-236-22"></a>    <span class="k">while</span> <span class="n">expressions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">nil</span><span class="p">:</span>
</span><span id="__span-236-23"><a id="__codelineno-236-23" name="__codelineno-236-23" href="#__codelineno-236-23"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">Pair</span><span class="p">):</span>
</span><span id="__span-236-24"><a id="__codelineno-236-24" name="__codelineno-236-24" href="#__codelineno-236-24"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-236-25"><a id="__codelineno-236-25" name="__codelineno-236-25" href="#__codelineno-236-25"></a>        <span class="k">elif</span> <span class="n">in_tail</span> <span class="ow">and</span> <span class="n">scheme_symbolp</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">first</span><span class="p">):</span>
</span><span id="__span-236-26"><a id="__codelineno-236-26" name="__codelineno-236-26" href="#__codelineno-236-26"></a>            <span class="n">first</span> <span class="o">=</span> <span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">first</span>
</span><span id="__span-236-27"><a id="__codelineno-236-27" name="__codelineno-236-27" href="#__codelineno-236-27"></a>            <span class="k">if</span> <span class="n">first</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SPECIAL_FORMS</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="n">first</span><span class="p">),</span> <span class="n">LambdaProcedure</span><span class="p">):</span>
</span><span id="__span-236-28"><a id="__codelineno-236-28" name="__codelineno-236-28" href="#__codelineno-236-28"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">tail</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-236-29"><a id="__codelineno-236-29" name="__codelineno-236-29" href="#__codelineno-236-29"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-236-30"><a id="__codelineno-236-30" name="__codelineno-236-30" href="#__codelineno-236-30"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-236-31"><a id="__codelineno-236-31" name="__codelineno-236-31" href="#__codelineno-236-31"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-236-32"><a id="__codelineno-236-32" name="__codelineno-236-32" href="#__codelineno-236-32"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-236-33"><a id="__codelineno-236-33" name="__codelineno-236-33" href="#__codelineno-236-33"></a>
</span><span id="__span-236-34"><a id="__codelineno-236-34" name="__codelineno-236-34" href="#__codelineno-236-34"></a>        <span class="k">if</span> <span class="n">is_true_primitive</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">Thunk</span><span class="p">):</span>
</span><span id="__span-236-35"><a id="__codelineno-236-35" name="__codelineno-236-35" href="#__codelineno-236-35"></a>            <span class="k">break</span>
</span><span id="__span-236-36"><a id="__codelineno-236-36" name="__codelineno-236-36" href="#__codelineno-236-36"></a>        <span class="n">expressions</span> <span class="o">=</span> <span class="n">expressions</span><span class="o">.</span><span class="n">rest</span>
</span><span id="__span-236-37"><a id="__codelineno-236-37" name="__codelineno-236-37" href="#__codelineno-236-37"></a>    <span class="k">return</span> <span class="n">result</span>
</span></code></pre></div>
<p>最后在 <code>optimized_eval</code> 中</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-237-1"><a id="__codelineno-237-1" name="__codelineno-237-1" href="#__codelineno-237-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">optimized_eval</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">tail</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="__span-237-2"><a id="__codelineno-237-2" name="__codelineno-237-2" href="#__codelineno-237-2"></a>    <span class="o">...</span>
</span><span id="__span-237-3"><a id="__codelineno-237-3" name="__codelineno-237-3" href="#__codelineno-237-3"></a>    <span class="c1"># BEGIN PROBLEM 19</span>
</span><span id="__span-237-4"><a id="__codelineno-237-4" name="__codelineno-237-4" href="#__codelineno-237-4"></a>    <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-237-5"><a id="__codelineno-237-5" name="__codelineno-237-5" href="#__codelineno-237-5"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">original_scheme_eval</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-237-6"><a id="__codelineno-237-6" name="__codelineno-237-6" href="#__codelineno-237-6"></a>    <span class="k">while</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">Thunk</span><span class="p">):</span>
</span><span id="__span-237-7"><a id="__codelineno-237-7" name="__codelineno-237-7" href="#__codelineno-237-7"></a>        <span class="n">rest_expr</span><span class="p">,</span> <span class="n">env</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">env</span>
</span><span id="__span-237-8"><a id="__codelineno-237-8" name="__codelineno-237-8" href="#__codelineno-237-8"></a>        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">first</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;if&quot;</span><span class="p">,</span> <span class="s2">&quot;and&quot;</span><span class="p">,</span> <span class="s2">&quot;or&quot;</span><span class="p">):</span>
</span><span id="__span-237-9"><a id="__codelineno-237-9" name="__codelineno-237-9" href="#__codelineno-237-9"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">SPECIAL_FORMS</span><span class="p">[</span><span class="n">result</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">first</span><span class="p">](</span><span class="n">rest_expr</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">in_tail</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-237-10"><a id="__codelineno-237-10" name="__codelineno-237-10" href="#__codelineno-237-10"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-237-11"><a id="__codelineno-237-11" name="__codelineno-237-11" href="#__codelineno-237-11"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">original_scheme_eval</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">expr</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-237-12"><a id="__codelineno-237-12" name="__codelineno-237-12" href="#__codelineno-237-12"></a>    <span class="k">return</span> <span class="n">result</span>
</span></code></pre></div>
<p>最后测试，终于全部通过了😭，总算是全部完成了这个project</p>
<details class="note">
<summary>code</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-238-1"><a id="__codelineno-238-1" name="__codelineno-238-1" href="#__codelineno-238-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">optimize_tail_calls</span><span class="p">(</span><span class="n">original_scheme_eval</span><span class="p">):</span>
</span><span id="__span-238-2"><a id="__codelineno-238-2" name="__codelineno-238-2" href="#__codelineno-238-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">optimized_eval</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">tail</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="__span-238-3"><a id="__codelineno-238-3" name="__codelineno-238-3" href="#__codelineno-238-3"></a>        <span class="k">if</span> <span class="n">tail</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">scheme_symbolp</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">self_evaluating</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
</span><span id="__span-238-4"><a id="__codelineno-238-4" name="__codelineno-238-4" href="#__codelineno-238-4"></a>            <span class="k">return</span> <span class="n">Thunk</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-238-5"><a id="__codelineno-238-5" name="__codelineno-238-5" href="#__codelineno-238-5"></a>
</span><span id="__span-238-6"><a id="__codelineno-238-6" name="__codelineno-238-6" href="#__codelineno-238-6"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">Thunk</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-238-7"><a id="__codelineno-238-7" name="__codelineno-238-7" href="#__codelineno-238-7"></a>        <span class="c1"># BEGIN PROBLEM 19</span>
</span><span id="__span-238-8"><a id="__codelineno-238-8" name="__codelineno-238-8" href="#__codelineno-238-8"></a>        <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-238-9"><a id="__codelineno-238-9" name="__codelineno-238-9" href="#__codelineno-238-9"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">original_scheme_eval</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-238-10"><a id="__codelineno-238-10" name="__codelineno-238-10" href="#__codelineno-238-10"></a>        <span class="k">while</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">Thunk</span><span class="p">):</span>
</span><span id="__span-238-11"><a id="__codelineno-238-11" name="__codelineno-238-11" href="#__codelineno-238-11"></a>            <span class="n">rest_expr</span><span class="p">,</span> <span class="n">env</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">env</span>
</span><span id="__span-238-12"><a id="__codelineno-238-12" name="__codelineno-238-12" href="#__codelineno-238-12"></a>            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">first</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;if&quot;</span><span class="p">,</span> <span class="s2">&quot;and&quot;</span><span class="p">,</span> <span class="s2">&quot;or&quot;</span><span class="p">):</span>
</span><span id="__span-238-13"><a id="__codelineno-238-13" name="__codelineno-238-13" href="#__codelineno-238-13"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">SPECIAL_FORMS</span><span class="p">[</span><span class="n">result</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">first</span><span class="p">](</span><span class="n">rest_expr</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">in_tail</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-238-14"><a id="__codelineno-238-14" name="__codelineno-238-14" href="#__codelineno-238-14"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-238-15"><a id="__codelineno-238-15" name="__codelineno-238-15" href="#__codelineno-238-15"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">original_scheme_eval</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">expr</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-238-16"><a id="__codelineno-238-16" name="__codelineno-238-16" href="#__codelineno-238-16"></a>        <span class="k">return</span> <span class="n">result</span>
</span><span id="__span-238-17"><a id="__codelineno-238-17" name="__codelineno-238-17" href="#__codelineno-238-17"></a>        <span class="c1"># END PROBLEM 19</span>
</span><span id="__span-238-18"><a id="__codelineno-238-18" name="__codelineno-238-18" href="#__codelineno-238-18"></a>    <span class="k">return</span> <span class="n">optimized_eval</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-239-1"><a id="__codelineno-239-1" name="__codelineno-239-1" href="#__codelineno-239-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">eval_all</span><span class="p">(</span><span class="n">expressions</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
</span><span id="__span-239-2"><a id="__codelineno-239-2" name="__codelineno-239-2" href="#__codelineno-239-2"></a>    <span class="c1"># BEGIN PROBLEM 7</span>
</span><span id="__span-239-3"><a id="__codelineno-239-3" name="__codelineno-239-3" href="#__codelineno-239-3"></a>    <span class="c1"># return scheme_eval(expressions.first, env) # replace this with lines of your own code</span>
</span><span id="__span-239-4"><a id="__codelineno-239-4" name="__codelineno-239-4" href="#__codelineno-239-4"></a>
</span><span id="__span-239-5"><a id="__codelineno-239-5" name="__codelineno-239-5" href="#__codelineno-239-5"></a>    <span class="c1"># result = None</span>
</span><span id="__span-239-6"><a id="__codelineno-239-6" name="__codelineno-239-6" href="#__codelineno-239-6"></a>    <span class="c1"># while expressions is not nil:</span>
</span><span id="__span-239-7"><a id="__codelineno-239-7" name="__codelineno-239-7" href="#__codelineno-239-7"></a>    <span class="c1">#     result = scheme_eval(expressions.first, env)</span>
</span><span id="__span-239-8"><a id="__codelineno-239-8" name="__codelineno-239-8" href="#__codelineno-239-8"></a>    <span class="c1">#     expressions = expressions.rest</span>
</span><span id="__span-239-9"><a id="__codelineno-239-9" name="__codelineno-239-9" href="#__codelineno-239-9"></a>    <span class="c1"># return result</span>
</span><span id="__span-239-10"><a id="__codelineno-239-10" name="__codelineno-239-10" href="#__codelineno-239-10"></a>
</span><span id="__span-239-11"><a id="__codelineno-239-11" name="__codelineno-239-11" href="#__codelineno-239-11"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">in_tail_context</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
</span><span id="__span-239-12"><a id="__codelineno-239-12" name="__codelineno-239-12" href="#__codelineno-239-12"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">Pair</span><span class="p">):</span>
</span><span id="__span-239-13"><a id="__codelineno-239-13" name="__codelineno-239-13" href="#__codelineno-239-13"></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-239-14"><a id="__codelineno-239-14" name="__codelineno-239-14" href="#__codelineno-239-14"></a>
</span><span id="__span-239-15"><a id="__codelineno-239-15" name="__codelineno-239-15" href="#__codelineno-239-15"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">Pair</span><span class="p">)</span> <span class="ow">and</span> <span class="n">scheme_symbolp</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">first</span><span class="p">):</span>
</span><span id="__span-239-16"><a id="__codelineno-239-16" name="__codelineno-239-16" href="#__codelineno-239-16"></a>            <span class="n">first</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">first</span>
</span><span id="__span-239-17"><a id="__codelineno-239-17" name="__codelineno-239-17" href="#__codelineno-239-17"></a>            <span class="k">if</span> <span class="n">first</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SPECIAL_FORMS</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="n">first</span><span class="p">),</span> <span class="n">LambdaProcedure</span><span class="p">):</span>
</span><span id="__span-239-18"><a id="__codelineno-239-18" name="__codelineno-239-18" href="#__codelineno-239-18"></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-239-19"><a id="__codelineno-239-19" name="__codelineno-239-19" href="#__codelineno-239-19"></a>            <span class="k">elif</span> <span class="n">first</span> <span class="o">==</span> <span class="s2">&quot;if&quot;</span><span class="p">:</span>
</span><span id="__span-239-20"><a id="__codelineno-239-20" name="__codelineno-239-20" href="#__codelineno-239-20"></a>                <span class="n">sub_expr_2</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">first</span>
</span><span id="__span-239-21"><a id="__codelineno-239-21" name="__codelineno-239-21" href="#__codelineno-239-21"></a>                <span class="n">sub_expr_3</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">first</span>
</span><span id="__span-239-22"><a id="__codelineno-239-22" name="__codelineno-239-22" href="#__codelineno-239-22"></a>                <span class="k">return</span> <span class="n">in_tail_context</span><span class="p">(</span><span class="n">sub_expr_2</span><span class="p">)</span> <span class="ow">and</span> <span class="n">in_tail_context</span><span class="p">(</span><span class="n">sub_expr_3</span><span class="p">)</span>
</span><span id="__span-239-23"><a id="__codelineno-239-23" name="__codelineno-239-23" href="#__codelineno-239-23"></a>            <span class="k">elif</span> <span class="n">first</span> <span class="o">==</span> <span class="s2">&quot;cond&quot;</span><span class="p">:</span>
</span><span id="__span-239-24"><a id="__codelineno-239-24" name="__codelineno-239-24" href="#__codelineno-239-24"></a>                <span class="n">non_preds</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-239-25"><a id="__codelineno-239-25" name="__codelineno-239-25" href="#__codelineno-239-25"></a>                <span class="n">cond_expr</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">rest</span>
</span><span id="__span-239-26"><a id="__codelineno-239-26" name="__codelineno-239-26" href="#__codelineno-239-26"></a>                <span class="k">while</span> <span class="n">cond_expr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">nil</span><span class="p">:</span>
</span><span id="__span-239-27"><a id="__codelineno-239-27" name="__codelineno-239-27" href="#__codelineno-239-27"></a>                    <span class="n">non_pred</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-239-28"><a id="__codelineno-239-28" name="__codelineno-239-28" href="#__codelineno-239-28"></a>                    <span class="n">sub_expr</span> <span class="o">=</span> <span class="n">cond_expr</span><span class="o">.</span><span class="n">first</span>
</span><span id="__span-239-29"><a id="__codelineno-239-29" name="__codelineno-239-29" href="#__codelineno-239-29"></a>                    <span class="k">while</span> <span class="n">sub_expr</span><span class="o">.</span><span class="n">rest</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">nil</span><span class="p">:</span>
</span><span id="__span-239-30"><a id="__codelineno-239-30" name="__codelineno-239-30" href="#__codelineno-239-30"></a>                        <span class="n">non_pred</span> <span class="o">=</span> <span class="n">sub_expr</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">first</span>
</span><span id="__span-239-31"><a id="__codelineno-239-31" name="__codelineno-239-31" href="#__codelineno-239-31"></a>                        <span class="n">sub_expr</span> <span class="o">=</span> <span class="n">sub_expr</span><span class="o">.</span><span class="n">rest</span>
</span><span id="__span-239-32"><a id="__codelineno-239-32" name="__codelineno-239-32" href="#__codelineno-239-32"></a>                    <span class="n">non_preds</span> <span class="o">+=</span> <span class="p">[</span><span class="n">non_pred</span><span class="p">]</span>
</span><span id="__span-239-33"><a id="__codelineno-239-33" name="__codelineno-239-33" href="#__codelineno-239-33"></a>                    <span class="n">cond_expr</span> <span class="o">=</span> <span class="n">cond_expr</span><span class="o">.</span><span class="n">rest</span>
</span><span id="__span-239-34"><a id="__codelineno-239-34" name="__codelineno-239-34" href="#__codelineno-239-34"></a>                <span class="k">return</span> <span class="nb">all</span><span class="p">([</span><span class="n">in_tail_context</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">non_preds</span><span class="p">])</span>
</span><span id="__span-239-35"><a id="__codelineno-239-35" name="__codelineno-239-35" href="#__codelineno-239-35"></a>            <span class="k">elif</span> <span class="n">first</span> <span class="o">==</span> <span class="s2">&quot;let&quot;</span><span class="p">:</span>
</span><span id="__span-239-36"><a id="__codelineno-239-36" name="__codelineno-239-36" href="#__codelineno-239-36"></a>                <span class="n">let_expr</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">rest</span>
</span><span id="__span-239-37"><a id="__codelineno-239-37" name="__codelineno-239-37" href="#__codelineno-239-37"></a>                <span class="k">while</span> <span class="n">let_expr</span><span class="o">.</span><span class="n">rest</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">nil</span><span class="p">:</span>
</span><span id="__span-239-38"><a id="__codelineno-239-38" name="__codelineno-239-38" href="#__codelineno-239-38"></a>                    <span class="n">let_expr</span> <span class="o">=</span> <span class="n">let_expr</span><span class="o">.</span><span class="n">rest</span>
</span><span id="__span-239-39"><a id="__codelineno-239-39" name="__codelineno-239-39" href="#__codelineno-239-39"></a>                <span class="k">return</span> <span class="n">in_tail_context</span><span class="p">(</span><span class="n">let_expr</span><span class="o">.</span><span class="n">first</span><span class="p">)</span>
</span><span id="__span-239-40"><a id="__codelineno-239-40" name="__codelineno-239-40" href="#__codelineno-239-40"></a>            <span class="k">elif</span> <span class="n">first</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;and&quot;</span><span class="p">,</span> <span class="s2">&quot;or&quot;</span><span class="p">,</span> <span class="s2">&quot;begin&quot;</span><span class="p">):</span>
</span><span id="__span-239-41"><a id="__codelineno-239-41" name="__codelineno-239-41" href="#__codelineno-239-41"></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-239-42"><a id="__codelineno-239-42" name="__codelineno-239-42" href="#__codelineno-239-42"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-239-43"><a id="__codelineno-239-43" name="__codelineno-239-43" href="#__codelineno-239-43"></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-239-44"><a id="__codelineno-239-44" name="__codelineno-239-44" href="#__codelineno-239-44"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-239-45"><a id="__codelineno-239-45" name="__codelineno-239-45" href="#__codelineno-239-45"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-239-46"><a id="__codelineno-239-46" name="__codelineno-239-46" href="#__codelineno-239-46"></a>
</span><span id="__span-239-47"><a id="__codelineno-239-47" name="__codelineno-239-47" href="#__codelineno-239-47"></a>    <span class="k">if</span> <span class="n">expressions</span> <span class="ow">is</span> <span class="n">nil</span><span class="p">:</span>
</span><span id="__span-239-48"><a id="__codelineno-239-48" name="__codelineno-239-48" href="#__codelineno-239-48"></a>        <span class="k">return</span>
</span><span id="__span-239-49"><a id="__codelineno-239-49" name="__codelineno-239-49" href="#__codelineno-239-49"></a>    <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-239-50"><a id="__codelineno-239-50" name="__codelineno-239-50" href="#__codelineno-239-50"></a>    <span class="k">while</span> <span class="n">expressions</span><span class="o">.</span><span class="n">rest</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">nil</span><span class="p">:</span>
</span><span id="__span-239-51"><a id="__codelineno-239-51" name="__codelineno-239-51" href="#__codelineno-239-51"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-239-52"><a id="__codelineno-239-52" name="__codelineno-239-52" href="#__codelineno-239-52"></a>        <span class="n">expressions</span> <span class="o">=</span> <span class="n">expressions</span><span class="o">.</span><span class="n">rest</span>
</span><span id="__span-239-53"><a id="__codelineno-239-53" name="__codelineno-239-53" href="#__codelineno-239-53"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">tail</span><span class="o">=</span><span class="n">in_tail_context</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">))</span>
</span><span id="__span-239-54"><a id="__codelineno-239-54" name="__codelineno-239-54" href="#__codelineno-239-54"></a>    <span class="k">return</span> <span class="n">result</span>
</span><span id="__span-239-55"><a id="__codelineno-239-55" name="__codelineno-239-55" href="#__codelineno-239-55"></a>    <span class="c1"># END PROBLEM 7</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-240-1"><a id="__codelineno-240-1" name="__codelineno-240-1" href="#__codelineno-240-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">do_if_form</span><span class="p">(</span><span class="n">expressions</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">in_tail</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="__span-240-2"><a id="__codelineno-240-2" name="__codelineno-240-2" href="#__codelineno-240-2"></a>    <span class="n">validate_form</span><span class="p">(</span><span class="n">expressions</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="__span-240-3"><a id="__codelineno-240-3" name="__codelineno-240-3" href="#__codelineno-240-3"></a>    <span class="k">if</span> <span class="n">is_true_primitive</span><span class="p">(</span><span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">)):</span>
</span><span id="__span-240-4"><a id="__codelineno-240-4" name="__codelineno-240-4" href="#__codelineno-240-4"></a>        <span class="k">return</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">tail</span><span class="o">=</span><span class="n">in_tail</span><span class="p">)</span>
</span><span id="__span-240-5"><a id="__codelineno-240-5" name="__codelineno-240-5" href="#__codelineno-240-5"></a>    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">expressions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="__span-240-6"><a id="__codelineno-240-6" name="__codelineno-240-6" href="#__codelineno-240-6"></a>        <span class="k">return</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">tail</span><span class="o">=</span><span class="n">in_tail</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-241-1"><a id="__codelineno-241-1" name="__codelineno-241-1" href="#__codelineno-241-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">do_and_form</span><span class="p">(</span><span class="n">expressions</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">in_tail</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="__span-241-2"><a id="__codelineno-241-2" name="__codelineno-241-2" href="#__codelineno-241-2"></a>    <span class="c1"># BEGIN PROBLEM 12</span>
</span><span id="__span-241-3"><a id="__codelineno-241-3" name="__codelineno-241-3" href="#__codelineno-241-3"></a>    <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-241-4"><a id="__codelineno-241-4" name="__codelineno-241-4" href="#__codelineno-241-4"></a>    <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;#t&quot;</span>
</span><span id="__span-241-5"><a id="__codelineno-241-5" name="__codelineno-241-5" href="#__codelineno-241-5"></a>    <span class="k">while</span> <span class="n">expressions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">nil</span><span class="p">:</span>
</span><span id="__span-241-6"><a id="__codelineno-241-6" name="__codelineno-241-6" href="#__codelineno-241-6"></a>        <span class="c1"># result = scheme_eval(expressions.first, env)</span>
</span><span id="__span-241-7"><a id="__codelineno-241-7" name="__codelineno-241-7" href="#__codelineno-241-7"></a>        <span class="c1"># if is_false_primitive(result):</span>
</span><span id="__span-241-8"><a id="__codelineno-241-8" name="__codelineno-241-8" href="#__codelineno-241-8"></a>        <span class="c1">#     return result</span>
</span><span id="__span-241-9"><a id="__codelineno-241-9" name="__codelineno-241-9" href="#__codelineno-241-9"></a>        <span class="c1"># expressions = expressions.rest</span>
</span><span id="__span-241-10"><a id="__codelineno-241-10" name="__codelineno-241-10" href="#__codelineno-241-10"></a>
</span><span id="__span-241-11"><a id="__codelineno-241-11" name="__codelineno-241-11" href="#__codelineno-241-11"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">Pair</span><span class="p">):</span>
</span><span id="__span-241-12"><a id="__codelineno-241-12" name="__codelineno-241-12" href="#__codelineno-241-12"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-241-13"><a id="__codelineno-241-13" name="__codelineno-241-13" href="#__codelineno-241-13"></a>        <span class="k">elif</span> <span class="n">in_tail</span> <span class="ow">and</span> <span class="n">scheme_symbolp</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">first</span><span class="p">):</span>
</span><span id="__span-241-14"><a id="__codelineno-241-14" name="__codelineno-241-14" href="#__codelineno-241-14"></a>            <span class="n">first</span> <span class="o">=</span> <span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">first</span>
</span><span id="__span-241-15"><a id="__codelineno-241-15" name="__codelineno-241-15" href="#__codelineno-241-15"></a>            <span class="k">if</span> <span class="n">first</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SPECIAL_FORMS</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="n">first</span><span class="p">),</span> <span class="n">LambdaProcedure</span><span class="p">):</span>
</span><span id="__span-241-16"><a id="__codelineno-241-16" name="__codelineno-241-16" href="#__codelineno-241-16"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">tail</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-241-17"><a id="__codelineno-241-17" name="__codelineno-241-17" href="#__codelineno-241-17"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-241-18"><a id="__codelineno-241-18" name="__codelineno-241-18" href="#__codelineno-241-18"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-241-19"><a id="__codelineno-241-19" name="__codelineno-241-19" href="#__codelineno-241-19"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-241-20"><a id="__codelineno-241-20" name="__codelineno-241-20" href="#__codelineno-241-20"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-241-21"><a id="__codelineno-241-21" name="__codelineno-241-21" href="#__codelineno-241-21"></a>
</span><span id="__span-241-22"><a id="__codelineno-241-22" name="__codelineno-241-22" href="#__codelineno-241-22"></a>        <span class="k">if</span> <span class="n">is_false_primitive</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">Thunk</span><span class="p">):</span>
</span><span id="__span-241-23"><a id="__codelineno-241-23" name="__codelineno-241-23" href="#__codelineno-241-23"></a>            <span class="k">break</span>
</span><span id="__span-241-24"><a id="__codelineno-241-24" name="__codelineno-241-24" href="#__codelineno-241-24"></a>        <span class="n">expressions</span> <span class="o">=</span> <span class="n">expressions</span><span class="o">.</span><span class="n">rest</span>
</span><span id="__span-241-25"><a id="__codelineno-241-25" name="__codelineno-241-25" href="#__codelineno-241-25"></a>    <span class="k">return</span> <span class="n">result</span>
</span><span id="__span-241-26"><a id="__codelineno-241-26" name="__codelineno-241-26" href="#__codelineno-241-26"></a>    <span class="c1"># END PROBLEM 12</span>
</span><span id="__span-241-27"><a id="__codelineno-241-27" name="__codelineno-241-27" href="#__codelineno-241-27"></a>
</span><span id="__span-241-28"><a id="__codelineno-241-28" name="__codelineno-241-28" href="#__codelineno-241-28"></a><span class="k">def</span><span class="w"> </span><span class="nf">do_or_form</span><span class="p">(</span><span class="n">expressions</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">in_tail</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="__span-241-29"><a id="__codelineno-241-29" name="__codelineno-241-29" href="#__codelineno-241-29"></a>    <span class="c1"># BEGIN PROBLEM 12</span>
</span><span id="__span-241-30"><a id="__codelineno-241-30" name="__codelineno-241-30" href="#__codelineno-241-30"></a>    <span class="s2">&quot;*** YOUR CODE HERE ***&quot;</span>
</span><span id="__span-241-31"><a id="__codelineno-241-31" name="__codelineno-241-31" href="#__codelineno-241-31"></a>    <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;#f&quot;</span>
</span><span id="__span-241-32"><a id="__codelineno-241-32" name="__codelineno-241-32" href="#__codelineno-241-32"></a>    <span class="k">while</span> <span class="n">expressions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">nil</span><span class="p">:</span>
</span><span id="__span-241-33"><a id="__codelineno-241-33" name="__codelineno-241-33" href="#__codelineno-241-33"></a>        <span class="c1"># result = scheme_eval(expressions.first, env)</span>
</span><span id="__span-241-34"><a id="__codelineno-241-34" name="__codelineno-241-34" href="#__codelineno-241-34"></a>        <span class="c1"># if is_true_primitive(result):</span>
</span><span id="__span-241-35"><a id="__codelineno-241-35" name="__codelineno-241-35" href="#__codelineno-241-35"></a>        <span class="c1">#     return result</span>
</span><span id="__span-241-36"><a id="__codelineno-241-36" name="__codelineno-241-36" href="#__codelineno-241-36"></a>        <span class="c1"># expressions = expressions.rest</span>
</span><span id="__span-241-37"><a id="__codelineno-241-37" name="__codelineno-241-37" href="#__codelineno-241-37"></a>
</span><span id="__span-241-38"><a id="__codelineno-241-38" name="__codelineno-241-38" href="#__codelineno-241-38"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">Pair</span><span class="p">):</span>
</span><span id="__span-241-39"><a id="__codelineno-241-39" name="__codelineno-241-39" href="#__codelineno-241-39"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-241-40"><a id="__codelineno-241-40" name="__codelineno-241-40" href="#__codelineno-241-40"></a>        <span class="k">elif</span> <span class="n">in_tail</span> <span class="ow">and</span> <span class="n">scheme_symbolp</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">first</span><span class="p">):</span>
</span><span id="__span-241-41"><a id="__codelineno-241-41" name="__codelineno-241-41" href="#__codelineno-241-41"></a>            <span class="n">first</span> <span class="o">=</span> <span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">first</span>
</span><span id="__span-241-42"><a id="__codelineno-241-42" name="__codelineno-241-42" href="#__codelineno-241-42"></a>            <span class="k">if</span> <span class="n">first</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SPECIAL_FORMS</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="n">first</span><span class="p">),</span> <span class="n">LambdaProcedure</span><span class="p">):</span>
</span><span id="__span-241-43"><a id="__codelineno-241-43" name="__codelineno-241-43" href="#__codelineno-241-43"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">tail</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-241-44"><a id="__codelineno-241-44" name="__codelineno-241-44" href="#__codelineno-241-44"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-241-45"><a id="__codelineno-241-45" name="__codelineno-241-45" href="#__codelineno-241-45"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-241-46"><a id="__codelineno-241-46" name="__codelineno-241-46" href="#__codelineno-241-46"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-241-47"><a id="__codelineno-241-47" name="__codelineno-241-47" href="#__codelineno-241-47"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">scheme_eval</span><span class="p">(</span><span class="n">expressions</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
</span><span id="__span-241-48"><a id="__codelineno-241-48" name="__codelineno-241-48" href="#__codelineno-241-48"></a>
</span><span id="__span-241-49"><a id="__codelineno-241-49" name="__codelineno-241-49" href="#__codelineno-241-49"></a>        <span class="k">if</span> <span class="n">is_true_primitive</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">Thunk</span><span class="p">):</span>
</span><span id="__span-241-50"><a id="__codelineno-241-50" name="__codelineno-241-50" href="#__codelineno-241-50"></a>            <span class="k">break</span>
</span><span id="__span-241-51"><a id="__codelineno-241-51" name="__codelineno-241-51" href="#__codelineno-241-51"></a>        <span class="n">expressions</span> <span class="o">=</span> <span class="n">expressions</span><span class="o">.</span><span class="n">rest</span>
</span><span id="__span-241-52"><a id="__codelineno-241-52" name="__codelineno-241-52" href="#__codelineno-241-52"></a>    <span class="k">return</span> <span class="n">result</span>
</span><span id="__span-241-53"><a id="__codelineno-241-53" name="__codelineno-241-53" href="#__codelineno-241-53"></a>    <span class="c1"># END PROBLEM 12</span>
</span></code></pre></div>
</details>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2024-03-13T19:47:16+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-03-13</span>
      
        <br>
        Created:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2024-03-12T13:02:19+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-03-12</span>
      
    
  </small>
</div>


  




                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../CS61A_part1/" class="md-footer__link md-footer__link--prev" aria-label="Previous: CS61A Part 1">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                CS61A Part 1
              </div>
            </div>
          </a>
        
        
          
          <a href="../CS61A_part3/" class="md-footer__link md-footer__link--next" aria-label="Next: CS61A Part 3">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                CS61A Part 3
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 - 2025 Ronald Luo
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.expand", "toc.follow", "navigation.top", "search.suggest", "navigation.footer", "navigation.tracking", "navigation.instant", "navigation.instant.progress", "content.code.copy", "search.suggest", "search.highlight", "search.share"], "search": "../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.aecac24b.min.js"></script>
      
        <script src="../../../js/timeago.min.js"></script>
      
        <script src="../../../js/timeago_mkdocs_material.js"></script>
      
        <script src="../../../js/timeago.min.js"></script>
      
        <script src="../../../js/timeago_mkdocs_material.js"></script>
      
        <script src="../../../js/timeago.min.js"></script>
      
        <script src="../../../js/timeago_mkdocs_material.js"></script>
      
        <script src="../../../javascripts/katex.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>